import{a as Z,b as N}from"./chunk-IBFSLYL4.js";import{a as Ot,b as Q}from"./chunk-SZXMKXCP.js";import{a as ht}from"./chunk-IJF73OZM.js";import{Aa as Mt,Ba as Gt,Bc as mt,Ea as a,F as Jt,Fa as p,Fb as X,Ga as dt,J as M,K as Qt,La as pt,Ma as Lt,Mc as Sn,N as D,Na as Ft,O as A,Oa as Yt,Pa as k,Pb as Y,Qa as P,Ub as H,Z as l,_ as x,_b as K,a as Bt,ab as Xt,ac as q,b as Wt,bc as yt,cb as Ht,cc as kt,da as T,db as ft,ec as nt,f as j,fc as J,gc as Pt,ha as b,hb as it,ia as E,jb as fn,jc as Dt,ka as F,kb as rt,la as V,lb as st,ma as t,mb as $,mc as At,na as e,nc as Ut,oa as m,oc as Nt,pc as Rt,sa as U,ta as L,tb as tt,ua as h,vb as G,wb as ot,wc as un,xc as hn,ya as $t,yb as Zt,za as Vt,zb as ut}from"./chunk-SGLRJF2H.js";var te=j(ut()),xn=j(ht());function Bs(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function Ws(i,s){i&1&&(t(0,"h4",22),a(1,"Drill-Down Report - Application Received"),e())}function Ms(i,s){i&1&&(t(0,"h4",22),a(1,"Drill-Down Report - Application Approved"),e())}function Fs(i,s){i&1&&(t(0,"h4",22),a(1,"Drill-Down Report - NFSA Application Rejected"),e())}function Vs(i,s){if(i&1){let o=U();t(0,"button",23),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",24),a(2,"Download PDF "),e()}}function zs(i,s){i&1&&(t(0,"button",25),m(1,"i",26),a(2,"Downloading "),e())}function js(i,s){if(i&1){let o=U();t(0,"button",23),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",24),a(2,"Download EXCEL "),e()}}function $s(i,s){i&1&&(t(0,"button",25),m(1,"i",26),a(2,"Downloading "),e())}function Gs(i,s){i&1&&(t(0,"thead",30)(1,"tr")(2,"th",31),a(3,"Sl.#"),e(),t(4,"th",31),a(5,"DISTRICT"),e(),t(6,"th",32),a(7,"APPLICATION DETAILS"),e()(),t(8,"tr")(9,"th"),a(10,"RECEIVED"),e(),t(11,"th"),a(12,"APPROVED"),e(),t(13,"th"),a(14,"NFSA APPLICATION REJECTED"),e(),t(15,"th"),a(16,"NON NFSA APPLICATION REJECTED"),e()()())}function Xs(i,s){i&1&&(t(0,"thead",30)(1,"tr")(2,"th"),a(3,"Sl.#"),e(),t(4,"th"),a(5,"DISTRICT"),e(),t(6,"th"),a(7,"APPLICATION APPROVED"),e()()())}function Ys(i,s){i&1&&(t(0,"thead",30)(1,"tr")(2,"th"),a(3,"Sl.#"),e(),t(4,"th"),a(5,"DISTRICT"),e(),t(6,"th"),a(7,"NFSA APPLICATION REJECTED"),e()()())}var ee=(i,s)=>s==null?null:s.id,Hs="/department/portal/application-stats/block-ulb-stats",ie=i=>[Hs,i],ne=(i,s)=>({application_status:i,installment:s});function Ks(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",34),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e(),t(9,"td"),a(10),e(),t(11,"td"),a(12),e(),t(13,"td"),a(14),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(4);l(2),p(n+1),l(2),T("routerLink",pt(10,ie,o==null?null:o.district_id))("queryParams",Lt(12,ne,r.application_status,r.installment)),l(1),dt(" ",P(6,8,o==null?null:o.district_name)," "),l(3),p(o==null?null:o.applications_received),l(2),p(o==null?null:o.approved_application),l(2),p(o==null?null:o.nfsa_rejected_application),l(2),p(o==null?null:o.non_nfsa_rejected_application)}}function qs(i,s){if(i&1&&(t(0,"tbody",33),F(1,Ks,15,15,"tr",null,ee),e()),i&2){let o=h(3);l(1),V(o.filteredDistrictStats)}}function Js(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",34),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(4);l(2),p(n+1),l(2),T("routerLink",pt(7,ie,o==null?null:o.district_id))("queryParams",Lt(9,ne,r.application_status,r.installment)),l(1),dt(" ",P(6,5,o==null?null:o.district_name)," "),l(3),p(o==null?null:o.approved_application)}}function Qs(i,s){if(i&1&&(t(0,"tbody",33),F(1,Js,9,12,"tr",null,ee),e()),i&2){let o=h(3);l(1),V(o.filteredDistrictStats)}}function Zs(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",34),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(4);l(2),p(n+1),l(2),T("routerLink",pt(7,ie,o==null?null:o.district_id))("queryParams",Lt(9,ne,r.application_status,r.installment)),l(1),dt(" ",P(6,5,o==null?null:o.district_name)," "),l(3),p(o==null?null:o.nfsa_rejected_application)}}function tl(i,s){if(i&1&&(t(0,"tbody",33),F(1,Zs,9,12,"tr",null,ee),e()),i&2){let o=h(3);l(1),V(o.filteredDistrictStats)}}function el(i,s){if(i&1&&(t(0,"table",27),b(1,Gs,17,0,"thead",28)(2,Xs,8,0,"thead",28)(3,Ys,8,0,"thead",28)(4,qs,3,0,"tbody",29)(5,Qs,3,0,"tbody",29)(6,tl,3,0,"tbody",29),e()),i&2){let o=h(2);l(1),T("ngIf",o.application_status=="recieved"),l(1),T("ngIf",o.application_status=="approved"),l(1),T("ngIf",o.application_status=="rejected"),l(1),T("ngIf",o.application_status=="recieved"),l(1),T("ngIf",o.application_status=="approved"),l(1),T("ngIf",o.application_status=="rejected")}}function il(i,s){i&1&&a(0," No Data Found ")}function nl(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11),b(2,Ws,2,0,"h4",12)(3,Ms,2,0,"h4",12)(4,Fs,2,0,"h4",12),e(),t(5,"div",13)(6,"div",14)(7,"input",15),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(8,"i",16),e(),t(9,"div",17),b(10,Vs,3,0,"button",18)(11,zs,3,0),e(),t(12,"div",19),b(13,js,3,0,"button",18)(14,$s,3,0),e()()(),t(15,"div",20),b(16,el,7,6,"table",21)(17,il,1,0),e()}if(i&2){let o=h();l(2),T("ngIf",o.application_status=="recieved"),l(1),T("ngIf",o.application_status=="approved"),l(1),T("ngIf",o.application_status=="rejected"),l(3),T("ngModel",o.searchTerm),l(3),E(10,o.isExportInProgress?11:10),l(3),E(13,o.isExportInProgressExcel?14:13),l(3),E(16,o.filteredDistrictStats&&o.filteredDistrictStats.length>0?16:17)}}var gn=(()=>{let s=class s{constructor(n,r,c,f,d,C,g,_){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.location=_,this.isStatsLoading=!1,this.districtStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.application_status=n.application_status,this.installment=n.installment,this.card_name=n.card_name,this.fetchDistrictStats()})}fetchDistrictStats(){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?card_name=${this.card_name}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isStatsLoading=!1,this.districtStats=n.data},n=>{this.isStatsLoading=!1,this.districtStats=[]})}goBack(){this.location.back()}get filteredDistrictStats(){return this.searchTerm?this.districtStats.filter(n=>n?.district_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.districtStats}exportToExcel(){this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?card_name=${this.card_name}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isExportInProgressExcel=!1;let r=n.data.map((I,R)=>{let z={"SI#":R+1,DISTRICT:I?.district_name.toUpperCase()};return this.application_status==="recieved"?Wt(Bt({},z),{"APPLICATION RECEIVED":I?.applications_received,"APPLICATION APPROVED":I?.approved_application,"NFSA APPLICATION REJECTED":I?.nfsa_rejected_application,"NON NFSA APPLICATION REJECTED":I?.non_nfsa_rejected_application}):this.application_status==="approved"?Wt(Bt({},z),{"APPLICATION APPROVED":I?.approved_application}):this.application_status==="rejected"?Wt(Bt({},z),{"NFSA APPLICATION REJECTED":I?.nfsa_rejected_application}):z}),c=N.json_to_sheet(r),f=N.book_new();N.book_append_sheet(f,c,"Applications");let d=Z(f,{bookType:"xlsx",type:"array"}),C=new Date,g=C.toLocaleDateString("en-GB").split("/").reverse().join("-"),_=C.toLocaleTimeString("en-GB").replace(/:/g,"-"),v=this.application_status=="recieved"?`application_recieved_district_drilldown_reports_${g}_${_}.xlsx`:this.application_status=="approved"?`application_approved_district_drilldown_reports_${g}_${_}.xlsx`:this.application_status=="rejected"?`application_rejected_district_drilldown_reports_${g}_${_}.xlsx`:"",S=new Blob([d],{type:"application/octet-stream"}),w=document.createElement("a"),u=window.URL.createObjectURL(S);w.href=u,w.download=v,w.click(),window.URL.revokeObjectURL(u)},n=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",n)})}exportToPDF(){te.default.vfs=xn.default.pdfMake.vfs,this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?card_name=${this.card_name}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isExportInProgress=!1;let r=[[{text:"SI#",fontSize:10},{text:"DISTRICT",fontSize:10},...this.application_status=="recieved"?[{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"NFSA APPLICATION REJECTED",fontSize:10},{text:"NON NFSA APPLICATION REJECTED",fontSize:10}]:this.application_status=="approved"?[{text:"APPLICATION APPROVED",fontSize:10}]:this.application_status=="rejected"?[{text:"NFSA APPLICATION REJECTED",fontSize:10}]:[]]],c=n.data.map((u,I)=>[{text:(I+1).toString().toUpperCase(),fontSize:9},{text:(u?.district_name||"").toUpperCase(),fontSize:9},...this.application_status==="recieved"?[{text:u?.applications_received||"",fontSize:9},{text:u?.approved_application||"",fontSize:9},{text:u?.nfsa_rejected_application||"",fontSize:9},{text:u?.non_nfsa_rejected_application||"",fontSize:9}]:this.application_status==="approved"?[{text:u?.approved_application||"",fontSize:9}]:this.application_status==="rejected"?[{text:u?.nfsa_rejected_application||"",fontSize:9}]:[]]);r.push(...c);let f=new Date,d=`Timestamp: ${f.toLocaleDateString()}, ${f.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,g={pageOrientation:"landscape",pageSize:"A4",content:[{text:this.application_status==="recieved"?"DRILL-DOWN REPORT - APPLICATION RECEIVED DISTRICT WISE":this.application_status==="approved"?"DRILL-DOWN REPORT - APPLICATION APPROVED DISTRICT WISE":this.application_status==="rejected"?"DRILL-DOWN REPORT - NFSA APPLICATION REJECTED DISTRICT WISE":"",style:"header"},{table:{headerRows:1,body:r,widths:Array(r[0].length).fill("15%")},layout:{fillColor:function(u){return u===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:d,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},table:{fontSize:7,lineHeight:1.2},timestamp:{fontSize:9,bold:!0,margin:[0,20,0,0],alignment:"left"}}},_=new Date,v=_.toLocaleDateString("en-GB").split("/").reverse().join("-"),S=_.toLocaleTimeString("en-GB").replace(/:/g,"-"),w=this.application_status==="recieved"?`application_recieved_district_drilldown_reports_${v}_${S}.pdf`:this.application_status==="approved"?`application_approved_district_drilldown_reports_${v}_${S}.pdf`:this.application_status==="rejected"?`application_rejected_district_drilldown_reports_${v}_${S}.pdf`:"";te.default.createPdf(g).download(w)},n=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",n)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q),x(Xt))},s.\u0275cmp=M({type:s,selectors:[["app-district-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],["style","color: #fd7b03;",4,"ngIf"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],[2,"color","#fd7b03"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],["class","text-light","style","background-color: #fd7b03;",4,"ngIf"],["style","font-size: 14px;",4,"ngIf"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],["colspan","4",1,"text-center"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,Bs,2,0)(11,nl,18,7),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ft,ot,K,q,J,it]});let i=s;return i})();var oe=j(ut()),Cn=j(ht());function ol(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function al(i,s){i&1&&(t(0,"h4",25),a(1,"Drill-Down Report - Application Received"),e())}function rl(i,s){i&1&&(t(0,"h4",25),a(1,"Drill-Down Report - Application Approved"),e())}function sl(i,s){i&1&&(t(0,"h4",25),a(1,"Drill-Down Report - NFSA Application Rejected"),e())}function ll(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",27),a(2,"Download PDF "),e()}}function cl(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}function dl(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",27),a(2,"Download EXCEL "),e()}}function pl(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}function ml(i,s){i&1&&(t(0,"thead",33)(1,"tr")(2,"th",34),a(3,"Sl.#"),e(),t(4,"th",34),a(5,"BLOCK/ULB"),e(),t(6,"th",35),a(7,"APPLICATION DETAILS"),e()(),t(8,"tr")(9,"th"),a(10,"RECEIVED"),e(),t(11,"th"),a(12,"APPROVED"),e(),t(13,"th"),a(14,"NFSA APPLICATION REJECTED"),e(),t(15,"th"),a(16,"NON NFSA APPLICATION REJECTED"),e()()())}function _l(i,s){i&1&&(t(0,"thead",33)(1,"tr")(2,"th"),a(3,"Sl.#"),e(),t(4,"th"),a(5,"BLOCK/ULB"),e(),t(6,"th"),a(7,"APPLICATION APPROVED"),e()()())}function fl(i,s){i&1&&(t(0,"thead",33)(1,"tr")(2,"th"),a(3,"Sl.#"),e(),t(4,"th"),a(5,"BLOCK/ULB"),e(),t(6,"th"),a(7,"NFSA APPLICATION REJECTED"),e()()())}var ae=(i,s)=>s==null?null:s.id,re=(i,s)=>["/department/portal/application-stats/gp-stats",i,s],Kt=(i,s)=>({application_status:i,installment:s});function ul(i,s){if(i&1&&(t(0,"a",38),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit,n=h(4);T("routerLink",Lt(5,re,o==null?null:o.district_id,o==null?null:o.block_id))("queryParams",Lt(8,Kt,n.application_status,n.installment)),l(1),dt(" ",P(2,3,o==null?null:o.block_name)," ")}}var se=(i,s)=>["/department/portal/application-stats/ward-stats",i,s];function hl(i,s){if(i&1&&(t(0,"a",38),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit,n=h(4);T("routerLink",Lt(5,se,o==null?null:o.district_id,o==null?null:o.ulb_id))("queryParams",Lt(8,Kt,n.application_status,n.installment)),l(1),dt(" ",P(2,3,o==null?null:o.ulb_name)," ")}}function Sl(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td"),b(4,ul,3,11,"a",37)(5,hl,3,11),e(),t(6,"td"),a(7),e(),t(8,"td"),a(9),e(),t(10,"td"),a(11),e(),t(12,"td"),a(13),e()()),i&2){let o=s.$implicit,n=s.$index;l(2),p(n+1),l(2),E(4,o!=null&&o.block_id?4:5),l(3),p(o==null?null:o.applications_received),l(2),p(o==null?null:o.approved_application),l(2),p(o==null?null:o.nfsa_rejected_application),l(2),p(o==null?null:o.non_nfsa_rejected_application)}}function xl(i,s){if(i&1&&(t(0,"tbody",36),F(1,Sl,14,6,"tr",null,ae),e()),i&2){let o=h(3);l(1),V(o.filteredBlockStats)}}function gl(i,s){if(i&1&&(t(0,"a",38),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit,n=h(4);T("routerLink",Lt(5,re,o==null?null:o.district_id,o==null?null:o.block_id))("queryParams",Lt(8,Kt,n.application_status,n.installment)),l(1),dt(" ",P(2,3,o==null?null:o.block_name)," ")}}function Cl(i,s){if(i&1&&(t(0,"a",38),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit,n=h(4);T("routerLink",Lt(5,se,o==null?null:o.district_id,o==null?null:o.ulb_id))("queryParams",Lt(8,Kt,n.application_status,n.installment)),l(1),dt(" ",P(2,3,o==null?null:o.ulb_name)," ")}}function bl(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td"),b(4,gl,3,11,"a",37)(5,Cl,3,11),e(),t(6,"td"),a(7),e()()),i&2){let o=s.$implicit,n=s.$index;l(2),p(n+1),l(2),E(4,o!=null&&o.block_id?4:5),l(3),p(o==null?null:o.approved_application)}}function vl(i,s){if(i&1&&(t(0,"tbody",36),F(1,bl,8,3,"tr",null,ae),e()),i&2){let o=h(3);l(1),V(o.filteredBlockStats)}}function El(i,s){if(i&1&&(t(0,"a",38),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit,n=h(4);T("routerLink",Lt(5,re,o==null?null:o.district_id,o==null?null:o.block_id))("queryParams",Lt(8,Kt,n.application_status,n.installment)),l(1),dt(" ",P(2,3,o==null?null:o.block_name)," ")}}function wl(i,s){if(i&1&&(t(0,"a",38),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit,n=h(4);T("routerLink",Lt(5,se,o==null?null:o.district_id,o==null?null:o.ulb_id))("queryParams",Lt(8,Kt,n.application_status,n.installment)),l(1),dt(" ",P(2,3,o==null?null:o.ulb_name)," ")}}function Tl(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td"),b(4,El,3,11,"a",37)(5,wl,3,11),e(),t(6,"td"),a(7),e()()),i&2){let o=s.$implicit,n=s.$index;l(2),p(n+1),l(2),E(4,o!=null&&o.block_id?4:5),l(3),p(o==null?null:o.nfsa_rejected_application)}}function Ll(i,s){if(i&1&&(t(0,"tbody",36),F(1,Tl,8,3,"tr",null,ae),e()),i&2){let o=h(3);l(1),V(o.filteredBlockStats)}}function Il(i,s){if(i&1&&(t(0,"table",30),b(1,ml,17,0,"thead",31)(2,_l,8,0,"thead",31)(3,fl,8,0,"thead",31)(4,xl,3,0,"tbody",32)(5,vl,3,0,"tbody",32)(6,Ll,3,0,"tbody",32),e()),i&2){let o=h(2);l(1),T("ngIf",o.application_status=="recieved"),l(1),T("ngIf",o.application_status=="approved"),l(1),T("ngIf",o.application_status=="rejected"),l(1),T("ngIf",o.application_status=="recieved"),l(1),T("ngIf",o.application_status=="approved"),l(1),T("ngIf",o.application_status=="rejected")}}function yl(i,s){i&1&&a(0," No Data Found ")}function kl(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11),b(2,al,2,0,"h4",12)(3,rl,2,0,"h4",12)(4,sl,2,0,"h4",12),t(5,"nav",13)(6,"ol",14)(7,"li",15),a(8),e()()()(),t(9,"div",16)(10,"div",17)(11,"input",18),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(12,"i",19),e(),t(13,"div",20),b(14,ll,3,0,"button",21)(15,cl,3,0),e(),t(16,"div",22),b(17,dl,3,0,"button",21)(18,pl,3,0),e()()(),t(19,"div",23),b(20,Il,7,6,"table",24)(21,yl,1,0),e()}if(i&2){let o=h();l(2),T("ngIf",o.application_status=="recieved"),l(1),T("ngIf",o.application_status=="approved"),l(1),T("ngIf",o.application_status=="rejected"),l(4),p(o.filteredBlockStats[0].district_name),l(3),T("ngModel",o.searchTerm),l(3),E(14,o.isExportInProgress?15:14),l(3),E(17,o.isExportInProgressExcel?18:17),l(3),E(20,o.filteredBlockStats&&o.filteredBlockStats.length>0?20:21)}}var bn=(()=>{let s=class s{constructor(n,r,c,f,d,C,g,_){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.location=_,this.isStatsLoading=!1,this.districtStats=[],this.district_id="",this.blockStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.application_status=n.application_status,this.installment=n.installment}),this.route.params.subscribe(n=>{let r=n.id;this.district_id=r,this.fetchblockStats(r)})}goBack(){this.location.back()}fetchblockStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/block-count?district_id=${n}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.blockStats=r.data,this.fetchulbStats(n)},r=>{this.isStatsLoading=!1,this.blockStats=[]})}fetchulbStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/ulb-count?district_id=${n}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.blockStats=[...this.blockStats,...r.data]},r=>{this.isStatsLoading=!1})}get filteredBlockStats(){return this.searchTerm?this.blockStats.filter(n=>n?.block_name&&n?.block_name.toLowerCase().includes(this.searchTerm.toLowerCase())||n?.ulb_name&&n?.ulb_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.blockStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.blockStats.map((u,I)=>{let R={"SI#":I+1,DISTRICT:u?.district_name,"BLOCK/ULB":(u?.block_name||u?.ulb_name).toUpperCase()};return this.application_status==="recieved"?Wt(Bt({},R),{"APPLICATION RECEIVED":u?.applications_received,"APPLICATION APPROVED":u?.approved_application,"NFSA APPLICATION REJECTED":u?.nfsa_rejected_application,"NON NFSA APPLICATION REJECTED":u?.non_nfsa_rejected_application}):this.application_status==="approved"?Wt(Bt({},R),{"APPLICATION APPROVED":u?.approved_application}):this.application_status==="rejected"?Wt(Bt({},R),{"NFSA APPLICATION REJECTED":u?.nfsa_rejected_application}):R}),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=this.application_status=="recieved"?`application_recieved_block_ulb_drilldown_reports_${C}_${g}.xlsx`:this.application_status=="approved"?`application_approved_block_ulb_drilldown_reports_${C}_${g}.xlsx`:this.application_status=="rejected"?`application_rejected_block_ulb_drilldown_reports_${C}_${g}.xlsx`:"",v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){oe.default.vfs=Cn.default.pdfMake.vfs,this.isExportInProgress=!0;let r=((this.blockStats[0]||{}).district_name||"N/A").toUpperCase(),f=[[{text:"SI#",fontSize:10},{text:"BLOCK/ULB",fontSize:10},...this.application_status==="recieved"?[{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"NFSA APPLICATION REJECTED",fontSize:10},{text:"NON NFSA APPLICATION REJECTED",fontSize:10}]:this.application_status==="approved"?[{text:"APPLICATION APPROVED",fontSize:10}]:this.application_status==="rejected"?[{text:"NFSA APPLICATION REJECTED",fontSize:10}]:[]]],d=this.blockStats.map((R,z)=>[{text:(z+1).toString().toUpperCase(),fontSize:9},{text:(R?.block_name||R?.ulb_name||"").toUpperCase(),fontSize:9},...this.application_status==="recieved"?[{text:R?.applications_received||"",fontSize:9},{text:R?.approved_application||"",fontSize:9},{text:R?.nfsa_rejected_application||"",fontSize:9},{text:R?.non_nfsa_rejected_application||"",fontSize:9}]:this.application_status==="approved"?[{text:R?.approved_application||"",fontSize:9}]:this.application_status==="rejected"?[{text:R?.nfsa_rejected_application||"",fontSize:9}]:[]]);f.push(...d);let C=new Date,g=`Timestamp: ${C.toLocaleDateString()}, ${C.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,_=this.application_status=="recieved"?"DRILL-DOWN REPORT - APPLICATION RECIEVED BLOCK-ULB WISE":this.application_status=="approved"?"DRILL-DOWN REPORT - APPLICATION APPROVED BLOCK-ULB WISE":this.application_status=="rejected"?"DRILL-DOWN REPORT - NFSA APPLICATION REJECTED BLOCK-ULB WISE":"",v={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r}`,style:"breadcrumb",margin:[0,0,0,10]},{text:_,style:"header"},{table:{headerRows:1,body:f,widths:Array(f[0].length).fill("15%")},layout:{fillColor:function(R){return R===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:g,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},S=new Date,w=S.toLocaleDateString("en-GB").split("/").reverse().join("-"),u=S.toLocaleTimeString("en-GB").replace(/:/g,"-"),I=this.application_status=="recieved"?`application_recieved_block_ulb_drilldown_reports_${w}_${u}.pdf`:this.application_status=="approved"?`application_approved_block_ulb_drilldown_reports_${w}_${u}.pdf`:this.application_status=="rejected"?`application_rejected_block_ulb_drilldown_reports_${w}_${u}.pdf`:"";oe.default.createPdf(v).download(I,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q),x(Xt))},s.\u0275cmp=M({type:s,selectors:[["app-block-ulb-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],["style","color: #fd7b03;",4,"ngIf"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],[2,"color","#fd7b03"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],["class","text-light","style","background-color: #fd7b03;",4,"ngIf"],["style","font-size: 14px;",4,"ngIf"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],["colspan","4",1,"text-center"],[2,"font-size","14px"],["style","text-decoration: none",3,"routerLink","queryParams"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,ol,2,0)(11,kl,22,8),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ft,ot,K,q,J,it]});let i=s;return i})();var le=j(ut()),vn=j(ht());function Pl(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function Dl(i,s){i&1&&(t(0,"h4",26),a(1,"Drill-Down Report - Application Received"),e())}function Al(i,s){i&1&&(t(0,"h4",26),a(1,"Drill-Down Report - Application Approved"),e())}function Ul(i,s){i&1&&(t(0,"h4",26),a(1,"Drill-Down Report - NFSA Application Rejected"),e())}function Nl(i,s){if(i&1){let o=U();t(0,"button",27),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",28),a(2,"Download PDF "),e()}}function Rl(i,s){i&1&&(t(0,"button",29),m(1,"i",30),a(2,"Downloading "),e())}function Ol(i,s){if(i&1){let o=U();t(0,"button",27),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",28),a(2,"Download EXCEL "),e()}}function Bl(i,s){i&1&&(t(0,"button",29),m(1,"i",30),a(2,"Downloading "),e())}function Wl(i,s){i&1&&(t(0,"thead",34)(1,"tr")(2,"th",35),a(3,"Sl.#"),e(),t(4,"th",35),a(5,"GRAM PANCHAYAT"),e(),t(6,"th",36),a(7,"APPLICATION DETAILS"),e()(),t(8,"tr")(9,"th"),a(10,"RECEIVED"),e(),t(11,"th"),a(12,"APPROVED"),e(),t(13,"th"),a(14,"NFSA APPLICATION REJECTED"),e(),t(15,"th"),a(16,"NON NFSA APPLICATION REJECTED"),e()()())}function Ml(i,s){i&1&&(t(0,"thead",34)(1,"tr")(2,"th"),a(3,"Sl.#"),e(),t(4,"th"),a(5,"GRAM PANCHAYAT"),e(),t(6,"th"),a(7,"APPLICATION APPROVED"),e()()())}function Fl(i,s){i&1&&(t(0,"thead",34)(1,"tr")(2,"th"),a(3,"Sl.#"),e(),t(4,"th"),a(5,"GRAM PANCHAYAT"),e(),t(6,"th"),a(7,"NFSA APPLICATION REJECTED"),e()()())}var ce=(i,s)=>s==null?null:s.id,Vl="/department/portal/application-stats/village-stats",de=(i,s,o)=>[Vl,i,s,o],pe=(i,s)=>({application_status:i,installment:s});function zl(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",38),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e(),t(9,"td"),a(10),e(),t(11,"td"),a(12),e(),t(13,"td"),a(14),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(4);l(2),p(n+1),l(2),T("routerLink",Ft(10,de,o==null?null:o.district_id,o==null?null:o.block_id,o==null?null:o.gp_id))("queryParams",Lt(14,pe,r.application_status,r.installment)),l(1),dt(" ",P(6,8,o==null?null:o.gp_name)," "),l(3),p(o==null?null:o.applications_received),l(2),p(o==null?null:o.approved_application),l(2),p(o==null?null:o.nfsa_rejected_application),l(2),p(o==null?null:o.non_nfsa_rejected_application)}}function jl(i,s){if(i&1&&(t(0,"tbody",37),F(1,zl,15,17,"tr",null,ce),e()),i&2){let o=h(3);l(1),V(o.filteredGpStats)}}function $l(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",38),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(4);l(2),p(n+1),l(2),T("routerLink",Ft(7,de,o==null?null:o.district_id,o==null?null:o.block_id,o==null?null:o.gp_id))("queryParams",Lt(11,pe,r.application_status,r.installment)),l(1),dt(" ",P(6,5,o==null?null:o.gp_name)," "),l(3),p(o==null?null:o.approved_application)}}function Gl(i,s){if(i&1&&(t(0,"tbody",37),F(1,$l,9,14,"tr",null,ce),e()),i&2){let o=h(3);l(1),V(o.filteredGpStats)}}function Xl(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",38),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(4);l(2),p(n+1),l(2),T("routerLink",Ft(7,de,o==null?null:o.district_id,o==null?null:o.block_id,o==null?null:o.gp_id))("queryParams",Lt(11,pe,r.application_status,r.installment)),l(1),dt(" ",P(6,5,o==null?null:o.gp_name)," "),l(3),p(o==null?null:o.nfsa_rejected_application)}}function Yl(i,s){if(i&1&&(t(0,"tbody",37),F(1,Xl,9,14,"tr",null,ce),e()),i&2){let o=h(3);l(1),V(o.filteredGpStats)}}function Hl(i,s){if(i&1&&(t(0,"table",31),b(1,Wl,17,0,"thead",32)(2,Ml,8,0,"thead",32)(3,Fl,8,0,"thead",32)(4,jl,3,0,"tbody",33)(5,Gl,3,0,"tbody",33)(6,Yl,3,0,"tbody",33),e()),i&2){let o=h(2);l(1),T("ngIf",o.application_status=="recieved"),l(1),T("ngIf",o.application_status=="approved"),l(1),T("ngIf",o.application_status=="rejected"),l(1),T("ngIf",o.application_status=="recieved"),l(1),T("ngIf",o.application_status=="approved"),l(1),T("ngIf",o.application_status=="rejected")}}function Kl(i,s){i&1&&a(0," No Data Found ")}function ql(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11),b(2,Dl,2,0,"h4",12)(3,Al,2,0,"h4",12)(4,Ul,2,0,"h4",12),t(5,"nav",13)(6,"ol",14)(7,"li",15),a(8),e(),t(9,"li",16),a(10),e()()()(),t(11,"div",17)(12,"div",18)(13,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(14,"i",20),e(),t(15,"div",21),b(16,Nl,3,0,"button",22)(17,Rl,3,0),e(),t(18,"div",23),b(19,Ol,3,0,"button",22)(20,Bl,3,0),e()()(),t(21,"div",24),b(22,Hl,7,6,"table",25)(23,Kl,1,0),e()}if(i&2){let o=h();l(2),T("ngIf",o.application_status=="recieved"),l(1),T("ngIf",o.application_status=="approved"),l(1),T("ngIf",o.application_status=="rejected"),l(4),p(o.filteredGpStats[0].district_name),l(2),p(o.filteredGpStats[0].block_name),l(3),T("ngModel",o.searchTerm),l(3),E(16,o.isExportInProgress?17:16),l(3),E(19,o.isExportInProgressExcel?20:19),l(3),E(22,o.filteredGpStats&&o.filteredGpStats.length>0?22:23)}}var En=(()=>{let s=class s{constructor(n,r,c,f,d,C,g,_){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.location=_,this.isStatsLoading=!1,this.block_id="",this.district_id="",this.gpStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.application_status=n.application_status,this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.id,this.fetchgpStats(this.block_id)})}goBack(){this.location.back()}fetchgpStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/gp-count?block_id=${n}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.gpStats=r.data},r=>{this.isStatsLoading=!1,this.gpStats=[]})}get filteredGpStats(){return this.searchTerm?this.gpStats.filter(n=>n?.gp_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.gpStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.gpStats.map((u,I)=>{let R={"SI#":I+1,DISTRICT:u?.district_name?u?.district_name.toUpperCase():"",BLOCK:u?.block_name?u?.block_name.toUpperCase():"",GP:u?.gp_name?u?.gp_name.toUpperCase():""};return this.application_status==="recieved"?Wt(Bt({},R),{"APPLICATION RECEIVED":u?.applications_received,"APPLICATION APPROVED":u?.approved_application,"NFSA APPLICATION REJECTED":u?.nfsa_rejected_application,"NON NFSA APPLICATION REJECTED":u?.non_nfsa_rejected_application}):this.application_status==="approved"?Wt(Bt({},R),{"APPLICATION APPROVED":u?.approved_application}):this.application_status==="rejected"?Wt(Bt({},R),{"NFSA APPLICATION REJECTED":u?.nfsa_rejected_application}):R}),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=this.application_status=="recieved"?`application_recieved_gp_drilldown_reports_${C}_${g}.xlsx`:this.application_status=="approved"?`application_approved_gp_drilldown_reports_${C}_${g}.xlsx`:this.application_status=="rejected"?`application_rejected_gp_drilldown_reports_${C}_${g}.xlsx`:"",v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){le.default.vfs=vn.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.gpStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),d=[[{text:"SI#",fontSize:10},{text:"GP",fontSize:10},...this.application_status==="recieved"?[{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"NFSA APPLICATION REJECTED",fontSize:10},{text:"NON NFSA APPLICATION REJECTED",fontSize:10}]:this.application_status==="approved"?[{text:"APPLICATION APPROVED",fontSize:10}]:this.application_status==="rejected"?[{text:"NFSA APPLICATION REJECTED",fontSize:10}]:[]]],C=this.gpStats.map((z,at)=>[{text:(at+1).toString().toUpperCase(),fontSize:9},{text:(z?.gp_name||"").toUpperCase(),fontSize:9},...this.application_status==="recieved"?[{text:z?.applications_received||"",fontSize:9},{text:z?.approved_application||"",fontSize:9},{text:z?.nfsa_rejected_application||"",fontSize:9},{text:z?.non_nfsa_rejected_application||"",fontSize:9}]:this.application_status==="approved"?[{text:z?.approved_application||"",fontSize:9}]:this.application_status==="rejected"?[{text:z?.nfsa_rejected_application||"",fontSize:9}]:[]]);d.push(...C);let g=new Date,_=`Timestamp: ${g.toLocaleDateString()}, ${g.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,v=this.application_status=="recieved"?"DRILL-DOWN REPORT - APPLICATION RECIEVED GP WISE":this.application_status=="approved"?"DRILL-DOWN REPORT - APPLICATION APPROVED GP WISE":this.application_status=="rejected"?"DRILL-DOWN REPORT - NFSA APPLICATION REJECTED GP WISE":"",S={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK: ${c}`,style:"breadcrumb",margin:[0,0,0,10]},{text:v,style:"header"},{table:{headerRows:1,body:d,widths:Array(d[0].length).fill("15%")},layout:{fillColor:function(z){return z===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:_,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},w=new Date,u=w.toLocaleDateString("en-GB").split("/").reverse().join("-"),I=w.toLocaleTimeString("en-GB").replace(/:/g,"-"),R=this.application_status=="recieved"?`application_recieved_gp_drilldown_reports_${u}_${I}.pdf`:this.application_status=="approved"?`application_approved_gp_drilldown_reports_${u}_${I}.pdf`:this.application_status=="rejected"?`application_rejected_gp_drilldown_reports_${u}_${I}.pdf`:"";le.default.createPdf(S).download(R,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q),x(Xt))},s.\u0275cmp=M({type:s,selectors:[["app-gp-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],["style","color: #fd7b03;",4,"ngIf"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],[2,"color","#fd7b03"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],["class","text-light","style","background-color: #fd7b03;",4,"ngIf"],["style","font-size: 14px;",4,"ngIf"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],["colspan","4",1,"text-center"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,Pl,2,0)(11,ql,24,9),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ft,ot,K,q,J,it]});let i=s;return i})();var me=j(ut()),wn=j(ht());function Jl(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function Ql(i,s){i&1&&(t(0,"h4",26),a(1,"Drill-Down Report - Application Received"),e())}function Zl(i,s){i&1&&(t(0,"h4",26),a(1,"Drill-Down Report - Application Approved"),e())}function tc(i,s){i&1&&(t(0,"h4",26),a(1,"Drill-Down Report - NFSA Application Rejected"),e())}function ec(i,s){if(i&1){let o=U();t(0,"button",27),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",28),a(2,"Download PDF "),e()}}function ic(i,s){i&1&&(t(0,"button",29),m(1,"i",30),a(2,"Downloading "),e())}function nc(i,s){if(i&1){let o=U();t(0,"button",27),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",28),a(2,"Download EXCEL "),e()}}function oc(i,s){i&1&&(t(0,"button",29),m(1,"i",30),a(2,"Downloading "),e())}function ac(i,s){i&1&&(t(0,"thead",34)(1,"tr")(2,"th",35),a(3,"Sl.#"),e(),t(4,"th",35),a(5,"WARD"),e(),t(6,"th",36),a(7,"APPLICATION DETAILS"),e()(),t(8,"tr")(9,"th"),a(10,"RECEIVED"),e(),t(11,"th"),a(12,"APPROVED"),e(),t(13,"th"),a(14,"NFSA APPLICATION REJECTED"),e(),t(15,"th"),a(16,"NON NFSA APPLICATION REJECTED"),e()()())}function rc(i,s){i&1&&(t(0,"thead",34)(1,"tr")(2,"th"),a(3,"Sl.#"),e(),t(4,"th"),a(5,"WARD"),e(),t(6,"th"),a(7,"APPLICATION APPROVED"),e()()())}function sc(i,s){i&1&&(t(0,"thead",34)(1,"tr")(2,"th"),a(3,"Sl.#"),e(),t(4,"th"),a(5,"WARD"),e(),t(6,"th"),a(7,"NFSA APPLICATION REJECTED"),e()()())}var _e=(i,s)=>s==null?null:s.id,lc="/department/portal/application-stats/ward-user-list",fe=(i,s,o)=>[lc,i,s,o],ue=(i,s)=>({application_status:i,installment:s});function cc(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",38),a(5),e()(),t(6,"td"),a(7),e(),t(8,"td"),a(9),e(),t(10,"td"),a(11),e(),t(12,"td"),a(13),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(4);l(2),p(n+1),l(2),T("routerLink",Ft(8,fe,o.district_id,o.ulb_id,o.ward_id))("queryParams",Lt(12,ue,r.application_status,r.installment)),l(1),dt(" ",o.ward_no," "),l(2),p(o==null?null:o.applications_received),l(2),p(o==null?null:o.approved_application),l(2),p(o==null?null:o.nfsa_rejected_application),l(2),p(o==null?null:o.non_nfsa_rejected_application)}}function dc(i,s){if(i&1&&(t(0,"tbody",37),F(1,cc,14,15,"tr",null,_e),e()),i&2){let o=h(3);l(1),V(o.filteredWardStats)}}function pc(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",38),a(5),e()(),t(6,"td"),a(7),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(4);l(2),p(n+1),l(2),T("routerLink",Ft(5,fe,o.district_id,o.ulb_id,o.ward_id))("queryParams",Lt(9,ue,r.application_status,r.installment)),l(1),dt(" ",o.ward_no," "),l(2),p(o==null?null:o.approved_application)}}function mc(i,s){if(i&1&&(t(0,"tbody",37),F(1,pc,8,12,"tr",null,_e),e()),i&2){let o=h(3);l(1),V(o.filteredWardStats)}}function _c(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",38),a(5),e()(),t(6,"td"),a(7),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(4);l(2),p(n+1),l(2),T("routerLink",Ft(5,fe,o.district_id,o.ulb_id,o.ward_id))("queryParams",Lt(9,ue,r.application_status,r.installment)),l(1),dt(" ",o.ward_no," "),l(2),p(o==null?null:o.nfsa_rejected_application)}}function fc(i,s){if(i&1&&(t(0,"tbody",37),F(1,_c,8,12,"tr",null,_e),e()),i&2){let o=h(3);l(1),V(o.filteredWardStats)}}function uc(i,s){if(i&1&&(t(0,"table",31),b(1,ac,17,0,"thead",32)(2,rc,8,0,"thead",32)(3,sc,8,0,"thead",32)(4,dc,3,0,"tbody",33)(5,mc,3,0,"tbody",33)(6,fc,3,0,"tbody",33),e()),i&2){let o=h(2);l(1),T("ngIf",o.application_status=="recieved"),l(1),T("ngIf",o.application_status=="approved"),l(1),T("ngIf",o.application_status=="rejected"),l(1),T("ngIf",o.application_status=="recieved"),l(1),T("ngIf",o.application_status=="approved"),l(1),T("ngIf",o.application_status=="rejected")}}function hc(i,s){i&1&&a(0," No Data Found ")}function Sc(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11),b(2,Ql,2,0,"h4",12)(3,Zl,2,0,"h4",12)(4,tc,2,0,"h4",12),t(5,"nav",13)(6,"ol",14)(7,"li",15),a(8),e(),t(9,"li",16),a(10),e()()()(),t(11,"div",17)(12,"div",18)(13,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(14,"i",20),e(),t(15,"div",21),b(16,ec,3,0,"button",22)(17,ic,3,0),e(),t(18,"div",23),b(19,nc,3,0,"button",22)(20,oc,3,0),e()()(),t(21,"div",24),b(22,uc,7,6,"table",25)(23,hc,1,0),e()}if(i&2){let o=h();l(2),T("ngIf",o.application_status=="recieved"),l(1),T("ngIf",o.application_status=="approved"),l(1),T("ngIf",o.application_status=="rejected"),l(4),p(o.filteredWardStats[0].district_name),l(2),p(o.filteredWardStats[0].ulb_name),l(3),T("ngModel",o.searchTerm),l(3),E(16,o.isExportInProgress?17:16),l(3),E(19,o.isExportInProgressExcel?20:19),l(3),E(22,o.filteredWardStats&&o.filteredWardStats.length>0?22:23)}}var Tn=(()=>{let s=class s{constructor(n,r,c,f,d,C,g,_){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.location=_,this.isStatsLoading=!1,this.block_id="",this.district_id="",this.wardStats=[],this.ulb_id="",this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.application_status=n.application_status,this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.ulb_id=n.id,this.fetchWardStats(this.ulb_id)})}goBack(){this.location.back()}fetchWardStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/ward-count?ulb_id=${n}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.wardStats=r.data},r=>{this.isStatsLoading=!1,this.wardStats=[]})}get filteredWardStats(){return this.searchTerm?this.wardStats.filter(n=>n.ward_no.toLowerCase().includes(this.searchTerm.toLowerCase())):this.wardStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.wardStats.map((u,I)=>{let R={"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",ULB:u.ulb_name?u.ulb_name.toUpperCase():"","WARD NO.":u.ward_no?u.ward_no.toUpperCase():""};return this.application_status==="recieved"?Wt(Bt({},R),{"APPLICATION RECEIVED":u?.applications_received,"APPLICATION APPROVED":u?.approved_application,"NFSA APPLICATION REJECTED":u?.nfsa_rejected_application,"NON NFSA APPLICATION REJECTED":u?.non_nfsa_rejected_application}):this.application_status==="approved"?Wt(Bt({},R),{"APPLICATION APPROVED":u?.approved_application}):this.application_status==="rejected"?Wt(Bt({},R),{"NFSA APPLICATION REJECTED":u?.nfsa_rejected_application}):R}),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=this.application_status=="recieved"?`application_recieved_ward_drilldown_reports_${C}_${g}.xlsx`:this.application_status=="approved"?`application_approved_ward_drilldown_reports_${C}_${g}.xlsx`:this.application_status=="rejected"?`application_rejected_ward_drilldown_reports_${C}_${g}.xlsx`:"",v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){me.default.vfs=wn.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.wardStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),d=[[{text:"SI#",fontSize:10},{text:"WARD NO.",fontSize:10},...this.application_status==="recieved"?[{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"NFSA APPLICATION REJECTED",fontSize:10},{text:"NON NFSA APPLICATION REJECTED",fontSize:10}]:this.application_status==="approved"?[{text:"APPLICATION APPROVED",fontSize:10}]:this.application_status==="rejected"?[{text:"NFSA APPLICATION REJECTED",fontSize:10}]:[]]],C=this.wardStats.map((z,at)=>[{text:(at+1).toString().toUpperCase(),fontSize:9},{text:(z.ward_no||"").toUpperCase(),fontSize:9},...this.application_status==="recieved"?[{text:z?.applications_received||"",fontSize:9},{text:z?.approved_application||"",fontSize:9},{text:z?.nfsa_rejected_application||"",fontSize:9},{text:z?.non_nfsa_rejected_application||"",fontSize:9}]:this.application_status==="approved"?[{text:z?.approved_application||"",fontSize:9}]:this.application_status==="rejected"?[{text:z?.nfsa_rejected_application||"",fontSize:9}]:[]]);d.push(...C);let g=new Date,_=`Timestamp: ${g.toLocaleDateString()}, ${g.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,v=this.application_status=="recieved"?"DRILL-DOWN REPORT - APPLICATION RECIEVED WARD WISE":this.application_status=="approved"?"DRILL-DOWN REPORT - APPLICATION APPROVED WARD WISE":this.application_status=="rejected"?"DRILL-DOWN REPORT - NFSA APPLICATION REJECTED WARD WISE":"",S={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK/ULB: ${c}`,style:"breadcrumb",margin:[0,0,0,10]},{text:v,style:"header"},{table:{headerRows:1,body:d,widths:Array(d[0].length).fill("15%")},layout:{fillColor:function(z){return z===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:_,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},w=new Date,u=w.toLocaleDateString("en-GB").split("/").reverse().join("-"),I=w.toLocaleTimeString("en-GB").replace(/:/g,"-"),R=this.application_status=="recieved"?`application_recieved_ward_drilldown_reports_${u}_${I}.pdf`:this.application_status=="approved"?`application_approved_ward_drilldown_reports_${u}_${I}.pdf`:this.application_status=="rejected"?`application_rejected_ward_drilldown_reports_${u}_${I}.pdf`:"";me.default.createPdf(S).download(R,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q),x(Xt))},s.\u0275cmp=M({type:s,selectors:[["app-ward-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],["style","color: #fd7b03;",4,"ngIf"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],[2,"color","#fd7b03"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],["class","text-light","style","background-color: #fd7b03;",4,"ngIf"],["style","font-size: 14px;",4,"ngIf"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],["colspan","4",1,"text-center"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,Jl,2,0)(11,Sc,24,9),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ft,ot,K,q,J]});let i=s;return i})();var he=j(ut()),Ln=j(ht());function xc(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function gc(i,s){i&1&&(t(0,"h4",26),a(1,"Drill-Down Report - Application Received"),e())}function Cc(i,s){i&1&&(t(0,"h4",26),a(1,"Drill-Down Report - Application Approved"),e())}function bc(i,s){i&1&&(t(0,"h4",26),a(1,"Drill-Down Report - NFSA Application Rejected"),e())}function vc(i,s){if(i&1){let o=U();t(0,"button",27),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",28),a(2,"Download PDF "),e()}}function Ec(i,s){i&1&&(t(0,"button",29),m(1,"i",30),a(2,"Downloading "),e())}function wc(i,s){if(i&1){let o=U();t(0,"button",27),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",28),a(2,"Download EXCEL "),e()}}function Tc(i,s){i&1&&(t(0,"button",29),m(1,"i",30),a(2,"Downloading "),e())}function Lc(i,s){i&1&&(t(0,"thead",34)(1,"tr")(2,"th",35),a(3,"Sl.#"),e(),t(4,"th",35),a(5,"VILLAGE"),e(),t(6,"th",36),a(7,"APPLICATION DETAILS"),e()(),t(8,"tr")(9,"th"),a(10,"RECEIVED"),e(),t(11,"th"),a(12,"APPROVED"),e(),t(13,"th"),a(14,"NFSA APPLICATION REJECTED"),e(),t(15,"th"),a(16,"NON NFSA APPLICATION REJECTED"),e()()())}function Ic(i,s){i&1&&(t(0,"thead",34)(1,"tr")(2,"th"),a(3,"Sl.#"),e(),t(4,"th"),a(5,"VILLAGE"),e(),t(6,"th"),a(7,"APPLICATION APPROVED"),e()()())}function yc(i,s){i&1&&(t(0,"thead",34)(1,"tr")(2,"th"),a(3,"Sl.#"),e(),t(4,"th"),a(5,"VILLAGE"),e(),t(6,"th"),a(7,"NFSA APPLICATION REJECTED"),e()()())}var Se=(i,s)=>s==null?null:s.id,kc="/department/portal/application-stats/village-user-list",xe=(i,s,o,n)=>[kc,i,s,o,n],ge=(i,s)=>({application_status:i,installment:s});function Pc(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",38),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e(),t(9,"td"),a(10),e(),t(11,"td"),a(12),e(),t(13,"td"),a(14),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(4);l(2),p(n+1),l(2),T("routerLink",Yt(10,xe,o.district_id,o.block_id,o.gp_id,o.village_id))("queryParams",Lt(15,ge,r.application_status,r.installment)),l(1),dt(" ",P(6,8,o.village_name)," "),l(3),p(o==null?null:o.applications_received),l(2),p(o==null?null:o.approved_application),l(2),p(o==null?null:o.nfsa_rejected_application),l(2),p(o==null?null:o.non_nfsa_rejected_application)}}function Dc(i,s){if(i&1&&(t(0,"tbody",37),F(1,Pc,15,18,"tr",null,Se),e()),i&2){let o=h(3);l(1),V(o.filteredVillageStats)}}function Ac(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",38),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(4);l(2),p(n+1),l(2),T("routerLink",Yt(7,xe,o.district_id,o.block_id,o.gp_id,o.village_id))("queryParams",Lt(12,ge,r.application_status,r.installment)),l(1),dt(" ",P(6,5,o.village_name)," "),l(3),p(o==null?null:o.approved_application)}}function Uc(i,s){if(i&1&&(t(0,"tbody",37),F(1,Ac,9,15,"tr",null,Se),e()),i&2){let o=h(3);l(1),V(o.filteredVillageStats)}}function Nc(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",38),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(4);l(2),p(n+1),l(2),T("routerLink",Yt(7,xe,o.district_id,o.block_id,o.gp_id,o.village_id))("queryParams",Lt(12,ge,r.application_status,r.installment)),l(1),dt(" ",P(6,5,o.village_name)," "),l(3),p(o==null?null:o.nfsa_rejected_application)}}function Rc(i,s){if(i&1&&(t(0,"tbody",37),F(1,Nc,9,15,"tr",null,Se),e()),i&2){let o=h(3);l(1),V(o.filteredVillageStats)}}function Oc(i,s){if(i&1&&(t(0,"table",31),b(1,Lc,17,0,"thead",32)(2,Ic,8,0,"thead",32)(3,yc,8,0,"thead",32)(4,Dc,3,0,"tbody",33)(5,Uc,3,0,"tbody",33)(6,Rc,3,0,"tbody",33),e()),i&2){let o=h(2);l(1),T("ngIf",o.application_status=="recieved"),l(1),T("ngIf",o.application_status=="approved"),l(1),T("ngIf",o.application_status=="rejected"),l(1),T("ngIf",o.application_status=="recieved"),l(1),T("ngIf",o.application_status=="approved"),l(1),T("ngIf",o.application_status=="rejected")}}function Bc(i,s){i&1&&a(0," No Data Found ")}function Wc(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11),b(2,gc,2,0,"h4",12)(3,Cc,2,0,"h4",12)(4,bc,2,0,"h4",12),t(5,"nav",13)(6,"ol",14)(7,"li",15),a(8),e(),t(9,"li",15),a(10),e(),t(11,"li",16),a(12),e()()()(),t(13,"div",17)(14,"div",18)(15,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(16,"i",20),e(),t(17,"div",21),b(18,vc,3,0,"button",22)(19,Ec,3,0),e(),t(20,"div",23),b(21,wc,3,0,"button",22)(22,Tc,3,0),e()()(),t(23,"div",24),b(24,Oc,7,6,"table",25)(25,Bc,1,0),e()}if(i&2){let o=h();l(2),T("ngIf",o.application_status=="recieved"),l(1),T("ngIf",o.application_status=="approved"),l(1),T("ngIf",o.application_status=="rejected"),l(4),p(o.filteredVillageStats[0].district_name),l(2),p(o.filteredVillageStats[0].block_name),l(2),p(o.filteredVillageStats[0].gp_name),l(3),T("ngModel",o.searchTerm),l(3),E(18,o.isExportInProgress?19:18),l(3),E(21,o.isExportInProgressExcel?22:21),l(3),E(24,o.filteredVillageStats&&o.filteredVillageStats.length>0?24:25)}}var In=(()=>{let s=class s{constructor(n,r,c,f,d,C,g,_){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.location=_,this.isStatsLoading=!1,this.block_id="",this.gp_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.application_status=n.application_status,this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.block_id,this.gp_id=n.id,this.fetchvillageStats(this.gp_id)})}goBack(){this.location.back()}fetchvillageStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/village-count?gp_id=${n}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.villageStats=r.data},r=>{this.isStatsLoading=!1,this.villageStats=[]})}get filteredVillageStats(){return this.searchTerm?this.villageStats.filter(n=>n.village_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.villageStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.villageStats.map((u,I)=>{let R={"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",BLOCK:u.block_name?u.block_name.toUpperCase():"",GP:u.gp_name?u.gp_name.toUpperCase():"",VILLAGE:u.village_name?u.village_name.toUpperCase():""};return this.application_status==="recieved"?Wt(Bt({},R),{"APPLICATION RECEIVED":u?.applications_received,"APPLICATION APPROVED":u?.approved_application,"NFSA APPLICATION REJECTED":u?.nfsa_rejected_application,"NON NFSA APPLICATION REJECTED":u?.non_nfsa_rejected_application}):this.application_status==="approved"?Wt(Bt({},R),{"APPLICATION APPROVED":u?.approved_application}):this.application_status==="rejected"?Wt(Bt({},R),{"NFSA APPLICATION REJECTED":u?.nfsa_rejected_application}):R}),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=this.application_status=="recieved"?`application_recieved_village_drilldown_reports_${C}_${g}.xlsx`:this.application_status=="approved"?`application_approved_village_drilldown_reports_${C}_${g}.xlsx`:this.application_status=="rejected"?`application_rejected_village_drilldown_reports_${C}_${g}.xlsx`:"",v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){he.default.vfs=Ln.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.villageStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=(n.gp_name||n.ward_no||"N/A").toUpperCase(),C=[[{text:"SI#",fontSize:10},{text:"VILLAGE",fontSize:10},...this.application_status==="recieved"?[{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"NFSA APPLICATION REJECTED",fontSize:10},{text:"NON NFSA APPLICATION REJECTED",fontSize:10}]:this.application_status==="approved"?[{text:"APPLICATION APPROVED",fontSize:10}]:this.application_status==="rejected"?[{text:"NFSA APPLICATION REJECTED",fontSize:10}]:[]]],g=this.villageStats.map((at,ct)=>[{text:(ct+1).toString().toUpperCase(),fontSize:9},{text:(at.village_name||"").toUpperCase(),fontSize:9},...this.application_status==="recieved"?[{text:at?.applications_received||"",fontSize:9},{text:at?.approved_application||"",fontSize:9},{text:at?.nfsa_rejected_application||"",fontSize:9},{text:at?.non_nfsa_rejected_application||"",fontSize:9}]:this.application_status==="approved"?[{text:at?.approved_application||"",fontSize:9}]:this.application_status==="rejected"?[{text:at?.nfsa_rejected_application||"",fontSize:9}]:[]]);C.push(...g);let _=new Date,v=`Timestamp: ${_.toLocaleDateString()}, ${_.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,S=this.application_status=="recieved"?"DRILL-DOWN REPORT - APPLICATION RECIEVED VILLAGE WISE":this.application_status=="approved"?"DRILL-DOWN REPORT - APPLICATION APPROVED VILLAGE WISE":this.application_status=="rejected"?"DRILL-DOWN REPORT - NFSA APPLICATION REJECTED VILLAGE WISE":"",w={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK: ${c} > GP:${f}`,style:"breadcrumb",margin:[0,0,0,10]},{text:S,style:"header"},{table:{headerRows:1,body:C,widths:Array(C[0].length).fill("15%")},layout:{fillColor:function(at){return at===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:v,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},u=new Date,I=u.toLocaleDateString("en-GB").split("/").reverse().join("-"),R=u.toLocaleTimeString("en-GB").replace(/:/g,"-"),z=this.application_status=="recieved"?`application_recieved_village_drilldown_reports_${I}_${R}.pdf`:this.application_status=="approved"?`application_approved_village_drilldown_reports_${I}_${R}.pdf`:this.application_status=="rejected"?`application_rejected_village_drilldown_reports_${I}_${R}.pdf`:"";he.default.createPdf(w).download(z,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q),x(Xt))},s.\u0275cmp=M({type:s,selectors:[["app-village-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],["style","color: #fd7b03;",4,"ngIf"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],[2,"color","#fd7b03"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],["class","text-light","style","background-color: #fd7b03;",4,"ngIf"],["style","font-size: 14px;",4,"ngIf"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],["colspan","4",1,"text-center"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,xc,2,0)(11,Wc,26,10),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ft,ot,K,q,J,it]});let i=s;return i})();var Ce=j(ut()),yn=j(ht());function Mc(i,s){i&1&&(t(0,"h4",17),a(1,"Detailed Report - Application Received"),e())}function Fc(i,s){i&1&&(t(0,"h4",17),a(1,"Detailed Report - Application Approved"),e())}function Vc(i,s){i&1&&(t(0,"h4",17),a(1,"Detailed Report - NFSA Application Rejected"),e())}function zc(i,s){if(i&1&&(t(0,"div",18)(1,"div",19)(2,"nav",20)(3,"ol",21)(4,"li",22),a(5),e(),t(6,"li",22),a(7),e(),t(8,"li",22),a(9),e(),t(10,"li",23),a(11),e()()()()()),i&2){let o=h();l(5),p(o.filteredVillageUserStats[0].district_name),l(2),p(o.filteredVillageUserStats[0].block_name),l(2),p(o.filteredVillageUserStats[0].gp_name),l(2),p(o.filteredVillageUserStats[0].village_name)}}function jc(i,s){i&1&&(t(0,"div")(1,"div",24)(2,"div",25)(3,"label",26),a(4," Social Category "),e(),t(5,"select",27)(6,"option",28),a(7,"Choose Social Category"),e(),t(8,"option",29),a(9,"Un-Reserved"),e(),t(10,"option",30),a(11,"OBC"),e(),t(12,"option",31),a(13,"SC"),e(),t(14,"option",32),a(15,"ST"),e()()(),t(16,"div",25)(17,"label",33),a(18," PWD "),e(),t(19,"select",34)(20,"option",28),a(21,"Choose PWD Status"),e(),t(22,"option",29),a(23,"Yes "),e(),t(24,"option",35),a(25,"NO"),e()()()()())}function $c(i,s){i&1&&(t(0,"div")(1,"div",24)(2,"div",36)(3,"label",37),a(4," Category "),e(),t(5,"select",38)(6,"option",28),a(7,"Choose Category"),e(),t(8,"option",29),a(9,"NFSA"),e(),t(10,"option",35),a(11,"NON-NFSA"),e()()(),t(12,"div",36)(13,"label",26),a(14," Social Category "),e(),t(15,"select",27)(16,"option",28),a(17,"Choose Social Category"),e(),t(18,"option",29),a(19,"Un-Reserved"),e(),t(20,"option",30),a(21,"OBC"),e(),t(22,"option",31),a(23,"SC"),e(),t(24,"option",32),a(25,"ST"),e()()(),t(26,"div",36)(27,"label",33),a(28," PWD "),e(),t(29,"select",34)(30,"option",28),a(31,"Choose PWD Status"),e(),t(32,"option",29),a(33,"Yes "),e(),t(34,"option",35),a(35,"NO"),e()()()()())}function Gc(i,s){i&1&&(t(0,"button",39),m(1,"i",40),a(2,"Search "),e())}function Xc(i,s){i&1&&(t(0,"button",41),m(1,"i",42),a(2," Searching ..."),e())}function Yc(i,s){i&1&&(m(0,"i",43),a(1," We are fetching the data, please wait. "))}function Hc(i,s){if(i&1){let o=U();t(0,"button",58),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",59),a(2,"Download to PDF "),e()}}function Kc(i,s){i&1&&(t(0,"button",60),m(1,"i",42),a(2,"Downloading "),e())}function qc(i,s){if(i&1){let o=U();t(0,"button",58),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",59),a(2,"Download to EXCEL "),e()}}function Jc(i,s){i&1&&(t(0,"button",60),m(1,"i",42),a(2,"Downloading "),e())}var Qc=(i,s)=>s.id;function Zc(i,s){i&1&&(t(0,"th"),a(1,"REASONS FOR INELIGIBILITY"),e())}function td(i,s){if(i&1&&(t(0,"td"),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit;l(1),p(P(2,1,o.village_name))}}function ed(i,s){i&1&&m(0,"td")}function id(i,s){i&1&&(t(0,"span"),a(1,", "),e())}function nd(i,s){if(i&1&&(t(0,"span"),a(1),b(2,id,2,0,"span",10),e()),i&2){let o=s.$implicit,n=s.index,r=h(2).$implicit,c=h(3);l(1),dt(" ",o," "),l(1),T("ngIf",n<c.getAllReasons(r).length-1)}}function od(i,s){if(i&1&&(t(0,"td"),b(1,nd,3,2,"span",63),e()),i&2){let o=h().$implicit,n=h(3);l(1),T("ngForOf",n.getAllReasons(o))}}function ad(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),b(3,td,3,3,"td")(4,ed,1,0),t(5,"td"),a(6),k(7,"uppercase"),e(),t(8,"td"),a(9),k(10,"uppercase"),e(),t(11,"td"),a(12),k(13,"uppercase"),e(),t(14,"td"),a(15),k(16,"uppercase"),e(),t(17,"td"),a(18),k(19,"uppercase"),e(),t(20,"td"),a(21),k(22,"uppercase"),e(),t(23,"td"),a(24),k(25,"uppercase"),e(),t(26,"td"),a(27),e(),t(28,"td"),a(29),k(30,"uppercase"),e(),b(31,od,2,1,"td",10),e()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(1),E(3,o.village_name?3:4),l(3),p(P(7,12,o.category)),l(3),p(P(10,14,o.application_number)),l(3),p(P(13,16,r.appService.dateFormat(o.application_date))),l(3),p(P(16,18,o.applicant_name)),l(3),p(P(19,20,o.spouse_or_father_name)),l(3),p(P(22,22,o.social_category)),l(3),p(P(25,24,o.pwd_status)),l(3),p(o.alt_mobile_number),l(2),p(P(30,26,o.application_status)),l(2),T("ngIf",r.application_status=="rejected")}}function rd(i,s){if(i&1&&(t(0,"table",61)(1,"thead",62)(2,"tr")(3,"th"),a(4,"SI#"),e(),t(5,"th"),a(6,"VILLAGE"),e(),t(7,"th"),a(8,"CATEGORY"),e(),t(9,"th"),a(10,"APPLICATION NO."),e(),t(11,"th"),a(12,"APPLICATION DATE"),e(),t(13,"th"),a(14,"APPLICANT NAME"),e(),t(15,"th"),a(16,"FATHER/HUSBAND NAME"),e(),t(17,"th"),a(18,"SOCIAL CATEGORY"),e(),t(19,"th"),a(20,"PWD"),e(),t(21,"th"),a(22,"MOBILE NO."),e(),t(23,"th"),a(24,"APPLICATION STATUS"),e(),b(25,Zc,2,0,"th",10),e()(),t(26,"tbody"),F(27,ad,32,28,"tr",null,Qc),e()()),i&2){let o=h(2);l(25),T("ngIf",o.application_status=="rejected"),l(2),V(o.filteredVillageUserStats)}}function sd(i,s){i&1&&(t(0,"h5",64),a(1,"No data available"),e())}function ld(i,s){i&1&&(t(0,"div",65),a(1,"Loading.. "),m(2,"i",66),e())}function cd(i,s){i&1&&(t(0,"span"),m(1,"i",43),a(2," Loading..."),e())}function dd(i,s){i&1&&(t(0,"span"),a(1,"Load More"),e())}function pd(i,s){if(i&1){let o=U();t(0,"div",67)(1,"button",68),L("click",function(){D(o);let r=h(2);return A(r.loadMore())}),b(2,cd,3,0,"span",10)(3,dd,2,0,"span",10),e()()}if(i&2){let o=h(2);l(2),T("ngIf",o.isLoadMoreInProgress),l(1),T("ngIf",!o.isLoadMoreInProgress)}}function md(i,s){if(i&1){let o=U();t(0,"div",18)(1,"div",44)(2,"h5",45),a(3," Number of records found : "),t(4,"span",46),a(5),e()()(),t(6,"div",47)(7,"div",48)(8,"input",49),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(9,"i",50),e(),t(10,"div",51),b(11,Hc,3,0,"button",52)(12,Kc,3,0),e(),t(13,"div",53),b(14,qc,3,0,"button",52)(15,Jc,3,0),e()()(),t(16,"div",54),b(17,rd,29,1,"table",55)(18,sd,2,0)(19,ld,3,0,"div",56),e(),b(20,pd,4,2,"div",57)}if(i&2){let o=h();l(5),p(o.count),l(3),T("ngModel",o.searchTerm),l(3),E(11,o.isExportInProgress?12:11),l(3),E(14,o.isExportInProgressExcel?15:14),l(3),E(17,o.filteredVillageUserStats&&o.filteredVillageUserStats.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),l(2),E(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),l(1),T("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var kn=(()=>{let s=class s{constructor(n,r,c,f,d,C,g,_,v){this.route=n,this.router=r,this.formService=c,this.appService=f,this.httpClient=d,this.toastService=C,this.authService=g,this.masterDataService=_,this.location=v,this.isStatsLoading=!1,this.userStats=[],this.block_id="",this.gp_id="",this.village_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.limit=this.appService.loadmorelimit,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.count=0,this.reasonsMapping={},this.rejectedremarkMapping={},this.searchForm=new kt({a_category:new nt(""),social_category:new nt(""),pwd_status:new nt(""),submit_date:new nt("")})}ngOnInit(){this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.block_id,this.gp_id=n.gp_id,this.village_id=n.id,console.log("gp id",this.gp_id)}),this.route.queryParams.subscribe(n=>{this.application_status=n.application_status,this.installment=n.installment,this.fetchuserStats(this.village_id)}),this.loadRejectReasonMappings()}goBack(){this.location.back()}fetchuserStats(n,r=!1){this.isStatsLoading=!0;let c=new st;c=c.set("gp_id",this.gp_id),c=c.set("village_id",n),c=c.set("offset",this.offset),c=c.set("limit",this.limit),this.application_status=="approved"?c=c.set("application_status","1"):this.application_status=="rejected"&&(c=c.set("category","1"),c=c.set("application_status","2")),this.installment!==void 0&&(c=c.set("installment",this.installment.toString()));let f=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:c,headers:f}).subscribe(d=>{this.isStatsLoading=!1,this.count=d.count,d.data&&d.data.length>0?(this.application_list=this.application_list.concat(d.data),this.offset+=d.data.length,this.hasMoreRecords=d.data.length===this.limit):this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)},d=>{this.isStatsLoading=!1,this.application_list=[],this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)})}get filteredVillageUserStats(){if(!this.searchTerm)return this.application_list;let n=this.searchTerm.toLowerCase();return this.application_list.filter(r=>r.village_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.category?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.application_number?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_date).toLowerCase().includes(this.searchTerm.toLowerCase())||r.applicant_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.spouse_or_father_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.dob).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.social_category).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.pwd_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.alt_mobile_number).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.payment_status).toLowerCase().includes(this.searchTerm.toLowerCase()))}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=new st;C=C.set("gp_id",this.gp_id),r&&(C=C.set("village_id",r)),c&&(C=C.set("category",c)),f&&(C=C.set("social_category",f)),d&&(C=C.set("pwd_status",d)),this.application_status=="approved"?C=C.set("application_status","1"):this.application_status=="rejected"&&(C=C.set("category","1"),C=C.set("application_status","2")),this.installment!==void 0&&(C=C.set("installment",this.installment.toString())),C=C.set("offset",this.offset),C=C.set("limit",this.limit);let g=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:C,headers:g}).subscribe(_=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=_.count,_.data&&_.data.length>0?(this.application_list=this.application_list.concat(_.data),this.offset+=_.data.length,this.hasMoreRecords=_.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},_=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}loadRejectReasonMappings(){this.httpClient.get("assets/json/rejected_reasons.json").subscribe(n=>{this.reasonsMapping=n.exrMapping,this.rejectedremarkMapping=n.rejectedremarkMapping})}getReasonText(n){return this.reasonsMapping[n]||""}getExclusionReasons(n){return typeof n.exclusion_reasons=="string"?n.exclusion_reasons.split(",").map(c=>c.trim()).map(c=>isNaN(Number(c))?c:this.getReasonText(Number(c))):Array.isArray(n.exclusion_reasons)?n.exclusion_reasons.map(r=>typeof r=="number"?this.getReasonText(r):r):typeof n.exclusion_reasons=="number"?[this.getReasonText(n.exclusion_reasons)]:[]}getRejectedremark(n){return this.rejectedremarkMapping[n]||""}getAllReasons(n){let r=this.getExclusionReasons(n),c=n?.rejectedremark_reasons?this.getRejectedremark(n?.rejectedremark_reasons):null,f=[...r];return c&&f.push(c),f}exportToExcel(){let n=new st,r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status;n=n.set("gp_id",this.gp_id),r&&(n=n.set("village_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),this.application_status=="approved"?n=n.set("application_status","1"):this.application_status=="rejected"&&(n=n.set("category","1"),n=n.set("application_status","2")),this.installment!==void 0&&(n=n.set("installment",this.installment.toString())),n=n.set("export_all","1");let C=new rt({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:C,responseType:"json"}).subscribe(g=>{this.isExportInProgressExcel=!1;let _=g.data.map((O,et)=>{let B=this.getAllReasons(O).join(", "),W={"SI#":et+1,DISTRICT:O.district_name?O.district_name.toUpperCase():"",BLOCK:O.block_name?O.block_name.toUpperCase():"",GP:O.gp_name?O.gp_name.toUpperCase():"",VILLAGE:O.village_name?O.village_name.toUpperCase():"",CATEGORY:O.category,"APPLICATION NO.":O.application_number.toUpperCase(),"APPLICATION DATE":this.appService.dateFormat(O.application_date),"APPLICANT NAME":O.applicant_name.toUpperCase(),"FATHER/HUSBAND NAME":O.spouse_or_father_name.toUpperCase(),"SOCIAL CATEGORY":O.social_category.toUpperCase(),PWD:O.pwd_status.toUpperCase(),"MOBILE NO.":O.alt_mobile_number,"APPLICATION STATUS":O.application_status.toUpperCase()};return this.application_status=="rejected"?Wt(Bt({},W),{"REASONS FOR INELIGIBILITY":B}):W}),v=N.json_to_sheet(_),S=N.book_new();N.book_append_sheet(S,v,"Applications");let w=Z(S,{bookType:"xlsx",type:"array"}),u=new Date,I=u.toLocaleDateString("en-GB").split("/").reverse().join("-"),R=u.toLocaleTimeString("en-GB").replace(/:/g,"-"),z=this.application_status=="recieved"?`Detailed_report_application_recieved_village_reports_${I}_${R}.xlsx`:this.application_status=="approved"?`Detailed_report_application_approved_village_reports_${I}_${R}.xlsx`:this.application_status=="rejected"?`Detailed_report_application_rejected_village_reports_${I}_${R}.xlsx`:"",at=new Blob([w],{type:"application/octet-stream"}),ct=document.createElement("a"),lt=window.URL.createObjectURL(at);ct.href=lt,ct.download=z,ct.click(),window.URL.revokeObjectURL(lt)},g=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",g)})}exportToPDF(){Ce.default.vfs=yn.default.pdfMake.vfs;let n=new st,r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date;n=n.set("gp_id",this.gp_id),r&&(n=n.set("village_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),C&&(n=n.set("submission_date",C)),this.application_status=="approved"?n=n.set("application_status","1"):this.application_status=="rejected"&&(n=n.set("category","1"),n=n.set("application_status","2")),this.installment!==void 0&&(n=n.set("installment",this.installment.toString())),n=n.set("export_all","1");let g=new rt({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:g,responseType:"json"}).subscribe(_=>{this.isExportInProgress=!1;let v=_.data[0]||{},S=(v.district_name||"N/A").toUpperCase(),w=(v.block_name||v.ulb_name||"N/A").toUpperCase(),u=(v.gp_name||v.ward_no||"N/A").toUpperCase(),I=(v.village_name||"").toUpperCase(),R=[[{text:"SI#",fontSize:10},{text:"CATEGORY",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICATION DATE.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"SOCIAL CATEGORY",fontSize:10},{text:"PWD",fontSize:10},{text:"MOBILE NO",fontSize:10},{text:"APPLICATION STATUS",fontSize:10},...this.application_status=="rejected"?[{text:"REASONS FOR INELIGIBILITY",fontSize:10}]:[]]],z=_.data.map((jt,qt)=>{let Os=this.getAllReasons(jt).join(", ");return[{text:(qt+1).toString().toUpperCase(),fontSize:9},{text:(jt.category||"").toUpperCase(),fontSize:9},{text:(jt.application_number||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(jt.application_date)||"",fontSize:9},{text:(jt.applicant_name||"").toUpperCase(),fontSize:9},{text:(jt.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:(jt.social_category||"").toUpperCase(),fontSize:9},{text:(jt.pwd_status||"").toUpperCase(),fontSize:9},{text:(jt.alt_mobile_number||"").toUpperCase(),fontSize:9},{text:(jt.application_status||"").toUpperCase(),fontSize:9},...this.application_status==="rejected"?[{text:Os,fontSize:9}]:[]]});R.push(...z);let at=new Date,ct=`Timestamp: ${at.toLocaleDateString()}, ${at.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,lt=this.application_status=="recieved"?" DETAILED REPORT - APPLICATION RECIEVED":this.application_status=="approved"?" DETAILED REPORT - APPLICATION APPROVED":this.application_status=="rejected"?"DETAILED REPORT - NFSA APPLICATION REJECTED":"",O=this.application_status==="rejected"?["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"],et={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${S} > BLOCK: ${w} > GP: ${u} >VILLAGE: ${I}`,style:"breadcrumb",margin:[0,0,0,10]},{text:lt,style:"header"},{table:{headerRows:1,body:R,widths:O},layout:{fillColor:function(jt){return jt===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:ct,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},y=new Date,B=y.toLocaleDateString("en-GB").split("/").reverse().join("-"),W=y.toLocaleTimeString("en-GB").replace(/:/g,"-"),It=this.application_status=="recieved"?`Detailed_report_application_recieved_vill_reports_${B}_${W}.pdf`:this.application_status=="approved"?`Detailed_report_application_approved_vill_reports_${B}_${W}.pdf`:this.application_status=="rejected"?`Detailed_report_application_rejected_vill_reports_${B}_${W}.pdf`:"";Ce.default.createPdf(et).download(It)},_=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",_)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(Ot),x(X),x($),x(Y),x(H),x(Q),x(Xt))},s.\u0275cmp=M({type:s,selectors:[["app-village-user-list"]],decls:24,vars:9,consts:[[1,"container-fluid","drilldown-reports"],[1,"d-flex","justify-content-between","w-100","mb-3"],["style","color: #fd7b03;",4,"ngIf"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],["class","row mb-2"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[4,"ngIf"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[2,"color","#fd7b03"],[1,"row","mb-2"],[1,"col-md-7"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"row","g-3","mb-2"],[1,"col-md-6"],["for","social_category",1,"fw-bold"],["formControlName","social_category","id","social_category",1,"form-select","my-2"],["value",""],["value","1"],["value","2"],["value","3"],["value","4"],["for","pwd_status",1,"fw-bold"],["formControlName","pwd_status","id","pwd_status",1,"form-select","my-2"],["value","0"],[1,"col-md-4"],["for","a_category",1,"fw-bold"],["formControlName","a_category","id","a_category",1,"form-select","my-2"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"fa","fa-spinner","fa-spin"],[1,"col-md-5"],[1,"card-title"],["id","recordCount"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports detail"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports","detail"],[1,"text-light",2,"background-color","#fd7b03"],[4,"ngFor","ngForOf"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),b(2,Mc,2,0,"h4",2)(3,Fc,2,0,"h4",2)(4,Vc,2,0,"h4",2),t(5,"div",3)(6,"a",4),L("click",function(){return c.goBack()}),t(7,"button",5),m(8,"i",6),a(9," Back"),e()()()(),b(10,zc,12,4,"div",7),t(11,"div",8)(12,"form",9),L("ngSubmit",function(){return c.onSearch()}),b(13,jc,26,0,"div",10)(14,$c,36,0,"div",10),t(15,"div",11)(16,"div",12),b(17,Gc,3,0,"button",13)(18,Xc,3,0),e()()()(),t(19,"div",14)(20,"div",15)(21,"div",16),b(22,Yc,2,0)(23,md,21,7),e()()()()),r&2&&(l(2),T("ngIf",c.application_status=="recieved"),l(1),T("ngIf",c.application_status=="approved"),l(1),T("ngIf",c.application_status=="rejected"),l(6),E(10,c.filteredVillageUserStats&&c.filteredVillageUserStats.length>0?10:-1),l(2),T("formGroup",c.searchForm),l(1),T("ngIf",c.application_status=="rejected"),l(1),T("ngIf",c.application_status!="rejected"),l(3),E(17,c.isFormSearchInProgress?18:17),l(5),E(22,c.isStatsLoading?22:23))},dependencies:[Ht,ft,Pt,Nt,Rt,K,Ut,q,yt,J,Dt,At,it]});let i=s;return i})();var be=j(ut()),Pn=j(ht());function _d(i,s){i&1&&(t(0,"h4",17),a(1,"Detailed Report - Application Received"),e())}function fd(i,s){i&1&&(t(0,"h4",17),a(1,"Detailed Report - Application Approved"),e())}function ud(i,s){i&1&&(t(0,"h4",17),a(1,"Detailed Report - NFSA Application Rejected"),e())}function hd(i,s){if(i&1&&(t(0,"div",18)(1,"div",19)(2,"nav",20)(3,"ol",21)(4,"li",22),a(5),e(),t(6,"li",22),a(7),e(),t(8,"li",23),a(9),e()()()()()),i&2){let o=h();l(5),p(o.filteredWardUserStats[0].district_name),l(2),p(o.filteredWardUserStats[0].ulb_name),l(2),p(o.filteredWardUserStats[0].ward_no)}}function Sd(i,s){i&1&&(t(0,"div")(1,"div",24)(2,"div",25)(3,"label",26),a(4," Social Category "),e(),t(5,"select",27)(6,"option",28),a(7,"Choose Social Category"),e(),t(8,"option",29),a(9,"Un-Reserved"),e(),t(10,"option",30),a(11,"OBC"),e(),t(12,"option",31),a(13,"SC"),e(),t(14,"option",32),a(15,"ST"),e()()(),t(16,"div",25)(17,"label",33),a(18," PWD "),e(),t(19,"select",34)(20,"option",28),a(21,"Choose PWD Status"),e(),t(22,"option",29),a(23,"Yes "),e(),t(24,"option",35),a(25,"NO"),e()()()()())}function xd(i,s){i&1&&(t(0,"div")(1,"div",24)(2,"div",36)(3,"label",37),a(4," Category "),e(),t(5,"select",38)(6,"option",28),a(7,"Choose Category"),e(),t(8,"option",29),a(9,"NFSA"),e(),t(10,"option",35),a(11,"NON-NFSA"),e()()(),t(12,"div",36)(13,"label",26),a(14," Social Category "),e(),t(15,"select",27)(16,"option",28),a(17,"Choose Social Category"),e(),t(18,"option",29),a(19,"Un-Reserved"),e(),t(20,"option",30),a(21,"OBC"),e(),t(22,"option",31),a(23,"SC"),e(),t(24,"option",32),a(25,"ST"),e()()(),t(26,"div",36)(27,"label",33),a(28," PWD "),e(),t(29,"select",34)(30,"option",28),a(31,"Choose PWD Status"),e(),t(32,"option",29),a(33,"Yes "),e(),t(34,"option",35),a(35,"NO"),e()()()()())}function gd(i,s){i&1&&(t(0,"button",39),m(1,"i",40),a(2,"Search "),e())}function Cd(i,s){i&1&&(t(0,"button",41),m(1,"i",42),a(2," Searching ..."),e())}function bd(i,s){i&1&&(m(0,"i",43),a(1," We are fetching the data, please wait. "))}function vd(i,s){if(i&1){let o=U();t(0,"button",58),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",59),a(2,"Download to PDF "),e()}}function Ed(i,s){i&1&&(t(0,"button",60),m(1,"i",42),a(2,"Downloading "),e())}function wd(i,s){if(i&1){let o=U();t(0,"button",58),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",59),a(2,"Download to EXCEL "),e()}}function Td(i,s){i&1&&(t(0,"button",60),m(1,"i",42),a(2,"Downloading "),e())}var Ld=(i,s)=>s.id;function Id(i,s){i&1&&(t(0,"th"),a(1,"REASONS FOR INELIGIBILITY"),e())}function yd(i,s){if(i&1&&(t(0,"td"),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit;l(1),p(P(2,1,o.ward_no))}}function kd(i,s){i&1&&m(0,"td")}function Pd(i,s){i&1&&(t(0,"span"),a(1,", "),e())}function Dd(i,s){if(i&1&&(t(0,"span"),a(1),b(2,Pd,2,0,"span",10),e()),i&2){let o=s.$implicit,n=s.index,r=h(2).$implicit,c=h(3);l(1),dt(" ",o," "),l(1),T("ngIf",n<c.getAllReasons(r).length-1)}}function Ad(i,s){if(i&1&&(t(0,"td"),b(1,Dd,3,2,"span",63),e()),i&2){let o=h().$implicit,n=h(3);l(1),T("ngForOf",n.getAllReasons(o))}}function Ud(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),b(3,yd,3,3,"td")(4,kd,1,0),t(5,"td"),a(6),k(7,"uppercase"),e(),t(8,"td"),a(9),k(10,"uppercase"),e(),t(11,"td"),a(12),k(13,"uppercase"),e(),t(14,"td"),a(15),k(16,"uppercase"),e(),t(17,"td"),a(18),k(19,"uppercase"),e(),t(20,"td"),a(21),k(22,"uppercase"),e(),t(23,"td"),a(24),k(25,"uppercase"),e(),t(26,"td"),a(27),e(),t(28,"td"),a(29),k(30,"uppercase"),e(),b(31,Ad,2,1,"td",10),e()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(1),E(3,o.ward_no?3:4),l(3),p(P(7,12,o.category)),l(3),p(P(10,14,o.application_number)),l(3),p(P(13,16,r.appService.dateFormat(o.application_date))),l(3),p(P(16,18,o.applicant_name)),l(3),p(P(19,20,o.spouse_or_father_name)),l(3),p(P(22,22,o.social_category)),l(3),p(P(25,24,o.pwd_status)),l(3),p(o.alt_mobile_number),l(2),p(P(30,26,o.application_status)),l(2),T("ngIf",r.application_status=="rejected")}}function Nd(i,s){if(i&1&&(t(0,"table",61)(1,"thead",62)(2,"tr")(3,"th"),a(4,"SI#"),e(),t(5,"th"),a(6,"WARD NO."),e(),t(7,"th"),a(8,"CATEGORY"),e(),t(9,"th"),a(10,"APPLICATION NO."),e(),t(11,"th"),a(12,"APPLICATION DATE"),e(),t(13,"th"),a(14,"APPLICANT NAME"),e(),t(15,"th"),a(16,"FATHER/HUSBAND NAME"),e(),t(17,"th"),a(18,"SOCIAL CATEGORY"),e(),t(19,"th"),a(20,"PWD"),e(),t(21,"th"),a(22,"MOBILE NO."),e(),t(23,"th"),a(24,"APPLICATION STATUS"),e(),b(25,Id,2,0,"th",10),e()(),t(26,"tbody"),F(27,Ud,32,28,"tr",null,Ld),e()()),i&2){let o=h(2);l(25),T("ngIf",o.application_status=="rejected"),l(2),V(o.filteredWardUserStats)}}function Rd(i,s){i&1&&(t(0,"h5",64),a(1,"No data available"),e())}function Od(i,s){i&1&&(t(0,"div",65),a(1,"Loading.. "),m(2,"i",66),e())}function Bd(i,s){i&1&&(t(0,"span"),m(1,"i",43),a(2," Loading..."),e())}function Wd(i,s){i&1&&(t(0,"span"),a(1,"Load More"),e())}function Md(i,s){if(i&1){let o=U();t(0,"div",67)(1,"button",68),L("click",function(){D(o);let r=h(2);return A(r.loadMore())}),b(2,Bd,3,0,"span",10)(3,Wd,2,0,"span",10),e()()}if(i&2){let o=h(2);l(2),T("ngIf",o.isLoadMoreInProgress),l(1),T("ngIf",!o.isLoadMoreInProgress)}}function Fd(i,s){if(i&1){let o=U();t(0,"div",18)(1,"div",44)(2,"h5",45),a(3," Number of records found : "),t(4,"span",46),a(5),e()()(),t(6,"div",47)(7,"div",48)(8,"input",49),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(9,"i",50),e(),t(10,"div",51),b(11,vd,3,0,"button",52)(12,Ed,3,0),e(),t(13,"div",53),b(14,wd,3,0,"button",52)(15,Td,3,0),e()()(),t(16,"div",54),b(17,Nd,29,1,"table",55)(18,Rd,2,0)(19,Od,3,0,"div",56),e(),b(20,Md,4,2,"div",57)}if(i&2){let o=h();l(5),p(o.count),l(3),T("ngModel",o.searchTerm),l(3),E(11,o.isExportInProgress?12:11),l(3),E(14,o.isExportInProgressExcel?15:14),l(3),E(17,o.filteredWardUserStats&&o.filteredWardUserStats.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),l(2),E(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),l(1),T("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var Dn=(()=>{let s=class s{constructor(n,r,c,f,d,C,g,_,v){this.route=n,this.router=r,this.formService=c,this.appService=f,this.httpClient=d,this.toastService=C,this.authService=g,this.masterDataService=_,this.location=v,this.isStatsLoading=!1,this.userStats=[],this.ulb_id="",this.ward_id="",this.village_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.limit=this.appService.loadmorelimit,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.count=0,this.reasonsMapping={},this.rejectedremarkMapping={},this.searchForm=new kt({a_category:new nt(""),social_category:new nt(""),pwd_status:new nt(""),submit_date:new nt("")})}ngOnInit(){this.route.params.subscribe(n=>{this.district_id=n.district_id,this.ulb_id=n.ulb_id,this.ward_id=n.id}),this.route.queryParams.subscribe(n=>{this.application_status=n.application_status,this.installment=n.installment,this.fetchuserStats(this.ward_id)}),this.loadRejectReasonMappings()}goBack(){this.location.back()}fetchuserStats(n,r=!1){this.isStatsLoading=!0;let c=new st;c=c.set("ward_id",n),c=c.set("offset",this.offset),c=c.set("limit",this.limit),this.application_status=="approved"?c=c.set("application_status","1"):this.application_status=="rejected"&&(c=c.set("category","1"),c=c.set("application_status","2")),this.installment!==void 0&&(c=c.set("installment",this.installment.toString()));let f=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:c,headers:f}).subscribe(d=>{this.isStatsLoading=!1,this.count=d.count,d.data&&d.data.length>0?(this.application_list=this.application_list.concat(d.data),this.offset+=d.data.length,this.hasMoreRecords=d.data.length===this.limit):this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)},d=>{this.isStatsLoading=!1,this.application_list=[],this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)})}get filteredWardUserStats(){if(!this.searchTerm)return this.application_list;let n=this.searchTerm.toLowerCase();return this.application_list.filter(r=>r.ward_no?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.category?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.application_number?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_date).toLowerCase().includes(this.searchTerm.toLowerCase())||r.applicant_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.spouse_or_father_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.dob).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.social_category).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.pwd_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.alt_mobile_number).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.payment_status).toLowerCase().includes(this.searchTerm.toLowerCase()))}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=new st;r&&(C=C.set("ward_id",r)),c&&(C=C.set("category",c)),f&&(C=C.set("social_category",f)),d&&(C=C.set("pwd_status",d)),this.application_status=="approved"?C=C.set("application_status","1"):this.application_status=="rejected"&&(C=C.set("category","1"),C=C.set("application_status","2")),this.installment!==void 0&&(C=C.set("installment",this.installment.toString())),C=C.set("offset",this.offset),C=C.set("limit",this.limit);let g=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:C,headers:g}).subscribe(_=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=_.count,_.data&&_.data.length>0?(this.application_list=this.application_list.concat(_.data),this.offset+=_.data.length,this.hasMoreRecords=_.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},_=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}getReasonText(n){return this.reasonsMapping[n]||""}loadRejectReasonMappings(){this.httpClient.get("assets/json/rejected_reasons.json").subscribe(n=>{this.reasonsMapping=n.exrMapping,this.rejectedremarkMapping=n.rejectedremarkMapping})}getExclusionReasons(n){return typeof n.exclusion_reasons=="string"?n.exclusion_reasons.split(",").map(c=>c.trim()).map(c=>isNaN(Number(c))?c:this.getReasonText(Number(c))):Array.isArray(n.exclusion_reasons)?n.exclusion_reasons.map(r=>typeof r=="number"?this.getReasonText(r):r):typeof n.exclusion_reasons=="number"?[this.getReasonText(n.exclusion_reasons)]:[]}getRejectedremark(n){return this.rejectedremarkMapping[n]||""}getAllReasons(n){let r=this.getExclusionReasons(n),c=n?.rejectedremark_reasons?this.getRejectedremark(n?.rejectedremark_reasons):null,f=[...r];return c&&f.push(c),f}exportToExcel(){let n=new st,r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status;r&&(n=n.set("ward_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),this.application_status=="approved"?n=n.set("application_status","1"):this.application_status=="rejected"&&(n=n.set("category","1"),n=n.set("application_status","2")),this.installment!==void 0&&(n=n.set("installment",this.installment.toString())),n=n.set("export_all","1");let C=new rt({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:C,responseType:"json"}).subscribe(g=>{this.isExportInProgressExcel=!1;let _=g.data.map((O,et)=>{let B=this.getAllReasons(O).join(", "),W={"SI#":et+1,DISTRICT:O.district_name?O.district_name.toUpperCase():"",ULB:O.ulb_name?O.ulb_name.toUpperCase():"","WARD NO.":O.ward_no?O.ward_no.toUpperCase():"",CATEGORY:O.category,"APPLICATION NO.":O.application_number.toUpperCase(),"APPLICATION DATE":this.appService.dateFormat(O.application_date),"APPLICANT NAME":O.applicant_name.toUpperCase(),"FATHER/HUSBAND NAME":O.spouse_or_father_name.toUpperCase(),"SOCIAL CATEGORY":O.social_category.toUpperCase(),PWD:O.pwd_status.toUpperCase(),"MOBILE NO.":O.alt_mobile_number,"APPLICATION STATUS":O.application_status.toUpperCase()};return this.application_status=="rejected"?Wt(Bt({},W),{"REASONS FOR INELIGIBILITY":B}):W}),v=N.json_to_sheet(_),S=N.book_new();N.book_append_sheet(S,v,"Applications");let w=Z(S,{bookType:"xlsx",type:"array"}),u=new Date,I=u.toLocaleDateString("en-GB").split("/").reverse().join("-"),R=u.toLocaleTimeString("en-GB").replace(/:/g,"-"),z=this.application_status=="recieved"?`Detailed_report_application_recieved_ward_reports_${I}_${R}.xlsx`:this.application_status=="approved"?`Detailed_report_application_approved_ward_reports_${I}_${R}.xlsx`:this.application_status=="rejected"?`Detailed_report_application_rejected_ward_reports_${I}_${R}.xlsx`:"",at=new Blob([w],{type:"application/octet-stream"}),ct=document.createElement("a"),lt=window.URL.createObjectURL(at);ct.href=lt,ct.download=z,ct.click(),window.URL.revokeObjectURL(lt)},g=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",g)})}exportToPDF(){be.default.vfs=Pn.default.pdfMake.vfs;let n=new st,r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status;r&&(n=n.set("ward_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),this.application_status=="approved"?n=n.set("application_status","1"):this.application_status=="rejected"&&(n=n.set("category","1"),n=n.set("application_status","2")),this.installment!==void 0&&(n=n.set("installment",this.installment.toString())),n=n.set("export_all","1");let C=new rt({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:C,responseType:"json"}).subscribe(g=>{this.isExportInProgress=!1;let _=g.data[0]||{},v=(_.district_name||"N/A").toUpperCase(),S=(_.block_name||_.ulb_name||"N/A").toUpperCase(),w=(_.gp_name||_.ward_no||"N/A").toUpperCase(),u=[[{text:"SI#",fontSize:10},{text:"CATEGORY",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICATION DATE.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"SOCIAL CATEGORY",fontSize:10},{text:"PWD",fontSize:10},{text:"MOBILE NO",fontSize:10},{text:"APPLICATION STATUS",fontSize:10},...this.application_status=="rejected"?[{text:"REASONS FOR INELIGIBILITY",fontSize:10}]:[]]],I=g.data.map((W,It)=>{let qt=this.getAllReasons(W).join(", ");return[{text:(It+1).toString().toUpperCase(),fontSize:9},{text:(W.category||"").toUpperCase(),fontSize:9},{text:(W.application_number||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(W.application_date)||"",fontSize:9},{text:(W.applicant_name||"").toUpperCase(),fontSize:9},{text:(W.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:(W.social_category||"").toUpperCase(),fontSize:9},{text:(W.pwd_status||"").toUpperCase(),fontSize:9},{text:(W.alt_mobile_number||"").toUpperCase(),fontSize:9},{text:(W.application_status||"").toUpperCase(),fontSize:9},...this.application_status==="rejected"?[{text:qt,fontSize:9}]:[]]});u.push(...I);let R=new Date,z=`Timestamp: ${R.toLocaleDateString()}, ${R.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,at=this.application_status=="recieved"?" DETAILED REPORT - APPLICATION RECIEVED":this.application_status=="approved"?" DETAILED REPORT - APPLICATION APPROVED":this.application_status=="rejected"?"DETAILED REPORT - NFSA APPLICATION REJECTED":"",ct=this.application_status==="rejected"?["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"],lt={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${v} > ULB: ${S} > WARD: ${w}`,style:"breadcrumb",margin:[0,0,0,10]},{text:at,style:"header"},{table:{headerRows:1,body:u,widths:ct},layout:{fillColor:function(W){return W===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:z,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},O=new Date,et=O.toLocaleDateString("en-GB").split("/").reverse().join("-"),y=O.toLocaleTimeString("en-GB").replace(/:/g,"-"),B=this.application_status=="recieved"?`Detailed_report_application_recieved_ward_reports_${et}_${y}.pdf`:this.application_status=="approved"?`Detailed_report_application_approved_ward_reports_${et}_${y}.pdf`:this.application_status=="rejected"?`Detailed_report_application_rejected_ward_reports_${et}_${y}.pdf`:"";be.default.createPdf(lt).download(B)},g=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",g)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(Ot),x(X),x($),x(Y),x(H),x(Q),x(Xt))},s.\u0275cmp=M({type:s,selectors:[["app-ward-user-list"]],decls:24,vars:9,consts:[[1,"container-fluid","drilldown-reports"],[1,"d-flex","justify-content-between","w-100","mb-3"],["style","color: #fd7b03;",4,"ngIf"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],["class","row mb-2"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[4,"ngIf"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[2,"color","#fd7b03"],[1,"row","mb-2"],[1,"col-md-7"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"row","g-3","mb-2"],[1,"col-md-6"],["for","social_category",1,"fw-bold"],["formControlName","social_category","id","social_category",1,"form-select","my-2"],["value",""],["value","1"],["value","2"],["value","3"],["value","4"],["for","pwd_status",1,"fw-bold"],["formControlName","pwd_status","id","pwd_status",1,"form-select","my-2"],["value","0"],[1,"col-md-4"],["for","a_category",1,"fw-bold"],["formControlName","a_category","id","a_category",1,"form-select","my-2"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"fa","fa-spinner","fa-spin"],[1,"col-md-5"],[1,"card-title"],["id","recordCount"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports detail"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports","detail"],[1,"text-light",2,"background-color","#fd7b03"],[4,"ngFor","ngForOf"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),b(2,_d,2,0,"h4",2)(3,fd,2,0,"h4",2)(4,ud,2,0,"h4",2),t(5,"div",3)(6,"a",4),L("click",function(){return c.goBack()}),t(7,"button",5),m(8,"i",6),a(9," Back"),e()()()(),b(10,hd,10,3,"div",7),t(11,"div",8)(12,"form",9),L("ngSubmit",function(){return c.onSearch()}),b(13,Sd,26,0,"div",10)(14,xd,36,0,"div",10),t(15,"div",11)(16,"div",12),b(17,gd,3,0,"button",13)(18,Cd,3,0),e()()()(),t(19,"div",14)(20,"div",15)(21,"div",16),b(22,bd,2,0)(23,Fd,21,7),e()()()()),r&2&&(l(2),T("ngIf",c.application_status=="recieved"),l(1),T("ngIf",c.application_status=="approved"),l(1),T("ngIf",c.application_status=="rejected"),l(6),E(10,c.filteredWardUserStats&&c.filteredWardUserStats.length>0?10:-1),l(2),T("formGroup",c.searchForm),l(1),T("ngIf",c.application_status=="rejected"),l(1),T("ngIf",c.application_status!="rejected"),l(3),E(17,c.isFormSearchInProgress?18:17),l(5),E(22,c.isStatsLoading?22:23))},dependencies:[Ht,ft,Pt,Nt,Rt,K,Ut,q,yt,J,Dt,At,it]});let i=s;return i})();var ve=j(ut()),An=j(ht());function Vd(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function zd(i,s){if(i&1){let o=U();t(0,"button",22),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",23),a(2,"Download PDF "),e()}}function jd(i,s){i&1&&(t(0,"button",24),m(1,"i",25),a(2,"Downloading "),e())}function $d(i,s){if(i&1){let o=U();t(0,"button",22),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",23),a(2,"Download EXCEL "),e()}}function Gd(i,s){i&1&&(t(0,"button",24),m(1,"i",25),a(2,"Downloading "),e())}var Xd=(i,s)=>s.id,Yd=i=>({installment:i});function Hd(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",31),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e(),t(9,"td"),a(10),e(),t(11,"td"),a(12),e(),t(13,"td"),a(14),e(),t(15,"td"),a(16),e(),t(17,"td"),a(18),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),$t("routerLink","/department/portal/lwe/block-ulb-stats/",o.district_id,""),T("queryParams",pt(12,Yd,r.installment)),l(1),dt(" ",P(6,10,o.district_name)," "),l(3),p(o==null?null:o.count_lwe),l(2),p(o==null?null:o.approved_applications_lwe),l(2),p(o==null?null:o.count_rejected_applications_lwe),l(2),p(o==null?null:o.payment_processed_lwe),l(2),p(o==null?null:o.payment_success_lwe),l(2),p(o==null?null:o.payment_fail_lwe)}}function Kd(i,s){if(i&1&&(t(0,"table",26)(1,"thead",27)(2,"tr")(3,"th",28),a(4,"Sl.#"),e(),t(5,"th",28),a(6,"DISTRICT"),e(),t(7,"th",29),a(8,"APPLICATION DETAILS"),e(),t(9,"th",29),a(10,"PAYMENT DETAILS"),e()(),t(11,"tr")(12,"th"),a(13,"RECEIVED"),e(),t(14,"th"),a(15,"APPROVED"),e(),t(16,"th"),a(17,"REJECTED"),e(),t(18,"th"),a(19,"PAYMENT PROCESSED"),e(),t(20,"th"),a(21,"PAYMENT SUCCESS"),e(),t(22,"th"),a(23,"PAYMENT FAILED"),e()()(),t(24,"tbody",30),F(25,Hd,19,14,"tr",null,Xd),e()()),i&2){let o=h(2);l(25),V(o.filteredDistrictStats)}}function qd(i,s){i&1&&a(0," No Data Found ")}function Jd(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - LWE"),e()(),t(4,"div",13)(5,"div",14)(6,"input",15),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(7,"i",16),e(),t(8,"div",17),b(9,zd,3,0,"button",18)(10,jd,3,0),e(),t(11,"div",19),b(12,$d,3,0,"button",18)(13,Gd,3,0),e()()(),t(14,"div",20),b(15,Kd,27,0,"table",21)(16,qd,1,0),e()}if(i&2){let o=h();l(6),T("ngModel",o.searchTerm),l(3),E(9,o.isExportInProgress?10:9),l(3),E(12,o.isExportInProgressExcel?13:12),l(3),E(15,o.filteredDistrictStats&&o.filteredDistrictStats.length>0?15:16)}}var Un=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.router=n,this.route=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.districtStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment,this.card_name=n.card_name,this.fetchDistrictStats()})}fetchDistrictStats(){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?specialgroup_lwe=1&installment=${this.installment}&card_name=${this.card_name}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isStatsLoading=!1,this.districtStats=n.data},n=>{this.isStatsLoading=!1,this.districtStats=[]})}get filteredDistrictStats(){return this.searchTerm?this.districtStats.filter(n=>n.district_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.districtStats}exportToExcel(){this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?specialgroup_lwe=1&installment=${this.installment}&card_name=${this.card_name}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isExportInProgressExcel=!1;let r=n.data.map((I,R)=>({"SI#":R+1,DISTRICT:I.district_name.toUpperCase(),"APPLICATION RECEIVED":I?.count_lwe,"APPLICATION APPROVED":I?.approved_applications_lwe,"APPLICATION REJECTED":I?.count_rejected_applications_lwe,"PAYMENT PROCESSED":I?.payment_processed_lwe,"PAYMENT SUCCESS":I?.payment_success_lwe,"PAYMENT FAILED":I?.payment_fail_lwe})),c=N.json_to_sheet(r),f=N.book_new();N.book_append_sheet(f,c,"Applications");let d=Z(f,{bookType:"xlsx",type:"array"}),C=new Date,g=C.toLocaleDateString("en-GB").split("/").reverse().join("-"),_=C.toLocaleTimeString("en-GB").replace(/:/g,"-"),v=`district_drilldown_reports_${g}_${_}.xlsx`,S=new Blob([d],{type:"application/octet-stream"}),w=document.createElement("a"),u=window.URL.createObjectURL(S);w.href=u,w.download=v,w.click(),window.URL.revokeObjectURL(u)},n=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",n)})}exportToPDF(){ve.default.vfs=An.default.pdfMake.vfs,this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?specialgroup_lwe=1&installment=${this.installment}&card_name=${this.card_name}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isExportInProgress=!1;let r=[[{text:"SI#",fontSize:10},{text:"DISTRICT",fontSize:10},{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"APPLICATION REJECTED",fontSize:10},{text:"PAYMENT PROCESSED",fontSize:10},{text:"PAYMENT SUCCESS",fontSize:10},{text:"PAYMENT FAILED",fontSize:10}]];n.data.forEach((S,w)=>{r.push([{text:(w+1).toString().toUpperCase(),fontSize:9},{text:(S.district_name||"").toUpperCase(),fontSize:9},{text:S?.count_lwe,fontSize:9},{text:S?.approved_applications_lwe,fontSize:9},{text:S?.count_rejected_applications_lwe,fontSize:9},{text:S?.payment_processed_lwe,fontSize:9},{text:S?.payment_success_lwe,fontSize:9},{text:S?.payment_fail_lwe,fontSize:9}])});let c=new Date,f=`Timestamp: ${c.toLocaleDateString()}, ${c.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,d={pageOrientation:"landscape",pageSize:"A4",content:[{text:"DRILL-DOWN REPORT - LWE DISTRICT-WISE",style:"header"},{table:{headerRows:1,body:r,widths:["9%","13%","13%","13%","13%","13%","13%","13%"]},layout:{fillColor:function(S){return S===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:f,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},C=new Date,g=C.toLocaleDateString("en-GB").split("/").reverse().join("-"),_=C.toLocaleTimeString("en-GB").replace(/:/g,"-"),v=`district_drilldown_reports_${g}_${_}.pdf`;ve.default.createPdf(d).download(v)},n=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",n)})}};s.\u0275fac=function(r){return new(r||s)(x(G),x(tt),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-lwe-district-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],["colspan","3",1,"text-center"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,Vd,2,0)(11,Jd,17,4),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var Ee=j(ut()),Nn=j(ht());function Qd(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function Zd(i,s){if(i&1){let o=U();t(0,"button",25),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",26),a(2,"Download PDF "),e()}}function tp(i,s){i&1&&(t(0,"button",27),m(1,"i",28),a(2,"Downloading "),e())}function ep(i,s){if(i&1){let o=U();t(0,"button",25),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",26),a(2,"Download EXCEL "),e()}}function ip(i,s){i&1&&(t(0,"button",27),m(1,"i",28),a(2,"Downloading "),e())}var np=(i,s)=>s.id,Rn=i=>({installment:i});function op(i,s){if(i&1&&(t(0,"a",35),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit,n=h(3);Vt("routerLink","/department/portal/lwe/gp-stats/",o.district_id,"/",o.block_id,""),T("queryParams",pt(6,Rn,n.installment)),l(1),dt(" ",P(2,4,o.block_name)," ")}}function ap(i,s){if(i&1&&(t(0,"a",35),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit,n=h(3);Vt("routerLink","/department/portal/lwe/ward-stats/",o.district_id,"/",o.ulb_id,""),T("queryParams",pt(6,Rn,n.installment)),l(1),dt(" ",P(2,4,o.ulb_name)," ")}}function rp(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td"),b(4,op,3,8,"a",34)(5,ap,3,8),e(),t(6,"td"),a(7),e(),t(8,"td"),a(9),e(),t(10,"td"),a(11),e(),t(12,"td"),a(13),e(),t(14,"td"),a(15),e(),t(16,"td"),a(17),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),E(4,o.block_id?4:5),l(3),p(o==null?null:o.applications_received),l(2),p(o==null?null:o.approved_application),l(2),p(r.getTotalRejected(o)),l(2),p(o==null?null:o.payment_processed),l(2),p(o==null?null:o.payment_success),l(2),p(o==null?null:o.payment_fail)}}function sp(i,s){if(i&1&&(t(0,"table",29)(1,"thead",30)(2,"tr")(3,"th",31),a(4,"Sl.#"),e(),t(5,"th",31),a(6,"BLOCK/ULB"),e(),t(7,"th",32),a(8,"APPLICATION DETAILS"),e(),t(9,"th",32),a(10,"PAYMENT DETAILS"),e()(),t(11,"tr")(12,"th"),a(13,"RECEIVED"),e(),t(14,"th"),a(15,"APPROVED"),e(),t(16,"th"),a(17,"REJECTED"),e(),t(18,"th"),a(19,"PAYMENT PROCESSED"),e(),t(20,"th"),a(21,"PAYMENT SUCCESS"),e(),t(22,"th"),a(23,"PAYMENT FAILED"),e()()(),t(24,"tbody",33),F(25,rp,18,8,"tr",null,np),e()()),i&2){let o=h(2);l(25),V(o.filteredBlockStats)}}function lp(i,s){i&1&&a(0," No Data Found ")}function cp(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - LWE"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e()()()(),t(8,"div",16)(9,"div",17)(10,"input",18),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(11,"i",19),e(),t(12,"div",20),b(13,Zd,3,0,"button",21)(14,tp,3,0),e(),t(15,"div",22),b(16,ep,3,0,"button",21)(17,ip,3,0),e()()(),t(18,"div",23),b(19,sp,27,0,"table",24)(20,lp,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredBlockStats[0].district_name),l(3),T("ngModel",o.searchTerm),l(3),E(13,o.isExportInProgress?14:13),l(3),E(16,o.isExportInProgressExcel?17:16),l(3),E(19,o.filteredBlockStats&&o.filteredBlockStats.length>0?19:20)}}var On=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.districtStats=[],this.district_id="",this.blockStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{let r=n.id;this.district_id=r,this.fetchblockStats(r)})}fetchblockStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/block-count?district_id=${n}&specialgroup_lwe=1&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.blockStats=r.data},r=>{this.isStatsLoading=!1,this.blockStats=[]})}fetchulbStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/ulb-count?district_id=${n}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{},r=>{this.isStatsLoading=!1})}getTotalRejected(n){let r=parseInt((n.nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10),c=parseInt((n.non_nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10);return(r+c).toLocaleString()}get filteredBlockStats(){return this.searchTerm?this.blockStats.filter(n=>n.block_name&&n.block_name.toLowerCase().includes(this.searchTerm.toLowerCase())||n.ulb_name&&n.ulb_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.blockStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.blockStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name,"BLOCK/ULB":u?.block_name?.toUpperCase()||u?.ulb_name?.toUpperCase(),"APPLICATION RECEIVED":u?.applications_received,"APPLICATION APPROVED":u?.approved_application,"APPLICATION REJECTED":this.getTotalRejected(u),"PAYMENT PROCESSED":u?.payment_processed,"PAYMENT SUCCESS":u?.payment_success,"PAYMENT FAILED":u?.payment_fail})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`block_ulb_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){Ee.default.vfs=Nn.default.pdfMake.vfs,this.isExportInProgress=!0;let r=((this.blockStats[0]||{}).district_name||"N/A").toUpperCase(),c=[[{text:"SI#",fontSize:10},{text:"BLOCK/ULB",fontSize:10},{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"APPLICATION REJECTED",fontSize:10},{text:"PAYMENT PROCESSED",fontSize:10},{text:"PAYMENT SUCCESS",fontSize:10},{text:"PAYMENT FAILED",fontSize:10}]];this.blockStats.forEach((w,u)=>{c.push([{text:(u+1).toString().toUpperCase(),fontSize:9},{text:(w.block_name||w.ulb_name||"").toUpperCase(),fontSize:9},{text:w?.applications_received,fontSize:9},{text:w?.approved_application,fontSize:9},{text:this.getTotalRejected(w),fontSize:9},{text:w?.payment_processed,fontSize:9},{text:w?.payment_success,fontSize:9},{text:w?.payment_fail,fontSize:9}])});let f=new Date,d=`Timestamp: ${f.toLocaleDateString()}, ${f.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,C={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - LWE BLOCK/ULB-WISE",style:"header"},{table:{headerRows:1,body:c,widths:["9%","13%","13%","13%","13%","13%","13%","13%"]},layout:{fillColor:function(w){return w===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:d,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},g=new Date,_=g.toLocaleDateString("en-GB").split("/").reverse().join("-"),v=g.toLocaleTimeString("en-GB").replace(/:/g,"-"),S=`block_ulb_drilldown_reports_${_}_${v}.pdf`;Ee.default.createPdf(C).download(S,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-lwe-block-ulb-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],["colspan","3",1,"text-center"],[2,"font-size","14px"],["style","text-decoration: none",3,"routerLink","queryParams"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,Qd,2,0)(11,cp,21,5),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var we=j(ut()),Bn=j(ht());function dp(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function pp(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",27),a(2,"Download PDF "),e()}}function mp(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}function _p(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",27),a(2,"Download EXCEL "),e()}}function fp(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}var up=(i,s)=>s.id,hp=i=>({installment:i});function Sp(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",35),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e(),t(9,"td"),a(10),e(),t(11,"td"),a(12),e(),t(13,"td"),a(14),e(),t(15,"td"),a(16),e(),t(17,"td"),a(18),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),Mt("routerLink","/department/portal/lwe/village-stats/",o.district_id,"/",o.block_id,"/",o.gp_id,""),T("queryParams",pt(14,hp,r.installment)),l(1),dt(" ",P(6,12,o.gp_name)," "),l(3),p(o==null?null:o.applications_received),l(2),p(o==null?null:o.approved_application),l(2),p(r.getTotalRejected(o)),l(2),p(o==null?null:o.payment_processed),l(2),p(o==null?null:o.payment_success),l(2),p(o==null?null:o.payment_fail)}}function xp(i,s){if(i&1&&(t(0,"table",30)(1,"thead",31)(2,"tr")(3,"th",32),a(4,"Sl.#"),e(),t(5,"th",32),a(6,"GRAM PANCHAYAT"),e(),t(7,"th",33),a(8,"APPLICATION DETAILS"),e(),t(9,"th",33),a(10,"PAYMENT DETAILS"),e()(),t(11,"tr")(12,"th"),a(13,"RECEIVED"),e(),t(14,"th"),a(15,"APPROVED"),e(),t(16,"th"),a(17,"REJECTED"),e(),t(18,"th"),a(19,"PAYMENT PROCESSED"),e(),t(20,"th"),a(21,"PAYMENT SUCCESS"),e(),t(22,"th"),a(23,"PAYMENT FAILED"),e()()(),t(24,"tbody",34),F(25,Sp,19,16,"tr",null,up),e()()),i&2){let o=h(2);l(25),V(o.filteredGpStats)}}function gp(i,s){i&1&&a(0," No Data Found ")}function Cp(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - LWE"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e(),t(8,"li",16),a(9),e()()()(),t(10,"div",17)(11,"div",18)(12,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(13,"i",20),e(),t(14,"div",21),b(15,pp,3,0,"button",22)(16,mp,3,0),e(),t(17,"div",23),b(18,_p,3,0,"button",22)(19,fp,3,0),e()()(),t(20,"div",24),b(21,xp,27,0,"table",25)(22,gp,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredGpStats[0].district_name),l(2),p(o.filteredGpStats[0].block_name),l(3),T("ngModel",o.searchTerm),l(3),E(15,o.isExportInProgress?16:15),l(3),E(18,o.isExportInProgressExcel?19:18),l(3),E(21,o.filteredGpStats&&o.filteredGpStats.length>0?21:22)}}var Wn=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.district_id="",this.gpStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.id,this.fetchgpStats(this.block_id)})}fetchgpStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/gp-count?block_id=${n}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.gpStats=r.data},r=>{this.isStatsLoading=!1,this.gpStats=[]})}getTotalRejected(n){let r=parseInt((n.nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10),c=parseInt((n.non_nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10);return(r+c).toLocaleString()}get filteredGpStats(){return this.searchTerm?this.gpStats.filter(n=>n.gp_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.gpStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.gpStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",BLOCK:u.block_name?u.block_name.toUpperCase():"",GP:u.gp_name?u.gp_name.toUpperCase():"","APPLICATION RECEIVED":u?.applications_received,"APPLICATION APPROVED":u?.approved_application,"APPLICATION REJECTED":this.getTotalRejected(u),"PAYMENT PROCESSED":u?.payment_processed,"PAYMENT SUCCESS":u?.payment_success,"PAYMENT FAILED":u?.payment_fail})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`gp_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){we.default.vfs=Bn.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.gpStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=[[{text:"SI#",fontSize:10},{text:"GP",fontSize:10},{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"APPLICATION REJECTED",fontSize:10},{text:"PAYMENT PROCESSED",fontSize:10},{text:"PAYMENT SUCCESS",fontSize:10},{text:"PAYMENT FAILED",fontSize:10}]];this.gpStats.forEach((u,I)=>{f.push([{text:(I+1).toString().toUpperCase(),fontSize:9},{text:(u.gp_name||"").toUpperCase(),fontSize:9},{text:u?.applications_received,fontSize:9},{text:u?.approved_application,fontSize:9},{text:this.getTotalRejected(u),fontSize:9},{text:u?.payment_processed,fontSize:9},{text:u?.payment_success,fontSize:9},{text:u?.payment_fail,fontSize:9}])});let d=new Date,C=`Timestamp: ${d.toLocaleDateString()}, ${d.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,g={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK: ${c}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - LWE GP-WISE",style:"header"},{table:{headerRows:1,body:f,widths:["9%","13%","13%","13%","13%","13%","13%","13%"]},layout:{fillColor:function(u){return u===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:C,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},_=new Date,v=_.toLocaleDateString("en-GB").split("/").reverse().join("-"),S=_.toLocaleTimeString("en-GB").replace(/:/g,"-"),w=`gp_drilldown_reports_${v}_${S}.pdf`;we.default.createPdf(g).download(w,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-lwe-gp-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],["colspan","3",1,"text-center"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,dp,2,0)(11,Cp,23,6),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var Te=j(ut()),Mn=j(ht());function bp(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function vp(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",27),a(2,"Download PDF "),e()}}function Ep(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}function wp(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",27),a(2,"Download EXCEL "),e()}}function Tp(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}var Lp=(i,s)=>s.id,Ip=i=>({installment:i});function yp(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",35),a(5),e()(),t(6,"td"),a(7),e(),t(8,"td"),a(9),e(),t(10,"td"),a(11),e(),t(12,"td"),a(13),e(),t(14,"td"),a(15),e(),t(16,"td"),a(17),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),Mt("routerLink","/department/portal/lwe/ward-user-list/",o.district_id,"/",o.ulb_id,"/",o.ward_id,""),T("queryParams",pt(12,Ip,r.installment)),l(1),p(o.ward_no),l(2),p(o==null?null:o.applications_received),l(2),p(o==null?null:o.approved_application),l(2),p(r.getTotalRejected(o)),l(2),p(o==null?null:o.payment_processed),l(2),p(o==null?null:o.payment_success),l(2),p(o==null?null:o.payment_fail)}}function kp(i,s){if(i&1&&(t(0,"table",30)(1,"thead",31)(2,"tr")(3,"th",32),a(4,"Sl.#"),e(),t(5,"th",32),a(6,"WARD"),e(),t(7,"th",33),a(8,"APPLICATION DETAILS"),e(),t(9,"th",33),a(10,"PAYMENT DETAILS"),e()(),t(11,"tr")(12,"th"),a(13,"RECEIVED"),e(),t(14,"th"),a(15,"APPROVED"),e(),t(16,"th"),a(17,"REJECTED"),e(),t(18,"th"),a(19,"PAYMENT PROCESSED"),e(),t(20,"th"),a(21,"PAYMENT SUCCESS"),e(),t(22,"th"),a(23,"PAYMENT FAILED"),e()()(),t(24,"tbody",34),F(25,yp,18,14,"tr",null,Lp),e()()),i&2){let o=h(2);l(25),V(o.filteredWardStats)}}function Pp(i,s){i&1&&a(0," No Data Found ")}function Dp(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - LWE"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e(),t(8,"li",16),a(9),e()()()(),t(10,"div",17)(11,"div",18)(12,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(13,"i",20),e(),t(14,"div",21),b(15,vp,3,0,"button",22)(16,Ep,3,0),e(),t(17,"div",23),b(18,wp,3,0,"button",22)(19,Tp,3,0),e()()(),t(20,"div",24),b(21,kp,27,0,"table",25)(22,Pp,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredWardStats[0].district_name),l(2),p(o.filteredWardStats[0].ulb_name),l(3),T("ngModel",o.searchTerm),l(3),E(15,o.isExportInProgress?16:15),l(3),E(18,o.isExportInProgressExcel?19:18),l(3),E(21,o.filteredWardStats&&o.filteredWardStats.length>0?21:22)}}var Fn=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.district_id="",this.wardStats=[],this.ulb_id="",this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.ulb_id=n.id,this.fetchWardStats(this.ulb_id)})}fetchWardStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/ward-count?ulb_id=${n}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.wardStats=r.data},r=>{this.isStatsLoading=!1,this.wardStats=[]})}getTotalRejected(n){let r=parseInt((n.nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10),c=parseInt((n.non_nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10);return(r+c).toLocaleString()}get filteredWardStats(){return this.searchTerm?this.wardStats.filter(n=>n.ward_no.toLowerCase().includes(this.searchTerm.toLowerCase())):this.wardStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.wardStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",ULB:u.ulb_name?u.ulb_name.toUpperCase():"","WARD NO.":u.ward_no?u.ward_no.toUpperCase():"","APPLICATION RECEIVED":u?.applications_received,"APPLICATION APPROVED":u?.approved_application,"APPLICATION REJECTED":this.getTotalRejected(u),"PAYMENT PROCESSED":u?.payment_processed,"PAYMENT SUCCESS":u?.payment_success,"PAYMENT FAILED":u?.payment_fail})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`ward_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){Te.default.vfs=Mn.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.wardStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=[[{text:"SI#",fontSize:10},{text:"WARD NO.",fontSize:10},{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"APPLICATION REJECTED",fontSize:10},{text:"PAYMENT PROCESSED",fontSize:10},{text:"PAYMENT SUCCESS",fontSize:10},{text:"PAYMENT FAILED",fontSize:10}]];this.wardStats.forEach((u,I)=>{f.push([{text:(I+1).toString().toUpperCase(),fontSize:9},{text:(u.ward_no||"").toUpperCase(),fontSize:9},{text:u?.applications_received,fontSize:9},{text:u?.approved_application,fontSize:9},{text:this.getTotalRejected(u),fontSize:9},{text:u?.payment_processed,fontSize:9},{text:u?.payment_success,fontSize:9},{text:u?.payment_fail,fontSize:9}])});let d=new Date,C=`Timestamp: ${d.toLocaleDateString()}, ${d.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,g={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK/ULB: ${c}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - LWE WARD-WISE",style:"header"},{table:{headerRows:1,body:f,widths:["9%","13%","13%","13%","13%","13%","13%","13%"]},layout:{fillColor:function(u){return u===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:C,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},_=new Date,v=_.toLocaleDateString("en-GB").split("/").reverse().join("-"),S=_.toLocaleTimeString("en-GB").replace(/:/g,"-"),w=`ward_drilldown_reports_${v}_${S}.pdf`;Te.default.createPdf(g).download(w,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-lwe-ward-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],["colspan","3",1,"text-center"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,bp,2,0)(11,Dp,23,6),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J]});let i=s;return i})();var Le=j(ut()),Vn=j(ht());function Ap(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function Up(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",27),a(2,"Download PDF "),e()}}function Np(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}function Rp(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",27),a(2,"Download EXCEL "),e()}}function Op(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}var Bp=(i,s)=>s.id,Wp=i=>({installment:i});function Mp(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",35),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e(),t(9,"td"),a(10),e(),t(11,"td"),a(12),e(),t(13,"td"),a(14),e(),t(15,"td"),a(16),e(),t(17,"td"),a(18),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),Gt("routerLink","/department/portal/lwe/village-user-list/",o.district_id,"/",o.block_id,"/",o.gp_id,"/",o.village_id,""),T("queryParams",pt(15,Wp,r.installment)),l(1),dt(" ",P(6,13,o.village_name)," "),l(3),p(o==null?null:o.applications_received),l(2),p(o==null?null:o.approved_application),l(2),p(r.getTotalRejected(o)),l(2),p(o==null?null:o.payment_processed),l(2),p(o==null?null:o.payment_success),l(2),p(o==null?null:o.payment_fail)}}function Fp(i,s){if(i&1&&(t(0,"table",30)(1,"thead",31)(2,"tr")(3,"th",32),a(4,"Sl.#"),e(),t(5,"th",32),a(6,"VILLAGE"),e(),t(7,"th",33),a(8,"APPLICATION DETAILS"),e(),t(9,"th",33),a(10,"PAYMENT DETAILS"),e()(),t(11,"tr")(12,"th"),a(13,"RECEIVED"),e(),t(14,"th"),a(15,"APPROVED"),e(),t(16,"th"),a(17,"REJECTED"),e(),t(18,"th"),a(19,"PAYMENT PROCESSED"),e(),t(20,"th"),a(21,"PAYMENT SUCCESS"),e(),t(22,"th"),a(23,"PAYMENT FAILED"),e()()(),t(24,"tbody",34),F(25,Mp,19,17,"tr",null,Bp),e()()),i&2){let o=h(2);l(25),V(o.filteredVillageStats)}}function Vp(i,s){i&1&&a(0," No Data Found ")}function zp(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - LWE"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e(),t(8,"li",15),a(9),e(),t(10,"li",16),a(11),e()()()(),t(12,"div",17)(13,"div",18)(14,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(15,"i",20),e(),t(16,"div",21),b(17,Up,3,0,"button",22)(18,Np,3,0),e(),t(19,"div",23),b(20,Rp,3,0,"button",22)(21,Op,3,0),e()()(),t(22,"div",24),b(23,Fp,27,0,"table",25)(24,Vp,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredVillageStats[0].district_name),l(2),p(o.filteredVillageStats[0].block_name),l(2),p(o.filteredVillageStats[0].gp_name),l(3),T("ngModel",o.searchTerm),l(3),E(17,o.isExportInProgress?18:17),l(3),E(20,o.isExportInProgressExcel?21:20),l(3),E(23,o.filteredVillageStats&&o.filteredVillageStats.length>0?23:24)}}var zn=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.gp_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.block_id,this.gp_id=n.id,this.fetchvillageStats(this.gp_id)})}fetchvillageStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/village-count?gp_id=${n}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.villageStats=r.data},r=>{this.isStatsLoading=!1,this.villageStats=[]})}getTotalRejected(n){let r=parseInt((n.nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10),c=parseInt((n.non_nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10);return(r+c).toLocaleString()}get filteredVillageStats(){return this.searchTerm?this.villageStats.filter(n=>n.village_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.villageStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.villageStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",BLOCK:u.block_name?u.block_name.toUpperCase():"",GP:u.gp_name?u.gp_name.toUpperCase():"",VILLAGE:u.village_name?u.village_name.toUpperCase():"","APPLICATION RECEIVED":u?.applications_received,"APPLICATION APPROVED":u?.approved_application,"APPLICATION REJECTED":this.getTotalRejected(u),"PAYMENT PROCESSED":u?.payment_processed,"PAYMENT SUCCESS":u?.payment_success,"PAYMENT FAILED":u?.payment_fail})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`village_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){Le.default.vfs=Vn.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.villageStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=(n.gp_name||n.ward_no||"N/A").toUpperCase(),d=[[{text:"SI#",fontSize:10},{text:"VILLAGE",fontSize:10},{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"APPLICATION REJECTED",fontSize:10},{text:"PAYMENT PROCESSED",fontSize:10},{text:"PAYMENT SUCCESS",fontSize:10},{text:"PAYMENT FAILED",fontSize:10}]];this.villageStats.forEach((I,R)=>{d.push([{text:(R+1).toString().toUpperCase(),fontSize:9},{text:(I.village_name||"").toUpperCase(),fontSize:9},{text:I?.applications_received,fontSize:9},{text:I?.approved_application,fontSize:9},{text:this.getTotalRejected(I),fontSize:9},{text:I?.payment_processed,fontSize:9},{text:I?.payment_success,fontSize:9},{text:I?.payment_fail,fontSize:9}])});let C=new Date,g=`Timestamp: ${C.toLocaleDateString()}, ${C.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,_={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK: ${c} > GP:${f}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - LWE VILLAGE-WISE",style:"header"},{table:{headerRows:1,body:d,widths:["9%","13%","13%","13%","13%","13%","13%","13%"]},layout:{fillColor:function(I){return I===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:g,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},v=new Date,S=v.toLocaleDateString("en-GB").split("/").reverse().join("-"),w=v.toLocaleTimeString("en-GB").replace(/:/g,"-"),u=`village_drilldown_reports_${S}_${w}.pdf`;Le.default.createPdf(_).download(u,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-lwe-village-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],["colspan","3",1,"text-center"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,Ap,2,0)(11,zp,25,7),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var Ie=j(ut()),jn=j(ht());function jp(i,s){if(i&1&&(t(0,"div",33)(1,"div",34)(2,"nav",35)(3,"ol",36)(4,"li",37),a(5),e(),t(6,"li",37),a(7),e(),t(8,"li",37),a(9),e(),t(10,"li",38),a(11),e()()()()()),i&2){let o=h();l(5),p(o.filteredVillageUserStats[0].district_name),l(2),p(o.filteredVillageUserStats[0].block_name),l(2),p(o.filteredVillageUserStats[0].gp_name),l(2),p(o.filteredVillageUserStats[0].village_name)}}function $p(i,s){i&1&&(t(0,"button",39),m(1,"i",40),a(2,"Search "),e())}function Gp(i,s){i&1&&(t(0,"button",41),m(1,"i",42),a(2," Searching ..."),e())}function Xp(i,s){i&1&&(m(0,"i",43),a(1," We are fetching the data, please wait. "))}function Yp(i,s){if(i&1){let o=U();t(0,"button",57),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",58),a(2,"Download to PDF "),e()}}function Hp(i,s){i&1&&(t(0,"button",59),m(1,"i",42),a(2,"Downloading "),e())}function Kp(i,s){if(i&1){let o=U();t(0,"button",57),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",58),a(2,"Download to EXCEL "),e()}}function qp(i,s){i&1&&(t(0,"button",59),m(1,"i",42),a(2,"Downloading "),e())}var Jp=(i,s)=>s.id;function Qp(i,s){if(i&1&&(t(0,"td"),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit;l(1),p(P(2,1,o.village_name))}}function Zp(i,s){i&1&&m(0,"td")}function t0(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),b(3,Qp,3,3,"td")(4,Zp,1,0),t(5,"td"),a(6),k(7,"uppercase"),e(),t(8,"td"),a(9),k(10,"uppercase"),e(),t(11,"td"),a(12),k(13,"uppercase"),e(),t(14,"td"),a(15),k(16,"uppercase"),e(),t(17,"td"),a(18),k(19,"uppercase"),e(),t(20,"td"),a(21),k(22,"uppercase"),e(),t(23,"td"),a(24),k(25,"uppercase"),e(),t(26,"td"),a(27),e(),t(28,"td"),a(29),k(30,"uppercase"),e(),t(31,"td"),a(32),k(33,"uppercase"),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(1),E(3,o.village_name?3:4),l(3),p(P(7,12,o.category)),l(3),p(P(10,14,o.application_number)),l(3),p(P(13,16,r.appService.dateFormat(o.application_date))),l(3),p(P(16,18,o.applicant_name)),l(3),p(P(19,20,o.spouse_or_father_name)),l(3),p(P(22,22,o.social_category)),l(3),p(P(25,24,o.pwd_status)),l(3),p(o.alt_mobile_number),l(2),p(P(30,26,o.application_status)),l(3),p(P(33,28,o.payment_status))}}function e0(i,s){if(i&1&&(t(0,"table",60)(1,"thead",61)(2,"tr")(3,"th"),a(4,"SI#"),e(),t(5,"th"),a(6,"VILLAGE"),e(),t(7,"th"),a(8,"CATEGORY"),e(),t(9,"th"),a(10,"APPLICATION NO."),e(),t(11,"th"),a(12,"APPLICATION DATE"),e(),t(13,"th"),a(14,"APPLICANT NAME"),e(),t(15,"th"),a(16,"FATHER/HUSBAND NAME"),e(),t(17,"th"),a(18,"SOCIAL CATEGORY"),e(),t(19,"th"),a(20,"PWD"),e(),t(21,"th"),a(22,"MOBILE NO."),e(),t(23,"th"),a(24,"APPLICATION STATUS "),e(),t(25,"th"),a(26,"PAYMENT STATUS"),e()()(),t(27,"tbody"),F(28,t0,34,30,"tr",null,Jp),e()()),i&2){let o=h(2);l(28),V(o.filteredVillageUserStats)}}function i0(i,s){i&1&&(t(0,"h5",62),a(1,"No data available"),e())}function n0(i,s){i&1&&(t(0,"div",63),a(1,"Loading.. "),m(2,"i",64),e())}function o0(i,s){i&1&&(t(0,"span"),m(1,"i",43),a(2," Loading..."),e())}function a0(i,s){i&1&&(t(0,"span"),a(1,"Load More"),e())}function r0(i,s){if(i&1){let o=U();t(0,"div",65)(1,"button",66),L("click",function(){D(o);let r=h(2);return A(r.loadMore())}),b(2,o0,3,0,"span",67)(3,a0,2,0,"span",67),e()()}if(i&2){let o=h(2);l(2),T("ngIf",o.isLoadMoreInProgress),l(1),T("ngIf",!o.isLoadMoreInProgress)}}function s0(i,s){if(i&1){let o=U();t(0,"div",33)(1,"div",44)(2,"h5",2),a(3," Number of records found : "),t(4,"span",45),a(5),e()()(),t(6,"div",46)(7,"div",47)(8,"input",48),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(9,"i",49),e(),t(10,"div",50),b(11,Yp,3,0,"button",51)(12,Hp,3,0),e(),t(13,"div",52),b(14,Kp,3,0,"button",51)(15,qp,3,0),e()()(),t(16,"div",53),b(17,e0,30,0,"table",54)(18,i0,2,0)(19,n0,3,0,"div",55),e(),b(20,r0,4,2,"div",56)}if(i&2){let o=h();l(5),p(o.count),l(3),T("ngModel",o.searchTerm),l(3),E(11,o.isExportInProgress?12:11),l(3),E(14,o.isExportInProgressExcel?15:14),l(3),E(17,o.filteredVillageUserStats&&o.filteredVillageUserStats.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),l(2),E(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),l(1),T("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var $n=(()=>{let s=class s{constructor(n,r,c,f,d,C,g,_){this.route=n,this.router=r,this.formService=c,this.appService=f,this.httpClient=d,this.toastService=C,this.authService=g,this.masterDataService=_,this.isStatsLoading=!1,this.userStats=[],this.block_id="",this.gp_id="",this.village_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.limit=this.appService.loadmorelimit,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.count=0,this.searchForm=new kt({a_category:new nt(""),social_category:new nt(""),pwd_status:new nt(""),submit_date:new nt(""),a_status:new nt("")})}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.block_id,this.gp_id=n.gp_id,this.village_id=n.id,this.fetchuserStats(this.village_id)})}fetchuserStats(n,r=!1){this.isStatsLoading=!0;let c=new st;c=c.set("gp_id",this.gp_id),c=c.set("village_id",n),c=c.set("offset",this.offset),c=c.set("limit",this.limit),c=c.set("installment",this.installment);let f=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:c,headers:f}).subscribe(d=>{this.isStatsLoading=!1,this.count=d.count,d.data&&d.data.length>0?(this.application_list=this.application_list.concat(d.data),this.offset+=d.data.length,this.hasMoreRecords=d.data.length===this.limit):this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)},d=>{this.isStatsLoading=!1,this.application_list=[],this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)})}get filteredVillageUserStats(){if(!this.searchTerm)return this.application_list;let n=this.searchTerm.toLowerCase();return this.application_list.filter(r=>r.village_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.category?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.application_number?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_date).toLowerCase().includes(this.searchTerm.toLowerCase())||r.applicant_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.spouse_or_father_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.dob).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.social_category).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.pwd_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.alt_mobile_number).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.payment_status).toLowerCase().includes(this.searchTerm.toLowerCase()))}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status,_=new st;_=_.set("gp_id",this.gp_id),r&&(_=_.set("village_id",r)),c&&(_=_.set("category",c)),f&&(_=_.set("social_category",f)),d&&(_=_.set("pwd_status",d)),g&&(_=_.set("application_status",g)),_=_.set("offset",this.offset),_=_.set("limit",this.limit),_=_.set("installment",this.installment);let v=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:_,headers:v}).subscribe(S=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=S.count,S.data&&S.data.length>0?(this.application_list=this.application_list.concat(S.data),this.offset+=S.data.length,this.hasMoreRecords=S.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},S=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}exportToExcel(){let n=new st,r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;n=n.set("gp_id",this.gp_id),r&&(n=n.set("village_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),g&&(n=n.set("application_status",g)),n=n.set("export_all","1"),n=n.set("installment",this.installment);let _=new rt({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgressExcel=!1;let S=v.data.map((y,B)=>({"SI#":B+1,DISTRICT:y.district_name?y.district_name.toUpperCase():"",BLOCK:y.block_name?y.block_name.toUpperCase():"",GP:y.gp_name?y.gp_name.toUpperCase():"",VILLAGE:y.village_name?y.village_name.toUpperCase():"",CATEGORY:y.category.toUpperCase(),"APPLICATION NO.":y.application_number.toUpperCase(),"APPLICATION DATE":this.appService.dateFormat(y.application_date),"APPLICANT NAME":y.applicant_name.toUpperCase(),"FATHER/HUSBAND NAME":y.spouse_or_father_name.toUpperCase(),"SOCIAL CATEGORY":y.social_category.toUpperCase(),PWD:y.pwd_status.toUpperCase(),"MOBILE NO.":y.alt_mobile_number,"APPLICATION STATUS":y.application_status.toUpperCase(),"PAYMENT STATUS":y.payment_status.toUpperCase()})),w=N.json_to_sheet(S),u=N.book_new();N.book_append_sheet(u,w,"Applications");let I=Z(u,{bookType:"xlsx",type:"array"}),R=new Date,z=R.toLocaleDateString("en-GB").split("/").reverse().join("-"),at=R.toLocaleTimeString("en-GB").replace(/:/g,"-"),ct=`application_status_reports_${z}_${at}.xlsx`,lt=new Blob([I],{type:"application/octet-stream"}),O=document.createElement("a"),et=window.URL.createObjectURL(lt);O.href=et,O.download=ct,O.click(),window.URL.revokeObjectURL(et)},v=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",v)})}exportToPDF(){Ie.default.vfs=jn.default.pdfMake.vfs;let n=new st,r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;n=n.set("gp_id",this.gp_id),r&&(n=n.set("village_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),g&&(n=n.set("application_status",g)),n=n.set("export_all","1"),n=n.set("installment",this.installment);let _=new rt({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgress=!1;let S=v.data[0]||{},w=(S.district_name||"N/A").toUpperCase(),u=(S.block_name||S.ulb_name||"N/A").toUpperCase(),I=(S.gp_name||S.ward_no||"N/A").toUpperCase(),R=(S.village_name||"").toUpperCase(),z=[[{text:"SI#",fontSize:10},{text:"CATEGORY",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICATION DATE.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"SOCIAL CATEGORY",fontSize:10},{text:"PWD",fontSize:10},{text:"MOBILE NO",fontSize:10},{text:"APPLICATION STATUS",fontSize:10},{text:"PAYMENT STATUS",fontSize:10}]];v.data.forEach((W,It)=>{z.push([{text:(It+1).toString().toUpperCase(),fontSize:9},{text:(W.category||"").toUpperCase(),fontSize:9},{text:(W.application_number||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(W.application_date)||"",fontSize:9},{text:(W.applicant_name||"").toUpperCase(),fontSize:9},{text:(W.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:(W.social_category||"").toUpperCase(),fontSize:9},{text:(W.pwd_status||"").toUpperCase(),fontSize:9},{text:(W.alt_mobile_number||"").toUpperCase(),fontSize:9},{text:(W.application_status||"").toUpperCase(),fontSize:9},{text:(W.payment_status||"").toUpperCase(),fontSize:9}])});let at=new Date,ct=`Timestamp: ${at.toLocaleDateString()}, ${at.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,lt={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${w} > BLOCK: ${u} > GP: ${I} >VILLAGE: ${R}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DETAILED REPORT - LWE",style:"header"},{table:{headerRows:1,body:z,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]},layout:{fillColor:function(W){return W===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:ct,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},O=new Date,et=O.toLocaleDateString("en-GB").split("/").reverse().join("-"),y=O.toLocaleTimeString("en-GB").replace(/:/g,"-"),B=`application_status_reports_${et}_${y}.pdf`;Ie.default.createPdf(lt).download(B)},v=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",v)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(Ot),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-lwe-village-user-list"]],decls:68,vars:4,consts:[[1,"container-fluid","drilldown-reports"],[1,"d-flex","justify-content-between","w-100","mb-3"],[1,"card-title"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],["class","row mb-2"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-2"],[1,"col-md-3"],["for","a_category",1,"fw-bold"],["formControlName","a_category","id","a_category",1,"form-select","my-2"],["value",""],["value","1"],["value","0"],["for","social_category",1,"fw-bold"],["formControlName","social_category","id","social_category",1,"form-select","my-2"],["value","2"],["value","3"],["value","4"],["for","a_status",1,"fw-bold"],["formControlName","a_status","id","a_status",1,"form-select","my-2"],["value","7"],["for","pwd_status",1,"fw-bold"],["formControlName","pwd_status","id","pwd_status",1,"form-select","my-2"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[1,"row","mb-2"],[1,"col-md-7"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"fa","fa-spinner","fa-spin"],[1,"col-md-5"],["id","recordCount"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports detail"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports","detail"],[1,"text-light",2,"background-color","#fd7b03"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"],[4,"ngIf"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1)(2,"h4",2),a(3,"Detailed Report - LWE"),e(),t(4,"div",3)(5,"a",4),L("click",function(){return c.appService.goBack()}),t(6,"button",5),m(7,"i",6),a(8," Back"),e()()()(),b(9,jp,12,4,"div",7),t(10,"div",8)(11,"form",9),L("ngSubmit",function(){return c.onSearch()}),t(12,"div",10)(13,"div",11)(14,"label",12),a(15," Category "),e(),t(16,"select",13)(17,"option",14),a(18,"Choose Category"),e(),t(19,"option",15),a(20,"NFSA"),e(),t(21,"option",16),a(22,"NON-NFSA"),e()()(),t(23,"div",11)(24,"label",17),a(25," Social Category "),e(),t(26,"select",18)(27,"option",14),a(28,"Choose Social Category"),e(),t(29,"option",15),a(30,"Un-Reserved"),e(),t(31,"option",19),a(32,"OBC"),e(),t(33,"option",20),a(34,"SC"),e(),t(35,"option",21),a(36,"ST"),e()()(),t(37,"div",11)(38,"label",22),a(39," Application Status "),e(),t(40,"select",23)(41,"option",14),a(42,"Choose Status"),e(),t(43,"option",24),a(44,"Under Process"),e(),t(45,"option",15),a(46,"Approved"),e(),t(47,"option",19),a(48,"Rejected"),e()()(),t(49,"div",11)(50,"label",25),a(51," PWD "),e(),t(52,"select",26)(53,"option",14),a(54,"Choose PWD Status"),e(),t(55,"option",15),a(56,"Yes "),e(),t(57,"option",16),a(58,"NO"),e()()()(),t(59,"div",27)(60,"div",28),b(61,$p,3,0,"button",29)(62,Gp,3,0),e()()()(),t(63,"div",30)(64,"div",31)(65,"div",32),b(66,Xp,2,0)(67,s0,21,7),e()()()()),r&2&&(l(9),E(9,c.filteredVillageUserStats&&c.filteredVillageUserStats.length>0?9:-1),l(2),T("formGroup",c.searchForm),l(50),E(61,c.isFormSearchInProgress?62:61),l(5),E(66,c.isStatsLoading?66:67))},dependencies:[ft,Pt,Nt,Rt,K,Ut,q,yt,J,Dt,At,it]});let i=s;return i})();var ye=j(ut()),Gn=j(ht());function l0(i,s){if(i&1&&(t(0,"div",33)(1,"div",34)(2,"nav",35)(3,"ol",36)(4,"li",37),a(5),e(),t(6,"li",37),a(7),e(),t(8,"li",38),a(9),e()()()()()),i&2){let o=h();l(5),p(o.filteredWardUserStats[0].district_name),l(2),p(o.filteredWardUserStats[0].ulb_name),l(2),p(o.filteredWardUserStats[0].ward_no)}}function c0(i,s){i&1&&(t(0,"button",39),m(1,"i",40),a(2,"Search "),e())}function d0(i,s){i&1&&(t(0,"button",41),m(1,"i",42),a(2," Searching ..."),e())}function p0(i,s){i&1&&(m(0,"i",43),a(1," We are fetching the data, please wait. "))}function m0(i,s){if(i&1){let o=U();t(0,"button",57),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",58),a(2,"Download to PDF "),e()}}function _0(i,s){i&1&&(t(0,"button",59),m(1,"i",42),a(2,"Downloading "),e())}function f0(i,s){if(i&1){let o=U();t(0,"button",57),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",58),a(2,"Download to EXCEL "),e()}}function u0(i,s){i&1&&(t(0,"button",59),m(1,"i",42),a(2,"Downloading "),e())}var h0=(i,s)=>s.id;function S0(i,s){if(i&1&&(t(0,"td"),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit;l(1),p(P(2,1,o.ward_no))}}function x0(i,s){i&1&&m(0,"td")}function g0(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),b(3,S0,3,3,"td")(4,x0,1,0),t(5,"td"),a(6),k(7,"uppercase"),e(),t(8,"td"),a(9),k(10,"uppercase"),e(),t(11,"td"),a(12),k(13,"uppercase"),e(),t(14,"td"),a(15),k(16,"uppercase"),e(),t(17,"td"),a(18),k(19,"uppercase"),e(),t(20,"td"),a(21),k(22,"uppercase"),e(),t(23,"td"),a(24),k(25,"uppercase"),e(),t(26,"td"),a(27),e(),t(28,"td"),a(29),k(30,"uppercase"),e(),t(31,"td"),a(32),k(33,"uppercase"),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(1),E(3,o.ward_no?3:4),l(3),p(P(7,12,o.category)),l(3),p(P(10,14,o.application_number)),l(3),p(P(13,16,r.appService.dateFormat(o.application_date))),l(3),p(P(16,18,o.applicant_name)),l(3),p(P(19,20,o.spouse_or_father_name)),l(3),p(P(22,22,o.social_category)),l(3),p(P(25,24,o.pwd_status)),l(3),p(o.alt_mobile_number),l(2),p(P(30,26,o.application_status)),l(3),p(P(33,28,o.payment_status))}}function C0(i,s){if(i&1&&(t(0,"table",60)(1,"thead",61)(2,"tr")(3,"th"),a(4,"SI#"),e(),t(5,"th"),a(6,"WARD NO."),e(),t(7,"th"),a(8,"CATEGORY"),e(),t(9,"th"),a(10,"APPLICATION NO."),e(),t(11,"th"),a(12,"APPLICATION DATE"),e(),t(13,"th"),a(14,"APPLICANT NAME"),e(),t(15,"th"),a(16,"FATHER/HUSBAND NAME"),e(),t(17,"th"),a(18,"SOCIAL CATEGORY"),e(),t(19,"th"),a(20,"PWD"),e(),t(21,"th"),a(22,"MOBILE NO."),e(),t(23,"th"),a(24,"APPLICATION STATUS "),e(),t(25,"th"),a(26,"PAYMENT STATUS"),e()()(),t(27,"tbody"),F(28,g0,34,30,"tr",null,h0),e()()),i&2){let o=h(2);l(28),V(o.filteredWardUserStats)}}function b0(i,s){i&1&&(t(0,"h5",62),a(1,"No data available"),e())}function v0(i,s){i&1&&(t(0,"div",63),a(1,"Loading.. "),m(2,"i",64),e())}function E0(i,s){i&1&&(t(0,"span"),m(1,"i",43),a(2," Loading..."),e())}function w0(i,s){i&1&&(t(0,"span"),a(1,"Load More"),e())}function T0(i,s){if(i&1){let o=U();t(0,"div",65)(1,"button",66),L("click",function(){D(o);let r=h(2);return A(r.loadMore())}),b(2,E0,3,0,"span",67)(3,w0,2,0,"span",67),e()()}if(i&2){let o=h(2);l(2),T("ngIf",o.isLoadMoreInProgress),l(1),T("ngIf",!o.isLoadMoreInProgress)}}function L0(i,s){if(i&1){let o=U();t(0,"div",33)(1,"div",44)(2,"h5",2),a(3," Number of records found : "),t(4,"span",45),a(5),e()()(),t(6,"div",46)(7,"div",47)(8,"input",48),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(9,"i",49),e(),t(10,"div",50),b(11,m0,3,0,"button",51)(12,_0,3,0),e(),t(13,"div",52),b(14,f0,3,0,"button",51)(15,u0,3,0),e()()(),t(16,"div",53),b(17,C0,30,0,"table",54)(18,b0,2,0)(19,v0,3,0,"div",55),e(),b(20,T0,4,2,"div",56)}if(i&2){let o=h();l(5),p(o.count),l(3),T("ngModel",o.searchTerm),l(3),E(11,o.isExportInProgress?12:11),l(3),E(14,o.isExportInProgressExcel?15:14),l(3),E(17,o.filteredWardUserStats&&o.filteredWardUserStats.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),l(2),E(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),l(1),T("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var Xn=(()=>{let s=class s{constructor(n,r,c,f,d,C,g,_){this.route=n,this.router=r,this.formService=c,this.appService=f,this.httpClient=d,this.toastService=C,this.authService=g,this.masterDataService=_,this.isStatsLoading=!1,this.userStats=[],this.ulb_id="",this.ward_id="",this.village_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.limit=this.appService.loadmorelimit,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.count=0,this.searchForm=new kt({a_category:new nt(""),social_category:new nt(""),pwd_status:new nt(""),submit_date:new nt(""),a_status:new nt("")})}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.ulb_id=n.ulb_id,this.ward_id=n.id,this.fetchuserStats(this.ward_id)})}fetchuserStats(n,r=!1){this.isStatsLoading=!0;let c=new st;c=c.set("ward_id",n),c=c.set("offset",this.offset),c=c.set("limit",this.limit),c=c.set("installment",this.installment);let f=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:c,headers:f}).subscribe(d=>{this.isStatsLoading=!1,this.count=d.count,d.data&&d.data.length>0?(this.application_list=this.application_list.concat(d.data),this.offset+=d.data.length,this.hasMoreRecords=d.data.length===this.limit):this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)},d=>{this.isStatsLoading=!1,this.application_list=[],this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)})}get filteredWardUserStats(){if(!this.searchTerm)return this.application_list;let n=this.searchTerm.toLowerCase();return this.application_list.filter(r=>r.ward_no?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.category?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.application_number?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_date).toLowerCase().includes(this.searchTerm.toLowerCase())||r.applicant_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.spouse_or_father_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.dob).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.social_category).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.pwd_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.alt_mobile_number).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.payment_status).toLowerCase().includes(this.searchTerm.toLowerCase()))}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status,_=new st;r&&(_=_.set("ward_id",r)),c&&(_=_.set("category",c)),f&&(_=_.set("social_category",f)),d&&(_=_.set("pwd_status",d)),g&&(_=_.set("application_status",g)),_=_.set("offset",this.offset),_=_.set("limit",this.limit),_=_.set("installment",this.installment);let v=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:_,headers:v}).subscribe(S=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=S.count,S.data&&S.data.length>0?(this.application_list=this.application_list.concat(S.data),this.offset+=S.data.length,this.hasMoreRecords=S.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},S=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}exportToExcel(){let n=new st,r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;r&&(n=n.set("ward_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),g&&(n=n.set("application_status",g)),n=n.set("export_all","1"),n=n.set("installment",this.installment);let _=new rt({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgressExcel=!1;let S=v.data.map((y,B)=>({"SI#":B+1,DISTRICT:y.district_name?y.district_name.toUpperCase():"",ULB:y.ulb_name?y.ulb_name.toUpperCase():"","WARD NO.":y.ward_no?y.ward_no.toUpperCase():"",CATEGORY:y.category.toUpperCase(),"APPLICATION NO.":y.application_number.toUpperCase(),"APPLICATION DATE":this.appService.dateFormat(y.application_date),"APPLICANT NAME":y.applicant_name.toUpperCase(),"FATHER/HUSBAND NAME":y.spouse_or_father_name.toUpperCase(),"SOCIAL CATEGORY":y.social_category.toUpperCase(),PWD:y.pwd_status.toUpperCase(),"MOBILE NO.":y.alt_mobile_number,"APPLICATION STATUS ":y.application_status.toUpperCase(),"PAYMENT STATUS":y.payment_status.toUpperCase()})),w=N.json_to_sheet(S),u=N.book_new();N.book_append_sheet(u,w,"Applications");let I=Z(u,{bookType:"xlsx",type:"array"}),R=new Date,z=R.toLocaleDateString("en-GB").split("/").reverse().join("-"),at=R.toLocaleTimeString("en-GB").replace(/:/g,"-"),ct=`application_status_reports_${z}_${at}.xlsx`,lt=new Blob([I],{type:"application/octet-stream"}),O=document.createElement("a"),et=window.URL.createObjectURL(lt);O.href=et,O.download=ct,O.click(),window.URL.revokeObjectURL(et)},v=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",v)})}exportToPDF(){ye.default.vfs=Gn.default.pdfMake.vfs;let n=new st,r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;r&&(n=n.set("ward_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),g&&(n=n.set("application_status",g)),n=n.set("export_all","1"),n=n.set("installment",this.installment);let _=new rt({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgress=!1;let S=v.data[0]||{},w=(S.district_name||"N/A").toUpperCase(),u=(S.block_name||S.ulb_name||"N/A").toUpperCase(),I=(S.gp_name||S.ward_no||"N/A").toUpperCase(),R=[[{text:"SI#",fontSize:10},{text:"CATEGORY",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICATION DATE.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"SOCIAL CATEGORY",fontSize:10},{text:"PWD",fontSize:10},{text:"MOBILE NO",fontSize:10},{text:"APPLICATION STATUS",fontSize:10},{text:"PAYMENT STATUS",fontSize:10}]];v.data.forEach((B,W)=>{R.push([{text:(W+1).toString().toUpperCase(),fontSize:9},{text:(B.category||"").toUpperCase(),fontSize:9},{text:(B.application_number||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(B.application_date)||"",fontSize:9},{text:(B.applicant_name||"").toUpperCase(),fontSize:9},{text:(B.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:(B.social_category||"").toUpperCase(),fontSize:9},{text:(B.pwd_status||"").toUpperCase(),fontSize:9},{text:(B.alt_mobile_number||"").toUpperCase(),fontSize:9},{text:(B.application_status||"").toUpperCase(),fontSize:9},{text:(B.payment_status||"").toUpperCase(),fontSize:9}])});let z=new Date,at=`Timestamp: ${z.toLocaleDateString()}, ${z.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,ct={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${w} > ULB: ${u} > WARD: ${I}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"Left wing Extrimism  REPORT",style:"header"},{table:{headerRows:1,body:R,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]},layout:{fillColor:function(B){return B===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:at,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},lt=new Date,O=lt.toLocaleDateString("en-GB").split("/").reverse().join("-"),et=lt.toLocaleTimeString("en-GB").replace(/:/g,"-"),y=`application_status_reports_${O}_${et}.pdf`;ye.default.createPdf(ct).download(y)},v=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",v)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(Ot),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-lwe-ward-user-list"]],decls:68,vars:4,consts:[[1,"container-fluid","drilldown-reports"],[1,"d-flex","justify-content-between","w-100","mb-3"],[1,"card-title"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],["class","row mb-2"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-2"],[1,"col-md-3"],["for","a_category",1,"fw-bold"],["formControlName","a_category","id","a_category",1,"form-select","my-2"],["value",""],["value","1"],["value","0"],["for","social_category",1,"fw-bold"],["formControlName","social_category","id","social_category",1,"form-select","my-2"],["value","2"],["value","3"],["value","4"],["for","a_status",1,"fw-bold"],["formControlName","a_status","id","a_status",1,"form-select","my-2"],["value","7"],["for","pwd_status",1,"fw-bold"],["formControlName","pwd_status","id","pwd_status",1,"form-select","my-2"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[1,"row","mb-2"],[1,"col-md-7"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"fa","fa-spinner","fa-spin"],[1,"col-md-5"],["id","recordCount"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports detail"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports","detail"],[1,"text-light",2,"background-color","#fd7b03"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"],[4,"ngIf"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1)(2,"h4",2),a(3,"Detailed Report - LWE"),e(),t(4,"div",3)(5,"a",4),L("click",function(){return c.appService.goBack()}),t(6,"button",5),m(7,"i",6),a(8," Back"),e()()()(),b(9,l0,10,3,"div",7),t(10,"div",8)(11,"form",9),L("ngSubmit",function(){return c.onSearch()}),t(12,"div",10)(13,"div",11)(14,"label",12),a(15," Category "),e(),t(16,"select",13)(17,"option",14),a(18,"Choose Category"),e(),t(19,"option",15),a(20,"NFSA"),e(),t(21,"option",16),a(22,"NON-NFSA"),e()()(),t(23,"div",11)(24,"label",17),a(25," Social Category "),e(),t(26,"select",18)(27,"option",14),a(28,"Choose Social Category"),e(),t(29,"option",15),a(30,"Un-Reserved"),e(),t(31,"option",19),a(32,"OBC"),e(),t(33,"option",20),a(34,"SC"),e(),t(35,"option",21),a(36,"ST"),e()()(),t(37,"div",11)(38,"label",22),a(39," Application Status "),e(),t(40,"select",23)(41,"option",14),a(42,"Choose Status"),e(),t(43,"option",24),a(44,"Under Process"),e(),t(45,"option",15),a(46,"Approved"),e(),t(47,"option",19),a(48,"Rejected"),e()()(),t(49,"div",11)(50,"label",25),a(51," PWD "),e(),t(52,"select",26)(53,"option",14),a(54,"Choose PWD Status"),e(),t(55,"option",15),a(56,"Yes "),e(),t(57,"option",16),a(58,"NO"),e()()()(),t(59,"div",27)(60,"div",28),b(61,c0,3,0,"button",29)(62,d0,3,0),e()()()(),t(63,"div",30)(64,"div",31)(65,"div",32),b(66,p0,2,0)(67,L0,21,7),e()()()()),r&2&&(l(9),E(9,c.filteredWardUserStats&&c.filteredWardUserStats.length>0?9:-1),l(2),T("formGroup",c.searchForm),l(50),E(61,c.isFormSearchInProgress?62:61),l(5),E(66,c.isStatsLoading?66:67))},dependencies:[ft,Pt,Nt,Rt,K,Ut,q,yt,J,Dt,At,it]});let i=s;return i})();var ke=j(ut()),Yn=j(ht());function I0(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function y0(i,s){if(i&1){let o=U();t(0,"button",22),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",23),a(2,"Download PDF "),e()}}function k0(i,s){i&1&&(t(0,"button",24),m(1,"i",25),a(2,"Downloading "),e())}function P0(i,s){if(i&1){let o=U();t(0,"button",22),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",23),a(2,"Download EXCEL "),e()}}function D0(i,s){i&1&&(t(0,"button",24),m(1,"i",25),a(2,"Downloading "),e())}var A0=(i,s)=>s.id;function U0(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",31),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e(),t(9,"td"),a(10),e(),t(11,"td"),a(12),e(),t(13,"td"),a(14),e(),t(15,"td"),a(16),e(),t(17,"td"),a(18),e()()),i&2){let o=s.$implicit,n=s.$index;l(2),p(n+1),l(2),$t("routerLink","/department/portal/adp/block-ulb-stats/",o.district_id,""),l(1),p(P(6,9,o.district_name)),l(3),p(o==null?null:o.applications_received),l(2),p(o==null?null:o.approved_application),l(2),p(o.rejected_application),l(2),p(o==null?null:o.payment_processed),l(2),p(o==null?null:o.payment_success),l(2),p(o==null?null:o.payment_fail)}}function N0(i,s){if(i&1&&(t(0,"table",26)(1,"thead",27)(2,"tr")(3,"th",28),a(4,"Sl.#"),e(),t(5,"th",28),a(6,"DISTRICT"),e(),t(7,"th",29),a(8,"APPLICATION DETAILS"),e(),t(9,"th",29),a(10,"PAYMENT DETAILS"),e()(),t(11,"tr")(12,"th"),a(13,"RECEIVED"),e(),t(14,"th"),a(15,"APPROVED"),e(),t(16,"th"),a(17,"REJECTED"),e(),t(18,"th"),a(19,"PAYMENT PROCESSED"),e(),t(20,"th"),a(21,"PAYMENT SUCCESS"),e(),t(22,"th"),a(23,"PAYMENT FAILED"),e()()(),t(24,"tbody",30),F(25,U0,19,11,"tr",null,A0),e()()),i&2){let o=h(2);l(25),V(o.filteredDistrictStats)}}function R0(i,s){i&1&&a(0," No Data Found ")}function O0(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - ADP"),e()(),t(4,"div",13)(5,"div",14)(6,"input",15),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(7,"i",16),e(),t(8,"div",17),b(9,y0,3,0,"button",18)(10,k0,3,0),e(),t(11,"div",19),b(12,P0,3,0,"button",18)(13,D0,3,0),e()()(),t(14,"div",20),b(15,N0,27,0,"table",21)(16,R0,1,0),e()}if(i&2){let o=h();l(6),T("ngModel",o.searchTerm),l(3),E(9,o.isExportInProgress?10:9),l(3),E(12,o.isExportInProgressExcel?13:12),l(3),E(15,o.filteredDistrictStats&&o.filteredDistrictStats.length>0?15:16)}}var Hn=(()=>{let s=class s{constructor(n,r,c,f,d,C){this.router=n,this.appService=r,this.httpClient=c,this.toastService=f,this.authService=d,this.masterDataService=C,this.isStatsLoading=!1,this.districtStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.fetchDistrictStats()}fetchDistrictStats(){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?specialgroup_adp=1`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isStatsLoading=!1,this.districtStats=n.data},n=>{this.isStatsLoading=!1,this.districtStats=[]})}get filteredDistrictStats(){return this.searchTerm?this.districtStats.filter(n=>n.district_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.districtStats}exportToExcel(){this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?specialgroup_adp=1`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isExportInProgressExcel=!1;let r=n.data.map((I,R)=>({"SI#":R+1,DISTRICT:I.district_name.toUpperCase(),"APPLICATION RECEIVED":I?.applications_received,"APPLICATION APPROVED":I?.approved_application,"APPLICATION REJECTED":I?.rejected_application,"PAYMENT PROCESSED":I?.payment_processed,"PAYMENT SUCCESS":I?.payment_success,"PAYMENT FAILED":I?.payment_fail})),c=N.json_to_sheet(r),f=N.book_new();N.book_append_sheet(f,c,"Applications");let d=Z(f,{bookType:"xlsx",type:"array"}),C=new Date,g=C.toLocaleDateString("en-GB").split("/").reverse().join("-"),_=C.toLocaleTimeString("en-GB").replace(/:/g,"-"),v=`district_drilldown_reports_${g}_${_}.xlsx`,S=new Blob([d],{type:"application/octet-stream"}),w=document.createElement("a"),u=window.URL.createObjectURL(S);w.href=u,w.download=v,w.click(),window.URL.revokeObjectURL(u)},n=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",n)})}exportToPDF(){ke.default.vfs=Yn.default.pdfMake.vfs,this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?specialgroup_adp=1`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isExportInProgress=!1;let r=[[{text:"SI#",fontSize:10},{text:"DISTRICT",fontSize:10},{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"APPLICATION REJECTED",fontSize:10},{text:"PAYMENT PROCESSED",fontSize:10},{text:"PAYMENT SUCCESS",fontSize:10},{text:"PAYMENT FAILED",fontSize:10}]];n.data.forEach((S,w)=>{r.push([{text:(w+1).toString().toUpperCase(),fontSize:9},{text:(S.district_name||"").toUpperCase(),fontSize:9},{text:S?.applications_received,fontSize:9},{text:S?.approved_application,fontSize:9},{text:S?.rejected_application,fontSize:9},{text:S?.payment_processed,fontSize:9},{text:S?.payment_success,fontSize:9},{text:S?.payment_fail,fontSize:9}])});let c=new Date,f=`Timestamp: ${c.toLocaleDateString()}, ${c.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,d={pageOrientation:"landscape",pageSize:"A4",content:[{text:"DRILL-DOWN REPORT - ADP DISTRICT-WISE",style:"header"},{table:{headerRows:1,body:r,widths:["9%","13%","13%","13%","13%","13%","13%","13%"]},layout:{fillColor:function(S){return S===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:f,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},C=new Date,g=C.toLocaleDateString("en-GB").split("/").reverse().join("-"),_=C.toLocaleTimeString("en-GB").replace(/:/g,"-"),v=`district_drilldown_reports_${g}_${_}.pdf`;ke.default.createPdf(d).download(v)},n=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",n)})}};s.\u0275fac=function(r){return new(r||s)(x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-adp-district-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],["colspan","3",1,"text-center"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,I0,2,0)(11,O0,17,4),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var Pe=j(ut()),Kn=j(ht());function B0(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function W0(i,s){if(i&1){let o=U();t(0,"button",25),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",26),a(2,"Download PDF "),e()}}function M0(i,s){i&1&&(t(0,"button",27),m(1,"i",28),a(2,"Downloading "),e())}function F0(i,s){if(i&1){let o=U();t(0,"button",25),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",26),a(2,"Download EXCEL "),e()}}function V0(i,s){i&1&&(t(0,"button",27),m(1,"i",28),a(2,"Downloading "),e())}var z0=(i,s)=>s.id;function j0(i,s){if(i&1&&(t(0,"a",35),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit;Vt("routerLink","/department/portal/adp/gp-stats/",o.district_id,"/",o.block_id,""),l(1),p(P(2,3,o.block_name))}}function $0(i,s){if(i&1&&(t(0,"a",35),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit;Vt("routerLink","/department/portal/adp/ward-stats/",o.district_id,"/",o.ulb_id,""),l(1),p(P(2,3,o.ulb_name))}}function G0(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td"),b(4,j0,3,5,"a",34)(5,$0,3,5),e(),t(6,"td"),a(7),e(),t(8,"td"),a(9),e(),t(10,"td"),a(11),e(),t(12,"td"),a(13),e(),t(14,"td"),a(15),e(),t(16,"td"),a(17),e()()),i&2){let o=s.$implicit,n=s.$index;l(2),p(n+1),l(2),E(4,o.block_id?4:5),l(3),p(o==null?null:o.applications_received),l(2),p(o==null?null:o.approved_application),l(2),p(o.rejected_application),l(2),p(o==null?null:o.payment_processed),l(2),p(o==null?null:o.payment_success),l(2),p(o==null?null:o.payment_fail)}}function X0(i,s){if(i&1&&(t(0,"table",29)(1,"thead",30)(2,"tr")(3,"th",31),a(4,"Sl.#"),e(),t(5,"th",31),a(6,"BLOCK/ULB"),e(),t(7,"th",32),a(8,"APPLICATION DETAILS"),e(),t(9,"th",32),a(10,"PAYMENT DETAILS"),e()(),t(11,"tr")(12,"th"),a(13,"RECEIVED"),e(),t(14,"th"),a(15,"APPROVED"),e(),t(16,"th"),a(17,"REJECTED"),e(),t(18,"th"),a(19,"PAYMENT PROCESSED"),e(),t(20,"th"),a(21,"PAYMENT SUCCESS"),e(),t(22,"th"),a(23,"PAYMENT FAILED"),e()()(),t(24,"tbody",33),F(25,G0,18,8,"tr",null,z0),e()()),i&2){let o=h(2);l(25),V(o.filteredBlockStats)}}function Y0(i,s){i&1&&a(0," No Data Found ")}function H0(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - ADP"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e()()()(),t(8,"div",16)(9,"div",17)(10,"input",18),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(11,"i",19),e(),t(12,"div",20),b(13,W0,3,0,"button",21)(14,M0,3,0),e(),t(15,"div",22),b(16,F0,3,0,"button",21)(17,V0,3,0),e()()(),t(18,"div",23),b(19,X0,27,0,"table",24)(20,Y0,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredBlockStats[0].district_name),l(3),T("ngModel",o.searchTerm),l(3),E(13,o.isExportInProgress?14:13),l(3),E(16,o.isExportInProgressExcel?17:16),l(3),E(19,o.filteredBlockStats&&o.filteredBlockStats.length>0?19:20)}}var qn=(()=>{let s=class s{constructor(n,r,c,f,d,C,g,_){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.location=_,this.isStatsLoading=!1,this.districtStats=[],this.district_id="",this.blockStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.params.subscribe(n=>{let r=n.id;this.district_id=r,this.fetchblockStats(r)})}goBack(){this.location.back()}fetchblockStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/block-count?district_id=${n}&specialgroup_adp=1`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.blockStats=r.data},r=>{this.isStatsLoading=!1,this.blockStats=[]})}fetchulbStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/ulb-count?district_id=${n}&specialgroup_adp=1`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.blockStats=[...this.blockStats,...r.data]},r=>{this.isStatsLoading=!1})}get filteredBlockStats(){return this.searchTerm?this.blockStats.filter(n=>n.block_name&&n.block_name.toLowerCase().includes(this.searchTerm.toLowerCase())||n.ulb_name&&n.ulb_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.blockStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.blockStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name,"BLOCK/ULB":u.block_name?.toUpperCase()||u.ulb_name?.toUpperCase(),"APPLICATION RECEIVED":u?.applications_received,"APPLICATION APPROVED":u?.approved_application,"APPLICATION REJECTED":u?.rejected_application,"PAYMENT PROCESSED":u?.payment_processed,"PAYMENT SUCCESS":u?.payment_success,"PAYMENT FAILED":u?.payment_fail})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`block_ulb_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){Pe.default.vfs=Kn.default.pdfMake.vfs,this.isExportInProgress=!0;let r=((this.blockStats[0]||{}).district_name||"N/A").toUpperCase(),c=[[{text:"SI#",fontSize:10},{text:"BLOCK/ULB",fontSize:10},{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"APPLICATION REJECTED",fontSize:10},{text:"PAYMENT PROCESSED",fontSize:10},{text:"PAYMENT SUCCESS",fontSize:10},{text:"PAYMENT FAILED",fontSize:10}]];this.blockStats.forEach((w,u)=>{c.push([{text:(u+1).toString().toUpperCase(),fontSize:9},{text:(w.block_name||w.ulb_name||"").toUpperCase(),fontSize:9},{text:w?.applications_received,fontSize:9},{text:w?.approved_application,fontSize:9},{text:w?.rejected_application,fontSize:9},{text:w?.payment_processed,fontSize:9},{text:w?.payment_success,fontSize:9},{text:w?.payment_fail,fontSize:9}])});let f=new Date,d=`Timestamp: ${f.toLocaleDateString()}, ${f.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,C={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - ADP BLOCK/ULB-WISE",style:"header"},{table:{headerRows:1,body:c,widths:["9%","13%","13%","13%","13%","13%","13%","13%"]},layout:{fillColor:function(w){return w===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:d,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},g=new Date,_=g.toLocaleDateString("en-GB").split("/").reverse().join("-"),v=g.toLocaleTimeString("en-GB").replace(/:/g,"-"),S=`block_ulb_drilldown_reports_${_}_${v}.pdf`;Pe.default.createPdf(C).download(S,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q),x(Xt))},s.\u0275cmp=M({type:s,selectors:[["app-adp-block-ulb-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],["colspan","3",1,"text-center"],[2,"font-size","14px"],["style","text-decoration: none",3,"routerLink"],[2,"text-decoration","none",3,"routerLink"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,B0,2,0)(11,H0,21,5),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var De=j(ut()),Jn=j(ht());function K0(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function q0(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",27),a(2,"Download PDF "),e()}}function J0(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}function Q0(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",27),a(2,"Download EXCEL "),e()}}function Z0(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}var tm=(i,s)=>s.id;function em(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",35),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e(),t(9,"td"),a(10),e(),t(11,"td"),a(12),e(),t(13,"td"),a(14),e(),t(15,"td"),a(16),e(),t(17,"td"),a(18),e()()),i&2){let o=s.$implicit,n=s.$index;l(2),p(n+1),l(2),Mt("routerLink","/department/portal/adp/village-stats/",o.district_id,"/",o.block_id,"/",o.gp_id,""),l(1),p(P(6,11,o.gp_name)),l(3),p(o==null?null:o.applications_received),l(2),p(o==null?null:o.approved_application),l(2),p(o.rejected_application),l(2),p(o==null?null:o.payment_processed),l(2),p(o==null?null:o.payment_success),l(2),p(o==null?null:o.payment_fail)}}function im(i,s){if(i&1&&(t(0,"table",30)(1,"thead",31)(2,"tr")(3,"th",32),a(4,"Sl.#"),e(),t(5,"th",32),a(6,"GRAM PANCHAYAT"),e(),t(7,"th",33),a(8,"APPLICATION DETAILS"),e(),t(9,"th",33),a(10,"PAYMENT DETAILS"),e()(),t(11,"tr")(12,"th"),a(13,"RECEIVED"),e(),t(14,"th"),a(15,"APPROVED"),e(),t(16,"th"),a(17,"REJECTED"),e(),t(18,"th"),a(19,"PAYMENT PROCESSED"),e(),t(20,"th"),a(21,"PAYMENT SUCCESS"),e(),t(22,"th"),a(23,"PAYMENT FAILED"),e()()(),t(24,"tbody",34),F(25,em,19,13,"tr",null,tm),e()()),i&2){let o=h(2);l(25),V(o.filteredGpStats)}}function nm(i,s){i&1&&a(0," No Data Found ")}function om(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - ADP"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e(),t(8,"li",16),a(9),e()()()(),t(10,"div",17)(11,"div",18)(12,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(13,"i",20),e(),t(14,"div",21),b(15,q0,3,0,"button",22)(16,J0,3,0),e(),t(17,"div",23),b(18,Q0,3,0,"button",22)(19,Z0,3,0),e()()(),t(20,"div",24),b(21,im,27,0,"table",25)(22,nm,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredGpStats[0].district_name),l(2),p(o.filteredGpStats[0].block_name),l(3),T("ngModel",o.searchTerm),l(3),E(15,o.isExportInProgress?16:15),l(3),E(18,o.isExportInProgressExcel?19:18),l(3),E(21,o.filteredGpStats&&o.filteredGpStats.length>0?21:22)}}var Qn=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.district_id="",this.gpStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.id,this.fetchgpStats(this.block_id)})}fetchgpStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/gp-count?block_id=${n}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.gpStats=r.data},r=>{this.isStatsLoading=!1,this.gpStats=[]})}get filteredGpStats(){return this.searchTerm?this.gpStats.filter(n=>n.gp_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.gpStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.gpStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",BLOCK:u.block_name?u.block_name.toUpperCase():"",GP:u.gp_name?u.gp_name.toUpperCase():"","APPLICATION RECEIVED":u?.applications_received,"APPLICATION APPROVED":u?.approved_application,"APPLICATION REJECTED":u?.rejected_application,"PAYMENT PROCESSED":u?.payment_processed,"PAYMENT SUCCESS":u?.payment_success,"PAYMENT FAILED":u?.payment_fail})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`gp_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){De.default.vfs=Jn.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.gpStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=[[{text:"SI#",fontSize:10},{text:"GP",fontSize:10},{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"APPLICATION REJECTED",fontSize:10},{text:"PAYMENT PROCESSED",fontSize:10},{text:"PAYMENT SUCCESS",fontSize:10},{text:"PAYMENT FAILED",fontSize:10}]];this.gpStats.forEach((u,I)=>{f.push([{text:(I+1).toString().toUpperCase(),fontSize:9},{text:(u.gp_name||"").toUpperCase(),fontSize:9},{text:u?.applications_received,fontSize:9},{text:u?.approved_application,fontSize:9},{text:u?.rejected_application,fontSize:9},{text:u?.payment_processed,fontSize:9},{text:u?.payment_success,fontSize:9},{text:u?.payment_fail,fontSize:9}])});let d=new Date,C=`Timestamp: ${d.toLocaleDateString()}, ${d.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,g={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK: ${c}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - ADP GP-WISE",style:"header"},{table:{headerRows:1,body:f,widths:["9%","13%","13%","13%","13%","13%","13%","13%"]},layout:{fillColor:function(u){return u===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:C,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},_=new Date,v=_.toLocaleDateString("en-GB").split("/").reverse().join("-"),S=_.toLocaleTimeString("en-GB").replace(/:/g,"-"),w=`gp_drilldown_reports_${v}_${S}.pdf`;De.default.createPdf(g).download(w,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-adp-gp-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],["colspan","3",1,"text-center"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,K0,2,0)(11,om,23,6),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var Ae=j(ut()),Zn=j(ht());function am(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function rm(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",27),a(2,"Download PDF "),e()}}function sm(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}function lm(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",27),a(2,"Download EXCEL "),e()}}function cm(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}var dm=(i,s)=>s.id;function pm(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",35),a(5),e()(),t(6,"td"),a(7),e(),t(8,"td"),a(9),e(),t(10,"td"),a(11),e(),t(12,"td"),a(13),e(),t(14,"td"),a(15),e(),t(16,"td"),a(17),e()()),i&2){let o=s.$implicit,n=s.$index;l(2),p(n+1),l(2),Mt("routerLink","/department/portal/adp/ward-user-list/",o.district_id,"/",o.ulb_id,"/",o.ward_id,""),l(1),p(o.ward_no),l(2),p(o==null?null:o.applications_received),l(2),p(o==null?null:o.approved_application),l(2),p(o.rejected_application),l(2),p(o==null?null:o.payment_processed),l(2),p(o==null?null:o.payment_success),l(2),p(o==null?null:o.payment_fail)}}function mm(i,s){if(i&1&&(t(0,"table",30)(1,"thead",31)(2,"tr")(3,"th",32),a(4,"Sl.#"),e(),t(5,"th",32),a(6,"WARD"),e(),t(7,"th",33),a(8,"APPLICATION DETAILS"),e(),t(9,"th",33),a(10,"PAYMENT DETAILS"),e()(),t(11,"tr")(12,"th"),a(13,"RECEIVED"),e(),t(14,"th"),a(15,"APPROVED"),e(),t(16,"th"),a(17,"REJECTED"),e(),t(18,"th"),a(19,"PAYMENT PROCESSED"),e(),t(20,"th"),a(21,"PAYMENT SUCCESS"),e(),t(22,"th"),a(23,"PAYMENT FAILED"),e()()(),t(24,"tbody",34),F(25,pm,18,11,"tr",null,dm),e()()),i&2){let o=h(2);l(25),V(o.filteredWardStats)}}function _m(i,s){i&1&&a(0," No Data Found ")}function fm(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - ADP"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e(),t(8,"li",16),a(9),e()()()(),t(10,"div",17)(11,"div",18)(12,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(13,"i",20),e(),t(14,"div",21),b(15,rm,3,0,"button",22)(16,sm,3,0),e(),t(17,"div",23),b(18,lm,3,0,"button",22)(19,cm,3,0),e()()(),t(20,"div",24),b(21,mm,27,0,"table",25)(22,_m,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredWardStats[0].district_name),l(2),p(o.filteredWardStats[0].ulb_name),l(3),T("ngModel",o.searchTerm),l(3),E(15,o.isExportInProgress?16:15),l(3),E(18,o.isExportInProgressExcel?19:18),l(3),E(21,o.filteredWardStats&&o.filteredWardStats.length>0?21:22)}}var to=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.district_id="",this.wardStats=[],this.ulb_id="",this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.params.subscribe(n=>{this.district_id=n.district_id,this.ulb_id=n.id,this.fetchWardStats(this.ulb_id)})}fetchWardStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/ward-count?ulb_id=${n}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.wardStats=r.data},r=>{this.isStatsLoading=!1,this.wardStats=[]})}get filteredWardStats(){return this.searchTerm?this.wardStats.filter(n=>n.ward_no.toLowerCase().includes(this.searchTerm.toLowerCase())):this.wardStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.wardStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",ULB:u.ulb_name?u.ulb_name.toUpperCase():"","WARD NO.":u.ward_no?u.ward_no.toUpperCase():"","APPLICATION RECEIVED":u?.applications_received,"APPLICATION APPROVED":u?.approved_application,"APPLICATION REJECTED":u?.rejected_application,"PAYMENT PROCESSED":u?.payment_processed,"PAYMENT SUCCESS":u?.payment_success,"PAYMENT FAILED":u?.payment_fail})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`ward_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){Ae.default.vfs=Zn.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.wardStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=[[{text:"SI#",fontSize:10},{text:"WARD NO.",fontSize:10},{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"APPLICATION REJECTED",fontSize:10},{text:"PAYMENT PROCESSED",fontSize:10},{text:"PAYMENT SUCCESS",fontSize:10},{text:"PAYMENT FAILED",fontSize:10}]];this.wardStats.forEach((u,I)=>{f.push([{text:(I+1).toString().toUpperCase(),fontSize:9},{text:(u.ward_no||"").toUpperCase(),fontSize:9},{text:u?.applications_received,fontSize:9},{text:u?.approved_application,fontSize:9},{text:u?.rejected_application,fontSize:9},{text:u?.payment_processed,fontSize:9},{text:u?.payment_success,fontSize:9},{text:u?.payment_fail,fontSize:9}])});let d=new Date,C=`Timestamp: ${d.toLocaleDateString()}, ${d.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,g={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK/ULB: ${c}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - ADP WARD-WISE",style:"header"},{table:{headerRows:1,body:f,widths:["9%","13%","13%","13%","13%","13%","13%","13%"]},layout:{fillColor:function(u){return u===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:C,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},_=new Date,v=_.toLocaleDateString("en-GB").split("/").reverse().join("-"),S=_.toLocaleTimeString("en-GB").replace(/:/g,"-"),w=`ward_drilldown_reports_${v}_${S}.pdf`;Ae.default.createPdf(g).download(w,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-adp-ward-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],["colspan","3",1,"text-center"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,am,2,0)(11,fm,23,6),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J]});let i=s;return i})();var Ue=j(ut()),eo=j(ht());function um(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function hm(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",27),a(2,"Download PDF "),e()}}function Sm(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}function xm(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",27),a(2,"Download EXCEL "),e()}}function gm(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}var Cm=(i,s)=>s.id;function bm(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",35),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e(),t(9,"td"),a(10),e(),t(11,"td"),a(12),e(),t(13,"td"),a(14),e(),t(15,"td"),a(16),e(),t(17,"td"),a(18),e()()),i&2){let o=s.$implicit,n=s.$index;l(2),p(n+1),l(2),Gt("routerLink","/department/portal/adp/village-user-list/",o.district_id,"/",o.block_id,"/",o.gp_id,"/",o.village_id,""),l(1),p(P(6,12,o.village_name)),l(3),p(o==null?null:o.applications_received),l(2),p(o==null?null:o.approved_application),l(2),p(o.rejected_application),l(2),p(o==null?null:o.payment_processed),l(2),p(o==null?null:o.payment_success),l(2),p(o==null?null:o.payment_fail)}}function vm(i,s){if(i&1&&(t(0,"table",30)(1,"thead",31)(2,"tr")(3,"th",32),a(4,"Sl.#"),e(),t(5,"th",32),a(6,"VILLAGE"),e(),t(7,"th",33),a(8,"APPLICATION DETAILS"),e(),t(9,"th",33),a(10,"PAYMENT DETAILS"),e()(),t(11,"tr")(12,"th"),a(13,"RECEIVED"),e(),t(14,"th"),a(15,"APPROVED"),e(),t(16,"th"),a(17,"REJECTED"),e(),t(18,"th"),a(19,"PAYMENT PROCESSED"),e(),t(20,"th"),a(21,"PAYMENT SUCCESS"),e(),t(22,"th"),a(23,"PAYMENT FAILED"),e()()(),t(24,"tbody",34),F(25,bm,19,14,"tr",null,Cm),e()()),i&2){let o=h(2);l(25),V(o.filteredVillageStats)}}function Em(i,s){i&1&&a(0," No Data Found ")}function wm(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - ADP"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e(),t(8,"li",15),a(9),e(),t(10,"li",16),a(11),e()()()(),t(12,"div",17)(13,"div",18)(14,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(15,"i",20),e(),t(16,"div",21),b(17,hm,3,0,"button",22)(18,Sm,3,0),e(),t(19,"div",23),b(20,xm,3,0,"button",22)(21,gm,3,0),e()()(),t(22,"div",24),b(23,vm,27,0,"table",25)(24,Em,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredVillageStats[0].district_name),l(2),p(o.filteredVillageStats[0].block_name),l(2),p(o.filteredVillageStats[0].gp_name),l(3),T("ngModel",o.searchTerm),l(3),E(17,o.isExportInProgress?18:17),l(3),E(20,o.isExportInProgressExcel?21:20),l(3),E(23,o.filteredVillageStats&&o.filteredVillageStats.length>0?23:24)}}var io=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.gp_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.block_id,this.gp_id=n.id,this.fetchvillageStats(this.gp_id)})}fetchvillageStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/village-count?gp_id=${n}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.villageStats=r.data},r=>{this.isStatsLoading=!1,this.villageStats=[]})}get filteredVillageStats(){return this.searchTerm?this.villageStats.filter(n=>n.village_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.villageStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.villageStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",BLOCK:u.block_name?u.block_name.toUpperCase():"",GP:u.gp_name?u.gp_name.toUpperCase():"",VILLAGE:u.village_name?u.village_name.toUpperCase():"","APPLICATION RECEIVED":u?.applications_received,"APPLICATION APPROVED":u?.approved_application,"APPLICATION REJECTED":u?.rejected_application,"PAYMENT PROCESSED":u?.payment_processed,"PAYMENT SUCCESS":u?.payment_success,"PAYMENT FAILED":u?.payment_fail})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`village_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){Ue.default.vfs=eo.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.villageStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=(n.gp_name||n.ward_no||"N/A").toUpperCase(),d=[[{text:"SI#",fontSize:10},{text:"VILLAGE",fontSize:10},{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"APPLICATION REJECTED",fontSize:10},{text:"PAYMENT PROCESSED",fontSize:10},{text:"PAYMENT SUCCESS",fontSize:10},{text:"PAYMENT FAILED",fontSize:10}]];this.villageStats.forEach((I,R)=>{d.push([{text:(R+1).toString().toUpperCase(),fontSize:9},{text:(I.village_name||"").toUpperCase(),fontSize:9},{text:I?.applications_received,fontSize:9},{text:I?.approved_application,fontSize:9},{text:I?.rejected_application,fontSize:9},{text:I?.payment_processed,fontSize:9},{text:I?.payment_success,fontSize:9},{text:I?.payment_fail,fontSize:9}])});let C=new Date,g=`Timestamp: ${C.toLocaleDateString()}, ${C.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,_={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK: ${c} > GP:${f}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - ADP VILLAGE-WISE",style:"header"},{table:{headerRows:1,body:d,widths:["9%","13%","13%","13%","13%","13%","13%","13%"]},layout:{fillColor:function(I){return I===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:g,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},v=new Date,S=v.toLocaleDateString("en-GB").split("/").reverse().join("-"),w=v.toLocaleTimeString("en-GB").replace(/:/g,"-"),u=`village_drilldown_reports_${S}_${w}.pdf`;Ue.default.createPdf(_).download(u,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-adp-village-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],["colspan","3",1,"text-center"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,um,2,0)(11,wm,25,7),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var Ne=j(ut()),no=j(ht());function Tm(i,s){if(i&1&&(t(0,"div",33)(1,"div",34)(2,"nav",35)(3,"ol",36)(4,"li",37),a(5),e(),t(6,"li",37),a(7),e(),t(8,"li",37),a(9),e(),t(10,"li",38),a(11),e()()()()()),i&2){let o=h();l(5),p(o.filteredVillageUserStats[0].district_name),l(2),p(o.filteredVillageUserStats[0].block_name),l(2),p(o.filteredVillageUserStats[0].gp_name),l(2),p(o.filteredVillageUserStats[0].village_name)}}function Lm(i,s){i&1&&(t(0,"button",39),m(1,"i",40),a(2,"Search "),e())}function Im(i,s){i&1&&(t(0,"button",41),m(1,"i",42),a(2," Searching ..."),e())}function ym(i,s){i&1&&(m(0,"i",43),a(1," We are fetching the data, please wait. "))}function km(i,s){if(i&1){let o=U();t(0,"button",57),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",58),a(2,"Download to PDF "),e()}}function Pm(i,s){i&1&&(t(0,"button",59),m(1,"i",42),a(2,"Downloading "),e())}function Dm(i,s){if(i&1){let o=U();t(0,"button",57),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",58),a(2,"Download to EXCEL "),e()}}function Am(i,s){i&1&&(t(0,"button",59),m(1,"i",42),a(2,"Downloading "),e())}var Um=(i,s)=>s.id;function Nm(i,s){if(i&1&&(t(0,"td"),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit;l(1),p(P(2,1,o.village_name))}}function Rm(i,s){i&1&&m(0,"td")}function Om(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),b(3,Nm,3,3,"td")(4,Rm,1,0),t(5,"td"),a(6),k(7,"uppercase"),e(),t(8,"td"),a(9),k(10,"uppercase"),e(),t(11,"td"),a(12),k(13,"uppercase"),e(),t(14,"td"),a(15),k(16,"uppercase"),e(),t(17,"td"),a(18),k(19,"uppercase"),e(),t(20,"td"),a(21),k(22,"uppercase"),e(),t(23,"td"),a(24),k(25,"uppercase"),e(),t(26,"td"),a(27),e(),t(28,"td"),a(29),k(30,"uppercase"),e(),t(31,"td"),a(32),k(33,"uppercase"),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(1),E(3,o.village_name?3:4),l(3),p(P(7,12,o.category)),l(3),p(P(10,14,o.application_number)),l(3),p(P(13,16,r.appService.dateFormat(o.application_date))),l(3),p(P(16,18,o.applicant_name)),l(3),p(P(19,20,o.spouse_or_father_name)),l(3),p(P(22,22,o.social_category)),l(3),p(P(25,24,o.pwd_status)),l(3),p(o.alt_mobile_number),l(2),p(P(30,26,o.application_status)),l(3),p(P(33,28,o.payment_status))}}function Bm(i,s){if(i&1&&(t(0,"table",60)(1,"thead",61)(2,"tr")(3,"th"),a(4,"SI#"),e(),t(5,"th"),a(6,"VILLAGE"),e(),t(7,"th"),a(8,"CATEGORY"),e(),t(9,"th"),a(10,"APPLICATION NO."),e(),t(11,"th"),a(12,"APPLICATION DATE"),e(),t(13,"th"),a(14,"APPLICANT NAME"),e(),t(15,"th"),a(16,"FATHER/HUSBAND NAME"),e(),t(17,"th"),a(18,"SOCIAL CATEGORY"),e(),t(19,"th"),a(20,"PWD"),e(),t(21,"th"),a(22,"MOBILE NO."),e(),t(23,"th"),a(24,"Aspirational Districts Programme"),e(),t(25,"th"),a(26,"PAYMENT STATUS"),e()()(),t(27,"tbody"),F(28,Om,34,30,"tr",null,Um),e()()),i&2){let o=h(2);l(28),V(o.filteredVillageUserStats)}}function Wm(i,s){i&1&&(t(0,"h5",62),a(1,"No data available"),e())}function Mm(i,s){i&1&&(t(0,"div",63),a(1,"Loading.. "),m(2,"i",64),e())}function Fm(i,s){i&1&&(t(0,"span"),m(1,"i",43),a(2," Loading..."),e())}function Vm(i,s){i&1&&(t(0,"span"),a(1,"Load More"),e())}function zm(i,s){if(i&1){let o=U();t(0,"div",65)(1,"button",66),L("click",function(){D(o);let r=h(2);return A(r.loadMore())}),b(2,Fm,3,0,"span",67)(3,Vm,2,0,"span",67),e()()}if(i&2){let o=h(2);l(2),T("ngIf",o.isLoadMoreInProgress),l(1),T("ngIf",!o.isLoadMoreInProgress)}}function jm(i,s){if(i&1){let o=U();t(0,"div",33)(1,"div",44)(2,"h5",2),a(3," Number of records found : "),t(4,"span",45),a(5),e()()(),t(6,"div",46)(7,"div",47)(8,"input",48),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(9,"i",49),e(),t(10,"div",50),b(11,km,3,0,"button",51)(12,Pm,3,0),e(),t(13,"div",52),b(14,Dm,3,0,"button",51)(15,Am,3,0),e()()(),t(16,"div",53),b(17,Bm,30,0,"table",54)(18,Wm,2,0)(19,Mm,3,0,"div",55),e(),b(20,zm,4,2,"div",56)}if(i&2){let o=h();l(5),p(o.count),l(3),T("ngModel",o.searchTerm),l(3),E(11,o.isExportInProgress?12:11),l(3),E(14,o.isExportInProgressExcel?15:14),l(3),E(17,o.filteredVillageUserStats&&o.filteredVillageUserStats.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),l(2),E(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),l(1),T("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var oo=(()=>{let s=class s{constructor(n,r,c,f,d,C,g,_){this.route=n,this.router=r,this.formService=c,this.appService=f,this.httpClient=d,this.toastService=C,this.authService=g,this.masterDataService=_,this.isStatsLoading=!1,this.userStats=[],this.block_id="",this.gp_id="",this.village_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.limit=this.appService.loadmorelimit,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.count=0,this.searchForm=new kt({a_category:new nt(""),social_category:new nt(""),pwd_status:new nt(""),submit_date:new nt(""),a_status:new nt("")})}ngOnInit(){this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.block_id,this.gp_id=n.gp_id,this.village_id=n.id,this.fetchuserStats(this.village_id)})}fetchuserStats(n,r=!1){this.isStatsLoading=!0;let c=new st;c=c.set("gp_id",this.gp_id),c=c.set("village_id",n),c=c.set("offset",this.offset),c=c.set("limit",this.limit);let f=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:c,headers:f}).subscribe(d=>{this.isStatsLoading=!1,this.count=d.count,d.data&&d.data.length>0?(this.application_list=this.application_list.concat(d.data),this.offset+=d.data.length,this.hasMoreRecords=d.data.length===this.limit):this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)},d=>{this.isStatsLoading=!1,this.application_list=[],this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)})}get filteredVillageUserStats(){if(!this.searchTerm)return this.application_list;let n=this.searchTerm.toLowerCase();return this.application_list.filter(r=>r.village_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.category?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.application_number?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_date).toLowerCase().includes(this.searchTerm.toLowerCase())||r.applicant_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.spouse_or_father_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.dob).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.social_category).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.pwd_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.alt_mobile_number).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.payment_status).toLowerCase().includes(this.searchTerm.toLowerCase()))}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status,_=new st;_=_.set("gp_id",this.gp_id),r&&(_=_.set("village_id",r)),c&&(_=_.set("category",c)),f&&(_=_.set("social_category",f)),d&&(_=_.set("pwd_status",d)),g&&(_=_.set("application_status",g)),_=_.set("offset",this.offset),_=_.set("limit",this.limit);let v=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:_,headers:v}).subscribe(S=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=S.count,S.data&&S.data.length>0?(this.application_list=this.application_list.concat(S.data),this.offset+=S.data.length,this.hasMoreRecords=S.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},S=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}exportToExcel(){let n=new st;n=n.set("gp_id",this.gp_id);let r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;r&&(n=n.set("village_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),g&&(n=n.set("application_status",g)),n=n.set("export_all","1");let _=new rt({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgressExcel=!1;let S=v.data.map((y,B)=>({"SI#":B+1,DISTRICT:y.district_name?y.district_name.toUpperCase():"",BLOCK:y.block_name?y.block_name.toUpperCase():"",GP:y.gp_name?y.gp_name.toUpperCase():"",VILLAGE:y.village_name?y.village_name.toUpperCase():"",CATEGORY:y.category.toUpperCase(),"APPLICATION NO.":y.application_number.toUpperCase(),"APPLICATION DATE":this.appService.dateFormat(y.application_date),"APPLICANT NAME":y.applicant_name.toUpperCase(),"FATHER/HUSBAND NAME":y.spouse_or_father_name.toUpperCase(),"SOCIAL CATEGORY":y.social_category.toUpperCase(),PWD:y.pwd_status.toUpperCase(),"MOBILE NO.":y.alt_mobile_number,"Aspirational Districts Programme":y.application_status.toUpperCase(),"PAYMENT STATUS":y.payment_status.toUpperCase()})),w=N.json_to_sheet(S),u=N.book_new();N.book_append_sheet(u,w,"Applications");let I=Z(u,{bookType:"xlsx",type:"array"}),R=new Date,z=R.toLocaleDateString("en-GB").split("/").reverse().join("-"),at=R.toLocaleTimeString("en-GB").replace(/:/g,"-"),ct=`application_status_reports_${z}_${at}.xlsx`,lt=new Blob([I],{type:"application/octet-stream"}),O=document.createElement("a"),et=window.URL.createObjectURL(lt);O.href=et,O.download=ct,O.click(),window.URL.revokeObjectURL(et)},v=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",v)})}exportToPDF(){Ne.default.vfs=no.default.pdfMake.vfs;let n=new st;n=n.set("gp_id",this.gp_id);let r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;r&&(n=n.set("village_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),g&&(n=n.set("application_status",g)),n=n.set("export_all","1");let _=new rt({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgress=!1;let S=v.data[0]||{},w=(S.district_name||"N/A").toUpperCase(),u=(S.block_name||S.ulb_name||"N/A").toUpperCase(),I=(S.gp_name||S.ward_no||"N/A").toUpperCase(),R=(S.village_name||"").toUpperCase(),z=[[{text:"SI#",fontSize:10},{text:"CATEGORY",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICATION DATE.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"SOCIAL CATEGORY",fontSize:10},{text:"PWD",fontSize:10},{text:"MOBILE NO",fontSize:10},{text:"Aspirational Districts Programme",fontSize:10},{text:"PAYMENT STATUS",fontSize:10}]];v.data.forEach((W,It)=>{z.push([{text:(It+1).toString().toUpperCase(),fontSize:9},{text:(W.category||"").toUpperCase(),fontSize:9},{text:(W.application_number||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(W.application_date)||"",fontSize:9},{text:(W.applicant_name||"").toUpperCase(),fontSize:9},{text:(W.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:(W.social_category||"").toUpperCase(),fontSize:9},{text:(W.pwd_status||"").toUpperCase(),fontSize:9},{text:(W.alt_mobile_number||"").toUpperCase(),fontSize:9},{text:(W.application_status||"").toUpperCase(),fontSize:9},{text:(W.payment_status||"").toUpperCase(),fontSize:9}])});let at=new Date,ct=`Timestamp: ${at.toLocaleDateString()}, ${at.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,lt={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${w} > BLOCK: ${u} > GP: ${I} >VILLAGE: ${R}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DETAILED REPORT ADP",style:"header"},{table:{headerRows:1,body:z,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]},layout:{fillColor:function(W){return W===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:ct,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},O=new Date,et=O.toLocaleDateString("en-GB").split("/").reverse().join("-"),y=O.toLocaleTimeString("en-GB").replace(/:/g,"-"),B=`application_status_reports_${et}_${y}.pdf`;Ne.default.createPdf(lt).download(B)},v=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",v)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(Ot),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-adp-village-user-list"]],decls:68,vars:4,consts:[[1,"container-fluid","drilldown-reports"],[1,"d-flex","justify-content-between","w-100","mb-3"],[1,"card-title"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],["class","row mb-2"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-2"],[1,"col-md-3"],["for","a_category",1,"fw-bold"],["formControlName","a_category","id","a_category",1,"form-select","my-2"],["value",""],["value","1"],["value","0"],["for","social_category",1,"fw-bold"],["formControlName","social_category","id","social_category",1,"form-select","my-2"],["value","2"],["value","3"],["value","4"],["for","a_status",1,"fw-bold"],["formControlName","a_status","id","a_status",1,"form-select","my-2"],["value","7"],["for","pwd_status",1,"fw-bold"],["formControlName","pwd_status","id","pwd_status",1,"form-select","my-2"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[1,"row","mb-2"],[1,"col-md-7"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"fa","fa-spinner","fa-spin"],[1,"col-md-5"],["id","recordCount"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports detail"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports","detail"],[1,"text-light",2,"background-color","#fd7b03"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"],[4,"ngIf"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1)(2,"h4",2),a(3,"Detailed Report - ADP"),e(),t(4,"div",3)(5,"a",4),L("click",function(){return c.appService.goBack()}),t(6,"button",5),m(7,"i",6),a(8," Back"),e()()()(),b(9,Tm,12,4,"div",7),t(10,"div",8)(11,"form",9),L("ngSubmit",function(){return c.onSearch()}),t(12,"div",10)(13,"div",11)(14,"label",12),a(15," Category "),e(),t(16,"select",13)(17,"option",14),a(18,"Choose Category"),e(),t(19,"option",15),a(20,"NFSA"),e(),t(21,"option",16),a(22,"NON-NFSA"),e()()(),t(23,"div",11)(24,"label",17),a(25," Social Category "),e(),t(26,"select",18)(27,"option",14),a(28,"Choose Social Category"),e(),t(29,"option",15),a(30,"Un-Reserved"),e(),t(31,"option",19),a(32,"OBC"),e(),t(33,"option",20),a(34,"SC"),e(),t(35,"option",21),a(36,"ST"),e()()(),t(37,"div",11)(38,"label",22),a(39," Application Status "),e(),t(40,"select",23)(41,"option",14),a(42,"Choose Status"),e(),t(43,"option",24),a(44,"Under Process"),e(),t(45,"option",15),a(46,"Approved"),e(),t(47,"option",19),a(48,"Rejected"),e()()(),t(49,"div",11)(50,"label",25),a(51," PWD "),e(),t(52,"select",26)(53,"option",14),a(54,"Choose PWD Status"),e(),t(55,"option",15),a(56,"Yes "),e(),t(57,"option",16),a(58,"NO"),e()()()(),t(59,"div",27)(60,"div",28),b(61,Lm,3,0,"button",29)(62,Im,3,0),e()()()(),t(63,"div",30)(64,"div",31)(65,"div",32),b(66,ym,2,0)(67,jm,21,7),e()()()()),r&2&&(l(9),E(9,c.filteredVillageUserStats&&c.filteredVillageUserStats.length>0?9:-1),l(2),T("formGroup",c.searchForm),l(50),E(61,c.isFormSearchInProgress?62:61),l(5),E(66,c.isStatsLoading?66:67))},dependencies:[ft,Pt,Nt,Rt,K,Ut,q,yt,J,Dt,At,it]});let i=s;return i})();var Re=j(ut()),ao=j(ht());function $m(i,s){if(i&1&&(t(0,"div",33)(1,"div",34)(2,"nav",35)(3,"ol",36)(4,"li",37),a(5),e(),t(6,"li",37),a(7),e(),t(8,"li",38),a(9),e()()()()()),i&2){let o=h();l(5),p(o.filteredWardUserStats[0].district_name),l(2),p(o.filteredWardUserStats[0].ulb_name),l(2),p(o.filteredWardUserStats[0].ward_no)}}function Gm(i,s){i&1&&(t(0,"button",39),m(1,"i",40),a(2,"Search "),e())}function Xm(i,s){i&1&&(t(0,"button",41),m(1,"i",42),a(2," Searching ..."),e())}function Ym(i,s){i&1&&(m(0,"i",43),a(1," We are fetching the data, please wait. "))}function Hm(i,s){if(i&1){let o=U();t(0,"button",57),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",58),a(2,"Download to PDF "),e()}}function Km(i,s){i&1&&(t(0,"button",59),m(1,"i",42),a(2,"Downloading "),e())}function qm(i,s){if(i&1){let o=U();t(0,"button",57),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",58),a(2,"Download to EXCEL "),e()}}function Jm(i,s){i&1&&(t(0,"button",59),m(1,"i",42),a(2,"Downloading "),e())}var Qm=(i,s)=>s.id;function Zm(i,s){if(i&1&&(t(0,"td"),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit;l(1),p(P(2,1,o.ward_no))}}function t_(i,s){i&1&&m(0,"td")}function e_(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),b(3,Zm,3,3,"td")(4,t_,1,0),t(5,"td"),a(6),k(7,"uppercase"),e(),t(8,"td"),a(9),k(10,"uppercase"),e(),t(11,"td"),a(12),k(13,"uppercase"),e(),t(14,"td"),a(15),k(16,"uppercase"),e(),t(17,"td"),a(18),k(19,"uppercase"),e(),t(20,"td"),a(21),k(22,"uppercase"),e(),t(23,"td"),a(24),k(25,"uppercase"),e(),t(26,"td"),a(27),e(),t(28,"td"),a(29),k(30,"uppercase"),e(),t(31,"td"),a(32),k(33,"uppercase"),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(1),E(3,o.ward_no?3:4),l(3),p(P(7,12,o.category)),l(3),p(P(10,14,o.application_number)),l(3),p(P(13,16,r.appService.dateFormat(o.application_date))),l(3),p(P(16,18,o.applicant_name)),l(3),p(P(19,20,o.spouse_or_father_name)),l(3),p(P(22,22,o.social_category)),l(3),p(P(25,24,o.pwd_status)),l(3),p(o.alt_mobile_number),l(2),p(P(30,26,o.application_status)),l(3),p(P(33,28,o.payment_status))}}function i_(i,s){if(i&1&&(t(0,"table",60)(1,"thead",61)(2,"tr")(3,"th"),a(4,"SI#"),e(),t(5,"th"),a(6,"WARD NO."),e(),t(7,"th"),a(8,"CATEGORY"),e(),t(9,"th"),a(10,"APPLICATION NO."),e(),t(11,"th"),a(12,"APPLICATION DATE"),e(),t(13,"th"),a(14,"APPLICANT NAME"),e(),t(15,"th"),a(16,"FATHER/HUSBAND NAME"),e(),t(17,"th"),a(18,"SOCIAL CATEGORY"),e(),t(19,"th"),a(20,"PWD"),e(),t(21,"th"),a(22,"MOBILE NO."),e(),t(23,"th"),a(24,"Aspirational Districts Programme"),e(),t(25,"th"),a(26,"PAYMENT STATUS"),e()()(),t(27,"tbody"),F(28,e_,34,30,"tr",null,Qm),e()()),i&2){let o=h(2);l(28),V(o.filteredWardUserStats)}}function n_(i,s){i&1&&(t(0,"h5",62),a(1,"No data available"),e())}function o_(i,s){i&1&&(t(0,"div",63),a(1,"Loading.. "),m(2,"i",64),e())}function a_(i,s){i&1&&(t(0,"span"),m(1,"i",43),a(2," Loading..."),e())}function r_(i,s){i&1&&(t(0,"span"),a(1,"Load More"),e())}function s_(i,s){if(i&1){let o=U();t(0,"div",65)(1,"button",66),L("click",function(){D(o);let r=h(2);return A(r.loadMore())}),b(2,a_,3,0,"span",67)(3,r_,2,0,"span",67),e()()}if(i&2){let o=h(2);l(2),T("ngIf",o.isLoadMoreInProgress),l(1),T("ngIf",!o.isLoadMoreInProgress)}}function l_(i,s){if(i&1){let o=U();t(0,"div",33)(1,"div",44)(2,"h5",2),a(3," Number of records found : "),t(4,"span",45),a(5),e()()(),t(6,"div",46)(7,"div",47)(8,"input",48),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(9,"i",49),e(),t(10,"div",50),b(11,Hm,3,0,"button",51)(12,Km,3,0),e(),t(13,"div",52),b(14,qm,3,0,"button",51)(15,Jm,3,0),e()()(),t(16,"div",53),b(17,i_,30,0,"table",54)(18,n_,2,0)(19,o_,3,0,"div",55),e(),b(20,s_,4,2,"div",56)}if(i&2){let o=h();l(5),p(o.count),l(3),T("ngModel",o.searchTerm),l(3),E(11,o.isExportInProgress?12:11),l(3),E(14,o.isExportInProgressExcel?15:14),l(3),E(17,o.filteredWardUserStats&&o.filteredWardUserStats.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),l(2),E(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),l(1),T("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var ro=(()=>{let s=class s{constructor(n,r,c,f,d,C,g,_){this.route=n,this.router=r,this.formService=c,this.appService=f,this.httpClient=d,this.toastService=C,this.authService=g,this.masterDataService=_,this.isStatsLoading=!1,this.userStats=[],this.ulb_id="",this.ward_id="",this.village_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.limit=this.appService.loadmorelimit,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.count=0,this.searchForm=new kt({a_category:new nt(""),social_category:new nt(""),pwd_status:new nt(""),submit_date:new nt(""),a_status:new nt("")})}ngOnInit(){this.route.params.subscribe(n=>{this.district_id=n.district_id,this.ulb_id=n.ulb_id,this.ward_id=n.id,this.fetchuserStats(this.ward_id)})}fetchuserStats(n,r=!1){this.isStatsLoading=!0;let c=new st;c=c.set("ward_id",n),c=c.set("offset",this.offset),c=c.set("limit",this.limit);let f=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:c,headers:f}).subscribe(d=>{this.isStatsLoading=!1,this.count=d.count,d.data&&d.data.length>0?(this.application_list=this.application_list.concat(d.data),this.offset+=d.data.length,this.hasMoreRecords=d.data.length===this.limit):this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)},d=>{this.isStatsLoading=!1,this.application_list=[],this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)})}get filteredWardUserStats(){if(!this.searchTerm)return this.application_list;let n=this.searchTerm.toLowerCase();return this.application_list.filter(r=>r.ward_no?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.category?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.application_number?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_date).toLowerCase().includes(this.searchTerm.toLowerCase())||r.applicant_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.spouse_or_father_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.dob).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.social_category).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.pwd_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.alt_mobile_number).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.payment_status).toLowerCase().includes(this.searchTerm.toLowerCase()))}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status,_=new st;r&&(_=_.set("ward_id",r)),c&&(_=_.set("category",c)),f&&(_=_.set("social_category",f)),d&&(_=_.set("pwd_status",d)),g&&(_=_.set("application_status",g)),_=_.set("offset",this.offset),_=_.set("limit",this.limit);let v=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:_,headers:v}).subscribe(S=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=S.count,S.data&&S.data.length>0?(this.application_list=this.application_list.concat(S.data),this.offset+=S.data.length,this.hasMoreRecords=S.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},S=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}exportToExcel(){let n=new st,r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;r&&(n=n.set("ward_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),g&&(n=n.set("application_status",g)),n=n.set("export_all","1");let _=new rt({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgressExcel=!1;let S=v.data.map((y,B)=>({"SI#":B+1,DISTRICT:y.district_name?y.district_name.toUpperCase():"",ULB:y.ulb_name?y.ulb_name.toUpperCase():"","WARD NO.":y.ward_no?y.ward_no.toUpperCase():"",CATEGORY:y.category.toUpperCase(),"APPLICATION NO.":y.application_number.toUpperCase(),"APPLICATION DATE":this.appService.dateFormat(y.application_date),"APPLICANT NAME":y.applicant_name.toUpperCase(),"FATHER/HUSBAND NAME":y.spouse_or_father_name.toUpperCase(),"SOCIAL CATEGORY":y.social_category.toUpperCase(),PWD:y.pwd_status.toUpperCase(),"MOBILE NO.":y.alt_mobile_number,"Aspirational Districts Programme":y.application_status.toUpperCase(),"PAYMENT STATUS":y.payment_status.toUpperCase()})),w=N.json_to_sheet(S),u=N.book_new();N.book_append_sheet(u,w,"Applications");let I=Z(u,{bookType:"xlsx",type:"array"}),R=new Date,z=R.toLocaleDateString("en-GB").split("/").reverse().join("-"),at=R.toLocaleTimeString("en-GB").replace(/:/g,"-"),ct=`application_status_reports_${z}_${at}.xlsx`,lt=new Blob([I],{type:"application/octet-stream"}),O=document.createElement("a"),et=window.URL.createObjectURL(lt);O.href=et,O.download=ct,O.click(),window.URL.revokeObjectURL(et)},v=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",v)})}exportToPDF(){Re.default.vfs=ao.default.pdfMake.vfs;let n=new st,r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;r&&(n=n.set("ward_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),g&&(n=n.set("application_status",g)),n=n.set("export_all","1");let _=new rt({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgress=!1;let S=v.data[0]||{},w=(S.district_name||"N/A").toUpperCase(),u=(S.block_name||S.ulb_name||"N/A").toUpperCase(),I=(S.gp_name||S.ward_no||"N/A").toUpperCase(),R=[[{text:"SI#",fontSize:10},{text:"CATEGORY",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICATION DATE.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"SOCIAL CATEGORY",fontSize:10},{text:"PWD",fontSize:10},{text:"MOBILE NO",fontSize:10},{text:"Aspirational Districts Programme",fontSize:10},{text:"PAYMENT STATUS",fontSize:10}]];v.data.forEach((B,W)=>{R.push([{text:(W+1).toString().toUpperCase(),fontSize:9},{text:(B.category||"").toUpperCase(),fontSize:9},{text:(B.application_number||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(B.application_date)||"",fontSize:9},{text:(B.applicant_name||"").toUpperCase(),fontSize:9},{text:(B.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:(B.social_category||"").toUpperCase(),fontSize:9},{text:(B.pwd_status||"").toUpperCase(),fontSize:9},{text:(B.alt_mobile_number||"").toUpperCase(),fontSize:9},{text:(B.application_status||"").toUpperCase(),fontSize:9},{text:(B.payment_status||"").toUpperCase(),fontSize:9}])});let z=new Date,at=`Timestamp: ${z.toLocaleDateString()}, ${z.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,ct={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${w} > ULB: ${u} > WARD: ${I}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DETAILED REPORT ADP",style:"header"},{table:{headerRows:1,body:R,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]},layout:{fillColor:function(B){return B===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:at,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},lt=new Date,O=lt.toLocaleDateString("en-GB").split("/").reverse().join("-"),et=lt.toLocaleTimeString("en-GB").replace(/:/g,"-"),y=`application_status_reports_${O}_${et}.pdf`;Re.default.createPdf(ct).download(y)},v=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",v)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(Ot),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-adp-ward-user-list"]],decls:68,vars:4,consts:[[1,"container-fluid","drilldown-reports"],[1,"d-flex","justify-content-between","w-100","mb-3"],[1,"card-title"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],["class","row mb-2"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-2"],[1,"col-md-3"],["for","a_category",1,"fw-bold"],["formControlName","a_category","id","a_category",1,"form-select","my-2"],["value",""],["value","1"],["value","0"],["for","social_category",1,"fw-bold"],["formControlName","social_category","id","social_category",1,"form-select","my-2"],["value","2"],["value","3"],["value","4"],["for","a_status",1,"fw-bold"],["formControlName","a_status","id","a_status",1,"form-select","my-2"],["value","7"],["for","pwd_status",1,"fw-bold"],["formControlName","pwd_status","id","pwd_status",1,"form-select","my-2"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[1,"row","mb-2"],[1,"col-md-7"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"fa","fa-spinner","fa-spin"],[1,"col-md-5"],["id","recordCount"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports detail"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports","detail"],[1,"text-light",2,"background-color","#fd7b03"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"],[4,"ngIf"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1)(2,"h4",2),a(3,"Detailed Report - ADP"),e(),t(4,"div",3)(5,"a",4),L("click",function(){return c.appService.goBack()}),t(6,"button",5),m(7,"i",6),a(8," Back"),e()()()(),b(9,$m,10,3,"div",7),t(10,"div",8)(11,"form",9),L("ngSubmit",function(){return c.onSearch()}),t(12,"div",10)(13,"div",11)(14,"label",12),a(15," Category "),e(),t(16,"select",13)(17,"option",14),a(18,"Choose Category"),e(),t(19,"option",15),a(20,"NFSA"),e(),t(21,"option",16),a(22,"NON-NFSA"),e()()(),t(23,"div",11)(24,"label",17),a(25," Social Category "),e(),t(26,"select",18)(27,"option",14),a(28,"Choose Social Category"),e(),t(29,"option",15),a(30,"Un-Reserved"),e(),t(31,"option",19),a(32,"OBC"),e(),t(33,"option",20),a(34,"SC"),e(),t(35,"option",21),a(36,"ST"),e()()(),t(37,"div",11)(38,"label",22),a(39," Application Status "),e(),t(40,"select",23)(41,"option",14),a(42,"Choose Status"),e(),t(43,"option",24),a(44,"Under Process"),e(),t(45,"option",15),a(46,"Approved"),e(),t(47,"option",19),a(48,"Rejected"),e()()(),t(49,"div",11)(50,"label",25),a(51," PWD "),e(),t(52,"select",26)(53,"option",14),a(54,"Choose PWD Status"),e(),t(55,"option",15),a(56,"Yes "),e(),t(57,"option",16),a(58,"NO"),e()()()(),t(59,"div",27)(60,"div",28),b(61,Gm,3,0,"button",29)(62,Xm,3,0),e()()()(),t(63,"div",30)(64,"div",31)(65,"div",32),b(66,Ym,2,0)(67,l_,21,7),e()()()()),r&2&&(l(9),E(9,c.filteredWardUserStats&&c.filteredWardUserStats.length>0?9:-1),l(2),T("formGroup",c.searchForm),l(50),E(61,c.isFormSearchInProgress?62:61),l(5),E(66,c.isStatsLoading?66:67))},dependencies:[ft,Pt,Nt,Rt,K,Ut,q,yt,J,Dt,At,it]});let i=s;return i})();var Oe=j(ut()),so=j(ht());function c_(i,s){if(i&1&&(t(0,"div",33)(1,"div",34)(2,"nav",35)(3,"ol",36)(4,"li",37),a(5),e(),t(6,"li",37),a(7),e(),t(8,"li",38),a(9),e()()()()()),i&2){let o=h();l(5),p(o.filteredWardUserStats[0].district_name),l(2),p(o.filteredWardUserStats[0].ulb_name),l(2),p(o.filteredWardUserStats[0].ward_no)}}function d_(i,s){i&1&&(t(0,"button",39),m(1,"i",40),a(2,"Search "),e())}function p_(i,s){i&1&&(t(0,"button",41),m(1,"i",42),a(2," Searching ..."),e())}function m_(i,s){i&1&&(m(0,"i",43),a(1," We are fetching the data, please wait. "))}function __(i,s){if(i&1){let o=U();t(0,"button",57),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",58),a(2,"Download to PDF "),e()}}function f_(i,s){i&1&&(t(0,"button",59),m(1,"i",42),a(2,"Downloading "),e())}function u_(i,s){if(i&1){let o=U();t(0,"button",57),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",58),a(2,"Download to EXCEL "),e()}}function h_(i,s){i&1&&(t(0,"button",59),m(1,"i",42),a(2,"Downloading "),e())}var S_=(i,s)=>s.id;function x_(i,s){if(i&1&&(t(0,"td"),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit;l(1),p(P(2,1,o.ward_no))}}function g_(i,s){i&1&&m(0,"td")}function C_(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),b(3,x_,3,3,"td")(4,g_,1,0),t(5,"td"),a(6),k(7,"uppercase"),e(),t(8,"td"),a(9),k(10,"uppercase"),e(),t(11,"td"),a(12),k(13,"uppercase"),e(),t(14,"td"),a(15),k(16,"uppercase"),e(),t(17,"td"),a(18),k(19,"uppercase"),e(),t(20,"td"),a(21),k(22,"uppercase"),e(),t(23,"td"),a(24),k(25,"uppercase"),e(),t(26,"td"),a(27),e(),t(28,"td"),a(29),k(30,"uppercase"),e(),t(31,"td"),a(32),k(33,"uppercase"),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(1),E(3,o.ward_no?3:4),l(3),p(P(7,12,o.category)),l(3),p(P(10,14,o.application_number)),l(3),p(P(13,16,r.appService.dateFormat(o.application_date))),l(3),p(P(16,18,o.applicant_name)),l(3),p(P(19,20,o.spouse_or_father_name)),l(3),p(P(22,22,o.social_category)),l(3),p(P(25,24,o.pwd_status)),l(3),p(o.alt_mobile_number),l(2),p(P(30,26,o.application_status)),l(3),p(P(33,28,o.payment_status))}}function b_(i,s){if(i&1&&(t(0,"table",60)(1,"thead",61)(2,"tr")(3,"th"),a(4,"SI#"),e(),t(5,"th"),a(6,"WARD NO."),e(),t(7,"th"),a(8,"CATEGORY"),e(),t(9,"th"),a(10,"APPLICATION NO."),e(),t(11,"th"),a(12,"APPLICATION DATE"),e(),t(13,"th"),a(14,"APPLICANT NAME"),e(),t(15,"th"),a(16,"FATHER/HUSBAND NAME"),e(),t(17,"th"),a(18,"SOCIAL CATEGORY"),e(),t(19,"th"),a(20,"PWD"),e(),t(21,"th"),a(22,"MOBILE NO."),e(),t(23,"th"),a(24,"APPLICATION STATUS "),e(),t(25,"th"),a(26,"PAYMENT STATUS"),e()()(),t(27,"tbody"),F(28,C_,34,30,"tr",null,S_),e()()),i&2){let o=h(2);l(28),V(o.filteredWardUserStats)}}function v_(i,s){i&1&&(t(0,"h5",62),a(1,"No data available"),e())}function E_(i,s){i&1&&(t(0,"div",63),a(1,"Loading.. "),m(2,"i",64),e())}function w_(i,s){i&1&&(t(0,"span"),m(1,"i",43),a(2," Loading..."),e())}function T_(i,s){i&1&&(t(0,"span"),a(1,"Load More"),e())}function L_(i,s){if(i&1){let o=U();t(0,"div",65)(1,"button",66),L("click",function(){D(o);let r=h(2);return A(r.loadMore())}),b(2,w_,3,0,"span",67)(3,T_,2,0,"span",67),e()()}if(i&2){let o=h(2);l(2),T("ngIf",o.isLoadMoreInProgress),l(1),T("ngIf",!o.isLoadMoreInProgress)}}function I_(i,s){if(i&1){let o=U();t(0,"div",33)(1,"div",44)(2,"h5",2),a(3," Number of records found : "),t(4,"span",45),a(5),e()()(),t(6,"div",46)(7,"div",47)(8,"input",48),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(9,"i",49),e(),t(10,"div",50),b(11,__,3,0,"button",51)(12,f_,3,0),e(),t(13,"div",52),b(14,u_,3,0,"button",51)(15,h_,3,0),e()()(),t(16,"div",53),b(17,b_,30,0,"table",54)(18,v_,2,0)(19,E_,3,0,"div",55),e(),b(20,L_,4,2,"div",56)}if(i&2){let o=h();l(5),p(o.count),l(3),T("ngModel",o.searchTerm),l(3),E(11,o.isExportInProgress?12:11),l(3),E(14,o.isExportInProgressExcel?15:14),l(3),E(17,o.filteredWardUserStats&&o.filteredWardUserStats.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),l(2),E(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),l(1),T("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var lo=(()=>{let s=class s{constructor(n,r,c,f,d,C,g,_){this.route=n,this.router=r,this.formService=c,this.appService=f,this.httpClient=d,this.toastService=C,this.authService=g,this.masterDataService=_,this.isStatsLoading=!1,this.userStats=[],this.ulb_id="",this.ward_id="",this.village_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.limit=this.appService.loadmorelimit,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.count=0,this.searchForm=new kt({a_category:new nt(""),social_category:new nt(""),pwd_status:new nt(""),submit_date:new nt(""),a_status:new nt("")})}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.ulb_id=n.ulb_id,this.ward_id=n.id,this.fetchuserStats(this.ward_id)})}fetchuserStats(n,r=!1){this.isStatsLoading=!0;let c=new st;c=c.set("ward_id",n),c=c.set("offset",this.offset),c=c.set("limit",this.limit),c=c.set("installment",this.installment);let f=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:c,headers:f}).subscribe(d=>{this.isStatsLoading=!1,this.count=d.count,d.data&&d.data.length>0?(this.application_list=this.application_list.concat(d.data),this.offset+=d.data.length,this.hasMoreRecords=d.data.length===this.limit):this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)},d=>{this.isStatsLoading=!1,this.application_list=[],this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)})}get filteredWardUserStats(){if(!this.searchTerm)return this.application_list;let n=this.searchTerm.toLowerCase();return this.application_list.filter(r=>r.ward_no?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.category?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.application_number?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_date).toLowerCase().includes(this.searchTerm.toLowerCase())||r.applicant_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.spouse_or_father_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.dob).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.social_category).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.pwd_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.alt_mobile_number).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.payment_status).toLowerCase().includes(this.searchTerm.toLowerCase()))}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status,_=new st;r&&(_=_.set("ward_id",r)),c&&(_=_.set("category",c)),f&&(_=_.set("social_category",f)),d&&(_=_.set("pwd_status",d)),g&&(_=_.set("application_status",g)),_=_.set("offset",this.offset),_=_.set("limit",this.limit),_=_.set("installment",this.installment);let v=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:_,headers:v}).subscribe(S=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=S.count,S.data&&S.data.length>0?(this.application_list=this.application_list.concat(S.data),this.offset+=S.data.length,this.hasMoreRecords=S.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},S=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}exportToExcel(){let n=new st,r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;r&&(n=n.set("ward_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),g&&(n=n.set("application_status",g)),n=n.set("export_all","1"),n=n.set("installment",this.installment);let _=new rt({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgressExcel=!1;let S=v.data.map((y,B)=>({"SI#":B+1,DISTRICT:y.district_name?y.district_name.toUpperCase():"",ULB:y.ulb_name?y.ulb_name.toUpperCase():"","WARD NO.":y.ward_no?y.ward_no.toUpperCase():"",CATEGORY:y.category.toUpperCase(),"APPLICATION NO.":y.application_number.toUpperCase(),"APPLICATION DATE":this.appService.dateFormat(y.application_date),"APPLICANT NAME":y.applicant_name.toUpperCase(),"FATHER/HUSBAND NAME":y.spouse_or_father_name.toUpperCase(),"SOCIAL CATEGORY":y.social_category.toUpperCase(),PWD:y.pwd_status.toUpperCase(),"MOBILE NO.":y.alt_mobile_number,"APPLICATION STATUS":y.application_status.toUpperCase(),"PAYMENT STATUS":y.payment_status.toUpperCase()})),w=N.json_to_sheet(S),u=N.book_new();N.book_append_sheet(u,w,"Applications");let I=Z(u,{bookType:"xlsx",type:"array"}),R=new Date,z=R.toLocaleDateString("en-GB").split("/").reverse().join("-"),at=R.toLocaleTimeString("en-GB").replace(/:/g,"-"),ct=`application_status_reports_${z}_${at}.xlsx`,lt=new Blob([I],{type:"application/octet-stream"}),O=document.createElement("a"),et=window.URL.createObjectURL(lt);O.href=et,O.download=ct,O.click(),window.URL.revokeObjectURL(et)},v=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",v)})}exportToPDF(){Oe.default.vfs=so.default.pdfMake.vfs;let n=new st,r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;r&&(n=n.set("ward_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),g&&(n=n.set("application_status",g)),n=n.set("export_all","1"),n=n.set("installment",this.installment);let _=new rt({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgress=!1;let S=v.data[0]||{},w=(S.district_name||"N/A").toUpperCase(),u=(S.block_name||S.ulb_name||"N/A").toUpperCase(),I=(S.gp_name||S.ward_no||"N/A").toUpperCase(),R=[[{text:"SI#",fontSize:10},{text:"CATEGORY",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICATION DATE.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"SOCIAL CATEGORY",fontSize:10},{text:"PWD",fontSize:10},{text:"MOBILE NO",fontSize:10},{text:"APPLICATION STATUS ",fontSize:10},{text:"PAYMENT STATUS",fontSize:10}]];v.data.forEach((B,W)=>{R.push([{text:(W+1).toString().toUpperCase(),fontSize:9},{text:(B.category||"").toUpperCase(),fontSize:9},{text:(B.application_number||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(B.application_date)||"",fontSize:9},{text:(B.applicant_name||"").toUpperCase(),fontSize:9},{text:(B.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:(B.social_category||"").toUpperCase(),fontSize:9},{text:(B.pwd_status||"").toUpperCase(),fontSize:9},{text:(B.alt_mobile_number||"").toUpperCase(),fontSize:9},{text:(B.application_status||"").toUpperCase(),fontSize:9},{text:(B.payment_status||"").toUpperCase(),fontSize:9}])});let z=new Date,at=`Timestamp: ${z.toLocaleDateString()}, ${z.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,ct={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${w} > ULB: ${u} > WARD: ${I}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DETAILED REPORT - TSP",style:"header"},{table:{headerRows:1,body:R,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]},layout:{fillColor:function(B){return B===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:at,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},lt=new Date,O=lt.toLocaleDateString("en-GB").split("/").reverse().join("-"),et=lt.toLocaleTimeString("en-GB").replace(/:/g,"-"),y=`application_status_reports_${O}_${et}.pdf`;Oe.default.createPdf(ct).download(y)},v=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",v)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(Ot),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-tsp-ward-user-list"]],decls:68,vars:4,consts:[[1,"container-fluid","drilldown-reports"],[1,"d-flex","justify-content-between","w-100","mb-3"],[1,"card-title"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],["class","row mb-2"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-2"],[1,"col-md-3"],["for","a_category",1,"fw-bold"],["formControlName","a_category","id","a_category",1,"form-select","my-2"],["value",""],["value","1"],["value","0"],["for","social_category",1,"fw-bold"],["formControlName","social_category","id","social_category",1,"form-select","my-2"],["value","2"],["value","3"],["value","4"],["for","a_status",1,"fw-bold"],["formControlName","a_status","id","a_status",1,"form-select","my-2"],["value","7"],["for","pwd_status",1,"fw-bold"],["formControlName","pwd_status","id","pwd_status",1,"form-select","my-2"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[1,"row","mb-2"],[1,"col-md-7"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"fa","fa-spinner","fa-spin"],[1,"col-md-5"],["id","recordCount"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports detail"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports","detail"],[1,"text-light",2,"background-color","#fd7b03"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"],[4,"ngIf"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1)(2,"h4",2),a(3,"Detailed Report - TSP"),e(),t(4,"div",3)(5,"a",4),L("click",function(){return c.appService.goBack()}),t(6,"button",5),m(7,"i",6),a(8," Back"),e()()()(),b(9,c_,10,3,"div",7),t(10,"div",8)(11,"form",9),L("ngSubmit",function(){return c.onSearch()}),t(12,"div",10)(13,"div",11)(14,"label",12),a(15," Category "),e(),t(16,"select",13)(17,"option",14),a(18,"Choose Category"),e(),t(19,"option",15),a(20,"NFSA"),e(),t(21,"option",16),a(22,"NON-NFSA"),e()()(),t(23,"div",11)(24,"label",17),a(25," Social Category "),e(),t(26,"select",18)(27,"option",14),a(28,"Choose Social Category"),e(),t(29,"option",15),a(30,"Un-Reserved"),e(),t(31,"option",19),a(32,"OBC"),e(),t(33,"option",20),a(34,"SC"),e(),t(35,"option",21),a(36,"ST"),e()()(),t(37,"div",11)(38,"label",22),a(39," Application Status "),e(),t(40,"select",23)(41,"option",14),a(42,"Choose Status"),e(),t(43,"option",24),a(44,"Under Process"),e(),t(45,"option",15),a(46,"Approved"),e(),t(47,"option",19),a(48,"Rejected"),e()()(),t(49,"div",11)(50,"label",25),a(51," PWD "),e(),t(52,"select",26)(53,"option",14),a(54,"Choose PWD Status"),e(),t(55,"option",15),a(56,"Yes "),e(),t(57,"option",16),a(58,"NO"),e()()()(),t(59,"div",27)(60,"div",28),b(61,d_,3,0,"button",29)(62,p_,3,0),e()()()(),t(63,"div",30)(64,"div",31)(65,"div",32),b(66,m_,2,0)(67,I_,21,7),e()()()()),r&2&&(l(9),E(9,c.filteredWardUserStats&&c.filteredWardUserStats.length>0?9:-1),l(2),T("formGroup",c.searchForm),l(50),E(61,c.isFormSearchInProgress?62:61),l(5),E(66,c.isStatsLoading?66:67))},dependencies:[ft,Pt,Nt,Rt,K,Ut,q,yt,J,Dt,At,it]});let i=s;return i})();var Be=j(ut()),co=j(ht());function y_(i,s){if(i&1&&(t(0,"div",33)(1,"div",34)(2,"nav",35)(3,"ol",36)(4,"li",37),a(5),e(),t(6,"li",37),a(7),e(),t(8,"li",37),a(9),e(),t(10,"li",38),a(11),e()()()()()),i&2){let o=h();l(5),p(o.filteredVillageUserStats[0].district_name),l(2),p(o.filteredVillageUserStats[0].block_name),l(2),p(o.filteredVillageUserStats[0].gp_name),l(2),p(o.filteredVillageUserStats[0].village_name)}}function k_(i,s){i&1&&(t(0,"button",39),m(1,"i",40),a(2,"Search "),e())}function P_(i,s){i&1&&(t(0,"button",41),m(1,"i",42),a(2," Searching ..."),e())}function D_(i,s){i&1&&(m(0,"i",43),a(1," We are fetching the data, please wait. "))}function A_(i,s){if(i&1){let o=U();t(0,"button",57),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",58),a(2,"Download to PDF "),e()}}function U_(i,s){i&1&&(t(0,"button",59),m(1,"i",42),a(2,"Downloading "),e())}function N_(i,s){if(i&1){let o=U();t(0,"button",57),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",58),a(2,"Download to EXCEL "),e()}}function R_(i,s){i&1&&(t(0,"button",59),m(1,"i",42),a(2,"Downloading "),e())}var O_=(i,s)=>s.id;function B_(i,s){if(i&1&&(t(0,"td"),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit;l(1),p(P(2,1,o.village_name))}}function W_(i,s){i&1&&m(0,"td")}function M_(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),b(3,B_,3,3,"td")(4,W_,1,0),t(5,"td"),a(6),k(7,"uppercase"),e(),t(8,"td"),a(9),k(10,"uppercase"),e(),t(11,"td"),a(12),k(13,"uppercase"),e(),t(14,"td"),a(15),k(16,"uppercase"),e(),t(17,"td"),a(18),k(19,"uppercase"),e(),t(20,"td"),a(21),k(22,"uppercase"),e(),t(23,"td"),a(24),k(25,"uppercase"),e(),t(26,"td"),a(27),e(),t(28,"td"),a(29),k(30,"uppercase"),e(),t(31,"td"),a(32),k(33,"uppercase"),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(1),E(3,o.village_name?3:4),l(3),p(P(7,12,o.category)),l(3),p(P(10,14,o.application_number)),l(3),p(P(13,16,r.appService.dateFormat(o.application_date))),l(3),p(P(16,18,o.applicant_name)),l(3),p(P(19,20,o.spouse_or_father_name)),l(3),p(P(22,22,o.social_category)),l(3),p(P(25,24,o.pwd_status)),l(3),p(o.alt_mobile_number),l(2),p(P(30,26,o.application_status)),l(3),p(P(33,28,o.payment_status))}}function F_(i,s){if(i&1&&(t(0,"table",60)(1,"thead",61)(2,"tr")(3,"th"),a(4,"SI#"),e(),t(5,"th"),a(6,"VILLAGE"),e(),t(7,"th"),a(8,"CATEGORY"),e(),t(9,"th"),a(10,"APPLICATION NO."),e(),t(11,"th"),a(12,"APPLICATION DATE"),e(),t(13,"th"),a(14,"APPLICANT NAME"),e(),t(15,"th"),a(16,"FATHER/HUSBAND NAME"),e(),t(17,"th"),a(18,"SOCIAL CATEGORY"),e(),t(19,"th"),a(20,"PWD"),e(),t(21,"th"),a(22,"MOBILE NO."),e(),t(23,"th"),a(24,"APPLICATION STATUS"),e(),t(25,"th"),a(26,"PAYMENT STATUS"),e()()(),t(27,"tbody"),F(28,M_,34,30,"tr",null,O_),e()()),i&2){let o=h(2);l(28),V(o.filteredVillageUserStats)}}function V_(i,s){i&1&&(t(0,"h5",62),a(1,"No data available"),e())}function z_(i,s){i&1&&(t(0,"div",63),a(1,"Loading.. "),m(2,"i",64),e())}function j_(i,s){i&1&&(t(0,"span"),m(1,"i",43),a(2," Loading..."),e())}function $_(i,s){i&1&&(t(0,"span"),a(1,"Load More"),e())}function G_(i,s){if(i&1){let o=U();t(0,"div",65)(1,"button",66),L("click",function(){D(o);let r=h(2);return A(r.loadMore())}),b(2,j_,3,0,"span",67)(3,$_,2,0,"span",67),e()()}if(i&2){let o=h(2);l(2),T("ngIf",o.isLoadMoreInProgress),l(1),T("ngIf",!o.isLoadMoreInProgress)}}function X_(i,s){if(i&1){let o=U();t(0,"div",33)(1,"div",44)(2,"h5",2),a(3," Number of records found : "),t(4,"span",45),a(5),e()()(),t(6,"div",46)(7,"div",47)(8,"input",48),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(9,"i",49),e(),t(10,"div",50),b(11,A_,3,0,"button",51)(12,U_,3,0),e(),t(13,"div",52),b(14,N_,3,0,"button",51)(15,R_,3,0),e()()(),t(16,"div",53),b(17,F_,30,0,"table",54)(18,V_,2,0)(19,z_,3,0,"div",55),e(),b(20,G_,4,2,"div",56)}if(i&2){let o=h();l(5),p(o.count),l(3),T("ngModel",o.searchTerm),l(3),E(11,o.isExportInProgress?12:11),l(3),E(14,o.isExportInProgressExcel?15:14),l(3),E(17,o.filteredVillageUserStats&&o.filteredVillageUserStats.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),l(2),E(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),l(1),T("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var po=(()=>{let s=class s{constructor(n,r,c,f,d,C,g,_){this.route=n,this.router=r,this.formService=c,this.appService=f,this.httpClient=d,this.toastService=C,this.authService=g,this.masterDataService=_,this.isStatsLoading=!1,this.userStats=[],this.block_id="",this.gp_id="",this.village_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.limit=this.appService.loadmorelimit,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.count=0,this.searchForm=new kt({a_category:new nt(""),social_category:new nt(""),pwd_status:new nt(""),submit_date:new nt(""),a_status:new nt("")})}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.block_id,this.gp_id=n.gp_id,this.village_id=n.id,this.fetchuserStats(this.village_id)})}fetchuserStats(n,r=!1){this.isStatsLoading=!0;let c=new st;c=c.set("gp_id",this.gp_id),c=c.set("village_id",n),c=c.set("offset",this.offset),c=c.set("limit",this.limit),c=c.set("installment",this.installment);let f=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:c,headers:f}).subscribe(d=>{this.isStatsLoading=!1,this.count=d.count,d.data&&d.data.length>0?(this.application_list=this.application_list.concat(d.data),this.offset+=d.data.length,this.hasMoreRecords=d.data.length===this.limit):this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)},d=>{this.isStatsLoading=!1,this.application_list=[],this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)})}get filteredVillageUserStats(){if(!this.searchTerm)return this.application_list;let n=this.searchTerm.toLowerCase();return this.application_list.filter(r=>r.village_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.category?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.application_number?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_date).toLowerCase().includes(this.searchTerm.toLowerCase())||r.applicant_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.spouse_or_father_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.dob).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.social_category).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.pwd_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.alt_mobile_number).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.payment_status).toLowerCase().includes(this.searchTerm.toLowerCase()))}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status,_=new st;_=_.set("gp_id",this.gp_id),r&&(_=_.set("village_id",r)),c&&(_=_.set("category",c)),f&&(_=_.set("social_category",f)),d&&(_=_.set("pwd_status",d)),g&&(_=_.set("application_status",g)),_=_.set("offset",this.offset),_=_.set("limit",this.limit),_=_.set("installment",this.installment);let v=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:_,headers:v}).subscribe(S=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=S.count,S.data&&S.data.length>0?(this.application_list=this.application_list.concat(S.data),this.offset+=S.data.length,this.hasMoreRecords=S.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},S=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}exportToExcel(){let n=new st,r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;n=n.set("gp_id",this.gp_id),r&&(n=n.set("village_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),g&&(n=n.set("application_status",g)),n=n.set("export_all","1"),n=n.set("installment",this.installment);let _=new rt({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgressExcel=!1;let S=v.data.map((y,B)=>({"SI#":B+1,DISTRICT:y.district_name?y.district_name.toUpperCase():"",BLOCK:y.block_name?y.block_name.toUpperCase():"",GP:y.gp_name?y.gp_name.toUpperCase():"",VILLAGE:y.village_name?y.village_name.toUpperCase():"",CATEGORY:y.category.toUpperCase(),"APPLICATION NO.":y.application_number.toUpperCase(),"APPLICATION DATE":this.appService.dateFormat(y.application_date),"APPLICANT NAME":y.applicant_name.toUpperCase(),"FATHER/HUSBAND NAME":y.spouse_or_father_name.toUpperCase(),"SOCIAL CATEGORY":y.social_category.toUpperCase(),PWD:y.pwd_status.toUpperCase(),"MOBILE NO.":y.alt_mobile_number,"APPLICATION STATUS":y.application_status.toUpperCase(),"PAYMENT STATUS":y.payment_status.toUpperCase()})),w=N.json_to_sheet(S),u=N.book_new();N.book_append_sheet(u,w,"Applications");let I=Z(u,{bookType:"xlsx",type:"array"}),R=new Date,z=R.toLocaleDateString("en-GB").split("/").reverse().join("-"),at=R.toLocaleTimeString("en-GB").replace(/:/g,"-"),ct=`application_status_reports_${z}_${at}.xlsx`,lt=new Blob([I],{type:"application/octet-stream"}),O=document.createElement("a"),et=window.URL.createObjectURL(lt);O.href=et,O.download=ct,O.click(),window.URL.revokeObjectURL(et)},v=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",v)})}exportToPDF(){Be.default.vfs=co.default.pdfMake.vfs;let n=new st,r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;n=n.set("gp_id",this.gp_id),r&&(n=n.set("village_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),g&&(n=n.set("application_status",g)),n=n.set("export_all","1"),n=n.set("installment",this.installment);let _=new rt({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgress=!1;let S=v.data[0]||{},w=(S.district_name||"N/A").toUpperCase(),u=(S.block_name||S.ulb_name||"N/A").toUpperCase(),I=(S.gp_name||S.ward_no||"N/A").toUpperCase(),R=(S.village_name||"").toUpperCase(),z=[[{text:"SI#",fontSize:10},{text:"CATEGORY",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICATION DATE.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"SOCIAL CATEGORY",fontSize:10},{text:"PWD",fontSize:10},{text:"MOBILE NO",fontSize:10},{text:"APPLICATION STATUS",fontSize:10},{text:"PAYMENT STATUS",fontSize:10}]];v.data.forEach((W,It)=>{z.push([{text:(It+1).toString().toUpperCase(),fontSize:9},{text:(W.category||"").toUpperCase(),fontSize:9},{text:(W.application_number||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(W.application_date)||"",fontSize:9},{text:(W.applicant_name||"").toUpperCase(),fontSize:9},{text:(W.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:(W.social_category||"").toUpperCase(),fontSize:9},{text:(W.pwd_status||"").toUpperCase(),fontSize:9},{text:(W.alt_mobile_number||"").toUpperCase(),fontSize:9},{text:(W.application_status||"").toUpperCase(),fontSize:9},{text:(W.payment_status||"").toUpperCase(),fontSize:9}])});let at=new Date,ct=`Timestamp: ${at.toLocaleDateString()}, ${at.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,lt={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${w} > BLOCK: ${u} > GP: ${I} >VILLAGE: ${R}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DETAILED REPORT - TSP",style:"header"},{table:{headerRows:1,body:z,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]},layout:{fillColor:function(W){return W===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:ct,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},O=new Date,et=O.toLocaleDateString("en-GB").split("/").reverse().join("-"),y=O.toLocaleTimeString("en-GB").replace(/:/g,"-"),B=`application_status_reports_${et}_${y}.pdf`;Be.default.createPdf(lt).download(B)},v=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",v)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(Ot),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-tsp-village-user-list"]],decls:68,vars:4,consts:[[1,"container-fluid","drilldown-reports"],[1,"d-flex","justify-content-between","w-100","mb-3"],[1,"card-title"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],["class","row mb-2"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-2"],[1,"col-md-3"],["for","a_category",1,"fw-bold"],["formControlName","a_category","id","a_category",1,"form-select","my-2"],["value",""],["value","1"],["value","0"],["for","social_category",1,"fw-bold"],["formControlName","social_category","id","social_category",1,"form-select","my-2"],["value","2"],["value","3"],["value","4"],["for","a_status",1,"fw-bold"],["formControlName","a_status","id","a_status",1,"form-select","my-2"],["value","7"],["for","pwd_status",1,"fw-bold"],["formControlName","pwd_status","id","pwd_status",1,"form-select","my-2"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[1,"row","mb-2"],[1,"col-md-7"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"fa","fa-spinner","fa-spin"],[1,"col-md-5"],["id","recordCount"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports detail"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports","detail"],[1,"text-light",2,"background-color","#fd7b03"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"],[4,"ngIf"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1)(2,"h4",2),a(3,"Detailed Report - TSP"),e(),t(4,"div",3)(5,"a",4),L("click",function(){return c.appService.goBack()}),t(6,"button",5),m(7,"i",6),a(8," Back"),e()()()(),b(9,y_,12,4,"div",7),t(10,"div",8)(11,"form",9),L("ngSubmit",function(){return c.onSearch()}),t(12,"div",10)(13,"div",11)(14,"label",12),a(15," Category "),e(),t(16,"select",13)(17,"option",14),a(18,"Choose Category"),e(),t(19,"option",15),a(20,"NFSA"),e(),t(21,"option",16),a(22,"NON-NFSA"),e()()(),t(23,"div",11)(24,"label",17),a(25," Social Category "),e(),t(26,"select",18)(27,"option",14),a(28,"Choose Social Category"),e(),t(29,"option",15),a(30,"Un-Reserved"),e(),t(31,"option",19),a(32,"OBC"),e(),t(33,"option",20),a(34,"SC"),e(),t(35,"option",21),a(36,"ST"),e()()(),t(37,"div",11)(38,"label",22),a(39," Application Status "),e(),t(40,"select",23)(41,"option",14),a(42,"Choose Status"),e(),t(43,"option",24),a(44,"Under Process"),e(),t(45,"option",15),a(46,"Approved"),e(),t(47,"option",19),a(48,"Rejected"),e()()(),t(49,"div",11)(50,"label",25),a(51," PWD "),e(),t(52,"select",26)(53,"option",14),a(54,"Choose PWD Status"),e(),t(55,"option",15),a(56,"Yes "),e(),t(57,"option",16),a(58,"NO"),e()()()(),t(59,"div",27)(60,"div",28),b(61,k_,3,0,"button",29)(62,P_,3,0),e()()()(),t(63,"div",30)(64,"div",31)(65,"div",32),b(66,D_,2,0)(67,X_,21,7),e()()()()),r&2&&(l(9),E(9,c.filteredVillageUserStats&&c.filteredVillageUserStats.length>0?9:-1),l(2),T("formGroup",c.searchForm),l(50),E(61,c.isFormSearchInProgress?62:61),l(5),E(66,c.isStatsLoading?66:67))},dependencies:[ft,Pt,Nt,Rt,K,Ut,q,yt,J,Dt,At,it]});let i=s;return i})();var We=j(ut()),mo=j(ht());function Y_(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function H_(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",27),a(2,"Download PDF "),e()}}function K_(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}function q_(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",27),a(2,"Download EXCEL "),e()}}function J_(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}var Q_=(i,s)=>s.id,Z_=i=>({installment:i});function t1(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",35),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e(),t(9,"td"),a(10),e(),t(11,"td"),a(12),e(),t(13,"td"),a(14),e(),t(15,"td"),a(16),e(),t(17,"td"),a(18),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),Gt("routerLink","/department/portal/tsp/village-user-list/",o.district_id,"/",o.block_id,"/",o.gp_id,"/",o.village_id,""),T("queryParams",pt(15,Z_,r.installment)),l(1),dt(" ",P(6,13,o.village_name)," "),l(3),p(o==null?null:o.applications_received),l(2),p(o==null?null:o.approved_application),l(2),p(r.getTotalRejected(o)),l(2),p(o==null?null:o.payment_processed),l(2),p(o==null?null:o.payment_success),l(2),p(o==null?null:o.payment_fail)}}function e1(i,s){if(i&1&&(t(0,"table",30)(1,"thead",31)(2,"tr")(3,"th",32),a(4,"Sl.#"),e(),t(5,"th",32),a(6,"VILLAGE"),e(),t(7,"th",33),a(8,"APPLICATION DETAILS"),e(),t(9,"th",33),a(10,"PAYMENT DETAILS"),e()(),t(11,"tr")(12,"th"),a(13,"RECEIVED"),e(),t(14,"th"),a(15,"APPROVED"),e(),t(16,"th"),a(17,"REJECTED"),e(),t(18,"th"),a(19,"PAYMENT PROCESSED"),e(),t(20,"th"),a(21,"PAYMENT SUCCESS"),e(),t(22,"th"),a(23,"PAYMENT FAILED"),e()()(),t(24,"tbody",34),F(25,t1,19,17,"tr",null,Q_),e()()),i&2){let o=h(2);l(25),V(o.filteredVillageStats)}}function i1(i,s){i&1&&a(0," No Data Found ")}function n1(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - TSP"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e(),t(8,"li",15),a(9),e(),t(10,"li",16),a(11),e()()()(),t(12,"div",17)(13,"div",18)(14,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(15,"i",20),e(),t(16,"div",21),b(17,H_,3,0,"button",22)(18,K_,3,0),e(),t(19,"div",23),b(20,q_,3,0,"button",22)(21,J_,3,0),e()()(),t(22,"div",24),b(23,e1,27,0,"table",25)(24,i1,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredVillageStats[0].district_name),l(2),p(o.filteredVillageStats[0].block_name),l(2),p(o.filteredVillageStats[0].gp_name),l(3),T("ngModel",o.searchTerm),l(3),E(17,o.isExportInProgress?18:17),l(3),E(20,o.isExportInProgressExcel?21:20),l(3),E(23,o.filteredVillageStats&&o.filteredVillageStats.length>0?23:24)}}var _o=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.gp_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.block_id,this.gp_id=n.id,this.fetchvillageStats(this.gp_id)})}fetchvillageStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/village-count?gp_id=${n}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.villageStats=r.data},r=>{this.isStatsLoading=!1,this.villageStats=[]})}getTotalRejected(n){let r=parseInt((n.nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10),c=parseInt((n.non_nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10);return(r+c).toLocaleString()}get filteredVillageStats(){return this.searchTerm?this.villageStats.filter(n=>n.village_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.villageStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.villageStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",BLOCK:u.block_name?u.block_name.toUpperCase():"",GP:u.gp_name?u.gp_name.toUpperCase():"",VILLAGE:u.village_name?u.village_name.toUpperCase():"","APPLICATION RECEIVED":u?.applications_received,"APPLICATION APPROVED":u?.approved_application,"APPLICATION REJECTED":this.getTotalRejected(u),"PAYMENT PROCESSED":u?.payment_processed,"PAYMENT SUCCESS":u?.payment_success,"PAYMENT FAILED":u?.payment_fail})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`village_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){We.default.vfs=mo.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.villageStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=(n.gp_name||n.ward_no||"N/A").toUpperCase(),d=[[{text:"SI#",fontSize:10},{text:"VILLAGE",fontSize:10},{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"APPLICATION REJECTED",fontSize:10},{text:"PAYMENT PROCESSED",fontSize:10},{text:"PAYMENT SUCCESS",fontSize:10},{text:"PAYMENT FAILED",fontSize:10}]];this.villageStats.forEach((I,R)=>{d.push([{text:(R+1).toString().toUpperCase(),fontSize:9},{text:(I.village_name||"").toUpperCase(),fontSize:9},{text:I?.applications_received,fontSize:9},{text:I?.approved_application,fontSize:9},{text:this.getTotalRejected(I),fontSize:9},{text:I?.payment_processed,fontSize:9},{text:I?.payment_success,fontSize:9},{text:I?.payment_fail,fontSize:9}])});let C=new Date,g=`Timestamp: ${C.toLocaleDateString()}, ${C.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,_={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK: ${c} > GP:${f}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - TSP VILLAGE-WISE",style:"header"},{table:{headerRows:1,body:d,widths:["9%","13%","13%","13%","13%","13%","13%","13%"]},layout:{fillColor:function(I){return I===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:g,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},v=new Date,S=v.toLocaleDateString("en-GB").split("/").reverse().join("-"),w=v.toLocaleTimeString("en-GB").replace(/:/g,"-"),u=`village_drilldown_reports_${S}_${w}.pdf`;We.default.createPdf(_).download(u,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-tsp-village-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],["colspan","3",1,"text-center"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,Y_,2,0)(11,n1,25,7),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var Me=j(ut()),fo=j(ht());function o1(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function a1(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",27),a(2,"Download PDF "),e()}}function r1(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}function s1(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",27),a(2,"Download EXCEL "),e()}}function l1(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}var c1=(i,s)=>s.id,d1=i=>({installment:i});function p1(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",35),a(5),e()(),t(6,"td"),a(7),e(),t(8,"td"),a(9),e(),t(10,"td"),a(11),e(),t(12,"td"),a(13),e(),t(14,"td"),a(15),e(),t(16,"td"),a(17),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),Mt("routerLink","/department/portal/tsp/ward-user-list/",o.district_id,"/",o.ulb_id,"/",o.ward_id,""),T("queryParams",pt(12,d1,r.installment)),l(1),p(o.ward_no),l(2),p(o==null?null:o.applications_received),l(2),p(o==null?null:o.approved_application),l(2),p(r.getTotalRejected(o)),l(2),p(o==null?null:o.payment_processed),l(2),p(o==null?null:o.payment_success),l(2),p(o==null?null:o.payment_fail)}}function m1(i,s){if(i&1&&(t(0,"table",30)(1,"thead",31)(2,"tr")(3,"th",32),a(4,"Sl.#"),e(),t(5,"th",32),a(6,"WARD"),e(),t(7,"th",33),a(8,"APPLICATION DETAILS"),e(),t(9,"th",33),a(10,"PAYMENT DETAILS"),e()(),t(11,"tr")(12,"th"),a(13,"RECEIVED"),e(),t(14,"th"),a(15,"APPROVED"),e(),t(16,"th"),a(17,"REJECTED"),e(),t(18,"th"),a(19,"PAYMENT PROCESSED"),e(),t(20,"th"),a(21,"PAYMENT SUCCESS"),e(),t(22,"th"),a(23,"PAYMENT FAILED"),e()()(),t(24,"tbody",34),F(25,p1,18,14,"tr",null,c1),e()()),i&2){let o=h(2);l(25),V(o.filteredWardStats)}}function _1(i,s){i&1&&a(0," No Data Found ")}function f1(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - TSP"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e(),t(8,"li",16),a(9),e()()()(),t(10,"div",17)(11,"div",18)(12,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(13,"i",20),e(),t(14,"div",21),b(15,a1,3,0,"button",22)(16,r1,3,0),e(),t(17,"div",23),b(18,s1,3,0,"button",22)(19,l1,3,0),e()()(),t(20,"div",24),b(21,m1,27,0,"table",25)(22,_1,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredWardStats[0].district_name),l(2),p(o.filteredWardStats[0].ulb_name),l(3),T("ngModel",o.searchTerm),l(3),E(15,o.isExportInProgress?16:15),l(3),E(18,o.isExportInProgressExcel?19:18),l(3),E(21,o.filteredWardStats&&o.filteredWardStats.length>0?21:22)}}var uo=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.district_id="",this.wardStats=[],this.ulb_id="",this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.ulb_id=n.id,this.fetchWardStats(this.ulb_id)})}fetchWardStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/ward-count?ulb_id=${n}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.wardStats=r.data},r=>{this.isStatsLoading=!1,this.wardStats=[]})}getTotalRejected(n){let r=parseInt((n.nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10),c=parseInt((n.non_nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10);return(r+c).toLocaleString()}get filteredWardStats(){return this.searchTerm?this.wardStats.filter(n=>n.ward_no.toLowerCase().includes(this.searchTerm.toLowerCase())):this.wardStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.wardStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",ULB:u.ulb_name?u.ulb_name.toUpperCase():"","WARD NO.":u.ward_no?u.ward_no.toUpperCase():"","APPLICATION RECEIVED":u?.applications_received,"APPLICATION APPROVED":u?.approved_application,"APPLICATION REJECTED":this.getTotalRejected(u),"PAYMENT PROCESSED":u?.payment_processed,"PAYMENT SUCCESS":u?.payment_success,"PAYMENT FAILED":u?.payment_fail})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`ward_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){Me.default.vfs=fo.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.wardStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=[[{text:"SI#",fontSize:10},{text:"WARD NO.",fontSize:10},{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"APPLICATION REJECTED",fontSize:10},{text:"PAYMENT PROCESSED",fontSize:10},{text:"PAYMENT SUCCESS",fontSize:10},{text:"PAYMENT FAILED",fontSize:10}]];this.wardStats.forEach((u,I)=>{f.push([{text:(I+1).toString().toUpperCase(),fontSize:9},{text:(u.ward_no||"").toUpperCase(),fontSize:9},{text:u.applications_received,fontSize:9},{text:u?.applications_received,fontSize:9},{text:u?.approved_application,fontSize:9},{text:this.getTotalRejected(u),fontSize:9},{text:u?.payment_processed,fontSize:9},{text:u?.payment_success,fontSize:9},{text:u?.payment_fail,fontSize:9}])});let d=new Date,C=`Timestamp: ${d.toLocaleDateString()}, ${d.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,g={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK/ULB: ${c}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - TSP WARD-WISE",style:"header"},{table:{headerRows:1,body:f,widths:["9%","13%","13%","13%","13%","13%","13%","13%"]},layout:{fillColor:function(u){return u===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:C,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},_=new Date,v=_.toLocaleDateString("en-GB").split("/").reverse().join("-"),S=_.toLocaleTimeString("en-GB").replace(/:/g,"-"),w=`ward_drilldown_reports_${v}_${S}.pdf`;Me.default.createPdf(g).download(w,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-tsp-ward-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],["colspan","3",1,"text-center"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,o1,2,0)(11,f1,23,6),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J]});let i=s;return i})();var Fe=j(ut()),ho=j(ht());function u1(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function h1(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",27),a(2,"Download PDF "),e()}}function S1(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}function x1(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",27),a(2,"Download EXCEL "),e()}}function g1(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}var C1=(i,s)=>s.id,b1=i=>({installment:i});function v1(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",35),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e(),t(9,"td"),a(10),e(),t(11,"td"),a(12),e(),t(13,"td"),a(14),e(),t(15,"td"),a(16),e(),t(17,"td"),a(18),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),Mt("routerLink","/department/portal/tsp/village-stats/",o.district_id,"/",o.block_id,"/",o.gp_id,""),T("queryParams",pt(14,b1,r.installment)),l(1),dt(" ",P(6,12,o.gp_name)," "),l(3),p(o==null?null:o.applications_received),l(2),p(o==null?null:o.approved_application),l(2),p(r.getTotalRejected(o)),l(2),p(o==null?null:o.payment_processed),l(2),p(o==null?null:o.payment_success),l(2),p(o==null?null:o.payment_fail)}}function E1(i,s){if(i&1&&(t(0,"table",30)(1,"thead",31)(2,"tr")(3,"th",32),a(4,"Sl.#"),e(),t(5,"th",32),a(6,"GRAM PANCHAYAT"),e(),t(7,"th",33),a(8,"APPLICATION DETAILS"),e(),t(9,"th",33),a(10,"PAYMENT DETAILS"),e()(),t(11,"tr")(12,"th"),a(13,"RECEIVED"),e(),t(14,"th"),a(15,"APPROVED"),e(),t(16,"th"),a(17,"REJECTED"),e(),t(18,"th"),a(19,"PAYMENT PROCESSED"),e(),t(20,"th"),a(21,"PAYMENT SUCCESS"),e(),t(22,"th"),a(23,"PAYMENT FAILED"),e()()(),t(24,"tbody",34),F(25,v1,19,16,"tr",null,C1),e()()),i&2){let o=h(2);l(25),V(o.filteredGpStats)}}function w1(i,s){i&1&&a(0," No Data Found ")}function T1(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - TSP"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e(),t(8,"li",16),a(9),e()()()(),t(10,"div",17)(11,"div",18)(12,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(13,"i",20),e(),t(14,"div",21),b(15,h1,3,0,"button",22)(16,S1,3,0),e(),t(17,"div",23),b(18,x1,3,0,"button",22)(19,g1,3,0),e()()(),t(20,"div",24),b(21,E1,27,0,"table",25)(22,w1,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredGpStats[0].district_name),l(2),p(o.filteredGpStats[0].block_name),l(3),T("ngModel",o.searchTerm),l(3),E(15,o.isExportInProgress?16:15),l(3),E(18,o.isExportInProgressExcel?19:18),l(3),E(21,o.filteredGpStats&&o.filteredGpStats.length>0?21:22)}}var So=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.district_id="",this.gpStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.id,this.fetchgpStats(this.block_id)})}fetchgpStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/gp-count?block_id=${n}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.gpStats=r.data},r=>{this.isStatsLoading=!1,this.gpStats=[]})}getTotalRejected(n){let r=parseInt((n.nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10),c=parseInt((n.non_nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10);return(r+c).toLocaleString()}get filteredGpStats(){return this.searchTerm?this.gpStats.filter(n=>n.gp_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.gpStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.gpStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",BLOCK:u.block_name?u.block_name.toUpperCase():"",GP:u.gp_name?u.gp_name.toUpperCase():"","APPLICATION RECEIVED":u?.applications_received,"APPLICATION APPROVED":u?.approved_application,"APPLICATION REJECTED":this.getTotalRejected(u),"PAYMENT PROCESSED":u?.payment_processed,"PAYMENT SUCCESS":u?.payment_success,"PAYMENT FAILED":u?.payment_fail})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`gp_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){Fe.default.vfs=ho.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.gpStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=[[{text:"SI#",fontSize:10},{text:"GP",fontSize:10},{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"APPLICATION REJECTED",fontSize:10},{text:"PAYMENT PROCESSED",fontSize:10},{text:"PAYMENT SUCCESS",fontSize:10},{text:"PAYMENT FAILED",fontSize:10}]];this.gpStats.forEach((u,I)=>{f.push([{text:(I+1).toString().toUpperCase(),fontSize:9},{text:(u.gp_name||"").toUpperCase(),fontSize:9},{text:u?.applications_received,fontSize:9},{text:u?.approved_application,fontSize:9},{text:this.getTotalRejected(u),fontSize:9},{text:u?.payment_processed,fontSize:9},{text:u?.payment_success,fontSize:9},{text:u?.payment_fail,fontSize:9}])});let d=new Date,C=`Timestamp: ${d.toLocaleDateString()}, ${d.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,g={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK: ${c}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - TSP GP-WISE",style:"header"},{table:{headerRows:1,body:f,widths:["9%","13%","13%","13%","13%","13%","13%","13%"]},layout:{fillColor:function(u){return u===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:C,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},_=new Date,v=_.toLocaleDateString("en-GB").split("/").reverse().join("-"),S=_.toLocaleTimeString("en-GB").replace(/:/g,"-"),w=`gp_drilldown_reports_${v}_${S}.pdf`;Fe.default.createPdf(g).download(w,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-tsp-gp-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],["colspan","3",1,"text-center"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,u1,2,0)(11,T1,23,6),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var Ve=j(ut()),xo=j(ht());function L1(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function I1(i,s){if(i&1){let o=U();t(0,"button",25),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",26),a(2,"Download PDF "),e()}}function y1(i,s){i&1&&(t(0,"button",27),m(1,"i",28),a(2,"Downloading "),e())}function k1(i,s){if(i&1){let o=U();t(0,"button",25),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",26),a(2,"Download EXCEL "),e()}}function P1(i,s){i&1&&(t(0,"button",27),m(1,"i",28),a(2,"Downloading "),e())}var D1=(i,s)=>s.id,go=i=>({installment:i});function A1(i,s){if(i&1&&(t(0,"a",35),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit,n=h(3);Vt("routerLink","/department/portal/tsp/gp-stats/",o.district_id,"/",o.block_id,""),T("queryParams",pt(6,go,n.installment)),l(1),dt(" ",P(2,4,o.block_name)," ")}}function U1(i,s){if(i&1&&(t(0,"a",35),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit,n=h(3);Vt("routerLink","/department/portal/tsp/ward-stats/",o.district_id,"/",o.ulb_id,""),T("queryParams",pt(6,go,n.installment)),l(1),dt(" ",P(2,4,o.ulb_name)," ")}}function N1(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td"),b(4,A1,3,8,"a",34)(5,U1,3,8),e(),t(6,"td"),a(7),e(),t(8,"td"),a(9),e(),t(10,"td"),a(11),e(),t(12,"td"),a(13),e(),t(14,"td"),a(15),e(),t(16,"td"),a(17),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),E(4,o.block_id?4:5),l(3),p(o==null?null:o.applications_received),l(2),p(o==null?null:o.approved_application),l(2),p(r.getTotalRejected(o)),l(2),p(o==null?null:o.payment_processed),l(2),p(o==null?null:o.payment_success),l(2),p(o==null?null:o.payment_fail)}}function R1(i,s){if(i&1&&(t(0,"table",29)(1,"thead",30)(2,"tr")(3,"th",31),a(4,"Sl.#"),e(),t(5,"th",31),a(6,"BLOCK/ULB"),e(),t(7,"th",32),a(8,"APPLICATION DETAILS"),e(),t(9,"th",32),a(10,"PAYMENT DETAILS"),e()(),t(11,"tr")(12,"th"),a(13,"RECEIVED"),e(),t(14,"th"),a(15,"APPROVED"),e(),t(16,"th"),a(17,"REJECTED"),e(),t(18,"th"),a(19,"PAYMENT PROCESSED"),e(),t(20,"th"),a(21,"PAYMENT SUCCESS"),e(),t(22,"th"),a(23,"PAYMENT FAILED"),e()()(),t(24,"tbody",33),F(25,N1,18,8,"tr",null,D1),e()()),i&2){let o=h(2);l(25),V(o.filteredBlockStats)}}function O1(i,s){i&1&&a(0," No Data Found ")}function B1(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - TSP"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e()()()(),t(8,"div",16)(9,"div",17)(10,"input",18),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(11,"i",19),e(),t(12,"div",20),b(13,I1,3,0,"button",21)(14,y1,3,0),e(),t(15,"div",22),b(16,k1,3,0,"button",21)(17,P1,3,0),e()()(),t(18,"div",23),b(19,R1,27,0,"table",24)(20,O1,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredBlockStats[0].district_name),l(3),T("ngModel",o.searchTerm),l(3),E(13,o.isExportInProgress?14:13),l(3),E(16,o.isExportInProgressExcel?17:16),l(3),E(19,o.filteredBlockStats&&o.filteredBlockStats.length>0?19:20)}}var Co=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.districtStats=[],this.district_id="",this.blockStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{let r=n.id;this.district_id=r,this.fetchblockStats(r)})}fetchblockStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/block-count?district_id=${n}&specialgroup_tsp=1&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.blockStats=r.data},r=>{this.isStatsLoading=!1,this.blockStats=[]})}fetchulbStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/ulb-count?district_id=${n}&specialgroup_tsp=1&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.blockStats=[...this.blockStats,...r.data]},r=>{this.isStatsLoading=!1})}getTotalRejected(n){let r=parseInt((n.nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10),c=parseInt((n.non_nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10);return(r+c).toLocaleString()}get filteredBlockStats(){return this.searchTerm?this.blockStats.filter(n=>n.block_name&&n.block_name.toLowerCase().includes(this.searchTerm.toLowerCase())||n.ulb_name&&n.ulb_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.blockStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.blockStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name,"BLOCK/ULB":u.block_name?.toUpperCase()||u.ulb_name?.toUpperCase(),"APPLICATION RECEIVED":u?.applications_received,"APPLICATION APPROVED":u?.approved_application,"APPLICATION REJECTED":this.getTotalRejected(u),"PAYMENT PROCESSED":u?.payment_processed,"PAYMENT SUCCESS":u?.payment_success,"PAYMENT FAILED":u?.payment_fail})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`block_ulb_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){Ve.default.vfs=xo.default.pdfMake.vfs,this.isExportInProgress=!0;let r=((this.blockStats[0]||{}).district_name||"N/A").toUpperCase(),c=[[{text:"SI#",fontSize:10},{text:"BLOCK/ULB",fontSize:10},{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"APPLICATION REJECTED",fontSize:10},{text:"PAYMENT PROCESSED",fontSize:10},{text:"PAYMENT SUCCESS",fontSize:10},{text:"PAYMENT FAILED",fontSize:10}]];this.blockStats.forEach((w,u)=>{c.push([{text:(u+1).toString().toUpperCase(),fontSize:9},{text:(w.block_name||w.ulb_name||"").toUpperCase(),fontSize:9},{text:w?.applications_received,fontSize:9},{text:w?.approved_application,fontSize:9},{text:this.getTotalRejected(w),fontSize:9},{text:w?.payment_processed,fontSize:9},{text:w?.payment_success,fontSize:9},{text:w?.payment_fail,fontSize:9}])});let f=new Date,d=`Timestamp: ${f.toLocaleDateString()}, ${f.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,C={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - TSP BLOCK/ULB-WISE",style:"header"},{table:{headerRows:1,body:c,widths:["9%","13%","13%","13%","13%","13%","13%","13%"]},layout:{fillColor:function(w){return w===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:d,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},g=new Date,_=g.toLocaleDateString("en-GB").split("/").reverse().join("-"),v=g.toLocaleTimeString("en-GB").replace(/:/g,"-"),S=`block_ulb_drilldown_reports_${_}_${v}.pdf`;Ve.default.createPdf(C).download(S,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-tsp-block-ulb-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],["colspan","3",1,"text-center"],[2,"font-size","14px"],["style","text-decoration: none",3,"routerLink","queryParams"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,L1,2,0)(11,B1,21,5),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var ze=j(ut()),bo=j(ht());function W1(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function M1(i,s){if(i&1){let o=U();t(0,"button",22),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",23),a(2,"Download PDF "),e()}}function F1(i,s){i&1&&(t(0,"button",24),m(1,"i",25),a(2,"Downloading "),e())}function V1(i,s){if(i&1){let o=U();t(0,"button",22),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",23),a(2,"Download EXCEL "),e()}}function z1(i,s){i&1&&(t(0,"button",24),m(1,"i",25),a(2,"Downloading "),e())}var j1=(i,s)=>s.id,$1=i=>({installment:i});function G1(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",31),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e(),t(9,"td"),a(10),e(),t(11,"td"),a(12),e(),t(13,"td"),a(14),e(),t(15,"td"),a(16),e(),t(17,"td"),a(18),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),$t("routerLink","/department/portal/tsp/block-ulb-stats/",o.district_id,""),T("queryParams",pt(12,$1,r.installment)),l(1),dt(" ",P(6,10,o.district_name)," "),l(3),p(o==null?null:o.count_tsp),l(2),p(o==null?null:o.approved_applications_tsp),l(2),p(o==null?null:o.count_rejected_applications_tsp),l(2),p(o==null?null:o.payment_processed_tsp),l(2),p(o==null?null:o.payment_success_tsp),l(2),p(o==null?null:o.payment_fail_tsp)}}function X1(i,s){if(i&1&&(t(0,"table",26)(1,"thead",27)(2,"tr")(3,"th",28),a(4,"Sl.#"),e(),t(5,"th",28),a(6,"DISTRICT"),e(),t(7,"th",29),a(8,"APPLICATION DETAILS"),e(),t(9,"th",29),a(10,"PAYMENT DETAILS"),e()(),t(11,"tr")(12,"th"),a(13,"RECEIVED"),e(),t(14,"th"),a(15,"APPROVED"),e(),t(16,"th"),a(17,"REJECTED"),e(),t(18,"th"),a(19,"PAYMENT PROCESSED"),e(),t(20,"th"),a(21,"PAYMENT SUCCESS"),e(),t(22,"th"),a(23,"PAYMENT FAILED"),e()()(),t(24,"tbody",30),F(25,G1,19,14,"tr",null,j1),e()()),i&2){let o=h(2);l(25),V(o.filteredDistrictStats)}}function Y1(i,s){i&1&&a(0," No Data Found ")}function H1(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - TSP"),e()(),t(4,"div",13)(5,"div",14)(6,"input",15),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(7,"i",16),e(),t(8,"div",17),b(9,M1,3,0,"button",18)(10,F1,3,0),e(),t(11,"div",19),b(12,V1,3,0,"button",18)(13,z1,3,0),e()()(),t(14,"div",20),b(15,X1,27,0,"table",21)(16,Y1,1,0),e()}if(i&2){let o=h();l(6),T("ngModel",o.searchTerm),l(3),E(9,o.isExportInProgress?10:9),l(3),E(12,o.isExportInProgressExcel?13:12),l(3),E(15,o.filteredDistrictStats&&o.filteredDistrictStats.length>0?15:16)}}var vo=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.router=n,this.route=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.districtStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment,this.card_name=n.card_name,this.fetchDistrictStats()})}fetchDistrictStats(){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?specialgroup_tsp=1&installment=${this.installment}&card_name=${this.card_name}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isStatsLoading=!1,this.districtStats=n.data},n=>{this.isStatsLoading=!1,this.districtStats=[]})}getTotalRejected(n){let r=parseInt((n.nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10),c=parseInt((n.non_nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10);return(r+c).toLocaleString()}get filteredDistrictStats(){return this.searchTerm?this.districtStats.filter(n=>n.district_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.districtStats}exportToExcel(){this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?specialgroup_tsp=1&installment=${this.installment}&card_name=${this.card_name}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isExportInProgressExcel=!1;let r=n.data.map((I,R)=>({"SI#":R+1,DISTRICT:I.district_name.toUpperCase(),"APPLICATION RECEIVED":I?.count_tsp,"APPLICATION APPROVED":I?.approved_applications_tsp,"APPLICATION REJECTED":I?.count_rejected_applications_tsp,"PAYMENT PROCESSED":I?.payment_processed_tsp,"PAYMENT SUCCESS":I?.payment_success_tsp,"PAYMENT FAILED":I?.payment_fail_tsp})),c=N.json_to_sheet(r),f=N.book_new();N.book_append_sheet(f,c,"Applications");let d=Z(f,{bookType:"xlsx",type:"array"}),C=new Date,g=C.toLocaleDateString("en-GB").split("/").reverse().join("-"),_=C.toLocaleTimeString("en-GB").replace(/:/g,"-"),v=`district_drilldown_reports_${g}_${_}.xlsx`,S=new Blob([d],{type:"application/octet-stream"}),w=document.createElement("a"),u=window.URL.createObjectURL(S);w.href=u,w.download=v,w.click(),window.URL.revokeObjectURL(u)},n=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",n)})}exportToPDF(){ze.default.vfs=bo.default.pdfMake.vfs,this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?specialgroup_tsp=1&installment=${this.installment}&card_name=${this.card_name}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isExportInProgress=!1;let r=[[{text:"SI#",fontSize:10},{text:"DISTRICT",fontSize:10},{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"APPLICATION REJECTED",fontSize:10},{text:"PAYMENT PROCESSED",fontSize:10},{text:"PAYMENT SUCCESS",fontSize:10},{text:"PAYMENT FAILED",fontSize:10}]];n.data.forEach((S,w)=>{r.push([{text:(w+1).toString().toUpperCase(),fontSize:9},{text:(S.district_name||"").toUpperCase(),fontSize:9},{text:S?.count_tsp,fontSize:9},{text:S?.approved_applications_tsp,fontSize:9},{text:S?.count_rejected_applications_tsp,fontSize:9},{text:S?.payment_processed_tsp,fontSize:9},{text:S?.payment_success_tsp,fontSize:9},{text:S?.payment_fail_tsp,fontSize:9}])});let c=new Date,f=`Timestamp: ${c.toLocaleDateString()}, ${c.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,d={pageOrientation:"landscape",pageSize:"A4",content:[{text:"DRILL-DOWN REPORT - TSP DISTRICT-WISE",style:"header"},{table:{headerRows:1,body:r,widths:["9%","13%","13%","13%","13%","13%","13%","13%"]},layout:{fillColor:function(S){return S===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:f,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},C=new Date,g=C.toLocaleDateString("en-GB").split("/").reverse().join("-"),_=C.toLocaleTimeString("en-GB").replace(/:/g,"-"),v=`district_drilldown_reports_${g}_${_}.pdf`;ze.default.createPdf(d).download(v)},n=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",n)})}};s.\u0275fac=function(r){return new(r||s)(x(G),x(tt),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-tsp-district-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],["colspan","3",1,"text-center"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,W1,2,0)(11,H1,17,4),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var je=j(ut()),Eo=j(ht());function K1(i,s){if(i&1&&(t(0,"div",31)(1,"div",32)(2,"nav",33)(3,"ol",34)(4,"li",35),a(5),e(),t(6,"li",35),a(7),e(),t(8,"li",36),a(9),e()()()()()),i&2){let o=h();l(5),p(o.filteredWardUserStats[0].district_name),l(2),p(o.filteredWardUserStats[0].ulb_name),l(2),p(o.filteredWardUserStats[0].ward_no)}}function q1(i,s){i&1&&(t(0,"button",37),m(1,"i",38),a(2,"Search "),e())}function J1(i,s){i&1&&(t(0,"button",39),m(1,"i",40),a(2," Searching ..."),e())}function Q1(i,s){i&1&&(m(0,"i",41),a(1," We are fetching the data, please wait. "))}function Z1(i,s){if(i&1){let o=U();t(0,"button",55),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",56),a(2,"Download to PDF "),e()}}function tf(i,s){i&1&&(t(0,"button",57),m(1,"i",40),a(2,"Downloading "),e())}function ef(i,s){if(i&1){let o=U();t(0,"button",55),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",56),a(2,"Download to EXCEL "),e()}}function nf(i,s){i&1&&(t(0,"button",57),m(1,"i",40),a(2,"Downloading "),e())}var of=(i,s)=>s.id;function af(i,s){if(i&1&&(t(0,"td"),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit;l(1),p(P(2,1,o.ward_no))}}function rf(i,s){i&1&&m(0,"td")}function sf(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),b(3,af,3,3,"td")(4,rf,1,0),t(5,"td"),a(6),k(7,"uppercase"),e(),t(8,"td"),a(9),k(10,"uppercase"),e(),t(11,"td"),a(12),k(13,"uppercase"),e(),t(14,"td"),a(15),k(16,"uppercase"),e(),t(17,"td"),a(18),k(19,"uppercase"),e(),t(20,"td"),a(21),k(22,"uppercase"),e(),t(23,"td"),a(24),k(25,"uppercase"),e(),t(26,"td"),a(27),e(),t(28,"td"),a(29),k(30,"uppercase"),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(1),E(3,o.ward_no?3:4),l(3),p(P(7,11,o.category)),l(3),p(P(10,13,o.application_number)),l(3),p(P(13,15,r.appService.dateFormat(o.application_date))),l(3),p(P(16,17,o.applicant_name)),l(3),p(P(19,19,o.spouse_or_father_name)),l(3),p(P(22,21,o.social_category)),l(3),p(P(25,23,o.pwd_status)),l(3),p(o.alt_mobile_number),l(2),p(P(30,25,o.application_status))}}function lf(i,s){if(i&1&&(t(0,"table",58)(1,"thead",59)(2,"tr")(3,"th"),a(4,"SI#"),e(),t(5,"th"),a(6,"WARD NO."),e(),t(7,"th"),a(8,"CATEGORY"),e(),t(9,"th"),a(10,"APPLICATION NO."),e(),t(11,"th"),a(12,"APPLICATION DATE"),e(),t(13,"th"),a(14,"APPLICANT NAME"),e(),t(15,"th"),a(16,"FATHER/HUSBAND NAME"),e(),t(17,"th"),a(18,"SOCIAL CATEGORY"),e(),t(19,"th"),a(20,"PWD"),e(),t(21,"th"),a(22,"MOBILE NO."),e(),t(23,"th"),a(24,"APPLICATION STATUS"),e()()(),t(25,"tbody"),F(26,sf,31,27,"tr",null,of),e()()),i&2){let o=h(2);l(26),V(o.filteredWardUserStats)}}function cf(i,s){i&1&&(t(0,"h5",60),a(1,"No data available"),e())}function df(i,s){i&1&&(t(0,"div",61),a(1,"Loading.. "),m(2,"i",62),e())}function pf(i,s){i&1&&(t(0,"span"),m(1,"i",41),a(2," Loading..."),e())}function mf(i,s){i&1&&(t(0,"span"),a(1,"Load More"),e())}function _f(i,s){if(i&1){let o=U();t(0,"div",63)(1,"button",64),L("click",function(){D(o);let r=h(2);return A(r.loadMore())}),b(2,pf,3,0,"span",65)(3,mf,2,0,"span",65),e()()}if(i&2){let o=h(2);l(2),T("ngIf",o.isLoadMoreInProgress),l(1),T("ngIf",!o.isLoadMoreInProgress)}}function ff(i,s){if(i&1){let o=U();t(0,"div",31)(1,"div",42)(2,"h5",2),a(3," Number of records found : "),t(4,"span",43),a(5),e()()(),t(6,"div",44)(7,"div",45)(8,"input",46),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(9,"i",47),e(),t(10,"div",48),b(11,Z1,3,0,"button",49)(12,tf,3,0),e(),t(13,"div",50),b(14,ef,3,0,"button",49)(15,nf,3,0),e()()(),t(16,"div",51),b(17,lf,28,0,"table",52)(18,cf,2,0)(19,df,3,0,"div",53),e(),b(20,_f,4,2,"div",54)}if(i&2){let o=h();l(5),p(o.count),l(3),T("ngModel",o.searchTerm),l(3),E(11,o.isExportInProgress?12:11),l(3),E(14,o.isExportInProgressExcel?15:14),l(3),E(17,o.filteredWardUserStats&&o.filteredWardUserStats.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),l(2),E(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),l(1),T("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var wo=(()=>{let s=class s{constructor(n,r,c,f,d,C,g,_){this.route=n,this.router=r,this.formService=c,this.appService=f,this.httpClient=d,this.toastService=C,this.authService=g,this.masterDataService=_,this.isStatsLoading=!1,this.userStats=[],this.ulb_id="",this.ward_id="",this.village_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.limit=this.appService.loadmorelimit,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.count=0,this.searchForm=new kt({a_category:new nt(""),social_category:new nt(""),pwd_status:new nt(""),submit_date:new nt(""),a_status:new nt("")})}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.ulb_id=n.ulb_id,this.ward_id=n.id,this.fetchuserStats(this.ward_id)})}fetchuserStats(n,r=!1){this.isStatsLoading=!0;let c=new st;c=c.set("ward_id",n),c=c.set("offset",this.offset),c=c.set("limit",this.limit),c=c.set("pwd_status",1),c=c.set("installment",this.installment);let f=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:c,headers:f}).subscribe(d=>{this.isStatsLoading=!1,this.count=d.count,d.data&&d.data.length>0?(this.application_list=this.application_list.concat(d.data),this.offset+=d.data.length,this.hasMoreRecords=d.data.length===this.limit):this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)},d=>{this.isStatsLoading=!1,this.application_list=[],this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)})}get filteredWardUserStats(){if(!this.searchTerm)return this.application_list;let n=this.searchTerm.toLowerCase();return this.application_list.filter(r=>r.ward_no?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.category?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.application_number?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_date).toLowerCase().includes(this.searchTerm.toLowerCase())||r.applicant_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.spouse_or_father_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.dob).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.social_category).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.pwd_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.alt_mobile_number).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.payment_status).toLowerCase().includes(this.searchTerm.toLowerCase()))}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status,_=new st;r&&(_=_.set("ward_id",r)),c&&(_=_.set("category",c)),f&&(_=_.set("social_category",f)),d&&(_=_.set("pwd_status",d)),g&&(_=_.set("application_status",g)),_=_.set("offset",this.offset),_=_.set("limit",this.limit),_=_.set("pwd_status",1),_=_.set("installment",this.installment);let v=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:_,headers:v}).subscribe(S=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=S.count,S.data&&S.data.length>0?(this.application_list=this.application_list.concat(S.data),this.offset+=S.data.length,this.hasMoreRecords=S.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},S=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}exportToExcel(){let n=new st,r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;r&&(n=n.set("ward_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),g&&(n=n.set("application_status",g)),n=n.set("export_all","1"),n=n.set("pwd_status","1"),n=n.set("installment",this.installment);let _=new rt({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgressExcel=!1;let S=v.data.map((y,B)=>({"SI#":B+1,DISTRICT:y.district_name?y.district_name.toUpperCase():"",ULB:y.ulb_name?y.ulb_name.toUpperCase():"","WARD NO.":y.ward_no?y.ward_no.toUpperCase():"",CATEGORY:y.category.toUpperCase(),"APPLICATION NO.":y.application_number.toUpperCase(),"APPLICATION DATE":this.appService.dateFormat(y.application_date),"APPLICANT NAME":y.applicant_name.toUpperCase(),"FATHER/HUSBAND NAME":y.spouse_or_father_name.toUpperCase(),"SOCIAL CATEGORY":y.social_category.toUpperCase(),PWD:y.pwd_status.toUpperCase(),"MOBILE NO.":y.alt_mobile_number,"APPLICATION STATUS":y.application_status.toUpperCase()})),w=N.json_to_sheet(S),u=N.book_new();N.book_append_sheet(u,w,"Applications");let I=Z(u,{bookType:"xlsx",type:"array"}),R=new Date,z=R.toLocaleDateString("en-GB").split("/").reverse().join("-"),at=R.toLocaleTimeString("en-GB").replace(/:/g,"-"),ct=`application_status_reports_${z}_${at}.xlsx`,lt=new Blob([I],{type:"application/octet-stream"}),O=document.createElement("a"),et=window.URL.createObjectURL(lt);O.href=et,O.download=ct,O.click(),window.URL.revokeObjectURL(et)},v=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",v)})}exportToPDF(){je.default.vfs=Eo.default.pdfMake.vfs;let n=new st,r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;r&&(n=n.set("ward_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),g&&(n=n.set("application_status",g)),n=n.set("export_all","1"),n=n.set("installment",this.installment);let _=new rt({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgress=!1;let S=v.data[0]||{},w=(S.district_name||"N/A").toUpperCase(),u=(S.block_name||S.ulb_name||"N/A").toUpperCase(),I=(S.gp_name||S.ward_no||"N/A").toUpperCase(),R=[[{text:"SI#",fontSize:10},{text:"CATEGORY",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICATION DATE.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"SOCIAL CATEGORY",fontSize:10},{text:"PWD",fontSize:10},{text:"MOBILE NO",fontSize:10},{text:"APPLICATION STATUS",fontSize:10}]];v.data.forEach((B,W)=>{R.push([{text:(W+1).toString().toUpperCase(),fontSize:9},{text:(B.category||"").toUpperCase(),fontSize:9},{text:(B.application_number||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(B.application_date)||"",fontSize:9},{text:(B.applicant_name||"").toUpperCase(),fontSize:9},{text:(B.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:(B.social_category||"").toUpperCase(),fontSize:9},{text:(B.pwd_status||"").toUpperCase(),fontSize:9},{text:(B.alt_mobile_number||"").toUpperCase(),fontSize:9},{text:(B.application_status||"").toUpperCase(),fontSize:9}])});let z=new Date,at=`Timestamp: ${z.toLocaleDateString()}, ${z.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,ct={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${w} > ULB: ${u} > WARD: ${I}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DETAILED REPORT DIFFERENTLY ABLED",style:"header"},{table:{headerRows:1,body:R,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]},layout:{fillColor:function(B){return B===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:at,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},lt=new Date,O=lt.toLocaleDateString("en-GB").split("/").reverse().join("-"),et=lt.toLocaleTimeString("en-GB").replace(/:/g,"-"),y=`application_status_reports_${O}_${et}.pdf`;je.default.createPdf(ct).download(y)},v=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",v)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(Ot),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-pwd-ward-user-list"]],decls:58,vars:4,consts:[[1,"container-fluid","drilldown-reports"],[1,"d-flex","justify-content-between","w-100","mb-3"],[1,"card-title"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],["class","row mb-2"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-2"],[1,"col-md-4"],["for","a_category",1,"fw-bold"],["formControlName","a_category","id","a_category",1,"form-select","my-2"],["value",""],["value","1"],["value","0"],["for","social_category",1,"fw-bold"],["formControlName","social_category","id","social_category",1,"form-select","my-2"],["value","2"],["value","3"],["value","4"],["for","a_status",1,"fw-bold"],["formControlName","a_status","id","a_status",1,"form-select","my-2"],["value","7"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[1,"row","mb-2"],[1,"col-md-7"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"fa","fa-spinner","fa-spin"],[1,"col-md-5"],["id","recordCount"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports detail"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports","detail"],[1,"text-light",2,"background-color","#fd7b03"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"],[4,"ngIf"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1)(2,"h4",2),a(3,"Detailed Report - Differently Abled"),e(),t(4,"div",3)(5,"a",4),L("click",function(){return c.appService.goBack()}),t(6,"button",5),m(7,"i",6),a(8," Back"),e()()()(),b(9,K1,10,3,"div",7),t(10,"div",8)(11,"form",9),L("ngSubmit",function(){return c.onSearch()}),t(12,"div",10)(13,"div",11)(14,"label",12),a(15," Category "),e(),t(16,"select",13)(17,"option",14),a(18,"Choose Category"),e(),t(19,"option",15),a(20,"NFSA"),e(),t(21,"option",16),a(22,"NON-NFSA"),e()()(),t(23,"div",11)(24,"label",17),a(25," Social Category "),e(),t(26,"select",18)(27,"option",14),a(28,"Choose Social Category"),e(),t(29,"option",15),a(30,"Un-Reserved"),e(),t(31,"option",19),a(32,"OBC"),e(),t(33,"option",20),a(34,"SC"),e(),t(35,"option",21),a(36,"ST"),e()()(),t(37,"div",11)(38,"label",22),a(39," Application Status "),e(),t(40,"select",23)(41,"option",14),a(42,"Choose Status"),e(),t(43,"option",24),a(44,"Under Process"),e(),t(45,"option",15),a(46,"Approved"),e(),t(47,"option",19),a(48,"Rejected"),e()()()(),t(49,"div",25)(50,"div",26),b(51,q1,3,0,"button",27)(52,J1,3,0),e()()()(),t(53,"div",28)(54,"div",29)(55,"div",30),b(56,Q1,2,0)(57,ff,21,7),e()()()()),r&2&&(l(9),E(9,c.filteredWardUserStats&&c.filteredWardUserStats.length>0?9:-1),l(2),T("formGroup",c.searchForm),l(40),E(51,c.isFormSearchInProgress?52:51),l(5),E(56,c.isStatsLoading?56:57))},dependencies:[ft,Pt,Nt,Rt,K,Ut,q,yt,J,Dt,At,it]});let i=s;return i})();var $e=j(ut()),To=j(ht());function uf(i,s){if(i&1&&(t(0,"div",31)(1,"div",32)(2,"nav",33)(3,"ol",34)(4,"li",35),a(5),e(),t(6,"li",35),a(7),e(),t(8,"li",35),a(9),e(),t(10,"li",36),a(11),e()()()()()),i&2){let o=h();l(5),p(o.filteredVillageUserStats[0].district_name),l(2),p(o.filteredVillageUserStats[0].block_name),l(2),p(o.filteredVillageUserStats[0].gp_name),l(2),p(o.filteredVillageUserStats[0].village_name)}}function hf(i,s){i&1&&(t(0,"button",37),m(1,"i",38),a(2,"Search "),e())}function Sf(i,s){i&1&&(t(0,"button",39),m(1,"i",40),a(2," Searching ..."),e())}function xf(i,s){i&1&&(m(0,"i",41),a(1," We are fetching the data, please wait. "))}function gf(i,s){if(i&1){let o=U();t(0,"button",55),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",56),a(2,"Download to PDF "),e()}}function Cf(i,s){i&1&&(t(0,"button",57),m(1,"i",40),a(2,"Downloading "),e())}function bf(i,s){if(i&1){let o=U();t(0,"button",55),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",56),a(2,"Download to EXCEL "),e()}}function vf(i,s){i&1&&(t(0,"button",57),m(1,"i",40),a(2,"Downloading "),e())}var Ef=(i,s)=>s.id;function wf(i,s){if(i&1&&(t(0,"td"),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit;l(1),p(P(2,1,o.village_name))}}function Tf(i,s){i&1&&m(0,"td")}function Lf(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),b(3,wf,3,3,"td")(4,Tf,1,0),t(5,"td"),a(6),k(7,"uppercase"),e(),t(8,"td"),a(9),k(10,"uppercase"),e(),t(11,"td"),a(12),k(13,"uppercase"),e(),t(14,"td"),a(15),k(16,"uppercase"),e(),t(17,"td"),a(18),k(19,"uppercase"),e(),t(20,"td"),a(21),k(22,"uppercase"),e(),t(23,"td"),a(24),k(25,"uppercase"),e(),t(26,"td"),a(27),e(),t(28,"td"),a(29),k(30,"uppercase"),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(1),E(3,o.village_name?3:4),l(3),p(P(7,11,o.category)),l(3),p(P(10,13,o.application_number)),l(3),p(P(13,15,r.appService.dateFormat(o.application_date))),l(3),p(P(16,17,o.applicant_name)),l(3),p(P(19,19,o.spouse_or_father_name)),l(3),p(P(22,21,o.social_category)),l(3),p(P(25,23,o.pwd_status)),l(3),p(o.alt_mobile_number),l(2),p(P(30,25,o.application_status))}}function If(i,s){if(i&1&&(t(0,"table",58)(1,"thead",59)(2,"tr")(3,"th"),a(4,"SI#"),e(),t(5,"th"),a(6,"VILLAGE"),e(),t(7,"th"),a(8,"CATEGORY"),e(),t(9,"th"),a(10,"APPLICATION NO."),e(),t(11,"th"),a(12,"APPLICATION DATE"),e(),t(13,"th"),a(14,"APPLICANT NAME"),e(),t(15,"th"),a(16,"FATHER/HUSBAND NAME"),e(),t(17,"th"),a(18,"SOCIAL CATEGORY"),e(),t(19,"th"),a(20,"PWD"),e(),t(21,"th"),a(22,"MOBILE NO."),e(),t(23,"th"),a(24,"APPLICATION STATUS"),e()()(),t(25,"tbody"),F(26,Lf,31,27,"tr",null,Ef),e()()),i&2){let o=h(2);l(26),V(o.filteredVillageUserStats)}}function yf(i,s){i&1&&(t(0,"h5",60),a(1,"No data available"),e())}function kf(i,s){i&1&&(t(0,"div",61),a(1,"Loading.. "),m(2,"i",62),e())}function Pf(i,s){i&1&&(t(0,"span"),m(1,"i",41),a(2," Loading..."),e())}function Df(i,s){i&1&&(t(0,"span"),a(1,"Load More"),e())}function Af(i,s){if(i&1){let o=U();t(0,"div",63)(1,"button",64),L("click",function(){D(o);let r=h(2);return A(r.loadMore())}),b(2,Pf,3,0,"span",65)(3,Df,2,0,"span",65),e()()}if(i&2){let o=h(2);l(2),T("ngIf",o.isLoadMoreInProgress),l(1),T("ngIf",!o.isLoadMoreInProgress)}}function Uf(i,s){if(i&1){let o=U();t(0,"div",31)(1,"div",42)(2,"h5",2),a(3," Number of records found : "),t(4,"span",43),a(5),e()()(),t(6,"div",44)(7,"div",45)(8,"input",46),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(9,"i",47),e(),t(10,"div",48),b(11,gf,3,0,"button",49)(12,Cf,3,0),e(),t(13,"div",50),b(14,bf,3,0,"button",49)(15,vf,3,0),e()()(),t(16,"div",51),b(17,If,28,0,"table",52)(18,yf,2,0)(19,kf,3,0,"div",53),e(),b(20,Af,4,2,"div",54)}if(i&2){let o=h();l(5),p(o.count),l(3),T("ngModel",o.searchTerm),l(3),E(11,o.isExportInProgress?12:11),l(3),E(14,o.isExportInProgressExcel?15:14),l(3),E(17,o.filteredVillageUserStats&&o.filteredVillageUserStats.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),l(2),E(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),l(1),T("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var Lo=(()=>{let s=class s{constructor(n,r,c,f,d,C,g,_){this.route=n,this.router=r,this.formService=c,this.appService=f,this.httpClient=d,this.toastService=C,this.authService=g,this.masterDataService=_,this.isStatsLoading=!1,this.userStats=[],this.block_id="",this.gp_id="",this.village_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.limit=this.appService.loadmorelimit,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.count=0,this.searchForm=new kt({a_category:new nt(""),social_category:new nt(""),pwd_status:new nt(""),submit_date:new nt(""),a_status:new nt("")})}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.block_id,this.gp_id=n.gp_id,this.village_id=n.id,this.fetchuserStats(this.village_id)})}fetchuserStats(n,r=!1){this.isStatsLoading=!0;let c=new st;c=c.set("gp_id",this.gp_id),c=c.set("village_id",n),c=c.set("offset",this.offset),c=c.set("limit",this.limit),c=c.set("pwd_status",1),c=c.set("installment",this.installment);let f=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:c,headers:f}).subscribe(d=>{this.isStatsLoading=!1,this.count=d.count,d.data&&d.data.length>0?(this.application_list=this.application_list.concat(d.data),this.offset+=d.data.length,this.hasMoreRecords=d.data.length===this.limit):this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)},d=>{this.isStatsLoading=!1,this.application_list=[],this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)})}get filteredVillageUserStats(){if(!this.searchTerm)return this.application_list;let n=this.searchTerm.toLowerCase();return this.application_list.filter(r=>r.village_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.category?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.application_number?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_date).toLowerCase().includes(this.searchTerm.toLowerCase())||r.applicant_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.spouse_or_father_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.dob).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.social_category).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.pwd_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.alt_mobile_number).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.payment_status).toLowerCase().includes(this.searchTerm.toLowerCase()))}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status,_=new st;_=_.set("gp_id",this.gp_id),r&&(_=_.set("village_id",r)),c&&(_=_.set("category",c)),f&&(_=_.set("social_category",f)),d&&(_=_.set("pwd_status",d)),g&&(_=_.set("application_status",g)),_=_.set("offset",this.offset),_=_.set("limit",this.limit),_=_.set("pwd_status",1),_=_.set("installment",this.installment);let v=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:_,headers:v}).subscribe(S=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=S.count,S.data&&S.data.length>0?(this.application_list=this.application_list.concat(S.data),this.offset+=S.data.length,this.hasMoreRecords=S.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},S=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}exportToExcel(){let n=new st,r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;n=n.set("gp_id",this.gp_id),r&&(n=n.set("village_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),g&&(n=n.set("application_status",g)),n=n.set("export_all","1"),n=n.set("pwd_status","1"),n=n.set("installment",this.installment);let _=new rt({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgressExcel=!1;let S=v.data.map((y,B)=>({"SI#":B+1,DISTRICT:y.district_name?y.district_name.toUpperCase():"",BLOCK:y.block_name?y.block_name.toUpperCase():"",GP:y.gp_name?y.gp_name.toUpperCase():"",VILLAGE:y.village_name?y.village_name.toUpperCase():"",CATEGORY:y.category.toUpperCase(),"APPLICATION NO.":y.application_number.toUpperCase(),"APPLICATION DATE":this.appService.dateFormat(y.application_date),"APPLICANT NAME":y.applicant_name.toUpperCase(),"FATHER/HUSBAND NAME":y.spouse_or_father_name.toUpperCase(),"SOCIAL CATEGORY":y.social_category.toUpperCase(),PWD:y.pwd_status.toUpperCase(),"MOBILE NO.":y.alt_mobile_number,"APPLICATION STATUS":y.application_status.toUpperCase()})),w=N.json_to_sheet(S),u=N.book_new();N.book_append_sheet(u,w,"Applications");let I=Z(u,{bookType:"xlsx",type:"array"}),R=new Date,z=R.toLocaleDateString("en-GB").split("/").reverse().join("-"),at=R.toLocaleTimeString("en-GB").replace(/:/g,"-"),ct=`application_status_reports_${z}_${at}.xlsx`,lt=new Blob([I],{type:"application/octet-stream"}),O=document.createElement("a"),et=window.URL.createObjectURL(lt);O.href=et,O.download=ct,O.click(),window.URL.revokeObjectURL(et)},v=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",v)})}exportToPDF(){$e.default.vfs=To.default.pdfMake.vfs;let n=new st,r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;n=n.set("gp_id",this.gp_id),r&&(n=n.set("village_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),g&&(n=n.set("application_status",g)),n=n.set("pwd_status","1"),n=n.set("installment",this.installment);let _=new rt({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgress=!1;let S=v.data[0]||{},w=(S.district_name||"N/A").toUpperCase(),u=(S.block_name||S.ulb_name||"N/A").toUpperCase(),I=(S.gp_name||S.ward_no||"N/A").toUpperCase(),R=(S.village_name||"").toUpperCase(),z=[[{text:"SI#",fontSize:10},{text:"CATEGORY",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICATION DATE.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"SOCIAL CATEGORY",fontSize:10},{text:"PWD",fontSize:10},{text:"MOBILE NO",fontSize:10},{text:"APPLICATION STATUS",fontSize:10}]];v.data.forEach((W,It)=>{z.push([{text:(It+1).toString().toUpperCase(),fontSize:9},{text:(W.category||"").toUpperCase(),fontSize:9},{text:(W.application_number||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(W.application_date)||"",fontSize:9},{text:(W.applicant_name||"").toUpperCase(),fontSize:9},{text:(W.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:(W.social_category||"").toUpperCase(),fontSize:9},{text:(W.pwd_status||"").toUpperCase(),fontSize:9},{text:(W.alt_mobile_number||"").toUpperCase(),fontSize:9},{text:(W.application_status||"").toUpperCase(),fontSize:9}])});let at=new Date,ct=`Timestamp: ${at.toLocaleDateString()}, ${at.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,lt={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${w} > BLOCK: ${u} > GP: ${I} >VILLAGE: ${R}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DETAILED REPORT DIFFERENTLY ABLED",style:"header"},{table:{headerRows:1,body:z,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]},layout:{fillColor:function(W){return W===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:ct,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},O=new Date,et=O.toLocaleDateString("en-GB").split("/").reverse().join("-"),y=O.toLocaleTimeString("en-GB").replace(/:/g,"-"),B=`application_status_reports_${et}_${y}.pdf`;$e.default.createPdf(lt).download(B)},v=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",v)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(Ot),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-pwd-village-user-list"]],decls:58,vars:4,consts:[[1,"container-fluid","drilldown-reports"],[1,"d-flex","justify-content-between","w-100","mb-3"],[1,"card-title"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],["class","row mb-2"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-2"],[1,"col-md-4"],["for","a_category",1,"fw-bold"],["formControlName","a_category","id","a_category",1,"form-select","my-2"],["value",""],["value","1"],["value","0"],["for","social_category",1,"fw-bold"],["formControlName","social_category","id","social_category",1,"form-select","my-2"],["value","2"],["value","3"],["value","4"],["for","a_status",1,"fw-bold"],["formControlName","a_status","id","a_status",1,"form-select","my-2"],["value","7"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[1,"row","mb-2"],[1,"col-md-7"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"fa","fa-spinner","fa-spin"],[1,"col-md-5"],["id","recordCount"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports detail"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports","detail"],[1,"text-light",2,"background-color","#fd7b03"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"],[4,"ngIf"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1)(2,"h4",2),a(3,"Detailed Report - Differently Abled"),e(),t(4,"div",3)(5,"a",4),L("click",function(){return c.appService.goBack()}),t(6,"button",5),m(7,"i",6),a(8," Back"),e()()()(),b(9,uf,12,4,"div",7),t(10,"div",8)(11,"form",9),L("ngSubmit",function(){return c.onSearch()}),t(12,"div",10)(13,"div",11)(14,"label",12),a(15," Category "),e(),t(16,"select",13)(17,"option",14),a(18,"Choose Category"),e(),t(19,"option",15),a(20,"NFSA"),e(),t(21,"option",16),a(22,"NON-NFSA"),e()()(),t(23,"div",11)(24,"label",17),a(25," Social Category "),e(),t(26,"select",18)(27,"option",14),a(28,"Choose Social Category"),e(),t(29,"option",15),a(30,"Un-Reserved"),e(),t(31,"option",19),a(32,"OBC"),e(),t(33,"option",20),a(34,"SC"),e(),t(35,"option",21),a(36,"ST"),e()()(),t(37,"div",11)(38,"label",22),a(39," Application Status "),e(),t(40,"select",23)(41,"option",14),a(42,"Choose Status"),e(),t(43,"option",24),a(44,"Under Process"),e(),t(45,"option",15),a(46,"Approved"),e(),t(47,"option",19),a(48,"Rejected"),e()()()(),t(49,"div",25)(50,"div",26),b(51,hf,3,0,"button",27)(52,Sf,3,0),e()()()(),t(53,"div",28)(54,"div",29)(55,"div",30),b(56,xf,2,0)(57,Uf,21,7),e()()()()),r&2&&(l(9),E(9,c.filteredVillageUserStats&&c.filteredVillageUserStats.length>0?9:-1),l(2),T("formGroup",c.searchForm),l(40),E(51,c.isFormSearchInProgress?52:51),l(5),E(56,c.isStatsLoading?56:57))},dependencies:[ft,Pt,Nt,Rt,K,Ut,q,yt,J,Dt,At,it]});let i=s;return i})();var Ge=j(ut()),Io=j(ht());function Nf(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function Rf(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",27),a(2,"Download PDF "),e()}}function Of(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}function Bf(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",27),a(2,"Download EXCEL "),e()}}function Wf(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}var Mf=(i,s)=>s.id,Ff=i=>({installment:i});function Vf(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",35),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e(),t(9,"td"),a(10),e(),t(11,"td"),a(12),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),Gt("routerLink","/department/portal/pwd/village-user-list/",o.district_id,"/",o.block_id,"/",o.gp_id,"/",o.village_id,""),T("queryParams",pt(12,Ff,r.installment)),l(1),p(P(6,10,o.village_name)),l(3),p(o==null?null:o.applications_received),l(2),p(o==null?null:o.approved_application),l(2),p(r.getTotalRejected(o))}}function zf(i,s){if(i&1&&(t(0,"table",30)(1,"thead",31)(2,"tr")(3,"th",32),a(4,"Sl.#"),e(),t(5,"th",32),a(6,"VILLAGE"),e(),t(7,"th",33),a(8,"APPLICATION DETAILS"),e()(),t(9,"tr")(10,"th"),a(11,"RECEIVED"),e(),t(12,"th"),a(13,"APPROVED"),e(),t(14,"th"),a(15,"REJECTED"),e()()(),t(16,"tbody",34),F(17,Vf,13,14,"tr",null,Mf),e()()),i&2){let o=h(2);l(17),V(o.filteredVillageStats)}}function jf(i,s){i&1&&a(0," No Data Found ")}function $f(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - Differently Abled"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e(),t(8,"li",15),a(9),e(),t(10,"li",16),a(11),e()()()(),t(12,"div",17)(13,"div",18)(14,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(15,"i",20),e(),t(16,"div",21),b(17,Rf,3,0,"button",22)(18,Of,3,0),e(),t(19,"div",23),b(20,Bf,3,0,"button",22)(21,Wf,3,0),e()()(),t(22,"div",24),b(23,zf,19,0,"table",25)(24,jf,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredVillageStats[0].district_name),l(2),p(o.filteredVillageStats[0].block_name),l(2),p(o.filteredVillageStats[0].gp_name),l(3),T("ngModel",o.searchTerm),l(3),E(17,o.isExportInProgress?18:17),l(3),E(20,o.isExportInProgressExcel?21:20),l(3),E(23,o.filteredVillageStats&&o.filteredVillageStats.length>0?23:24)}}var yo=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.gp_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.block_id,this.gp_id=n.id,this.fetchvillageStats(this.gp_id)})}fetchvillageStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/village-count?gp_id=${n}&pwd_status=1&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.villageStats=r.data},r=>{this.isStatsLoading=!1,this.villageStats=[]})}getTotalRejected(n){let r=parseInt((n.nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10),c=parseInt((n.non_nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10);return(r+c).toLocaleString()}get filteredVillageStats(){return this.searchTerm?this.villageStats.filter(n=>n.village_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.villageStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.villageStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",BLOCK:u.block_name?u.block_name.toUpperCase():"",GP:u.gp_name?u.gp_name.toUpperCase():"",VILLAGE:u.village_name?u.village_name.toUpperCase():"","APPLICATION RECEIVED":u?.applications_received,"APPLICATION APPROVED":u?.approved_application,"APPLICATION REJECTED":this.getTotalRejected(u)})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`village_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){Ge.default.vfs=Io.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.villageStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=(n.gp_name||n.ward_no||"N/A").toUpperCase(),d=[[{text:"SI#",fontSize:10},{text:"VILLAGE",fontSize:10},{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"APPLICATION REJECTED",fontSize:10}]];this.villageStats.forEach((I,R)=>{d.push([{text:(R+1).toString().toUpperCase(),fontSize:9},{text:(I.village_name||"").toUpperCase(),fontSize:9},{text:I?.applications_received,fontSize:9},{text:I?.approved_application,fontSize:9},{text:this.getTotalRejected(I),fontSize:9}])});let C=new Date,g=`Timestamp: ${C.toLocaleDateString()}, ${C.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,_={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK: ${c} > GP:${f}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - DIFFERENTLY ABLED VILLAGE-WISE",style:"header"},{table:{headerRows:1,body:d,widths:["9%","13%","13%","13%","13%"]},layout:{fillColor:function(I){return I===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:g,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},v=new Date,S=v.toLocaleDateString("en-GB").split("/").reverse().join("-"),w=v.toLocaleTimeString("en-GB").replace(/:/g,"-"),u=`village_drilldown_reports_${S}_${w}.pdf`;Ge.default.createPdf(_).download(u,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-pwd-village-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],["colspan","3",1,"text-center"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,Nf,2,0)(11,$f,25,7),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var Xe=j(ut()),ko=j(ht());function Gf(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function Xf(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",27),a(2,"Download PDF "),e()}}function Yf(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}function Hf(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",27),a(2,"Download EXCEL "),e()}}function Kf(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}var qf=(i,s)=>s.id,Jf=i=>({installment:i});function Qf(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",35),a(5),e()(),t(6,"td"),a(7),e(),t(8,"td"),a(9),e(),t(10,"td"),a(11),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),Mt("routerLink","/department/portal/pwd/ward-user-list/",o.district_id,"/",o.ulb_id,"/",o.ward_id,""),T("queryParams",pt(9,Jf,r.installment)),l(1),p(o.ward_no),l(2),p(o==null?null:o.applications_received),l(2),p(o==null?null:o.approved_application),l(2),p(r.getTotalRejected(o))}}function Zf(i,s){if(i&1&&(t(0,"table",30)(1,"thead",31)(2,"tr")(3,"th",32),a(4,"Sl.#"),e(),t(5,"th",32),a(6,"WARD"),e(),t(7,"th",33),a(8,"APPLICATION DETAILS"),e()(),t(9,"tr")(10,"th"),a(11,"RECEIVED"),e(),t(12,"th"),a(13,"APPROVED"),e(),t(14,"th"),a(15,"REJECTED"),e()()(),t(16,"tbody",34),F(17,Qf,12,11,"tr",null,qf),e()()),i&2){let o=h(2);l(17),V(o.filteredWardStats)}}function tu(i,s){i&1&&a(0," No Data Found ")}function eu(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - Differently Abled"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e(),t(8,"li",16),a(9),e()()()(),t(10,"div",17)(11,"div",18)(12,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(13,"i",20),e(),t(14,"div",21),b(15,Xf,3,0,"button",22)(16,Yf,3,0),e(),t(17,"div",23),b(18,Hf,3,0,"button",22)(19,Kf,3,0),e()()(),t(20,"div",24),b(21,Zf,19,0,"table",25)(22,tu,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredWardStats[0].district_name),l(2),p(o.filteredWardStats[0].ulb_name),l(3),T("ngModel",o.searchTerm),l(3),E(15,o.isExportInProgress?16:15),l(3),E(18,o.isExportInProgressExcel?19:18),l(3),E(21,o.filteredWardStats&&o.filteredWardStats.length>0?21:22)}}var Po=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.district_id="",this.wardStats=[],this.ulb_id="",this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.ulb_id=n.id,this.fetchWardStats(this.ulb_id)})}fetchWardStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/ward-count?ulb_id=${n}&pwd_status=1&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.wardStats=r.data},r=>{this.isStatsLoading=!1,this.wardStats=[]})}getTotalRejected(n){let r=parseInt((n.nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10),c=parseInt((n.non_nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10);return(r+c).toLocaleString()}get filteredWardStats(){return this.searchTerm?this.wardStats.filter(n=>n.ward_no.toLowerCase().includes(this.searchTerm.toLowerCase())):this.wardStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.wardStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",ULB:u.ulb_name?u.ulb_name.toUpperCase():"","WARD NO.":u.ward_no?u.ward_no.toUpperCase():"","APPLICATION RECEIVED":u?.applications_received,"APPLICATION APPROVED":u?.approved_application,"APPLICATION REJECTED":this.getTotalRejected(u)})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`ward_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){Xe.default.vfs=ko.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.wardStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=[[{text:"SI#",fontSize:10},{text:"WARD NO.",fontSize:10},{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"APPLICATION REJECTED",fontSize:10}]];this.wardStats.forEach((u,I)=>{f.push([{text:(I+1).toString().toUpperCase(),fontSize:9},{text:(u.ward_no||"").toUpperCase(),fontSize:9},{text:u?.applications_received,fontSize:9},{text:u?.approved_application,fontSize:9},{text:this.getTotalRejected(u),fontSize:9}])});let d=new Date,C=`Timestamp: ${d.toLocaleDateString()}, ${d.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,g={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK/ULB: ${c}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - DIFFERENTLY ABLED WARD-WISE",style:"header"},{table:{headerRows:1,body:f,widths:["9%","13%","13%","13%","13%"]},layout:{fillColor:function(u){return u===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:C,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},_=new Date,v=_.toLocaleDateString("en-GB").split("/").reverse().join("-"),S=_.toLocaleTimeString("en-GB").replace(/:/g,"-"),w=`ward_drilldown_reports_${v}_${S}.pdf`;Xe.default.createPdf(g).download(w,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-pwd-ward-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],["colspan","3",1,"text-center"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,Gf,2,0)(11,eu,23,6),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J]});let i=s;return i})();var Ye=j(ut()),Do=j(ht());function iu(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function nu(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",27),a(2,"Download PDF "),e()}}function ou(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}function au(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",27),a(2,"Download EXCEL "),e()}}function ru(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}var su=(i,s)=>s.id,lu=i=>({installment:i});function cu(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",35),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e(),t(9,"td"),a(10),e(),t(11,"td"),a(12),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),Mt("routerLink","/department/portal/pwd/village-stats/",o.district_id,"/",o.block_id,"/",o.gp_id,""),T("queryParams",pt(11,lu,r.installment)),l(1),p(P(6,9,o.gp_name)),l(3),p(o==null?null:o.applications_received),l(2),p(o==null?null:o.approved_application),l(2),p(r.getTotalRejected(o))}}function du(i,s){if(i&1&&(t(0,"table",30)(1,"thead",31)(2,"tr")(3,"th",32),a(4,"Sl.#"),e(),t(5,"th",32),a(6,"GRAM PANCHAYAT"),e(),t(7,"th",33),a(8,"APPLICATION DETAILS"),e()(),t(9,"tr")(10,"th"),a(11,"RECEIVED"),e(),t(12,"th"),a(13,"APPROVED"),e(),t(14,"th"),a(15,"REJECTED"),e()()(),t(16,"tbody",34),F(17,cu,13,13,"tr",null,su),e()()),i&2){let o=h(2);l(17),V(o.filteredGpStats)}}function pu(i,s){i&1&&a(0," No Data Found ")}function mu(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - Differently Abled"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e(),t(8,"li",16),a(9),e()()()(),t(10,"div",17)(11,"div",18)(12,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(13,"i",20),e(),t(14,"div",21),b(15,nu,3,0,"button",22)(16,ou,3,0),e(),t(17,"div",23),b(18,au,3,0,"button",22)(19,ru,3,0),e()()(),t(20,"div",24),b(21,du,19,0,"table",25)(22,pu,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredGpStats[0].district_name),l(2),p(o.filteredGpStats[0].block_name),l(3),T("ngModel",o.searchTerm),l(3),E(15,o.isExportInProgress?16:15),l(3),E(18,o.isExportInProgressExcel?19:18),l(3),E(21,o.filteredGpStats&&o.filteredGpStats.length>0?21:22)}}var Ao=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.district_id="",this.gpStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.id,this.fetchgpStats(this.block_id)})}fetchgpStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/gp-count?block_id=${n}&pwd_status=1&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.gpStats=r.data},r=>{this.isStatsLoading=!1,this.gpStats=[]})}getTotalRejected(n){let r=parseInt((n.nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10),c=parseInt((n.non_nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10);return(r+c).toLocaleString()}get filteredGpStats(){return this.searchTerm?this.gpStats.filter(n=>n.gp_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.gpStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.gpStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",BLOCK:u.block_name?u.block_name.toUpperCase():"",GP:u.gp_name?u.gp_name.toUpperCase():"","APPLICATION RECEIVED":u?.applications_received,"APPLICATION APPROVED":u?.approved_application,"APPLICATION REJECTED":this.getTotalRejected(u)})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`gp_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){Ye.default.vfs=Do.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.gpStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=[[{text:"SI#",fontSize:10},{text:"GP",fontSize:10},{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"APPLICATION REJECTED",fontSize:10}]];this.gpStats.forEach((u,I)=>{f.push([{text:(I+1).toString().toUpperCase(),fontSize:9},{text:(u.gp_name||"").toUpperCase(),fontSize:9},{text:u?.applications_received,fontSize:9},{text:u?.approved_application,fontSize:9},{text:this.getTotalRejected(u),fontSize:9}])});let d=new Date,C=`Timestamp: ${d.toLocaleDateString()}, ${d.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,g={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK: ${c}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - DIFFERENTLY ABLED GP-WISE",style:"header"},{table:{headerRows:1,body:f,widths:["9%","13%","13%","13%","13%"]},layout:{fillColor:function(u){return u===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:C,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},_=new Date,v=_.toLocaleDateString("en-GB").split("/").reverse().join("-"),S=_.toLocaleTimeString("en-GB").replace(/:/g,"-"),w=`gp_drilldown_reports_${v}_${S}.pdf`;Ye.default.createPdf(g).download(w,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-pwd-gp-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],["colspan","3",1,"text-center"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,iu,2,0)(11,mu,23,6),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var He=j(ut()),Uo=j(ht());function _u(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function fu(i,s){if(i&1){let o=U();t(0,"button",25),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",26),a(2,"Download PDF "),e()}}function uu(i,s){i&1&&(t(0,"button",27),m(1,"i",28),a(2,"Downloading "),e())}function hu(i,s){if(i&1){let o=U();t(0,"button",25),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",26),a(2,"Download EXCEL "),e()}}function Su(i,s){i&1&&(t(0,"button",27),m(1,"i",28),a(2,"Downloading "),e())}var xu=(i,s)=>s.id,No=i=>({installment:i});function gu(i,s){if(i&1&&(t(0,"a",35),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit,n=h(3);Vt("routerLink","/department/portal/pwd/gp-stats/",o.district_id,"/",o.block_id,""),T("queryParams",pt(6,No,n.installment)),l(1),p(P(2,4,o.block_name))}}function Cu(i,s){if(i&1&&(t(0,"a",35),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit,n=h(3);Vt("routerLink","/department/portal/pwd/ward-stats/",o.district_id,"/",o.ulb_id,""),T("queryParams",pt(6,No,n.installment)),l(1),p(P(2,4,o.ulb_name))}}function bu(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td"),b(4,gu,3,8,"a",34)(5,Cu,3,8),e(),t(6,"td"),a(7),e(),t(8,"td"),a(9),e(),t(10,"td"),a(11),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),E(4,o.block_id?4:5),l(3),p(o==null?null:o.applications_received),l(2),p(o==null?null:o.approved_application),l(2),p(r.getTotalRejected(o))}}function vu(i,s){if(i&1&&(t(0,"table",29)(1,"thead",30)(2,"tr")(3,"th",31),a(4,"Sl.#"),e(),t(5,"th",31),a(6,"BLOCK/ULB"),e(),t(7,"th",32),a(8,"APPLICATION DETAILS"),e()(),t(9,"tr")(10,"th"),a(11,"RECEIVED"),e(),t(12,"th"),a(13,"APPROVED"),e(),t(14,"th"),a(15,"REJECTED"),e()()(),t(16,"tbody",33),F(17,bu,12,5,"tr",null,xu),e()()),i&2){let o=h(2);l(17),V(o.filteredBlockStats)}}function Eu(i,s){i&1&&a(0," No Data Found ")}function wu(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - Differently Abled"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e()()()(),t(8,"div",16)(9,"div",17)(10,"input",18),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(11,"i",19),e(),t(12,"div",20),b(13,fu,3,0,"button",21)(14,uu,3,0),e(),t(15,"div",22),b(16,hu,3,0,"button",21)(17,Su,3,0),e()()(),t(18,"div",23),b(19,vu,19,0,"table",24)(20,Eu,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredBlockStats[0].district_name),l(3),T("ngModel",o.searchTerm),l(3),E(13,o.isExportInProgress?14:13),l(3),E(16,o.isExportInProgressExcel?17:16),l(3),E(19,o.filteredBlockStats&&o.filteredBlockStats.length>0?19:20)}}var Ro=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.districtStats=[],this.district_id="",this.blockStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{let r=n.id;this.district_id=r,this.fetchblockStats(r)})}fetchblockStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/block-count?district_id=${n}&pwd_status=1&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.blockStats=r.data,this.fetchulbStats(n)},r=>{this.isStatsLoading=!1,this.blockStats=[]})}fetchulbStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/ulb-count?district_id=${n}&pwd_status=1&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.blockStats=[...this.blockStats,...r.data]},r=>{this.isStatsLoading=!1})}getTotalRejected(n){let r=parseInt((n.nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10),c=parseInt((n.non_nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10);return(r+c).toLocaleString()}get filteredBlockStats(){return this.searchTerm?this.blockStats.filter(n=>n.block_name&&n.block_name.toLowerCase().includes(this.searchTerm.toLowerCase())||n.ulb_name&&n.ulb_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.blockStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.blockStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name,"BLOCK/ULB":u.block_name?.toUpperCase()||u.ulb_name?.toUpperCase(),"APPLICATION RECEIVED":u?.applications_received,"APPLICATION APPROVED":u?.approved_application,"APPLICATION REJECTED":this.getTotalRejected(u)})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`block_ulb_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){He.default.vfs=Uo.default.pdfMake.vfs,this.isExportInProgress=!0;let r=((this.blockStats[0]||{}).district_name||"N/A").toUpperCase(),c=[[{text:"SI#",fontSize:10},{text:"BLOCK/ULB",fontSize:10},{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"APPLICATION REJECTED",fontSize:10}]];this.blockStats.forEach((w,u)=>{c.push([{text:(u+1).toString().toUpperCase(),fontSize:9},{text:(w.block_name||w.ulb_name||"").toUpperCase(),fontSize:9},{text:w?.applications_received,fontSize:9},{text:w?.approved_application,fontSize:9},{text:this.getTotalRejected(w),fontSize:9}])});let f=new Date,d=`Timestamp: ${f.toLocaleDateString()}, ${f.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,C={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - DIFFERENTLY ABLED BLOCK/ULB WISE",style:"header"},{table:{headerRows:1,body:c,widths:["9%","13%","13%","13%","13%"]},layout:{fillColor:function(w){return w===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:d,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},g=new Date,_=g.toLocaleDateString("en-GB").split("/").reverse().join("-"),v=g.toLocaleTimeString("en-GB").replace(/:/g,"-"),S=`block_ulb_drilldown_reports_${_}_${v}.pdf`;He.default.createPdf(C).download(S,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-pwd-block-ulb-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],["colspan","3",1,"text-center"],[2,"font-size","14px"],["style","text-decoration: none",3,"routerLink","queryParams"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,_u,2,0)(11,wu,21,5),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var Ke=j(ut()),Oo=j(ht());function Tu(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function Lu(i,s){if(i&1){let o=U();t(0,"button",22),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",23),a(2,"Download PDF "),e()}}function Iu(i,s){i&1&&(t(0,"button",24),m(1,"i",25),a(2,"Downloading "),e())}function yu(i,s){if(i&1){let o=U();t(0,"button",22),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",23),a(2,"Download EXCEL "),e()}}function ku(i,s){i&1&&(t(0,"button",24),m(1,"i",25),a(2,"Downloading "),e())}var Pu=(i,s)=>s.id,Du=i=>({installment:i});function Au(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",31),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e(),t(9,"td"),a(10),e(),t(11,"td"),a(12),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),$t("routerLink","/department/portal/pwd/block-ulb-stats/",o.district_id,""),T("queryParams",pt(9,Du,r.installment)),l(1),p(P(6,7,o.district_name)),l(3),p(o==null?null:o.count_differently_abled),l(2),p(o==null?null:o.approved_applications_differently_abled),l(2),p(o==null?null:o.count_differently_abled_rejected)}}function Uu(i,s){if(i&1&&(t(0,"table",26)(1,"thead",27)(2,"tr")(3,"th",28),a(4,"Sl.#"),e(),t(5,"th",28),a(6,"DISTRICT"),e(),t(7,"th",29),a(8,"APPLICATION DETAILS"),e()(),t(9,"tr")(10,"th"),a(11,"RECEIVED"),e(),t(12,"th"),a(13,"APPROVED"),e(),t(14,"th"),a(15,"REJECTED"),e()()(),t(16,"tbody",30),F(17,Au,13,11,"tr",null,Pu),e()()),i&2){let o=h(2);l(17),V(o.filteredDistrictStats)}}function Nu(i,s){i&1&&a(0," No Data Found ")}function Ru(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - Differently Abled"),e()(),t(4,"div",13)(5,"div",14)(6,"input",15),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(7,"i",16),e(),t(8,"div",17),b(9,Lu,3,0,"button",18)(10,Iu,3,0),e(),t(11,"div",19),b(12,yu,3,0,"button",18)(13,ku,3,0),e()()(),t(14,"div",20),b(15,Uu,19,0,"table",21)(16,Nu,1,0),e()}if(i&2){let o=h();l(6),T("ngModel",o.searchTerm),l(3),E(9,o.isExportInProgress?10:9),l(3),E(12,o.isExportInProgressExcel?13:12),l(3),E(15,o.filteredDistrictStats&&o.filteredDistrictStats.length>0?15:16)}}var Bo=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.router=n,this.route=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.districtStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment,this.card_name=n.card_name,this.fetchDistrictStats()})}fetchDistrictStats(){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?pwd_status=1&installment=${this.installment}&card_name=${this.card_name}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isStatsLoading=!1,this.districtStats=n.data},n=>{this.isStatsLoading=!1,this.districtStats=[]})}getTotalRejected(n){let r=parseInt((n.nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10),c=parseInt((n.non_nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10);return(r+c).toLocaleString()}get filteredDistrictStats(){return this.searchTerm?this.districtStats.filter(n=>n.district_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.districtStats}exportToExcel(){this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?pwd_status=1&installment=${this.installment}&card_name=${this.card_name}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isExportInProgressExcel=!1;let r=n.data.map((I,R)=>({"SI#":R+1,DISTRICT:I.district_name.toUpperCase(),"APPLICATION RECEIVED":I?.count_differently_abled,"APPLICATION APPROVED":I?.approved_applications_differently_abled,"APPLICATION REJECTED":I.count_differently_abled_rejected})),c=N.json_to_sheet(r),f=N.book_new();N.book_append_sheet(f,c,"Applications");let d=Z(f,{bookType:"xlsx",type:"array"}),C=new Date,g=C.toLocaleDateString("en-GB").split("/").reverse().join("-"),_=C.toLocaleTimeString("en-GB").replace(/:/g,"-"),v=`district_drilldown_reports_${g}_${_}.xlsx`,S=new Blob([d],{type:"application/octet-stream"}),w=document.createElement("a"),u=window.URL.createObjectURL(S);w.href=u,w.download=v,w.click(),window.URL.revokeObjectURL(u)},n=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",n)})}exportToPDF(){Ke.default.vfs=Oo.default.pdfMake.vfs,this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?pwd_status=1&installment=${this.installment}&card_name=${this.card_name}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isExportInProgress=!1;let r=[[{text:"SI#",fontSize:10},{text:"DISTRICT",fontSize:10},{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"APPLICATION REJECTED",fontSize:10}]];n.data.forEach((S,w)=>{r.push([{text:(w+1).toString().toUpperCase(),fontSize:9},{text:(S.district_name||"").toUpperCase(),fontSize:9},{text:S?.count_differently_abled,fontSize:9},{text:S?.approved_applications_differently_abled,fontSize:9},{text:S?.count_differently_abled_rejected,fontSize:9}])});let c=new Date,f=`Timestamp: ${c.toLocaleDateString()}, ${c.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,d={pageOrientation:"landscape",pageSize:"A4",content:[{text:"DRILL-DOWN REPORT - DIFFERENTLY ABLED DISTRICT-WISE",style:"header"},{table:{headerRows:1,body:r,widths:["9%","13%","13%","13%","13%"]},layout:{fillColor:function(S){return S===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:f,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},C=new Date,g=C.toLocaleDateString("en-GB").split("/").reverse().join("-"),_=C.toLocaleTimeString("en-GB").replace(/:/g,"-"),v=`district_drilldown_reports_${g}_${_}.pdf`;Ke.default.createPdf(d).download(v)},n=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",n)})}};s.\u0275fac=function(r){return new(r||s)(x(G),x(tt),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-pwd-district-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],["colspan","3",1,"text-center"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,Tu,2,0)(11,Ru,17,4),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var qe=j(ut()),Wo=j(ht());function Ou(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function Bu(i,s){if(i&1){let o=U();t(0,"button",22),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",23),a(2,"Download PDF "),e()}}function Wu(i,s){i&1&&(t(0,"button",24),m(1,"i",25),a(2,"Downloading "),e())}function Mu(i,s){if(i&1){let o=U();t(0,"button",22),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",23),a(2,"Download EXCEL "),e()}}function Fu(i,s){i&1&&(t(0,"button",24),m(1,"i",25),a(2,"Downloading "),e())}var Vu=(i,s)=>s.id,zu=i=>({installment:i});function ju(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",30),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e(),t(9,"td"),a(10),e(),t(11,"td"),a(12),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),$t("routerLink","/department/portal/nfsa/block-ulb-stats/",o.district_id,""),T("queryParams",pt(9,zu,r.installment)),l(1),p(P(6,7,o.district_name)),l(3),p(o==null?null:o.nfsa_applications_received),l(2),p(o==null?null:o.nfsa_approved_application),l(2),p(o==null?null:o.nfsa_rejected_application)}}function $u(i,s){if(i&1&&(t(0,"table",26)(1,"thead",27)(2,"tr")(3,"th",28),a(4,"Sl.#"),e(),t(5,"th",28),a(6,"DISTRICT"),e()(),t(7,"tr")(8,"th"),a(9,"RECEIVED"),e(),t(10,"th"),a(11,"APPROVED"),e(),t(12,"th"),a(13,"NFSA REJECTED"),e()()(),t(14,"tbody",29),F(15,ju,13,11,"tr",null,Vu),e()()),i&2){let o=h(2);l(15),V(o.filteredDistrictStats)}}function Gu(i,s){i&1&&a(0," No Data Found ")}function Xu(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - NFSA"),e()(),t(4,"div",13)(5,"div",14)(6,"input",15),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(7,"i",16),e(),t(8,"div",17),b(9,Bu,3,0,"button",18)(10,Wu,3,0),e(),t(11,"div",19),b(12,Mu,3,0,"button",18)(13,Fu,3,0),e()()(),t(14,"div",20),b(15,$u,17,0,"table",21)(16,Gu,1,0),e()}if(i&2){let o=h();l(6),T("ngModel",o.searchTerm),l(3),E(9,o.isExportInProgress?10:9),l(3),E(12,o.isExportInProgressExcel?13:12),l(3),E(15,o.filteredDistrictStats&&o.filteredDistrictStats.length>0?15:16)}}var Mo=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.router=n,this.route=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.districtStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment,this.card_name=n.card_name,this.fetchDistrictStats()})}fetchDistrictStats(){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?category=1&installment=${this.installment}&card_name=${this.card_name}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isStatsLoading=!1,this.districtStats=n.data},n=>{this.isStatsLoading=!1,this.districtStats=[]})}get filteredDistrictStats(){return this.searchTerm?this.districtStats.filter(n=>n.district_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.districtStats}exportToExcel(){this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?category=1&installment=${this.installment}&card_name=${this.card_name}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isExportInProgressExcel=!1;let r=n.data.map((I,R)=>({"SI#":R+1,DISTRICT:I.district_name.toUpperCase(),"APPLICATION RECEIVED":I?.nfsa_applications_received,"APPLICATION APPROVED":I?.nfsa_approved_application,"NFSA REJECTED":I?.nfsa_rejected_application})),c=N.json_to_sheet(r),f=N.book_new();N.book_append_sheet(f,c,"Applications");let d=Z(f,{bookType:"xlsx",type:"array"}),C=new Date,g=C.toLocaleDateString("en-GB").split("/").reverse().join("-"),_=C.toLocaleTimeString("en-GB").replace(/:/g,"-"),v=`nfsa_district_drilldown_reports_${g}_${_}.xlsx`,S=new Blob([d],{type:"application/octet-stream"}),w=document.createElement("a"),u=window.URL.createObjectURL(S);w.href=u,w.download=v,w.click(),window.URL.revokeObjectURL(u)},n=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",n)})}exportToPDF(){qe.default.vfs=Wo.default.pdfMake.vfs,this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?category=1&installment=${this.installment}&card_name=${this.card_name}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isExportInProgress=!1;let r=[[{text:"SI#",fontSize:10},{text:"DISTRICT",fontSize:10},{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"NFSA REJECTED",fontSize:10}]];n.data.forEach((S,w)=>{r.push([{text:(w+1).toString().toUpperCase(),fontSize:9},{text:(S.district_name||"").toUpperCase(),fontSize:9},{text:S?.nfsa_applications_received,fontSize:9},{text:S?.nfsa_approved_application,fontSize:9},{text:S?.nfsa_rejected_application,fontSize:9}])});let c=new Date,f=`Timestamp: ${c.toLocaleDateString()}, ${c.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,d={pageOrientation:"landscape",pageSize:"A4",content:[{text:"DRILL-DOWN REPORT - NFSA DISTRICT-WISE",style:"header"},{table:{headerRows:1,body:r,widths:["20%","20%","20%","20%","20%"]},layout:{fillColor:function(S){return S===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:f,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},C=new Date,g=C.toLocaleDateString("en-GB").split("/").reverse().join("-"),_=C.toLocaleTimeString("en-GB").replace(/:/g,"-"),v=`nfsa_district_drilldown_reports_${g}_${_}.pdf`;qe.default.createPdf(d).download(v)},n=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",n)})}};s.\u0275fac=function(r){return new(r||s)(x(G),x(tt),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-nfsa-district-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,Ou,2,0)(11,Xu,17,4),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var Je=j(ut()),Fo=j(ht());function Yu(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function Hu(i,s){if(i&1){let o=U();t(0,"button",25),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",26),a(2,"Download PDF "),e()}}function Ku(i,s){i&1&&(t(0,"button",27),m(1,"i",28),a(2,"Downloading "),e())}function qu(i,s){if(i&1){let o=U();t(0,"button",25),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",26),a(2,"Download EXCEL "),e()}}function Ju(i,s){i&1&&(t(0,"button",27),m(1,"i",28),a(2,"Downloading "),e())}var Qu=(i,s)=>s.id,Vo=i=>({installment:i});function Zu(i,s){if(i&1&&(t(0,"a",34),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit,n=h(3);Vt("routerLink","/department/portal/nfsa/gp-stats/",o.district_id,"/",o.block_id,""),T("queryParams",pt(6,Vo,n.installment)),l(1),p(P(2,4,o.block_name))}}function th(i,s){if(i&1&&(t(0,"a",34),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit,n=h(3);Vt("routerLink","/department/portal/nfsa/ward-stats/",o.district_id,"/",o.ulb_id,""),T("queryParams",pt(6,Vo,n.installment)),l(1),p(P(2,4,o.ulb_name))}}function eh(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td"),b(4,Zu,3,8,"a",33)(5,th,3,8),e(),t(6,"td"),a(7),e(),t(8,"td"),a(9),e(),t(10,"td"),a(11),e()()),i&2){let o=s.$implicit,n=s.$index;l(2),p(n+1),l(2),E(4,o.block_id?4:5),l(3),p(o==null?null:o.applications_received),l(2),p(o==null?null:o.approved_application),l(2),p(o==null?null:o.nfsa_rejected_application)}}function ih(i,s){if(i&1&&(t(0,"table",29)(1,"thead",30)(2,"tr")(3,"th",31),a(4,"Sl.#"),e(),t(5,"th",31),a(6,"BLOCK/ULB"),e()(),t(7,"tr")(8,"th"),a(9,"RECEIVED"),e(),t(10,"th"),a(11,"APPROVED"),e(),t(12,"th"),a(13,"NFSA REJECTED"),e()()(),t(14,"tbody",32),F(15,eh,12,5,"tr",null,Qu),e()()),i&2){let o=h(2);l(15),V(o.filteredBlockStats)}}function nh(i,s){i&1&&a(0," No Data Found ")}function oh(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - NFSA"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e()()()(),t(8,"div",16)(9,"div",17)(10,"input",18),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(11,"i",19),e(),t(12,"div",20),b(13,Hu,3,0,"button",21)(14,Ku,3,0),e(),t(15,"div",22),b(16,qu,3,0,"button",21)(17,Ju,3,0),e()()(),t(18,"div",23),b(19,ih,17,0,"table",24)(20,nh,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredBlockStats[0].district_name),l(3),T("ngModel",o.searchTerm),l(3),E(13,o.isExportInProgress?14:13),l(3),E(16,o.isExportInProgressExcel?17:16),l(3),E(19,o.filteredBlockStats&&o.filteredBlockStats.length>0?19:20)}}var zo=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.districtStats=[],this.district_id="",this.blockStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{let r=n.id;this.district_id=r,this.fetchblockStats(r)})}fetchblockStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/block-count?district_id=${n}&category=1&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.blockStats=r.data,this.fetchulbStats(n)},r=>{this.isStatsLoading=!1,this.blockStats=[]})}fetchulbStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/ulb-count?district_id=${n}&category=1&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.blockStats=[...this.blockStats,...r.data]},r=>{this.isStatsLoading=!1})}get filteredBlockStats(){return this.searchTerm?this.blockStats.filter(n=>n.block_name&&n.block_name.toLowerCase().includes(this.searchTerm.toLowerCase())||n.ulb_name&&n.ulb_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.blockStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.blockStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name,"BLOCK/ULB":(u.block_name||u.ulb_name).toUpperCase(),"APPLICATION RECEIVED":u?.applications_received,"APPLICATION APPROVED":u?.approved_application,"NFSA REJECTED":u?.nfsa_rejected_application})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`nfsa_block_ulb_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){Je.default.vfs=Fo.default.pdfMake.vfs,this.isExportInProgress=!0;let r=((this.blockStats[0]||{}).district_name||"N/A").toUpperCase(),c=[[{text:"SI#",fontSize:10},{text:"BLOCK/ULB",fontSize:10},{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"NFSA REJECTED",fontSize:10}]];this.blockStats.forEach((w,u)=>{c.push([{text:(u+1).toString().toUpperCase(),fontSize:9},{text:(w.block_name||w.ulb_name||"").toUpperCase(),fontSize:9},{text:w?.applications_received,fontSize:9},{text:w?.approved_application,fontSize:9},{text:w?.nfsa_rejected_application,fontSize:9}])});let f=new Date,d=`Timestamp: ${f.toLocaleDateString()}, ${f.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,C={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - NFSA BLOCK-ULB WISE",style:"header"},{table:{headerRows:1,body:c,widths:["20%","20%","20%","20%","20%"]},layout:{fillColor:function(w){return w===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:d,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},g=new Date,_=g.toLocaleDateString("en-GB").split("/").reverse().join("-"),v=g.toLocaleTimeString("en-GB").replace(/:/g,"-"),S=`nfsa_block_ulb_drilldown_reports_${_}_${v}.pdf`;Je.default.createPdf(C).download(S,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-nfsa-block-ulb-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],[2,"font-size","14px"],["style","text-decoration: none",3,"routerLink","queryParams"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,Yu,2,0)(11,oh,21,5),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var Qe=j(ut()),jo=j(ht());function ah(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function rh(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",27),a(2,"Download PDF "),e()}}function sh(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}function lh(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",27),a(2,"Download EXCEL "),e()}}function ch(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}var dh=(i,s)=>s.id,ph=i=>({installment:i});function mh(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",34),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e(),t(9,"td"),a(10),e(),t(11,"td"),a(12),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),Mt("routerLink","/department/portal/nfsa/village-stats/",o.district_id,"/",o.block_id,"/",o.gp_id,""),T("queryParams",pt(11,ph,r.installment)),l(1),p(P(6,9,o.gp_name)),l(3),p(o==null?null:o.applications_received),l(2),p(o==null?null:o.approved_application),l(2),p(o==null?null:o.nfsa_rejected_application)}}function _h(i,s){if(i&1&&(t(0,"table",30)(1,"thead",31)(2,"tr")(3,"th",32),a(4,"Sl.#"),e(),t(5,"th",32),a(6,"GRAM PANCHAYAT"),e()(),t(7,"tr")(8,"th"),a(9,"RECEIVED"),e(),t(10,"th"),a(11,"APPROVED"),e(),t(12,"th"),a(13,"NFSA REJECTED"),e()()(),t(14,"tbody",33),F(15,mh,13,13,"tr",null,dh),e()()),i&2){let o=h(2);l(15),V(o.filteredGpStats)}}function fh(i,s){i&1&&a(0," No Data Found ")}function uh(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - NFSA"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e(),t(8,"li",16),a(9),e()()()(),t(10,"div",17)(11,"div",18)(12,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(13,"i",20),e(),t(14,"div",21),b(15,rh,3,0,"button",22)(16,sh,3,0),e(),t(17,"div",23),b(18,lh,3,0,"button",22)(19,ch,3,0),e()()(),t(20,"div",24),b(21,_h,17,0,"table",25)(22,fh,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredGpStats[0].district_name),l(2),p(o.filteredGpStats[0].block_name),l(3),T("ngModel",o.searchTerm),l(3),E(15,o.isExportInProgress?16:15),l(3),E(18,o.isExportInProgressExcel?19:18),l(3),E(21,o.filteredGpStats&&o.filteredGpStats.length>0?21:22)}}var $o=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.district_id="",this.gpStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.id,this.fetchgpStats(this.block_id)})}fetchgpStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/gp-count?block_id=${n}&category=1&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.gpStats=r.data},r=>{this.isStatsLoading=!1,this.gpStats=[]})}get filteredGpStats(){return this.searchTerm?this.gpStats.filter(n=>n.gp_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.gpStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.gpStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",BLOCK:u.block_name?u.block_name.toUpperCase():"",GP:u.gp_name?u.gp_name.toUpperCase():"","APPLICATION RECEIVED":u?.applications_received,"APPLICATION APPROVED":u?.approved_application,"NFSA REJECTED":u?.nfsa_rejected_application})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`nfsa_gp_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){Qe.default.vfs=jo.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.gpStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=[[{text:"SI#",fontSize:10},{text:"GP",fontSize:10},{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"NFSA REJECTED",fontSize:10}]];this.gpStats.forEach((u,I)=>{f.push([{text:(I+1).toString().toUpperCase(),fontSize:9},{text:(u.gp_name||"").toUpperCase(),fontSize:9},{text:u?.applications_received,fontSize:9},{text:u?.approved_application,fontSize:9},{text:u?.nfsa_rejected_application,fontSize:9}])});let d=new Date,C=`Timestamp: ${d.toLocaleDateString()}, ${d.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,g={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK: ${c}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - NFSA GP WISE",style:"header"},{table:{headerRows:1,body:f,widths:["20%","20%","20%","20%","20%"]},layout:{fillColor:function(u){return u===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:C,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},_=new Date,v=_.toLocaleDateString("en-GB").split("/").reverse().join("-"),S=_.toLocaleTimeString("en-GB").replace(/:/g,"-"),w=`nfsa_gp_drilldown_reports_${v}_${S}.pdf`;Qe.default.createPdf(g).download(w,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-nfsa-gp-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,ah,2,0)(11,uh,23,6),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var Ze=j(ut()),Go=j(ht());function hh(i,s){if(i&1&&(t(0,"div",31)(1,"div",32)(2,"nav",33)(3,"ol",34)(4,"li",35),a(5),e(),t(6,"li",35),a(7),e(),t(8,"li",36),a(9),e()()()()()),i&2){let o=h();l(5),p(o.filteredWardUserStats[0].district_name),l(2),p(o.filteredWardUserStats[0].ulb_name),l(2),p(o.filteredWardUserStats[0].ward_no)}}function Sh(i,s){i&1&&(t(0,"button",37),m(1,"i",38),a(2,"Search "),e())}function xh(i,s){i&1&&(t(0,"button",39),m(1,"i",40),a(2," Searching ..."),e())}function gh(i,s){i&1&&(m(0,"i",41),a(1," We are fetching the data, please wait. "))}function Ch(i,s){if(i&1){let o=U();t(0,"button",55),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",56),a(2,"Download to PDF "),e()}}function bh(i,s){i&1&&(t(0,"button",57),m(1,"i",40),a(2,"Downloading "),e())}function vh(i,s){if(i&1){let o=U();t(0,"button",55),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",56),a(2,"Download to EXCEL "),e()}}function Eh(i,s){i&1&&(t(0,"button",57),m(1,"i",40),a(2,"Downloading "),e())}var wh=(i,s)=>s.id;function Th(i,s){if(i&1&&(t(0,"td"),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit;l(1),p(P(2,1,o.ward_no))}}function Lh(i,s){i&1&&m(0,"td")}function Ih(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),b(3,Th,3,3,"td")(4,Lh,1,0),t(5,"td"),a(6),k(7,"uppercase"),e(),t(8,"td"),a(9),k(10,"uppercase"),e(),t(11,"td"),a(12),k(13,"uppercase"),e(),t(14,"td"),a(15),k(16,"uppercase"),e(),t(17,"td"),a(18),k(19,"uppercase"),e(),t(20,"td"),a(21),k(22,"uppercase"),e(),t(23,"td"),a(24),k(25,"uppercase"),e(),t(26,"td"),a(27),e(),t(28,"td"),a(29),k(30,"uppercase"),e(),t(31,"td"),a(32),k(33,"uppercase"),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(1),E(3,o.ward_no?3:4),l(3),p(P(7,12,o.category)),l(3),p(P(10,14,o.application_number)),l(3),p(P(13,16,r.appService.dateFormat(o.application_date))),l(3),p(P(16,18,o.applicant_name)),l(3),p(P(19,20,o.spouse_or_father_name)),l(3),p(P(22,22,o.social_category)),l(3),p(P(25,24,o.pwd_status)),l(3),p(o.alt_mobile_number),l(2),p(P(30,26,o.application_status)),l(3),p(P(33,28,o.payment_status))}}function yh(i,s){if(i&1&&(t(0,"table",58)(1,"thead",59)(2,"tr")(3,"th"),a(4,"SI#"),e(),t(5,"th"),a(6,"WARD NO."),e(),t(7,"th"),a(8,"CATEGORY"),e(),t(9,"th"),a(10,"APPLICATION NO."),e(),t(11,"th"),a(12,"APPLICATION DATE"),e(),t(13,"th"),a(14,"APPLICANT NAME"),e(),t(15,"th"),a(16,"FATHER/HUSBAND NAME"),e(),t(17,"th"),a(18,"SOCIAL CATEGORY"),e(),t(19,"th"),a(20,"PWD"),e(),t(21,"th"),a(22,"MOBILE NO."),e(),t(23,"th"),a(24,"APPLICATION STATUS"),e(),t(25,"th"),a(26,"PAYMENT STATUS"),e()()(),t(27,"tbody"),F(28,Ih,34,30,"tr",null,wh),e()()),i&2){let o=h(2);l(28),V(o.filteredWardUserStats)}}function kh(i,s){i&1&&(t(0,"h5",60),a(1,"No data available"),e())}function Ph(i,s){i&1&&(t(0,"div",61),a(1,"Loading.. "),m(2,"i",62),e())}function Dh(i,s){i&1&&(t(0,"span"),m(1,"i",41),a(2," Loading..."),e())}function Ah(i,s){i&1&&(t(0,"span"),a(1,"Load More"),e())}function Uh(i,s){if(i&1){let o=U();t(0,"div",63)(1,"button",64),L("click",function(){D(o);let r=h(2);return A(r.loadMore())}),b(2,Dh,3,0,"span",65)(3,Ah,2,0,"span",65),e()()}if(i&2){let o=h(2);l(2),T("ngIf",o.isLoadMoreInProgress),l(1),T("ngIf",!o.isLoadMoreInProgress)}}function Nh(i,s){if(i&1){let o=U();t(0,"div",31)(1,"div",42)(2,"h5",2),a(3," Number of records found : "),t(4,"span",43),a(5),e()()(),t(6,"div",44)(7,"div",45)(8,"input",46),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(9,"i",47),e(),t(10,"div",48),b(11,Ch,3,0,"button",49)(12,bh,3,0),e(),t(13,"div",50),b(14,vh,3,0,"button",49)(15,Eh,3,0),e()()(),t(16,"div",51),b(17,yh,30,0,"table",52)(18,kh,2,0)(19,Ph,3,0,"div",53),e(),b(20,Uh,4,2,"div",54)}if(i&2){let o=h();l(5),p(o.count),l(3),T("ngModel",o.searchTerm),l(3),E(11,o.isExportInProgress?12:11),l(3),E(14,o.isExportInProgressExcel?15:14),l(3),E(17,o.filteredWardUserStats&&o.filteredWardUserStats.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),l(2),E(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),l(1),T("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var Xo=(()=>{let s=class s{constructor(n,r,c,f,d,C,g,_){this.route=n,this.router=r,this.formService=c,this.appService=f,this.httpClient=d,this.toastService=C,this.authService=g,this.masterDataService=_,this.isStatsLoading=!1,this.userStats=[],this.ulb_id="",this.ward_id="",this.village_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.limit=this.appService.loadmorelimit,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.count=0,this.searchForm=new kt({a_category:new nt(""),social_category:new nt(""),pwd_status:new nt(""),submit_date:new nt(""),a_status:new nt("")})}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.ulb_id=n.ulb_id,this.ward_id=n.id,this.fetchuserStats(this.ward_id)})}fetchuserStats(n,r=!1){this.isStatsLoading=!0;let c=new st;c=c.set("ward_id",n),c=c.set("offset",this.offset),c=c.set("limit",this.limit),c=c.set("category","1"),c=c.set("installment",this.installment);let f=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:c,headers:f}).subscribe(d=>{this.isStatsLoading=!1,this.count=d.count,d.data&&d.data.length>0?(this.application_list=this.application_list.concat(d.data),this.offset+=d.data.length,this.hasMoreRecords=d.data.length===this.limit):this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)},d=>{this.isStatsLoading=!1,this.application_list=[],this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)})}get filteredWardUserStats(){if(!this.searchTerm)return this.application_list;let n=this.searchTerm.toLowerCase();return this.application_list.filter(r=>r.ward_no?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.category?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.application_number?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_date).toLowerCase().includes(this.searchTerm.toLowerCase())||r.applicant_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.spouse_or_father_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.dob).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.social_category).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.pwd_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.alt_mobile_number).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.payment_status).toLowerCase().includes(this.searchTerm.toLowerCase()))}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status,_=new st;r&&(_=_.set("ward_id",r)),f&&(_=_.set("social_category",f)),d&&(_=_.set("pwd_status",d)),g&&(_=_.set("application_status",g)),_=_.set("offset",this.offset),_=_.set("limit",this.limit),_=_.set("category","1"),_=_.set("installment",this.installment);let v=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:_,headers:v}).subscribe(S=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=S.count,S.data&&S.data.length>0?(this.application_list=this.application_list.concat(S.data),this.offset+=S.data.length,this.hasMoreRecords=S.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},S=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}exportToExcel(){let n=new st,r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;r&&(n=n.set("ward_id",r)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),g&&(n=n.set("application_status",g)),n=n.set("export_all","1"),n=n.set("category","1"),n=n.set("installment",this.installment);let _=new rt({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgressExcel=!1;let S=v.data.map((y,B)=>({"SI#":B+1,DISTRICT:y.district_name?y.district_name.toUpperCase():"",ULB:y.ulb_name?y.ulb_name.toUpperCase():"","WARD NO.":y.ward_no?y.ward_no.toUpperCase():"",CATEGORY:y.category.toUpperCase(),"APPLICATION NO.":y.application_number.toUpperCase(),"APPLICATION DATE":this.appService.dateFormat(y.application_date),"APPLICANT NAME":y.applicant_name.toUpperCase(),"FATHER/HUSBAND NAME":y.spouse_or_father_name.toUpperCase(),"SOCIAL CATEGORY":y.social_category.toUpperCase(),PWD:y.pwd_status.toUpperCase(),"MOBILE NO.":y.alt_mobile_number,"APPLICATION STATUS":y.application_status.toUpperCase(),"PAYMENT STATUS":y.payment_status.toUpperCase()})),w=N.json_to_sheet(S),u=N.book_new();N.book_append_sheet(u,w,"Applications");let I=Z(u,{bookType:"xlsx",type:"array"}),R=new Date,z=R.toLocaleDateString("en-GB").split("/").reverse().join("-"),at=R.toLocaleTimeString("en-GB").replace(/:/g,"-"),ct=`nfsa_reports_${z}_${at}.xlsx`,lt=new Blob([I],{type:"application/octet-stream"}),O=document.createElement("a"),et=window.URL.createObjectURL(lt);O.href=et,O.download=ct,O.click(),window.URL.revokeObjectURL(et)},v=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",v)})}exportToPDF(){Ze.default.vfs=Go.default.pdfMake.vfs;let n=new st,r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;r&&(n=n.set("ward_id",r)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),g&&(n=n.set("application_status",g)),n=n.set("export_all","1"),n=n.set("category","1"),n=n.set("installment",this.installment);let _=new rt({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgress=!1;let S=v.data[0]||{},w=(S.district_name||"N/A").toUpperCase(),u=(S.block_name||S.ulb_name||"N/A").toUpperCase(),I=(S.gp_name||S.ward_no||"N/A").toUpperCase(),R=[[{text:"SI#",fontSize:10},{text:"CATEGORY",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICATION DATE.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"SOCIAL CATEGORY",fontSize:10},{text:"PWD",fontSize:10},{text:"MOBILE NO",fontSize:10},{text:"APPLICATION STATUS",fontSize:10},{text:"PAYMENT STATUS",fontSize:10}]];v.data.forEach((B,W)=>{R.push([{text:(W+1).toString().toUpperCase(),fontSize:9},{text:(B.category||"").toUpperCase(),fontSize:9},{text:(B.application_number||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(B.application_date)||"",fontSize:9},{text:(B.applicant_name||"").toUpperCase(),fontSize:9},{text:(B.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:(B.social_category||"").toUpperCase(),fontSize:9},{text:(B.pwd_status||"").toUpperCase(),fontSize:9},{text:(B.alt_mobile_number||"").toUpperCase(),fontSize:9},{text:(B.application_status||"").toUpperCase(),fontSize:9},{text:(B.payment_status||"").toUpperCase(),fontSize:9}])});let z=new Date,at=`Timestamp: ${z.toLocaleDateString()}, ${z.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,ct={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${w} > ULB: ${u} > WARD: ${I}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DETAILED REPORT - NFSA",style:"header"},{table:{headerRows:1,body:R,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]},layout:{fillColor:function(B){return B===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:at,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},lt=new Date,O=lt.toLocaleDateString("en-GB").split("/").reverse().join("-"),et=lt.toLocaleTimeString("en-GB").replace(/:/g,"-"),y=`nfsa_reports_${O}_${et}.pdf`;Ze.default.createPdf(ct).download(y)},v=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",v)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(Ot),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-nfsa-ward-user-list"]],decls:58,vars:4,consts:[[1,"container-fluid","drilldown-reports"],[1,"d-flex","justify-content-between","w-100","mb-3"],[1,"card-title"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],["class","row mb-2"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-2"],[1,"col-md-4"],["for","social_category",1,"fw-bold"],["formControlName","social_category","id","social_category",1,"form-select","my-2"],["value",""],["value","1"],["value","2"],["value","3"],["value","4"],["for","a_status",1,"fw-bold"],["formControlName","a_status","id","a_status",1,"form-select","my-2"],["value","7"],["for","pwd_status",1,"fw-bold"],["formControlName","pwd_status","id","pwd_status",1,"form-select","my-2"],["value","0"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[1,"row","mb-2"],[1,"col-md-7"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"fa","fa-spinner","fa-spin"],[1,"col-md-5"],["id","recordCount"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports detail"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports","detail"],[1,"text-light",2,"background-color","#fd7b03"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"],[4,"ngIf"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1)(2,"h4",2),a(3,"Detailed Report - NFSA"),e(),t(4,"div",3)(5,"a",4),L("click",function(){return c.appService.goBack()}),t(6,"button",5),m(7,"i",6),a(8," Back"),e()()()(),b(9,hh,10,3,"div",7),t(10,"div",8)(11,"form",9),L("ngSubmit",function(){return c.onSearch()}),t(12,"div",10)(13,"div",11)(14,"label",12),a(15," Social Category "),e(),t(16,"select",13)(17,"option",14),a(18,"Choose Social Category"),e(),t(19,"option",15),a(20,"Un-Reserved"),e(),t(21,"option",16),a(22,"OBC"),e(),t(23,"option",17),a(24,"SC"),e(),t(25,"option",18),a(26,"ST"),e()()(),t(27,"div",11)(28,"label",19),a(29," Application Status "),e(),t(30,"select",20)(31,"option",14),a(32,"Choose Status"),e(),t(33,"option",21),a(34,"Under Process"),e(),t(35,"option",15),a(36,"Approved"),e(),t(37,"option",16),a(38,"Rejected"),e()()(),t(39,"div",11)(40,"label",22),a(41," PWD "),e(),t(42,"select",23)(43,"option",14),a(44,"Choose PWD Status"),e(),t(45,"option",15),a(46,"Yes "),e(),t(47,"option",24),a(48,"NO"),e()()()(),t(49,"div",25)(50,"div",26),b(51,Sh,3,0,"button",27)(52,xh,3,0),e()()()(),t(53,"div",28)(54,"div",29)(55,"div",30),b(56,gh,2,0)(57,Nh,21,7),e()()()()),r&2&&(l(9),E(9,c.filteredWardUserStats&&c.filteredWardUserStats.length>0?9:-1),l(2),T("formGroup",c.searchForm),l(40),E(51,c.isFormSearchInProgress?52:51),l(5),E(56,c.isStatsLoading?56:57))},dependencies:[ft,Pt,Nt,Rt,K,Ut,q,yt,J,Dt,At,it]});let i=s;return i})();var ti=j(ut()),Yo=j(ht());function Rh(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function Oh(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",27),a(2,"Download PDF "),e()}}function Bh(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}function Wh(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",27),a(2,"Download EXCEL "),e()}}function Mh(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}var Fh=(i,s)=>s.id,Vh=i=>({installment:i});function zh(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",34),a(5),e()(),t(6,"td"),a(7),e(),t(8,"td"),a(9),e(),t(10,"td"),a(11),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),Mt("routerLink","/department/portal/nfsa/ward-user-list/",o.district_id,"/",o.ulb_id,"/",o.ward_id,""),T("queryParams",pt(9,Vh,r.installment)),l(1),p(o.ward_no),l(2),p(o==null?null:o.applications_received),l(2),p(o==null?null:o.approved_application),l(2),p(o==null?null:o.nfsa_rejected_application)}}function jh(i,s){if(i&1&&(t(0,"table",30)(1,"thead",31)(2,"tr")(3,"th",32),a(4,"Sl.#"),e(),t(5,"th",32),a(6,"WARD"),e()(),t(7,"tr")(8,"th"),a(9,"RECEIVED"),e(),t(10,"th"),a(11,"APPROVED"),e(),t(12,"th"),a(13,"NFSA REJECTED"),e()()(),t(14,"tbody",33),F(15,zh,12,11,"tr",null,Fh),e()()),i&2){let o=h(2);l(15),V(o.filteredWardStats)}}function $h(i,s){i&1&&a(0," No Data Found ")}function Gh(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - NFSA"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e(),t(8,"li",16),a(9),e()()()(),t(10,"div",17)(11,"div",18)(12,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(13,"i",20),e(),t(14,"div",21),b(15,Oh,3,0,"button",22)(16,Bh,3,0),e(),t(17,"div",23),b(18,Wh,3,0,"button",22)(19,Mh,3,0),e()()(),t(20,"div",24),b(21,jh,17,0,"table",25)(22,$h,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredWardStats[0].district_name),l(2),p(o.filteredWardStats[0].ulb_name),l(3),T("ngModel",o.searchTerm),l(3),E(15,o.isExportInProgress?16:15),l(3),E(18,o.isExportInProgressExcel?19:18),l(3),E(21,o.filteredWardStats&&o.filteredWardStats.length>0?21:22)}}var Ho=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.district_id="",this.wardStats=[],this.ulb_id="",this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.ulb_id=n.id,this.fetchWardStats(this.ulb_id)})}fetchWardStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/ward-count?ulb_id=${n}&category=1&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.wardStats=r.data},r=>{this.isStatsLoading=!1,this.wardStats=[]})}get filteredWardStats(){return this.searchTerm?this.wardStats.filter(n=>n.ward_no.toLowerCase().includes(this.searchTerm.toLowerCase())):this.wardStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.wardStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",ULB:u.ulb_name?u.ulb_name.toUpperCase():"","WARD NO.":u.ward_no?u.ward_no.toUpperCase():"","APPLICATION RECEIVED":u?.applications_received,"APPLICATION APPROVED":u?.approved_application,"NFSA REJECTED":u?.nfsa_rejected_application})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`nfsa_ward_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){ti.default.vfs=Yo.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.wardStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=[[{text:"SI#",fontSize:10},{text:"WARD NO.",fontSize:10},{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"NFSA REJECTED",fontSize:10}]];this.wardStats.forEach((u,I)=>{f.push([{text:(I+1).toString().toUpperCase(),fontSize:9},{text:(u.ward_no||"").toUpperCase(),fontSize:9},{text:u?.applications_received,fontSize:9},{text:u?.approved_application,fontSize:9},{text:u?.nfsa_rejected_application,fontSize:9}])});let d=new Date,C=`Timestamp: ${d.toLocaleDateString()}, ${d.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,g={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK/ULB: ${c}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - NFSA WARD WISE",style:"header"},{table:{headerRows:1,body:f,widths:["20%","20%","20%","20%","20%"]},layout:{fillColor:function(u){return u===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:C,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},_=new Date,v=_.toLocaleDateString("en-GB").split("/").reverse().join("-"),S=_.toLocaleTimeString("en-GB").replace(/:/g,"-"),w=`nfsa_ward_drilldown_reports_${v}_${S}.pdf`;ti.default.createPdf(g).download(w,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-nfsa-ward-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,Rh,2,0)(11,Gh,23,6),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J]});let i=s;return i})();var ei=j(ut()),Ko=j(ht());function Xh(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function Yh(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",27),a(2,"Download PDF "),e()}}function Hh(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}function Kh(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",27),a(2,"Download EXCEL "),e()}}function qh(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}var Jh=(i,s)=>s.id,Qh=i=>({installment:i});function Zh(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",34),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e(),t(9,"td"),a(10),e(),t(11,"td"),a(12),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),Gt("routerLink","/department/portal/nfsa/village-user-list/",o.district_id,"/",o.block_id,"/",o.gp_id,"/",o.village_id,""),T("queryParams",pt(12,Qh,r.installment)),l(1),p(P(6,10,o.village_name)),l(3),p(o==null?null:o.applications_received),l(2),p(o==null?null:o.approved_application),l(2),p(o==null?null:o.nfsa_rejected_application)}}function tS(i,s){if(i&1&&(t(0,"table",30)(1,"thead",31)(2,"tr")(3,"th",32),a(4,"Sl.#"),e(),t(5,"th",32),a(6,"VILLAGE"),e()(),t(7,"tr")(8,"th"),a(9,"RECEIVED"),e(),t(10,"th"),a(11,"APPROVED"),e(),t(12,"th"),a(13,"NFSA REJECTED"),e()()(),t(14,"tbody",33),F(15,Zh,13,14,"tr",null,Jh),e()()),i&2){let o=h(2);l(15),V(o.filteredVillageStats)}}function eS(i,s){i&1&&a(0," No Data Found ")}function iS(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - NFSA"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e(),t(8,"li",15),a(9),e(),t(10,"li",16),a(11),e()()()(),t(12,"div",17)(13,"div",18)(14,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(15,"i",20),e(),t(16,"div",21),b(17,Yh,3,0,"button",22)(18,Hh,3,0),e(),t(19,"div",23),b(20,Kh,3,0,"button",22)(21,qh,3,0),e()()(),t(22,"div",24),b(23,tS,17,0,"table",25)(24,eS,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredVillageStats[0].district_name),l(2),p(o.filteredVillageStats[0].block_name),l(2),p(o.filteredVillageStats[0].gp_name),l(3),T("ngModel",o.searchTerm),l(3),E(17,o.isExportInProgress?18:17),l(3),E(20,o.isExportInProgressExcel?21:20),l(3),E(23,o.filteredVillageStats&&o.filteredVillageStats.length>0?23:24)}}var qo=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.gp_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.block_id,this.gp_id=n.id,this.fetchvillageStats(this.gp_id)})}fetchvillageStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/village-count?gp_id=${n}&category=1&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.villageStats=r.data},r=>{this.isStatsLoading=!1,this.villageStats=[]})}get filteredVillageStats(){return this.searchTerm?this.villageStats.filter(n=>n.village_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.villageStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.villageStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",BLOCK:u.block_name?u.block_name.toUpperCase():"",GP:u.gp_name?u.gp_name.toUpperCase():"",VILLAGE:u.village_name?u.village_name.toUpperCase():"","APPLICATION RECEIVED":u?.applications_received,"APPLICATION APPROVED":u?.approved_application,"NFSA REJECTED":u?.nfsa_rejected_application})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`nfsa_village_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){ei.default.vfs=Ko.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.villageStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=(n.gp_name||n.ward_no||"N/A").toUpperCase(),d=[[{text:"SI#",fontSize:10},{text:"VILLAGE",fontSize:10},{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"NFSA REJECTED",fontSize:10}]];this.villageStats.forEach((I,R)=>{d.push([{text:(R+1).toString().toUpperCase(),fontSize:9},{text:(I.village_name||"").toUpperCase(),fontSize:9},{text:I?.applications_received,fontSize:9},{text:I?.approved_application,fontSize:9},{text:I?.nfsa_rejected_application,fontSize:9}])});let C=new Date,g=`Timestamp: ${C.toLocaleDateString()}, ${C.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,_={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK: ${c} > GP:${f}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - NFSA VILLAGE WISE",style:"header"},{table:{headerRows:1,body:d,widths:["20%","20%","20%","20%","20%"]},layout:{fillColor:function(I){return I===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:g,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},v=new Date,S=v.toLocaleDateString("en-GB").split("/").reverse().join("-"),w=v.toLocaleTimeString("en-GB").replace(/:/g,"-"),u=`nfsa_village_drilldown_reports_${S}_${w}.pdf`;ei.default.createPdf(_).download(u,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-nfsa-village-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,Xh,2,0)(11,iS,25,7),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var ii=j(ut()),Jo=j(ht());function nS(i,s){if(i&1&&(t(0,"div",31)(1,"div",32)(2,"nav",33)(3,"ol",34)(4,"li",35),a(5),e(),t(6,"li",35),a(7),e(),t(8,"li",35),a(9),e(),t(10,"li",36),a(11),e()()()()()),i&2){let o=h();l(5),p(o.filteredVillageUserStats[0].district_name),l(2),p(o.filteredVillageUserStats[0].block_name),l(2),p(o.filteredVillageUserStats[0].gp_name),l(2),p(o.filteredVillageUserStats[0].village_name)}}function oS(i,s){i&1&&(t(0,"button",37),m(1,"i",38),a(2,"Search "),e())}function aS(i,s){i&1&&(t(0,"button",39),m(1,"i",40),a(2," Searching ..."),e())}function rS(i,s){i&1&&(m(0,"i",41),a(1," We are fetching the data, please wait. "))}function sS(i,s){if(i&1){let o=U();t(0,"button",55),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",56),a(2,"Download to PDF "),e()}}function lS(i,s){i&1&&(t(0,"button",57),m(1,"i",40),a(2,"Downloading "),e())}function cS(i,s){if(i&1){let o=U();t(0,"button",55),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",56),a(2,"Download to EXCEL "),e()}}function dS(i,s){i&1&&(t(0,"button",57),m(1,"i",40),a(2,"Downloading "),e())}var pS=(i,s)=>s.id;function mS(i,s){if(i&1&&(t(0,"td"),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit;l(1),p(P(2,1,o.village_name))}}function _S(i,s){i&1&&m(0,"td")}function fS(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),b(3,mS,3,3,"td")(4,_S,1,0),t(5,"td"),a(6),k(7,"uppercase"),e(),t(8,"td"),a(9),k(10,"uppercase"),e(),t(11,"td"),a(12),k(13,"uppercase"),e(),t(14,"td"),a(15),k(16,"uppercase"),e(),t(17,"td"),a(18),k(19,"uppercase"),e(),t(20,"td"),a(21),k(22,"uppercase"),e(),t(23,"td"),a(24),k(25,"uppercase"),e(),t(26,"td"),a(27),e(),t(28,"td"),a(29),k(30,"uppercase"),e(),t(31,"td"),a(32),k(33,"uppercase"),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(1),E(3,o.village_name?3:4),l(3),p(P(7,12,o.category)),l(3),p(P(10,14,o.application_number)),l(3),p(P(13,16,r.appService.dateFormat(o.application_date))),l(3),p(P(16,18,o.applicant_name)),l(3),p(P(19,20,o.spouse_or_father_name)),l(3),p(P(22,22,o.social_category)),l(3),p(P(25,24,o.pwd_status)),l(3),p(o.alt_mobile_number),l(2),p(P(30,26,o.application_status)),l(3),p(P(33,28,o.payment_status))}}function uS(i,s){if(i&1&&(t(0,"table",58)(1,"thead",59)(2,"tr")(3,"th"),a(4,"SI#"),e(),t(5,"th"),a(6,"VILLAGE"),e(),t(7,"th"),a(8,"CATEGORY"),e(),t(9,"th"),a(10,"APPLICATION NO."),e(),t(11,"th"),a(12,"APPLICATION DATE"),e(),t(13,"th"),a(14,"APPLICANT NAME"),e(),t(15,"th"),a(16,"FATHER/HUSBAND NAME"),e(),t(17,"th"),a(18,"SOCIAL CATEGORY"),e(),t(19,"th"),a(20,"PWD"),e(),t(21,"th"),a(22,"MOBILE NO."),e(),t(23,"th"),a(24,"APPLICATION STATUS"),e(),t(25,"th"),a(26,"PAYMENT STATUS"),e()()(),t(27,"tbody"),F(28,fS,34,30,"tr",null,pS),e()()),i&2){let o=h(2);l(28),V(o.filteredVillageUserStats)}}function hS(i,s){i&1&&(t(0,"h5",60),a(1,"No data available"),e())}function SS(i,s){i&1&&(t(0,"div",61),a(1,"Loading.. "),m(2,"i",62),e())}function xS(i,s){i&1&&(t(0,"span"),m(1,"i",41),a(2," Loading..."),e())}function gS(i,s){i&1&&(t(0,"span"),a(1,"Load More"),e())}function CS(i,s){if(i&1){let o=U();t(0,"div",63)(1,"button",64),L("click",function(){D(o);let r=h(2);return A(r.loadMore())}),b(2,xS,3,0,"span",65)(3,gS,2,0,"span",65),e()()}if(i&2){let o=h(2);l(2),T("ngIf",o.isLoadMoreInProgress),l(1),T("ngIf",!o.isLoadMoreInProgress)}}function bS(i,s){if(i&1){let o=U();t(0,"div",31)(1,"div",42)(2,"h5",2),a(3," Number of records found : "),t(4,"span",43),a(5),e()()(),t(6,"div",44)(7,"div",45)(8,"input",46),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(9,"i",47),e(),t(10,"div",48),b(11,sS,3,0,"button",49)(12,lS,3,0),e(),t(13,"div",50),b(14,cS,3,0,"button",49)(15,dS,3,0),e()()(),t(16,"div",51),b(17,uS,30,0,"table",52)(18,hS,2,0)(19,SS,3,0,"div",53),e(),b(20,CS,4,2,"div",54)}if(i&2){let o=h();l(5),p(o.count),l(3),T("ngModel",o.searchTerm),l(3),E(11,o.isExportInProgress?12:11),l(3),E(14,o.isExportInProgressExcel?15:14),l(3),E(17,o.filteredVillageUserStats&&o.filteredVillageUserStats.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),l(2),E(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),l(1),T("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var Qo=(()=>{let s=class s{constructor(n,r,c,f,d,C,g,_){this.route=n,this.router=r,this.formService=c,this.appService=f,this.httpClient=d,this.toastService=C,this.authService=g,this.masterDataService=_,this.isStatsLoading=!1,this.userStats=[],this.block_id="",this.gp_id="",this.village_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.limit=this.appService.loadmorelimit,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.count=0,this.searchForm=new kt({a_category:new nt(""),social_category:new nt(""),pwd_status:new nt(""),submit_date:new nt(""),a_status:new nt("")})}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.block_id,this.gp_id=n.gp_id,this.village_id=n.id,this.fetchuserStats(this.village_id)})}fetchuserStats(n,r=!1){this.isStatsLoading=!0;let c=new st;c=c.set("gp_id",this.gp_id),c=c.set("village_id",n),c=c.set("offset",this.offset),c=c.set("limit",this.limit),c=c.set("category","1"),c=c.set("installment",this.installment);let f=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:c,headers:f}).subscribe(d=>{this.isStatsLoading=!1,this.count=d.count,d.data&&d.data.length>0?(this.application_list=this.application_list.concat(d.data),this.offset+=d.data.length,this.hasMoreRecords=d.data.length===this.limit):this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)},d=>{this.isStatsLoading=!1,this.application_list=[],this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)})}get filteredVillageUserStats(){if(!this.searchTerm)return this.application_list;let n=this.searchTerm.toLowerCase();return this.application_list.filter(r=>r.village_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.category?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.application_number?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_date).toLowerCase().includes(this.searchTerm.toLowerCase())||r.applicant_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.spouse_or_father_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.dob).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.social_category).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.pwd_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.alt_mobile_number).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.payment_status).toLowerCase().includes(this.searchTerm.toLowerCase()))}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status,_=new st;_=_.set("gp_id",this.gp_id),r&&(_=_.set("village_id",r)),g&&(_=_.set("application_status",g)),f&&(_=_.set("social_category",f)),d&&(_=_.set("pwd_status",d)),_=_.set("offset",this.offset),_=_.set("limit",this.limit),_=_.set("category","1"),_=_.set("installment",this.installment);let v=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:_,headers:v}).subscribe(S=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=S.count,S.data&&S.data.length>0?(this.application_list=this.application_list.concat(S.data),this.offset+=S.data.length,this.hasMoreRecords=S.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},S=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}exportToExcel(){let n=new st,r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;n=n.set("gp_id",this.gp_id),r&&(n=n.set("village_id",r)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),g&&(n=n.set("application_status",g)),n=n.set("export_all","1"),n=n.set("category","1"),n=n.set("installment",this.installment);let _=new rt({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgressExcel=!1;let S=v.data.map((y,B)=>({"SI#":B+1,DISTRICT:y.district_name?y.district_name.toUpperCase():"",BLOCK:y.block_name?y.block_name.toUpperCase():"",GP:y.gp_name?y.gp_name.toUpperCase():"",VILLAGE:y.village_name?y.village_name.toUpperCase():"",CATEGORY:y.category.toUpperCase(),"APPLICATION NO.":y.application_number.toUpperCase(),"APPLICATION DATE":this.appService.dateFormat(y.application_date),"APPLICANT NAME":y.applicant_name.toUpperCase(),"FATHER/HUSBAND NAME":y.spouse_or_father_name.toUpperCase(),"SOCIAL CATEGORY":y.social_category.toUpperCase(),PWD:y.pwd_status.toUpperCase(),"MOBILE NO.":y.alt_mobile_number,"APPLICATION STATUS":y.application_status.toUpperCase(),"PAYMENT STATUS":y.payment_status.toUpperCase()})),w=N.json_to_sheet(S),u=N.book_new();N.book_append_sheet(u,w,"Applications");let I=Z(u,{bookType:"xlsx",type:"array"}),R=new Date,z=R.toLocaleDateString("en-GB").split("/").reverse().join("-"),at=R.toLocaleTimeString("en-GB").replace(/:/g,"-"),ct=`nfsa__reports_${z}_${at}.xlsx`,lt=new Blob([I],{type:"application/octet-stream"}),O=document.createElement("a"),et=window.URL.createObjectURL(lt);O.href=et,O.download=ct,O.click(),window.URL.revokeObjectURL(et)},v=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",v)})}exportToPDF(){ii.default.vfs=Jo.default.pdfMake.vfs;let n=new st,r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;n=n.set("gp_id",this.gp_id),r&&(n=n.set("village_id",r)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),g&&(n=n.set("application_status",g)),n=n.set("export_all","1"),n=n.set("category","1"),n=n.set("installment",this.installment);let _=new rt({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgress=!1;let S=v.data[0]||{},w=(S.district_name||"N/A").toUpperCase(),u=(S.block_name||S.ulb_name||"N/A").toUpperCase(),I=(S.gp_name||S.ward_no||"N/A").toUpperCase(),R=(S.village_name||"").toUpperCase(),z=[[{text:"SI#",fontSize:10},{text:"CATEGORY",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICATION DATE.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"SOCIAL CATEGORY",fontSize:10},{text:"PWD",fontSize:10},{text:"MOBILE NO",fontSize:10},{text:"APPLICATION STATUS",fontSize:10},{text:"PAYMENT STATUS",fontSize:10}]];v.data.forEach((W,It)=>{z.push([{text:(It+1).toString().toUpperCase(),fontSize:9},{text:(W.category||"").toUpperCase(),fontSize:9},{text:(W.application_number||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(W.application_date)||"",fontSize:9},{text:(W.applicant_name||"").toUpperCase(),fontSize:9},{text:(W.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:(W.social_category||"").toUpperCase(),fontSize:9},{text:(W.pwd_status||"").toUpperCase(),fontSize:9},{text:(W.alt_mobile_number||"").toUpperCase(),fontSize:9},{text:(W.application_status||"").toUpperCase(),fontSize:9},{text:(W.payment_status||"").toUpperCase(),fontSize:9}])});let at=new Date,ct=`Timestamp: ${at.toLocaleDateString()}, ${at.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,lt={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${w} > BLOCK: ${u} > GP: ${I} >VILLAGE: ${R}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DETAILED REPORT - NFSA",style:"header"},{table:{headerRows:1,body:z,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]},layout:{fillColor:function(W){return W===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:ct,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},O=new Date,et=O.toLocaleDateString("en-GB").split("/").reverse().join("-"),y=O.toLocaleTimeString("en-GB").replace(/:/g,"-"),B=`nfsa_reports_${et}_${y}.pdf`;ii.default.createPdf(lt).download(B)},v=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",v)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(Ot),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-nfsa-village-user-list"]],decls:58,vars:4,consts:[[1,"container-fluid","drilldown-reports"],[1,"d-flex","justify-content-between","w-100","mb-3"],[1,"card-title"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],["class","row mb-2"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-2"],[1,"col-md-4"],["for","social_category",1,"fw-bold"],["formControlName","social_category","id","social_category",1,"form-select","my-2"],["value",""],["value","1"],["value","2"],["value","3"],["value","4"],["for","a_status",1,"fw-bold"],["formControlName","a_status","id","a_status",1,"form-select","my-2"],["value","7"],["for","pwd_status",1,"fw-bold"],["formControlName","pwd_status","id","pwd_status",1,"form-select","my-2"],["value","0"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[1,"row","mb-2"],[1,"col-md-7"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"fa","fa-spinner","fa-spin"],[1,"col-md-5"],["id","recordCount"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports detail"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports","detail"],[1,"text-light",2,"background-color","#fd7b03"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"],[4,"ngIf"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1)(2,"h4",2),a(3,"Detailed Report - NFSA"),e(),t(4,"div",3)(5,"a",4),L("click",function(){return c.appService.goBack()}),t(6,"button",5),m(7,"i",6),a(8," Back"),e()()()(),b(9,nS,12,4,"div",7),t(10,"div",8)(11,"form",9),L("ngSubmit",function(){return c.onSearch()}),t(12,"div",10)(13,"div",11)(14,"label",12),a(15," Social Category "),e(),t(16,"select",13)(17,"option",14),a(18,"Choose Social Category"),e(),t(19,"option",15),a(20,"Un-Reserved"),e(),t(21,"option",16),a(22,"OBC"),e(),t(23,"option",17),a(24,"SC"),e(),t(25,"option",18),a(26,"ST"),e()()(),t(27,"div",11)(28,"label",19),a(29," Application Status "),e(),t(30,"select",20)(31,"option",14),a(32,"Choose Status"),e(),t(33,"option",21),a(34,"Under Process"),e(),t(35,"option",15),a(36,"Approved"),e(),t(37,"option",16),a(38,"Rejected"),e()()(),t(39,"div",11)(40,"label",22),a(41," PWD "),e(),t(42,"select",23)(43,"option",14),a(44,"Choose PWD Status"),e(),t(45,"option",15),a(46,"Yes "),e(),t(47,"option",24),a(48,"NO"),e()()()(),t(49,"div",25)(50,"div",26),b(51,oS,3,0,"button",27)(52,aS,3,0),e()()()(),t(53,"div",28)(54,"div",29)(55,"div",30),b(56,rS,2,0)(57,bS,21,7),e()()()()),r&2&&(l(9),E(9,c.filteredVillageUserStats&&c.filteredVillageUserStats.length>0?9:-1),l(2),T("formGroup",c.searchForm),l(40),E(51,c.isFormSearchInProgress?52:51),l(5),E(56,c.isStatsLoading?56:57))},dependencies:[ft,Pt,Nt,Rt,K,Ut,q,yt,J,Dt,At,it]});let i=s;return i})();var ni=j(ut()),Zo=j(ht());function vS(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function ES(i,s){if(i&1){let o=U();t(0,"button",22),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",23),a(2,"Download PDF "),e()}}function wS(i,s){i&1&&(t(0,"button",24),m(1,"i",25),a(2,"Downloading "),e())}function TS(i,s){if(i&1){let o=U();t(0,"button",22),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",23),a(2,"Download EXCEL "),e()}}function LS(i,s){i&1&&(t(0,"button",24),m(1,"i",25),a(2,"Downloading "),e())}var IS=(i,s)=>s.id,yS=i=>({installment:i});function kS(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",30),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e(),t(9,"td"),a(10),e(),t(11,"td"),a(12),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),$t("routerLink","/department/portal/non_nfsa/block-ulb-stats/",o.district_id,""),T("queryParams",pt(9,yS,r.installment)),l(1),p(P(6,7,o.district_name)),l(3),p(o==null?null:o.non_nfsa_applications_received),l(2),p(o==null?null:o.non_nfsa_approved_application),l(2),p(o==null?null:o.non_nfsa_rejected_application)}}function PS(i,s){if(i&1&&(t(0,"table",26)(1,"thead",27)(2,"tr")(3,"th",28),a(4,"Sl.#"),e(),t(5,"th",28),a(6,"DISTRICT"),e()(),t(7,"tr")(8,"th"),a(9,"RECEIVED"),e(),t(10,"th"),a(11,"APPROVED"),e(),t(12,"th"),a(13,"NON-NFSA REJECTED"),e()()(),t(14,"tbody",29),F(15,kS,13,11,"tr",null,IS),e()()),i&2){let o=h(2);l(15),V(o.filteredDistrictStats)}}function DS(i,s){i&1&&a(0," No Data Found ")}function AS(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - NON-NFSA"),e()(),t(4,"div",13)(5,"div",14)(6,"input",15),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(7,"i",16),e(),t(8,"div",17),b(9,ES,3,0,"button",18)(10,wS,3,0),e(),t(11,"div",19),b(12,TS,3,0,"button",18)(13,LS,3,0),e()()(),t(14,"div",20),b(15,PS,17,0,"table",21)(16,DS,1,0),e()}if(i&2){let o=h();l(6),T("ngModel",o.searchTerm),l(3),E(9,o.isExportInProgress?10:9),l(3),E(12,o.isExportInProgressExcel?13:12),l(3),E(15,o.filteredDistrictStats&&o.filteredDistrictStats.length>0?15:16)}}var ta=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.router=n,this.route=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.districtStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment,this.card_name=n.card_name,this.fetchDistrictStats()})}fetchDistrictStats(){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?category=0&installment=${this.installment}&card_name=${this.card_name}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isStatsLoading=!1,this.districtStats=n.data},n=>{this.isStatsLoading=!1,this.districtStats=[]})}get filteredDistrictStats(){return this.searchTerm?this.districtStats.filter(n=>n.district_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.districtStats}exportToExcel(){this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?category=0&installment=${this.installment}&card_name=${this.card_name}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isExportInProgressExcel=!1;let r=n.data.map((I,R)=>({"SI#":R+1,DISTRICT:I.district_name.toUpperCase(),"APPLICATION RECEIVED":I?.non_nfsa_applications_received,"APPLICATION APPROVED":I?.non_nfsa_approved_application,"NON-NFSA REJECTED":I?.non_nfsa_rejected_application})),c=N.json_to_sheet(r),f=N.book_new();N.book_append_sheet(f,c,"Applications");let d=Z(f,{bookType:"xlsx",type:"array"}),C=new Date,g=C.toLocaleDateString("en-GB").split("/").reverse().join("-"),_=C.toLocaleTimeString("en-GB").replace(/:/g,"-"),v=`non_nfsa_district_drilldown_reports_${g}_${_}.xlsx`,S=new Blob([d],{type:"application/octet-stream"}),w=document.createElement("a"),u=window.URL.createObjectURL(S);w.href=u,w.download=v,w.click(),window.URL.revokeObjectURL(u)},n=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",n)})}exportToPDF(){ni.default.vfs=Zo.default.pdfMake.vfs,this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?category=0&installment=${this.installment}&card_name=${this.card_name}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isExportInProgress=!1;let r=[[{text:"SI#",fontSize:10},{text:"DISTRICT",fontSize:10},{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"NON-NFSA REJECTED",fontSize:10}]];n.data.forEach((S,w)=>{r.push([{text:(w+1).toString().toUpperCase(),fontSize:9},{text:(S.district_name||"").toUpperCase(),fontSize:9},{text:S?.non_nfsa_applications_received,fontSize:9},{text:S?.non_nfsa_approved_application,fontSize:9},{text:S?.non_nfsa_rejected_application,fontSize:9}])});let c=new Date,f=`Timestamp: ${c.toLocaleDateString()}, ${c.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,d={pageOrientation:"landscape",pageSize:"A4",content:[{text:"DRILL-DOWN REPORT - NON-NFSA DISTRICT-WISE",style:"header"},{table:{headerRows:1,body:r,widths:["20%","20%","20%","20%","20%"]},layout:{fillColor:function(S){return S===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:f,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},C=new Date,g=C.toLocaleDateString("en-GB").split("/").reverse().join("-"),_=C.toLocaleTimeString("en-GB").replace(/:/g,"-"),v=`non_nfsa_district_drilldown_reports_${g}_${_}.pdf`;ni.default.createPdf(d).download(v)},n=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",n)})}};s.\u0275fac=function(r){return new(r||s)(x(G),x(tt),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-non-nfsa-district-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,vS,2,0)(11,AS,17,4),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var oi=j(ut()),ea=j(ht());function US(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function NS(i,s){if(i&1){let o=U();t(0,"button",25),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",26),a(2,"Download PDF "),e()}}function RS(i,s){i&1&&(t(0,"button",27),m(1,"i",28),a(2,"Downloading "),e())}function OS(i,s){if(i&1){let o=U();t(0,"button",25),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",26),a(2,"Download EXCEL "),e()}}function BS(i,s){i&1&&(t(0,"button",27),m(1,"i",28),a(2,"Downloading "),e())}var WS=(i,s)=>s.id,ia=i=>({installment:i});function MS(i,s){if(i&1&&(t(0,"a",34),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit,n=h(3);Vt("routerLink","/department/portal/non_nfsa/gp-stats/",o.district_id,"/",o.block_id,""),T("queryParams",pt(6,ia,n.installment)),l(1),p(P(2,4,o.block_name))}}function FS(i,s){if(i&1&&(t(0,"a",34),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit,n=h(3);Vt("routerLink","/department/portal/non_nfsa/ward-stats/",o.district_id,"/",o.ulb_id,""),T("queryParams",pt(6,ia,n.installment)),l(1),p(P(2,4,o.ulb_name))}}function VS(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td"),b(4,MS,3,8,"a",33)(5,FS,3,8),e(),t(6,"td"),a(7),e(),t(8,"td"),a(9),e(),t(10,"td"),a(11),e()()),i&2){let o=s.$implicit,n=s.$index;l(2),p(n+1),l(2),E(4,o.block_id?4:5),l(3),p(o==null?null:o.applications_received),l(2),p(o==null?null:o.approved_application),l(2),p(o==null?null:o.non_nfsa_rejected_application)}}function zS(i,s){if(i&1&&(t(0,"table",29)(1,"thead",30)(2,"tr")(3,"th",31),a(4,"Sl.#"),e(),t(5,"th",31),a(6,"BLOCK/ULB"),e()(),t(7,"tr")(8,"th"),a(9,"RECEIVED"),e(),t(10,"th"),a(11,"APPROVED"),e(),t(12,"th"),a(13,"NON-NFSA REJECTED"),e()()(),t(14,"tbody",32),F(15,VS,12,5,"tr",null,WS),e()()),i&2){let o=h(2);l(15),V(o.filteredBlockStats)}}function jS(i,s){i&1&&a(0," No Data Found ")}function $S(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - NON-NFSA"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e()()()(),t(8,"div",16)(9,"div",17)(10,"input",18),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(11,"i",19),e(),t(12,"div",20),b(13,NS,3,0,"button",21)(14,RS,3,0),e(),t(15,"div",22),b(16,OS,3,0,"button",21)(17,BS,3,0),e()()(),t(18,"div",23),b(19,zS,17,0,"table",24)(20,jS,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredBlockStats[0].district_name),l(3),T("ngModel",o.searchTerm),l(3),E(13,o.isExportInProgress?14:13),l(3),E(16,o.isExportInProgressExcel?17:16),l(3),E(19,o.filteredBlockStats&&o.filteredBlockStats.length>0?19:20)}}var na=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.districtStats=[],this.district_id="",this.blockStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{let r=n.id;this.district_id=r,this.fetchblockStats(r)})}fetchblockStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/block-count?district_id=${n}&category=0&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.blockStats=r.data,this.fetchulbStats(n)},r=>{this.isStatsLoading=!1,this.blockStats=[]})}fetchulbStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/ulb-count?district_id=${n}&category=0&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.blockStats=[...this.blockStats,...r.data]},r=>{this.isStatsLoading=!1})}get filteredBlockStats(){return this.searchTerm?this.blockStats.filter(n=>n.block_name&&n.block_name.toLowerCase().includes(this.searchTerm.toLowerCase())||n.ulb_name&&n.ulb_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.blockStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.blockStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name,"BLOCK/ULB":(u.block_name||u.ulb_name).toUpperCase(),"APPLICATION RECEIVED":u?.applications_received,"APPLICATION APPROVED":u?.approved_application,"NON-NFSA REJECTED":u?.non_nfsa_rejected_application})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`non_nfsa_block_ulb_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){oi.default.vfs=ea.default.pdfMake.vfs,this.isExportInProgress=!0;let r=((this.blockStats[0]||{}).district_name||"N/A").toUpperCase(),c=[[{text:"SI#",fontSize:10},{text:"BLOCK/ULB",fontSize:10},{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"NON-NFSA REJECTED",fontSize:10}]];this.blockStats.forEach((w,u)=>{c.push([{text:(u+1).toString().toUpperCase(),fontSize:9},{text:(w.block_name||w.ulb_name||"").toUpperCase(),fontSize:9},{text:w?.applications_received,fontSize:9},{text:w?.approved_application,fontSize:9},{text:w?.non_nfsa_rejected_application,fontSize:9}])});let f=new Date,d=`Timestamp: ${f.toLocaleDateString()}, ${f.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,C={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - NON-NFSA BLOCK/ULB WISE",style:"header"},{table:{headerRows:1,body:c,widths:["20%","20%","20%","20%","20%"]},layout:{fillColor:function(w){return w===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:d,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},g=new Date,_=g.toLocaleDateString("en-GB").split("/").reverse().join("-"),v=g.toLocaleTimeString("en-GB").replace(/:/g,"-"),S=`non_nfsa_block_ulb_drilldown_reports_${_}_${v}.pdf`;oi.default.createPdf(C).download(S,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-non-nfsa-block-ulb-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],[2,"font-size","14px"],["style","text-decoration: none",3,"routerLink","queryParams"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,US,2,0)(11,$S,21,5),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var ai=j(ut()),oa=j(ht());function GS(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function XS(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",27),a(2,"Download PDF "),e()}}function YS(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}function HS(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",27),a(2,"Download EXCEL "),e()}}function KS(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}var qS=(i,s)=>s.id,JS=i=>({installment:i});function QS(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",34),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e(),t(9,"td"),a(10),e(),t(11,"td"),a(12),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),Mt("routerLink","/department/portal/non_nfsa/village-stats/",o.district_id,"/",o.block_id,"/",o.gp_id,""),T("queryParams",pt(11,JS,r.installment)),l(1),p(P(6,9,o.gp_name)),l(3),p(o==null?null:o.applications_received),l(2),p(o==null?null:o.approved_application),l(2),p(o==null?null:o.non_nfsa_rejected_application)}}function ZS(i,s){if(i&1&&(t(0,"table",30)(1,"thead",31)(2,"tr")(3,"th",32),a(4,"Sl.#"),e(),t(5,"th",32),a(6,"GRAM PANCHAYAT"),e()(),t(7,"tr")(8,"th"),a(9,"RECEIVED"),e(),t(10,"th"),a(11,"APPROVED"),e(),t(12,"th"),a(13,"NON-NFSA REJECTED"),e()()(),t(14,"tbody",33),F(15,QS,13,13,"tr",null,qS),e()()),i&2){let o=h(2);l(15),V(o.filteredGpStats)}}function tx(i,s){i&1&&a(0," No Data Found ")}function ex(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - NON-NFSA"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e(),t(8,"li",16),a(9),e()()()(),t(10,"div",17)(11,"div",18)(12,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(13,"i",20),e(),t(14,"div",21),b(15,XS,3,0,"button",22)(16,YS,3,0),e(),t(17,"div",23),b(18,HS,3,0,"button",22)(19,KS,3,0),e()()(),t(20,"div",24),b(21,ZS,17,0,"table",25)(22,tx,1,0),e()}if(i&2){let o=h();l(7),dt(" ",o.filteredGpStats[0].district_name," "),l(2),dt(" ",o.filteredGpStats[0].block_name," "),l(3),T("ngModel",o.searchTerm),l(3),E(15,o.isExportInProgress?16:15),l(3),E(18,o.isExportInProgressExcel?19:18),l(3),E(21,o.filteredGpStats&&o.filteredGpStats.length>0?21:22)}}var aa=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.district_id="",this.gpStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.id,this.fetchgpStats(this.block_id)})}fetchgpStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/gp-count?block_id=${n}&category=0&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.gpStats=r.data},r=>{this.isStatsLoading=!1,this.gpStats=[]})}get filteredGpStats(){return this.searchTerm?this.gpStats.filter(n=>n.gp_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.gpStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.gpStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",BLOCK:u.block_name?u.block_name.toUpperCase():"",GP:u.gp_name?u.gp_name.toUpperCase():"","APPLICATION RECEIVED":u?.applications_received,"APPLICATION APPROVED":u?.approved_application,"NON-NFSA REJECTED":u?.non_nfsa_rejected_application})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`non_nfsa_gp_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){ai.default.vfs=oa.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.gpStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=[[{text:"SI#",fontSize:10},{text:"GP",fontSize:10},{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"NON-NFSA REJECTED",fontSize:10}]];this.gpStats.forEach((u,I)=>{f.push([{text:(I+1).toString().toUpperCase(),fontSize:9},{text:(u.gp_name||"").toUpperCase(),fontSize:9},{text:u?.applications_received,fontSize:9},{text:u?.approved_application,fontSize:9},{text:u?.non_nfsa_rejected_application,fontSize:9}])});let d=new Date,C=`Timestamp: ${d.toLocaleDateString()}, ${d.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,g={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK: ${c}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - NON-NFSA GP WISE",style:"header"},{table:{headerRows:1,body:f,widths:["20%","20%","20%","20%","20%"]},layout:{fillColor:function(u){return u===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:C,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},_=new Date,v=_.toLocaleDateString("en-GB").split("/").reverse().join("-"),S=_.toLocaleTimeString("en-GB").replace(/:/g,"-"),w=`non_nfsa_gp_drilldown_reports_${v}_${S}.pdf`;ai.default.createPdf(g).download(w,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-non-nfsa-gp-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url(
                "data:image/svg + xml,%3Csvgxmlns='http://www.w3.org/2000/svg'width='8'height='8'%3E%3Cpathd='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z'fill='%236c757d'/%3E%3C/svg%3E"
              )`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style",`
                background-color: #ffe8d0;
                color: #fd7b03;
                font-weight: 620;
              `,"type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back "),e()()()(),t(8,"div",7)(9,"div",8),b(10,GS,2,0)(11,ex,23,6),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var ri=j(ut()),ra=j(ht());function ix(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function nx(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",27),a(2,"Download PDF "),e()}}function ox(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}function ax(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",27),a(2,"Download EXCEL "),e()}}function rx(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}var sx=(i,s)=>s.id,lx=i=>({installment:i});function cx(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",34),a(5),e()(),t(6,"td"),a(7),e(),t(8,"td"),a(9),e(),t(10,"td"),a(11),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),Mt("routerLink","/department/portal/non_nfsa/ward-user-list/",o.district_id,"/",o.ulb_id,"/",o.ward_id,""),T("queryParams",pt(9,lx,r.installment)),l(1),p(o.ward_no),l(2),p(o==null?null:o.applications_received),l(2),p(o==null?null:o.approved_application),l(2),p(o==null?null:o.non_nfsa_rejected_application)}}function dx(i,s){if(i&1&&(t(0,"table",30)(1,"thead",31)(2,"tr")(3,"th",32),a(4,"Sl.#"),e(),t(5,"th",32),a(6,"WARD"),e()(),t(7,"tr")(8,"th"),a(9,"RECEIVED"),e(),t(10,"th"),a(11,"APPROVED"),e(),t(12,"th"),a(13,"NON-NFSA REJECTED"),e()()(),t(14,"tbody",33),F(15,cx,12,11,"tr",null,sx),e()()),i&2){let o=h(2);l(15),V(o.filteredWardStats)}}function px(i,s){i&1&&a(0," No Data Found ")}function mx(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - NON-NFSA"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e(),t(8,"li",16),a(9),e()()()(),t(10,"div",17)(11,"div",18)(12,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(13,"i",20),e(),t(14,"div",21),b(15,nx,3,0,"button",22)(16,ox,3,0),e(),t(17,"div",23),b(18,ax,3,0,"button",22)(19,rx,3,0),e()()(),t(20,"div",24),b(21,dx,17,0,"table",25)(22,px,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredWardStats[0].district_name),l(2),p(o.filteredWardStats[0].ulb_name),l(3),T("ngModel",o.searchTerm),l(3),E(15,o.isExportInProgress?16:15),l(3),E(18,o.isExportInProgressExcel?19:18),l(3),E(21,o.filteredWardStats&&o.filteredWardStats.length>0?21:22)}}var sa=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.district_id="",this.wardStats=[],this.ulb_id="",this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.ulb_id=n.id,this.fetchWardStats(this.ulb_id)})}fetchWardStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/ward-count?ulb_id=${n}&category=0&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.wardStats=r.data},r=>{this.isStatsLoading=!1,this.wardStats=[]})}get filteredWardStats(){return this.searchTerm?this.wardStats.filter(n=>n.ward_no.toLowerCase().includes(this.searchTerm.toLowerCase())):this.wardStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.wardStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",ULB:u.ulb_name?u.ulb_name.toUpperCase():"","WARD NO.":u.ward_no?u.ward_no.toUpperCase():"","APPLICATION RECEIVED":u?.applications_received,"APPLICATION APPROVED":u?.approved_application,"NON-NFSA REJECTED":u?.non_nfsa_rejected_application})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`non_nfsa_ward_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){ri.default.vfs=ra.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.wardStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=[[{text:"SI#",fontSize:10},{text:"WARD NO.",fontSize:10},{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"NON-NFSA REJECTED",fontSize:10}]];this.wardStats.forEach((u,I)=>{f.push([{text:(I+1).toString().toUpperCase(),fontSize:9},{text:(u.ward_no||"").toUpperCase(),fontSize:9},{text:u?.applications_received,fontSize:9},{text:u?.approved_application,fontSize:9},{text:u?.non_nfsa_rejected_application,fontSize:9}])});let d=new Date,C=`Timestamp: ${d.toLocaleDateString()}, ${d.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,g={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK/ULB: ${c}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - NON-NFSA WARD wISE",style:"header"},{table:{headerRows:1,body:f,widths:["20%","20%","20%","20%","20%"]},layout:{fillColor:function(u){return u===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:C,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},_=new Date,v=_.toLocaleDateString("en-GB").split("/").reverse().join("-"),S=_.toLocaleTimeString("en-GB").replace(/:/g,"-"),w=`non_nfsa_ward_drilldown_reports_${v}_${S}.pdf`;ri.default.createPdf(g).download(w,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-non-nfsa-ward-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,ix,2,0)(11,mx,23,6),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J]});let i=s;return i})();var si=j(ut()),la=j(ht());function _x(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function fx(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",27),a(2,"Download PDF "),e()}}function ux(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}function hx(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",27),a(2,"Download EXCEL "),e()}}function Sx(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}var xx=(i,s)=>s.id,gx=i=>({installment:i});function Cx(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",34),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e(),t(9,"td"),a(10),e(),t(11,"td"),a(12),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),Gt("routerLink","/department/portal/non_nfsa/village-user-list/",o.district_id,"/",o.block_id,"/",o.gp_id,"/",o.village_id,""),T("queryParams",pt(12,gx,r.installment)),l(1),p(P(6,10,o.village_name)),l(3),p(o==null?null:o.applications_received),l(2),p(o==null?null:o.approved_application),l(2),p(o==null?null:o.non_nfsa_rejected_application)}}function bx(i,s){if(i&1&&(t(0,"table",30)(1,"thead",31)(2,"tr")(3,"th",32),a(4,"Sl.#"),e(),t(5,"th",32),a(6,"VILLAGE"),e()(),t(7,"tr")(8,"th"),a(9,"RECEIVED"),e(),t(10,"th"),a(11,"APPROVED"),e(),t(12,"th"),a(13,"NON-NFSA REJECTED"),e()()(),t(14,"tbody",33),F(15,Cx,13,14,"tr",null,xx),e()()),i&2){let o=h(2);l(15),V(o.filteredVillageStats)}}function vx(i,s){i&1&&a(0," No Data Found ")}function Ex(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - NON-NFSA"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e(),t(8,"li",15),a(9),e(),t(10,"li",16),a(11),e()()()(),t(12,"div",17)(13,"div",18)(14,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(15,"i",20),e(),t(16,"div",21),b(17,fx,3,0,"button",22)(18,ux,3,0),e(),t(19,"div",23),b(20,hx,3,0,"button",22)(21,Sx,3,0),e()()(),t(22,"div",24),b(23,bx,17,0,"table",25)(24,vx,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredVillageStats[0].district_name),l(2),p(o.filteredVillageStats[0].block_name),l(2),p(o.filteredVillageStats[0].gp_name),l(3),T("ngModel",o.searchTerm),l(3),E(17,o.isExportInProgress?18:17),l(3),E(20,o.isExportInProgressExcel?21:20),l(3),E(23,o.filteredVillageStats&&o.filteredVillageStats.length>0?23:24)}}var ca=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.gp_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.block_id,this.gp_id=n.id,this.fetchvillageStats(this.gp_id)})}fetchvillageStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/village-count?gp_id=${n}&category=0&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.villageStats=r.data},r=>{this.isStatsLoading=!1,this.villageStats=[]})}get filteredVillageStats(){return this.searchTerm?this.villageStats.filter(n=>n.village_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.villageStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.villageStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",BLOCK:u.block_name?u.block_name.toUpperCase():"",GP:u.gp_name?u.gp_name.toUpperCase():"",VILLAGE:u.village_name?u.village_name.toUpperCase():"","APPLICATION RECEIVED":u?.applications_received,"APPLICATION APPROVED":u?.approved_application,"NON-NFSA REJECTED":u?.non_nfsa_rejected_application})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`non_nfsa_village_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){si.default.vfs=la.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.villageStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=(n.gp_name||n.ward_no||"N/A").toUpperCase(),d=[[{text:"SI#",fontSize:10},{text:"VILLAGE",fontSize:10},{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"NON-NFSA REJECTED",fontSize:10}]];this.villageStats.forEach((I,R)=>{d.push([{text:(R+1).toString().toUpperCase(),fontSize:9},{text:(I.village_name||"").toUpperCase(),fontSize:9},{text:I?.applications_received,fontSize:9},{text:I?.approved_application,fontSize:9},{text:I?.non_nfsa_rejected_application,fontSize:9}])});let C=new Date,g=`Timestamp: ${C.toLocaleDateString()}, ${C.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,_={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK: ${c} > GP:${f}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - NON-NFSA VILLAGE WISE",style:"header"},{table:{headerRows:1,body:d,widths:["20%","20%","20%","20%","20%"]},layout:{fillColor:function(I){return I===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:g,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},v=new Date,S=v.toLocaleDateString("en-GB").split("/").reverse().join("-"),w=v.toLocaleTimeString("en-GB").replace(/:/g,"-"),u=`non_nfsa_village_drilldown_reports_${S}_${w}.pdf`;si.default.createPdf(_).download(u,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-non-nfsa-village-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,_x,2,0)(11,Ex,25,7),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var li=j(ut()),da=j(ht());function wx(i,s){if(i&1&&(t(0,"div",31)(1,"div",32)(2,"nav",33)(3,"ol",34)(4,"li",35),a(5),e(),t(6,"li",35),a(7),e(),t(8,"li",35),a(9),e(),t(10,"li",36),a(11),e()()()()()),i&2){let o=h();l(5),p(o.filteredVillageUserStats[0].district_name),l(2),p(o.filteredVillageUserStats[0].block_name),l(2),p(o.filteredVillageUserStats[0].gp_name),l(2),p(o.filteredVillageUserStats[0].village_name)}}function Tx(i,s){i&1&&(t(0,"button",37),m(1,"i",38),a(2,"Search "),e())}function Lx(i,s){i&1&&(t(0,"button",39),m(1,"i",40),a(2," Searching ..."),e())}function Ix(i,s){i&1&&(m(0,"i",41),a(1," We are fetching the data, please wait. "))}function yx(i,s){if(i&1){let o=U();t(0,"button",55),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",56),a(2,"Download to PDF "),e()}}function kx(i,s){i&1&&(t(0,"button",57),m(1,"i",40),a(2,"Downloading "),e())}function Px(i,s){if(i&1){let o=U();t(0,"button",55),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",56),a(2,"Download to EXCEL "),e()}}function Dx(i,s){i&1&&(t(0,"button",57),m(1,"i",40),a(2,"Downloading "),e())}var Ax=(i,s)=>s.id;function Ux(i,s){if(i&1&&(t(0,"td"),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit;l(1),p(P(2,1,o.village_name))}}function Nx(i,s){i&1&&m(0,"td")}function Rx(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),b(3,Ux,3,3,"td")(4,Nx,1,0),t(5,"td"),a(6),k(7,"uppercase"),e(),t(8,"td"),a(9),k(10,"uppercase"),e(),t(11,"td"),a(12),k(13,"uppercase"),e(),t(14,"td"),a(15),k(16,"uppercase"),e(),t(17,"td"),a(18),k(19,"uppercase"),e(),t(20,"td"),a(21),k(22,"uppercase"),e(),t(23,"td"),a(24),k(25,"uppercase"),e(),t(26,"td"),a(27),e(),t(28,"td"),a(29),k(30,"uppercase"),e(),t(31,"td"),a(32),k(33,"uppercase"),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(1),E(3,o.village_name?3:4),l(3),p(P(7,12,o.category)),l(3),p(P(10,14,o.application_number)),l(3),p(P(13,16,r.appService.dateFormat(o.application_date))),l(3),p(P(16,18,o.applicant_name)),l(3),p(P(19,20,o.spouse_or_father_name)),l(3),p(P(22,22,o.social_category)),l(3),p(P(25,24,o.pwd_status)),l(3),p(o.alt_mobile_number),l(2),p(P(30,26,o.application_status)),l(3),p(P(33,28,o.payment_status))}}function Ox(i,s){if(i&1&&(t(0,"table",58)(1,"thead",59)(2,"tr")(3,"th"),a(4,"SI#"),e(),t(5,"th"),a(6,"VILLAGE"),e(),t(7,"th"),a(8,"CATEGORY"),e(),t(9,"th"),a(10,"APPLICATION NO."),e(),t(11,"th"),a(12,"APPLICATION DATE"),e(),t(13,"th"),a(14,"APPLICANT NAME"),e(),t(15,"th"),a(16,"FATHER/HUSBAND NAME"),e(),t(17,"th"),a(18,"SOCIAL CATEGORY"),e(),t(19,"th"),a(20,"PWD"),e(),t(21,"th"),a(22,"MOBILE NO."),e(),t(23,"th"),a(24,"APPLICATION STATUS"),e(),t(25,"th"),a(26,"PAYMENT STATUS"),e()()(),t(27,"tbody"),F(28,Rx,34,30,"tr",null,Ax),e()()),i&2){let o=h(2);l(28),V(o.filteredVillageUserStats)}}function Bx(i,s){i&1&&(t(0,"h5",60),a(1,"No data available"),e())}function Wx(i,s){i&1&&(t(0,"div",61),a(1,"Loading.. "),m(2,"i",62),e())}function Mx(i,s){i&1&&(t(0,"span"),m(1,"i",41),a(2," Loading..."),e())}function Fx(i,s){i&1&&(t(0,"span"),a(1,"Load More"),e())}function Vx(i,s){if(i&1){let o=U();t(0,"div",63)(1,"button",64),L("click",function(){D(o);let r=h(2);return A(r.loadMore())}),b(2,Mx,3,0,"span",65)(3,Fx,2,0,"span",65),e()()}if(i&2){let o=h(2);l(2),T("ngIf",o.isLoadMoreInProgress),l(1),T("ngIf",!o.isLoadMoreInProgress)}}function zx(i,s){if(i&1){let o=U();t(0,"div",31)(1,"div",42)(2,"h5",2),a(3," Number of records found : "),t(4,"span",43),a(5),e()()(),t(6,"div",44)(7,"div",45)(8,"input",46),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(9,"i",47),e(),t(10,"div",48),b(11,yx,3,0,"button",49)(12,kx,3,0),e(),t(13,"div",50),b(14,Px,3,0,"button",49)(15,Dx,3,0),e()()(),t(16,"div",51),b(17,Ox,30,0,"table",52)(18,Bx,2,0)(19,Wx,3,0,"div",53),e(),b(20,Vx,4,2,"div",54)}if(i&2){let o=h();l(5),p(o.count),l(3),T("ngModel",o.searchTerm),l(3),E(11,o.isExportInProgress?12:11),l(3),E(14,o.isExportInProgressExcel?15:14),l(3),E(17,o.filteredVillageUserStats&&o.filteredVillageUserStats.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),l(2),E(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),l(1),T("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var pa=(()=>{let s=class s{constructor(n,r,c,f,d,C,g,_){this.route=n,this.router=r,this.formService=c,this.appService=f,this.httpClient=d,this.toastService=C,this.authService=g,this.masterDataService=_,this.isStatsLoading=!1,this.userStats=[],this.block_id="",this.gp_id="",this.village_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.limit=this.appService.loadmorelimit,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.count=0,this.searchForm=new kt({a_category:new nt(""),social_category:new nt(""),pwd_status:new nt(""),submit_date:new nt(""),a_status:new nt("")})}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.block_id,this.gp_id=n.gp_id,this.village_id=n.id,this.fetchuserStats(this.village_id)})}fetchuserStats(n,r=!1){this.isStatsLoading=!0;let c=new st;c=c.set("gp_id",this.gp_id),c=c.set("village_id",n),c=c.set("offset",this.offset),c=c.set("limit",this.limit),c=c.set("category","0"),c=c.set("installment",this.installment);let f=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:c,headers:f}).subscribe(d=>{this.isStatsLoading=!1,this.count=d.count,d.data&&d.data.length>0?(this.application_list=this.application_list.concat(d.data),this.offset+=d.data.length,this.hasMoreRecords=d.data.length===this.limit):this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)},d=>{this.isStatsLoading=!1,this.application_list=[],this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)})}get filteredVillageUserStats(){if(!this.searchTerm)return this.application_list;let n=this.searchTerm.toLowerCase();return this.application_list.filter(r=>r.village_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.category?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.application_number?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_date).toLowerCase().includes(this.searchTerm.toLowerCase())||r.applicant_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.spouse_or_father_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.dob).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.social_category).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.pwd_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.alt_mobile_number).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.payment_status).toLowerCase().includes(this.searchTerm.toLowerCase()))}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status,_=new st;_=_.set("gp_id",this.gp_id),r&&(_=_.set("village_id",r)),f&&(_=_.set("social_category",f)),d&&(_=_.set("pwd_status",d)),g&&(_=_.set("application_status",g)),_=_.set("offset",this.offset),_=_.set("limit",this.limit),_=_.set("category","0"),_=_.set("installment",this.installment);let v=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:_,headers:v}).subscribe(S=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=S.count,S.data&&S.data.length>0?(this.application_list=this.application_list.concat(S.data),this.offset+=S.data.length,this.hasMoreRecords=S.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},S=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}exportToExcel(){let n=new st,r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;n=n.set("gp_id",this.gp_id),r&&(n=n.set("village_id",r)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),g&&(n=n.set("application_status",g)),n=n.set("export_all","1"),n=n.set("category","0"),n=n.set("installment",this.installment);let _=new rt({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgressExcel=!1;let S=v.data.map((y,B)=>({"SI#":B+1,DISTRICT:y.district_name?y.district_name.toUpperCase():"",BLOCK:y.block_name?y.block_name.toUpperCase():"",GP:y.gp_name?y.gp_name.toUpperCase():"",VILLAGE:y.village_name?y.village_name.toUpperCase():"",CATEGORY:y.category.toUpperCase(),"APPLICATION NO.":y.application_number.toUpperCase(),"APPLICATION DATE":this.appService.dateFormat(y.application_date),"APPLICANT NAME":y.applicant_name.toUpperCase(),"FATHER/HUSBAND NAME":y.spouse_or_father_name.toUpperCase(),"SOCIAL CATEGORY":y.social_category.toUpperCase(),PWD:y.pwd_status.toUpperCase(),"MOBILE NO.":y.alt_mobile_number,"APPLICATION STATUS":y.application_status.toUpperCase(),"PAYMENT STATUS":y.payment_status.toUpperCase()})),w=N.json_to_sheet(S),u=N.book_new();N.book_append_sheet(u,w,"Applications");let I=Z(u,{bookType:"xlsx",type:"array"}),R=new Date,z=R.toLocaleDateString("en-GB").split("/").reverse().join("-"),at=R.toLocaleTimeString("en-GB").replace(/:/g,"-"),ct=`non_nfsa_reports_${z}_${at}.xlsx`,lt=new Blob([I],{type:"application/octet-stream"}),O=document.createElement("a"),et=window.URL.createObjectURL(lt);O.href=et,O.download=ct,O.click(),window.URL.revokeObjectURL(et)},v=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",v)})}exportToPDF(){li.default.vfs=da.default.pdfMake.vfs;let n=new st,r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;n=n.set("gp_id",this.gp_id),r&&(n=n.set("village_id",r)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),g&&(n=n.set("application_status",g)),n=n.set("export_all","1"),n=n.set("category","0"),n=n.set("installment",this.installment);let _=new rt({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgress=!1;let S=v.data[0]||{},w=(S.district_name||"N/A").toUpperCase(),u=(S.block_name||S.ulb_name||"N/A").toUpperCase(),I=(S.gp_name||S.ward_no||"N/A").toUpperCase(),R=(S.village_name||"").toUpperCase(),z=[[{text:"SI#",fontSize:10},{text:"CATEGORY",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICATION DATE.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"SOCIAL CATEGORY",fontSize:10},{text:"PWD",fontSize:10},{text:"MOBILE NO",fontSize:10},{text:"APPLICATION STATUS",fontSize:10},{text:"PAYMENT STATUS",fontSize:10}]];v.data.forEach((W,It)=>{z.push([{text:(It+1).toString().toUpperCase(),fontSize:9},{text:(W.category||"").toUpperCase(),fontSize:9},{text:(W.application_number||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(W.application_date)||"",fontSize:9},{text:(W.applicant_name||"").toUpperCase(),fontSize:9},{text:(W.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:(W.social_category||"").toUpperCase(),fontSize:9},{text:(W.pwd_status||"").toUpperCase(),fontSize:9},{text:(W.alt_mobile_number||"").toUpperCase(),fontSize:9},{text:(W.application_status||"").toUpperCase(),fontSize:9},{text:(W.payment_status||"").toUpperCase(),fontSize:9}])});let at=new Date,ct=`Timestamp: ${at.toLocaleDateString()}, ${at.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,lt={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${w} > BLOCK: ${u} > GP: ${I} >VILLAGE: ${R}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DETAILED REPORT NON-NFSA",style:"header"},{table:{headerRows:1,body:z,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]},layout:{fillColor:function(W){return W===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:ct,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},O=new Date,et=O.toLocaleDateString("en-GB").split("/").reverse().join("-"),y=O.toLocaleTimeString("en-GB").replace(/:/g,"-"),B=`non_nfsa_reports_${et}_${y}.pdf`;li.default.createPdf(lt).download(B)},v=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",v)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(Ot),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-non-nfsa-village-user-list"]],decls:58,vars:4,consts:[[1,"container-fluid","drilldown-reports"],[1,"d-flex","justify-content-between","w-100","mb-3"],[1,"card-title"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],["class","row mb-2"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-2"],[1,"col-md-4"],["for","social_category",1,"fw-bold"],["formControlName","social_category","id","social_category",1,"form-select","my-2"],["value",""],["value","1"],["value","2"],["value","3"],["value","4"],["for","a_status",1,"fw-bold"],["formControlName","a_status","id","a_status",1,"form-select","my-2"],["value","7"],["for","pwd_status",1,"fw-bold"],["formControlName","pwd_status","id","pwd_status",1,"form-select","my-2"],["value","0"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[1,"row","mb-2"],[1,"col-md-7"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"fa","fa-spinner","fa-spin"],[1,"col-md-5"],["id","recordCount"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports detail"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports","detail"],[1,"text-light",2,"background-color","#fd7b03"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"],[4,"ngIf"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1)(2,"h4",2),a(3,"Detailed Report - NON-NFSA"),e(),t(4,"div",3)(5,"a",4),L("click",function(){return c.appService.goBack()}),t(6,"button",5),m(7,"i",6),a(8," Back"),e()()()(),b(9,wx,12,4,"div",7),t(10,"div",8)(11,"form",9),L("ngSubmit",function(){return c.onSearch()}),t(12,"div",10)(13,"div",11)(14,"label",12),a(15," Social Category "),e(),t(16,"select",13)(17,"option",14),a(18,"Choose Social Category"),e(),t(19,"option",15),a(20,"Un-Reserved"),e(),t(21,"option",16),a(22,"OBC"),e(),t(23,"option",17),a(24,"SC"),e(),t(25,"option",18),a(26,"ST"),e()()(),t(27,"div",11)(28,"label",19),a(29," Application Status "),e(),t(30,"select",20)(31,"option",14),a(32,"Choose Status"),e(),t(33,"option",21),a(34,"Under Process"),e(),t(35,"option",15),a(36,"Approved"),e(),t(37,"option",16),a(38,"Rejected"),e()()(),t(39,"div",11)(40,"label",22),a(41," PWD "),e(),t(42,"select",23)(43,"option",14),a(44,"Choose PWD Status"),e(),t(45,"option",15),a(46,"Yes "),e(),t(47,"option",24),a(48,"NO"),e()()()(),t(49,"div",25)(50,"div",26),b(51,Tx,3,0,"button",27)(52,Lx,3,0),e()()()(),t(53,"div",28)(54,"div",29)(55,"div",30),b(56,Ix,2,0)(57,zx,21,7),e()()()()),r&2&&(l(9),E(9,c.filteredVillageUserStats&&c.filteredVillageUserStats.length>0?9:-1),l(2),T("formGroup",c.searchForm),l(40),E(51,c.isFormSearchInProgress?52:51),l(5),E(56,c.isStatsLoading?56:57))},dependencies:[ft,Pt,Nt,Rt,K,Ut,q,yt,J,Dt,At,it]});let i=s;return i})();var ci=j(ut()),ma=j(ht());function jx(i,s){if(i&1&&(t(0,"div",31)(1,"div",32)(2,"nav",33)(3,"ol",34)(4,"li",35),a(5),e(),t(6,"li",35),a(7),e(),t(8,"li",36),a(9),e()()()()()),i&2){let o=h();l(5),p(o.filteredWardUserStats[0].district_name),l(2),p(o.filteredWardUserStats[0].ulb_name),l(2),p(o.filteredWardUserStats[0].ward_no)}}function $x(i,s){i&1&&(t(0,"button",37),m(1,"i",38),a(2,"Search "),e())}function Gx(i,s){i&1&&(t(0,"button",39),m(1,"i",40),a(2," Searching ..."),e())}function Xx(i,s){i&1&&(m(0,"i",41),a(1," We are fetching the data, please wait. "))}function Yx(i,s){if(i&1){let o=U();t(0,"button",55),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",56),a(2,"Download to PDF "),e()}}function Hx(i,s){i&1&&(t(0,"button",57),m(1,"i",40),a(2,"Downloading "),e())}function Kx(i,s){if(i&1){let o=U();t(0,"button",55),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",56),a(2,"Download to EXCEL "),e()}}function qx(i,s){i&1&&(t(0,"button",57),m(1,"i",40),a(2,"Downloading "),e())}var Jx=(i,s)=>s.id;function Qx(i,s){if(i&1&&(t(0,"td"),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit;l(1),p(P(2,1,o.ward_no))}}function Zx(i,s){i&1&&m(0,"td")}function tg(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),b(3,Qx,3,3,"td")(4,Zx,1,0),t(5,"td"),a(6),k(7,"uppercase"),e(),t(8,"td"),a(9),k(10,"uppercase"),e(),t(11,"td"),a(12),k(13,"uppercase"),e(),t(14,"td"),a(15),k(16,"uppercase"),e(),t(17,"td"),a(18),k(19,"uppercase"),e(),t(20,"td"),a(21),k(22,"uppercase"),e(),t(23,"td"),a(24),k(25,"uppercase"),e(),t(26,"td"),a(27),e(),t(28,"td"),a(29),k(30,"uppercase"),e(),t(31,"td"),a(32),k(33,"uppercase"),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(1),E(3,o.ward_no?3:4),l(3),p(P(7,12,o.category)),l(3),p(P(10,14,o.application_number)),l(3),p(P(13,16,r.appService.dateFormat(o.application_date))),l(3),p(P(16,18,o.applicant_name)),l(3),p(P(19,20,o.spouse_or_father_name)),l(3),p(P(22,22,o.social_category)),l(3),p(P(25,24,o.pwd_status)),l(3),p(o.alt_mobile_number),l(2),p(P(30,26,o.application_status)),l(3),p(P(33,28,o.payment_status))}}function eg(i,s){if(i&1&&(t(0,"table",58)(1,"thead",59)(2,"tr")(3,"th"),a(4,"SI#"),e(),t(5,"th"),a(6,"WARD NO."),e(),t(7,"th"),a(8,"CATEGORY"),e(),t(9,"th"),a(10,"APPLICATION NO."),e(),t(11,"th"),a(12,"APPLICATION DATE"),e(),t(13,"th"),a(14,"APPLICANT NAME"),e(),t(15,"th"),a(16,"FATHER/HUSBAND NAME"),e(),t(17,"th"),a(18,"SOCIAL CATEGORY"),e(),t(19,"th"),a(20,"PWD"),e(),t(21,"th"),a(22,"MOBILE NO."),e(),t(23,"th"),a(24,"APPLICATION STATUS"),e(),t(25,"th"),a(26,"PAYMENT STATUS"),e()()(),t(27,"tbody"),F(28,tg,34,30,"tr",null,Jx),e()()),i&2){let o=h(2);l(28),V(o.filteredWardUserStats)}}function ig(i,s){i&1&&(t(0,"h5",60),a(1,"No data available"),e())}function ng(i,s){i&1&&(t(0,"div",61),a(1,"Loading.. "),m(2,"i",62),e())}function og(i,s){i&1&&(t(0,"span"),m(1,"i",41),a(2," Loading..."),e())}function ag(i,s){i&1&&(t(0,"span"),a(1,"Load More"),e())}function rg(i,s){if(i&1){let o=U();t(0,"div",63)(1,"button",64),L("click",function(){D(o);let r=h(2);return A(r.loadMore())}),b(2,og,3,0,"span",65)(3,ag,2,0,"span",65),e()()}if(i&2){let o=h(2);l(2),T("ngIf",o.isLoadMoreInProgress),l(1),T("ngIf",!o.isLoadMoreInProgress)}}function sg(i,s){if(i&1){let o=U();t(0,"div",31)(1,"div",42)(2,"h5",2),a(3," Number of records found : "),t(4,"span",43),a(5),e()()(),t(6,"div",44)(7,"div",45)(8,"input",46),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(9,"i",47),e(),t(10,"div",48),b(11,Yx,3,0,"button",49)(12,Hx,3,0),e(),t(13,"div",50),b(14,Kx,3,0,"button",49)(15,qx,3,0),e()()(),t(16,"div",51),b(17,eg,30,0,"table",52)(18,ig,2,0)(19,ng,3,0,"div",53),e(),b(20,rg,4,2,"div",54)}if(i&2){let o=h();l(5),p(o.count),l(3),T("ngModel",o.searchTerm),l(3),E(11,o.isExportInProgress?12:11),l(3),E(14,o.isExportInProgressExcel?15:14),l(3),E(17,o.filteredWardUserStats&&o.filteredWardUserStats.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),l(2),E(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),l(1),T("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var _a=(()=>{let s=class s{constructor(n,r,c,f,d,C,g,_){this.route=n,this.router=r,this.formService=c,this.appService=f,this.httpClient=d,this.toastService=C,this.authService=g,this.masterDataService=_,this.isStatsLoading=!1,this.userStats=[],this.ulb_id="",this.ward_id="",this.village_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.limit=this.appService.loadmorelimit,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.count=0,this.searchForm=new kt({a_category:new nt(""),social_category:new nt(""),pwd_status:new nt(""),submit_date:new nt(""),a_status:new nt("")})}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.ulb_id=n.ulb_id,this.ward_id=n.id,this.fetchuserStats(this.ward_id)})}fetchuserStats(n,r=!1){this.isStatsLoading=!0;let c=new st;c=c.set("ward_id",n),c=c.set("offset",this.offset),c=c.set("limit",this.limit),c=c.set("category","0"),c=c.set("installment",this.installment);let f=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:c,headers:f}).subscribe(d=>{this.isStatsLoading=!1,this.count=d.count,d.data&&d.data.length>0?(this.application_list=this.application_list.concat(d.data),this.offset+=d.data.length,this.hasMoreRecords=d.data.length===this.limit):this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)},d=>{this.isStatsLoading=!1,this.application_list=[],this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)})}get filteredWardUserStats(){if(!this.searchTerm)return this.application_list;let n=this.searchTerm.toLowerCase();return this.application_list.filter(r=>r.ward_no?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.category?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.application_number?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_date).toLowerCase().includes(this.searchTerm.toLowerCase())||r.applicant_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.spouse_or_father_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.dob).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.social_category).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.pwd_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.alt_mobile_number).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.payment_status).toLowerCase().includes(this.searchTerm.toLowerCase()))}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status,_=new st;r&&(_=_.set("ward_id",r)),f&&(_=_.set("social_category",f)),d&&(_=_.set("pwd_status",d)),g&&(_=_.set("application_status",g)),_=_.set("offset",this.offset),_=_.set("limit",this.limit),_=_.set("category","0"),_=_.set("installment",this.installment);let v=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:_,headers:v}).subscribe(S=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=S.count,S.data&&S.data.length>0?(this.application_list=this.application_list.concat(S.data),this.offset+=S.data.length,this.hasMoreRecords=S.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},S=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}exportToExcel(){let n=new st,r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;r&&(n=n.set("ward_id",r)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),g&&(n=n.set("application_status",g)),n=n.set("export_all","1"),n=n.set("category","0"),n=n.set("installment",this.installment);let _=new rt({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgressExcel=!1;let S=v.data.map((y,B)=>({"SI#":B+1,DISTRICT:y.district_name?y.district_name.toUpperCase():"",ULB:y.ulb_name?y.ulb_name.toUpperCase():"","WARD NO.":y.ward_no?y.ward_no.toUpperCase():"",CATEGORY:y.category.toUpperCase(),"APPLICATION NO.":y.application_number.toUpperCase(),"APPLICATION DATE":this.appService.dateFormat(y.application_date),"APPLICANT NAME":y.applicant_name.toUpperCase(),"FATHER/HUSBAND NAME":y.spouse_or_father_name.toUpperCase(),"SOCIAL CATEGORY":y.social_category.toUpperCase(),PWD:y.pwd_status.toUpperCase(),"MOBILE NO.":y.alt_mobile_number,"APPLICATION STATUS":y.application_status.toUpperCase(),"PAYMENT STATUS":y.payment_status.toUpperCase()})),w=N.json_to_sheet(S),u=N.book_new();N.book_append_sheet(u,w,"Applications");let I=Z(u,{bookType:"xlsx",type:"array"}),R=new Date,z=R.toLocaleDateString("en-GB").split("/").reverse().join("-"),at=R.toLocaleTimeString("en-GB").replace(/:/g,"-"),ct=`non_nfsa_reports_${z}_${at}.xlsx`,lt=new Blob([I],{type:"application/octet-stream"}),O=document.createElement("a"),et=window.URL.createObjectURL(lt);O.href=et,O.download=ct,O.click(),window.URL.revokeObjectURL(et)},v=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",v)})}exportToPDF(){ci.default.vfs=ma.default.pdfMake.vfs;let n=new st,r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;r&&(n=n.set("ward_id",r)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),g&&(n=n.set("application_status",g)),n=n.set("export_all","1"),n=n.set("category","0"),n=n.set("installment",this.installment);let _=new rt({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgress=!1;let S=v.data[0]||{},w=(S.district_name||"N/A").toUpperCase(),u=(S.block_name||S.ulb_name||"N/A").toUpperCase(),I=(S.gp_name||S.ward_no||"N/A").toUpperCase(),R=[[{text:"SI#",fontSize:10},{text:"CATEGORY",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICATION DATE.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"SOCIAL CATEGORY",fontSize:10},{text:"PWD",fontSize:10},{text:"MOBILE NO",fontSize:10},{text:"APPLICATION STATUS",fontSize:10},{text:"PAYMENT STATUS",fontSize:10}]];v.data.forEach((B,W)=>{R.push([{text:(W+1).toString().toUpperCase(),fontSize:9},{text:(B.category||"").toUpperCase(),fontSize:9},{text:(B.application_number||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(B.application_date)||"",fontSize:9},{text:(B.applicant_name||"").toUpperCase(),fontSize:9},{text:(B.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:(B.social_category||"").toUpperCase(),fontSize:9},{text:(B.pwd_status||"").toUpperCase(),fontSize:9},{text:(B.alt_mobile_number||"").toUpperCase(),fontSize:9},{text:(B.application_status||"").toUpperCase(),fontSize:9},{text:(B.payment_status||"").toUpperCase(),fontSize:9}])});let z=new Date,at=`Timestamp: ${z.toLocaleDateString()}, ${z.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,ct={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${w} > ULB: ${u} > WARD: ${I}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DETAILED REPORT NON-NFSA",style:"header"},{table:{headerRows:1,body:R,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]},layout:{fillColor:function(B){return B===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:at,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},lt=new Date,O=lt.toLocaleDateString("en-GB").split("/").reverse().join("-"),et=lt.toLocaleTimeString("en-GB").replace(/:/g,"-"),y=`non_nfsa_reports_${O}_${et}.pdf`;ci.default.createPdf(ct).download(y)},v=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",v)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(Ot),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-non-nfsa-ward-user-list"]],decls:58,vars:4,consts:[[1,"container-fluid","drilldown-reports"],[1,"d-flex","justify-content-between","w-100","mb-3"],[1,"card-title"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],["class","row mb-2"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-2"],[1,"col-md-4"],["for","social_category",1,"fw-bold"],["formControlName","social_category","id","social_category",1,"form-select","my-2"],["value",""],["value","1"],["value","2"],["value","3"],["value","4"],["for","a_status",1,"fw-bold"],["formControlName","a_status","id","a_status",1,"form-select","my-2"],["value","7"],["for","pwd_status",1,"fw-bold"],["formControlName","pwd_status","id","pwd_status",1,"form-select","my-2"],["value","0"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[1,"row","mb-2"],[1,"col-md-7"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"fa","fa-spinner","fa-spin"],[1,"col-md-5"],["id","recordCount"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports detail"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports","detail"],[1,"text-light",2,"background-color","#fd7b03"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"],[4,"ngIf"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1)(2,"h4",2),a(3,"Detailed Report - NON-NFSA"),e(),t(4,"div",3)(5,"a",4),L("click",function(){return c.appService.goBack()}),t(6,"button",5),m(7,"i",6),a(8," Back"),e()()()(),b(9,jx,10,3,"div",7),t(10,"div",8)(11,"form",9),L("ngSubmit",function(){return c.onSearch()}),t(12,"div",10)(13,"div",11)(14,"label",12),a(15," Social Category "),e(),t(16,"select",13)(17,"option",14),a(18,"Choose Social Category"),e(),t(19,"option",15),a(20,"Un-Reserved"),e(),t(21,"option",16),a(22,"OBC"),e(),t(23,"option",17),a(24,"SC"),e(),t(25,"option",18),a(26,"ST"),e()()(),t(27,"div",11)(28,"label",19),a(29," Application Status "),e(),t(30,"select",20)(31,"option",14),a(32,"Choose Status"),e(),t(33,"option",21),a(34,"Under Process"),e(),t(35,"option",15),a(36,"Approved"),e(),t(37,"option",16),a(38,"Rejected"),e()()(),t(39,"div",11)(40,"label",22),a(41," PWD "),e(),t(42,"select",23)(43,"option",14),a(44,"Choose PWD Status"),e(),t(45,"option",15),a(46,"Yes "),e(),t(47,"option",24),a(48,"NO"),e()()()(),t(49,"div",25)(50,"div",26),b(51,$x,3,0,"button",27)(52,Gx,3,0),e()()()(),t(53,"div",28)(54,"div",29)(55,"div",30),b(56,Xx,2,0)(57,sg,21,7),e()()()()),r&2&&(l(9),E(9,c.filteredWardUserStats&&c.filteredWardUserStats.length>0?9:-1),l(2),T("formGroup",c.searchForm),l(40),E(51,c.isFormSearchInProgress?52:51),l(5),E(56,c.isStatsLoading?56:57))},dependencies:[ft,Pt,Nt,Rt,K,Ut,q,yt,J,Dt,At,it]});let i=s;return i})();var di=j(ut()),fa=j(ht());function lg(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function cg(i,s){i&1&&(t(0,"h4",22),a(1,"Drill-Down Report - e-KYC through OTP"),e())}function dg(i,s){i&1&&(t(0,"h4",22),a(1,"Drill-Down Report - e-KYC through Biometric"),e())}function pg(i,s){if(i&1){let o=U();t(0,"button",23),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",24),a(2,"Download PDF "),e()}}function mg(i,s){i&1&&(t(0,"button",25),m(1,"i",26),a(2,"Downloading "),e())}function _g(i,s){if(i&1){let o=U();t(0,"button",23),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",24),a(2,"Download EXCEL "),e()}}function fg(i,s){i&1&&(t(0,"button",25),m(1,"i",26),a(2,"Downloading "),e())}var ug=(i,s)=>s.id;function hg(i,s){if(i&1&&(t(0,"td"),a(1),e()),i&2){let o=h().$implicit;l(1),p(o==null?null:o.count_ekyc_otp)}}function Sg(i,s){if(i&1&&(t(0,"td"),a(1),e()),i&2){let o=h().$implicit;l(1),p(o==null?null:o.count_ekyc_biometric)}}var xg=i=>["/department/portal/ekycmode/block-ulb-stats",i],gg=(i,s)=>({ekyc_mode:i,installment:s});function Cg(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",31),a(5),k(6,"uppercase"),e()(),b(7,hg,2,1,"td",32)(8,Sg,2,1,"td",32),e()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),T("routerLink",pt(8,xg,o.district_id))("queryParams",Lt(10,gg,r.ekyc_mode,r.installment)),l(1),dt(" ",P(6,6,o.district_name)," "),l(2),T("ngIf",r.card_name=="otp"),l(1),T("ngIf",r.card_name=="biometric")}}function bg(i,s){if(i&1&&(t(0,"table",27)(1,"thead",28)(2,"tr")(3,"th",29),a(4,"Sl.#"),e(),t(5,"th",29),a(6,"DISTRICT"),e()(),t(7,"tr")(8,"th"),a(9),e()()(),t(10,"tbody",30),F(11,Cg,9,13,"tr",null,ug),e()()),i&2){let o=h(2);l(9),p(o.ekyc_mode==1?"E-KYC through OTP":"E-KYC through BIOMETRIC"),l(2),V(o.filteredDistrictStats)}}function vg(i,s){i&1&&a(0," No Data Found ")}function Eg(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11),b(2,cg,2,0,"h4",12)(3,dg,2,0,"h4",12),e(),t(4,"div",13)(5,"div",14)(6,"input",15),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(7,"i",16),e(),t(8,"div",17),b(9,pg,3,0,"button",18)(10,mg,3,0),e(),t(11,"div",19),b(12,_g,3,0,"button",18)(13,fg,3,0),e()()(),t(14,"div",20),b(15,bg,13,1,"table",21)(16,vg,1,0),e()}if(i&2){let o=h();l(2),T("ngIf",o.ekyc_mode==1),l(1),T("ngIf",o.ekyc_mode==5),l(3),T("ngModel",o.searchTerm),l(3),E(9,o.isExportInProgress?10:9),l(3),E(12,o.isExportInProgressExcel?13:12),l(3),E(15,o.filteredDistrictStats&&o.filteredDistrictStats.length>0?15:16)}}var ua=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.districtStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.ekyc_mode=n.ekyc_mode,this.installment=n.installment,this.card_name=n.card_name,this.fetchDistrictStats()})}fetchDistrictStats(){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?card_name=${this.card_name}&ekyc_mode=${this.ekyc_mode}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isStatsLoading=!1,this.districtStats=n.data},n=>{this.isStatsLoading=!1,this.districtStats=[]})}get filteredDistrictStats(){return this.searchTerm?this.districtStats.filter(n=>n.district_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.districtStats}exportToExcel(){this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?card_name=${this.card_name}&ekyc_mode=${this.ekyc_mode}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isExportInProgressExcel=!1;let r=n.data.map((I,R)=>{let z={"SI#":R+1,DISTRICT:I.district_name.toUpperCase()};return this.card_name=="ekyc_completed"?Wt(Bt({},z),{"PE-KYC through OTP":I?.count_ekyc_otp}):this.card_name=="ekyc_pending"?Wt(Bt({},z),{"E-KYC through BIOMETRIC":I?.count_ekyc_biometric}):z}),c=N.json_to_sheet(r),f=N.book_new();N.book_append_sheet(f,c,"Applications");let d=Z(f,{bookType:"xlsx",type:"array"}),C=new Date,g=C.toLocaleDateString("en-GB").split("/").reverse().join("-"),_=C.toLocaleTimeString("en-GB").replace(/:/g,"-"),v=this.ekyc_mode==1?`otp_district_drilldown_reports_${g}_${_}.xlsx`:`biometrics_district_drilldown_reports_${g}_${_}.xlsx`,S=new Blob([d],{type:"application/octet-stream"}),w=document.createElement("a"),u=window.URL.createObjectURL(S);w.href=u,w.download=v,w.click(),window.URL.revokeObjectURL(u)},n=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",n)})}exportToPDF(){di.default.vfs=fa.default.pdfMake.vfs,this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?card_name=${this.card_name}&ekyc_mode=${this.ekyc_mode}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isExportInProgress=!1;let r=[[{text:"SI#",fontSize:10},{text:"DISTRICT",fontSize:10},{text:[this.ekyc_mode==1?"E-KYC through OTP":"E-KYC through BIOMETRIC"],fontSize:10}]];n.data.forEach((w,u)=>{r.push([{text:(u+1).toString().toUpperCase(),fontSize:9},{text:(w.district_name||"").toUpperCase(),fontSize:9},{text:[this.ekyc_mode==1?w?.count_ekyc_otp:w?.count_ekyc_biometric],fontSize:9}])});let c=new Date,f=`Timestamp: ${c.toLocaleDateString()}, ${c.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,C={pageOrientation:"landscape",pageSize:"A4",content:[{text:this.ekyc_mode==1?"DRILL-DOWN REPORT - e-KYC THROUGH OTP DISTRICT WISE":"DRILL-DOWN REPORT - e-KYC THROUGH BIOMETRIC DISTRICT WISE",style:"header"},{table:{headerRows:1,body:r,widths:["20%","20%","20%"]},layout:{fillColor:function(w){return w===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:f,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},g=new Date,_=g.toLocaleDateString("en-GB").split("/").reverse().join("-"),v=g.toLocaleTimeString("en-GB").replace(/:/g,"-"),S=this.ekyc_mode==1?`otp_district_drilldown_reports_${_}_${v}.pdf`:`biometrics_district_drilldown_reports_${_}_${v}.pdf`;di.default.createPdf(C).download(S)},n=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",n)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-e-kyc-mode-district-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],["style","color: #fd7b03;",4,"ngIf"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],[2,"color","#fd7b03"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"],[4,"ngIf"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,lg,2,0)(11,Eg,17,6),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ft,ot,K,q,J,it]});let i=s;return i})();var pi=j(ut()),ha=j(ht());function wg(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function Tg(i,s){i&1&&(t(0,"h4",25),a(1,"Drill-Down Report - e-KYC through OTP"),e())}function Lg(i,s){i&1&&(t(0,"h4",25),a(1,"Drill-Down Report - e-KYC through Biometric"),e())}function Ig(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",27),a(2,"Download PDF "),e()}}function yg(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}function kg(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",27),a(2,"Download EXCEL "),e()}}function Pg(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}var Dg=(i,s)=>s.id,Ag=(i,s)=>["/department/portal/ekycmode/gp-stats",i,s],Sa=(i,s)=>({ekyc_mode:i,installment:s});function Ug(i,s){if(i&1&&(t(0,"a",35),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit,n=h(3);T("routerLink",Lt(5,Ag,o.district_id,o.block_id))("queryParams",Lt(8,Sa,n.ekyc_mode,n.installment)),l(1),dt(" ",P(2,3,o.block_name)," ")}}var Ng=(i,s)=>["/department/portal/ekycmode/ward-stats",i,s];function Rg(i,s){if(i&1&&(t(0,"a",35),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit,n=h(3);T("routerLink",Lt(5,Ng,o.district_id,o.ulb_id))("queryParams",Lt(8,Sa,n.ekyc_mode,n.installment)),l(1),dt(" ",P(2,3,o.ulb_name)," ")}}function Og(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td"),b(4,Ug,3,11,"a",34)(5,Rg,3,11),e(),t(6,"td"),a(7),e()()),i&2){let o=s.$implicit,n=s.$index;l(2),p(n+1),l(2),E(4,o.block_id?4:5),l(3),p(o==null?null:o.applications_received)}}function Bg(i,s){if(i&1&&(t(0,"table",30)(1,"thead",31)(2,"tr")(3,"th",32),a(4,"Sl.#"),e(),t(5,"th",32),a(6,"BLOCK/ULB"),e()(),t(7,"tr")(8,"th"),a(9),e()()(),t(10,"tbody",33),F(11,Og,8,3,"tr",null,Dg),e()()),i&2){let o=h(2);l(9),p(o.ekyc_mode==1?"E-KYC through OTP":"E-KYC through BIOMETRIC"),l(2),V(o.filteredBlockStats)}}function Wg(i,s){i&1&&a(0," No Data Found ")}function Mg(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11),b(2,Tg,2,0,"h4",12)(3,Lg,2,0,"h4",12),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e()()()(),t(8,"div",16)(9,"div",17)(10,"input",18),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(11,"i",19),e(),t(12,"div",20),b(13,Ig,3,0,"button",21)(14,yg,3,0),e(),t(15,"div",22),b(16,kg,3,0,"button",21)(17,Pg,3,0),e()()(),t(18,"div",23),b(19,Bg,13,1,"table",24)(20,Wg,1,0),e()}if(i&2){let o=h();l(2),T("ngIf",o.ekyc_mode==1),l(1),T("ngIf",o.ekyc_mode==5),l(4),p(o.filteredBlockStats[0].district_name),l(3),T("ngModel",o.searchTerm),l(3),E(13,o.isExportInProgress?14:13),l(3),E(16,o.isExportInProgressExcel?17:16),l(3),E(19,o.filteredBlockStats&&o.filteredBlockStats.length>0?19:20)}}var xa=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.districtStats=[],this.district_id="",this.blockStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.params.subscribe(n=>{let r=n.id;this.district_id=r}),this.route.queryParams.subscribe(n=>{this.ekyc_mode=n.ekyc_mode,this.installment=n.installment,this.fetchblockStats(this.district_id)})}fetchblockStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/block-count?district_id=${n}&ekyc_mode=${this.ekyc_mode}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.blockStats=r.data,this.fetchulbStats(n)},r=>{this.isStatsLoading=!1,this.blockStats=[]})}fetchulbStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/ulb-count?district_id=${n}&ekyc_mode=${this.ekyc_mode}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.blockStats=[...this.blockStats,...r.data]},r=>{this.isStatsLoading=!1})}get filteredBlockStats(){return this.searchTerm?this.blockStats.filter(n=>n.block_name&&n.block_name.toLowerCase().includes(this.searchTerm.toLowerCase())||n.ulb_name&&n.ulb_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.blockStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.blockStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name,"BLOCK/ULB":(u.block_name||u.ulb_name).toUpperCase(),[this.ekyc_mode==1?"E-KYC through OTP":"E-KYC through BIOMETRIC"]:u?.applications_received})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=this.ekyc_mode==1?`otp_block_ulb_drilldown_reports_${C}_${g}.xlsx`:`biometrics_block_ulb_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){pi.default.vfs=ha.default.pdfMake.vfs,this.isExportInProgress=!0;let r=((this.blockStats[0]||{}).district_name||"N/A").toUpperCase(),c=[[{text:"SI#",fontSize:10},{text:"BLOCK/ULB",fontSize:10},{text:[this.ekyc_mode==1?"E-KYC through OTP":"E-KYC through BIOMETRIC"],fontSize:10}]];this.blockStats.forEach((u,I)=>{c.push([{text:(I+1).toString().toUpperCase(),fontSize:9},{text:(u.block_name||u.ulb_name||"").toUpperCase(),fontSize:9},{text:u?.applications_received,fontSize:9}])});let f=new Date,d=`Timestamp: ${f.toLocaleDateString()}, ${f.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,C=this.ekyc_mode==1?"DRILL-DOWN REPORT - e-KYC THROUGH OTP BLOCK-ULB-WISE":"DRILL-DOWN REPORT - e-KYC THROUGH BIOMETRIC BLOCK-ULB-WISE",g={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r}`,style:"breadcrumb",margin:[0,0,0,10]},{text:C,style:"header"},{table:{headerRows:1,body:c,widths:["20%","20%","20%"]},layout:{fillColor:function(u){return u===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:d,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},_=new Date,v=_.toLocaleDateString("en-GB").split("/").reverse().join("-"),S=_.toLocaleTimeString("en-GB").replace(/:/g,"-"),w=this.ekyc_mode==1?`otp_block_ulb_drilldown_reports_${v}_${S}.pdf`:`biometrics_block_ulb_drilldown_reports_${v}_${S}.pdf`;pi.default.createPdf(g).download(w,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-e-kyc-mode-block-ulb-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],["style","color: #fd7b03;",4,"ngIf"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],[2,"color","#fd7b03"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],[2,"font-size","14px"],["style","text-decoration: none",3,"routerLink","queryParams"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,wg,2,0)(11,Mg,21,7),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ft,ot,K,q,J,it]});let i=s;return i})();var mi=j(ut()),ga=j(ht());function Fg(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function Vg(i,s){i&1&&(t(0,"h4",26),a(1,"Drill-Down Report - e-KYC through OTP"),e())}function zg(i,s){i&1&&(t(0,"h4",26),a(1,"Drill-Down Report - e-KYC through Biometric"),e())}function jg(i,s){if(i&1){let o=U();t(0,"button",27),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",28),a(2,"Download PDF "),e()}}function $g(i,s){i&1&&(t(0,"button",29),m(1,"i",30),a(2,"Downloading "),e())}function Gg(i,s){if(i&1){let o=U();t(0,"button",27),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",28),a(2,"Download EXCEL "),e()}}function Xg(i,s){i&1&&(t(0,"button",29),m(1,"i",30),a(2,"Downloading "),e())}var Yg=(i,s)=>s.id,Hg=(i,s,o)=>["/department/portal/ekycmode/village-stats",i,s,o],Kg=(i,s)=>({ekyc_mode:i,installment:s});function qg(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",35),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),T("routerLink",Ft(7,Hg,o.district_id,o.block_id,o.gp_id))("queryParams",Lt(11,Kg,r.ekyc_mode,r.installment)),l(1),dt(" ",P(6,5,o.gp_name)," "),l(3),p(o==null?null:o.applications_received)}}function Jg(i,s){if(i&1&&(t(0,"table",31)(1,"thead",32)(2,"tr")(3,"th",33),a(4,"Sl.#"),e(),t(5,"th",33),a(6,"GRAM PANCHAYAT"),e()(),t(7,"tr")(8,"th"),a(9),e()()(),t(10,"tbody",34),F(11,qg,9,14,"tr",null,Yg),e()()),i&2){let o=h(2);l(9),p(o.ekyc_mode==1?"E-KYC through OTP":"E-KYC through BIOMETRIC"),l(2),V(o.filteredGpStats)}}function Qg(i,s){i&1&&a(0," No Data Found ")}function Zg(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11),b(2,Vg,2,0,"h4",12)(3,zg,2,0,"h4",12),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e(),t(8,"li",16),a(9),e()()()(),t(10,"div",17)(11,"div",18)(12,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(13,"i",20),e(),t(14,"div",21),b(15,jg,3,0,"button",22)(16,$g,3,0),e(),t(17,"div",23),b(18,Gg,3,0,"button",22)(19,Xg,3,0),e()()(),t(20,"div",24),b(21,Jg,13,1,"table",25)(22,Qg,1,0),e()}if(i&2){let o=h();l(2),T("ngIf",o.ekyc_mode==1),l(1),T("ngIf",o.ekyc_mode==5),l(4),p(o.filteredGpStats[0].district_name),l(2),p(o.filteredGpStats[0].block_name),l(3),T("ngModel",o.searchTerm),l(3),E(15,o.isExportInProgress?16:15),l(3),E(18,o.isExportInProgressExcel?19:18),l(3),E(21,o.filteredGpStats&&o.filteredGpStats.length>0?21:22)}}var Ca=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.district_id="",this.gpStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.id}),this.route.queryParams.subscribe(n=>{this.ekyc_mode=n.ekyc_mode,this.installment=n.installment,this.fetchgpStats(this.block_id)})}fetchgpStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/gp-count?block_id=${n}&ekyc_mode=${this.ekyc_mode}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.gpStats=r.data},r=>{this.isStatsLoading=!1,this.gpStats=[]})}get filteredGpStats(){return this.searchTerm?this.gpStats.filter(n=>n.gp_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.gpStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.gpStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",BLOCK:u.block_name?u.block_name.toUpperCase():"",GP:u.gp_name?u.gp_name.toUpperCase():"",[this.ekyc_mode==1?"E-KYC through OTP":"E-KYC through BIOMETRIC"]:u?.applications_received})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=this.ekyc_mode==1?`otp_gp_drilldown_reports_${C}_${g}.xlsx`:`biometrics_gp_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){mi.default.vfs=ga.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.gpStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=[[{text:"SI#",fontSize:10},{text:"GP",fontSize:10},{text:[this.ekyc_mode==1?"E-KYC through OTP":"E-KYC through BIOMETRIC"],fontSize:10}]];this.gpStats.forEach((I,R)=>{f.push([{text:(R+1).toString().toUpperCase(),fontSize:9},{text:(I.gp_name||"").toUpperCase(),fontSize:9},{text:I?.applications_received,fontSize:9}])});let d=new Date,C=`Timestamp: ${d.toLocaleDateString()}, ${d.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,g=this.ekyc_mode==1?"DRILL-DOWN REPORT - e-KYC THROUGH OTP GP WISE":"DRILL-DOWN REPORT - e-KYC THROUGH BIOMETRIC GP WISE",_={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK: ${c}`,style:"breadcrumb",margin:[0,0,0,10]},{text:g,style:"header"},{table:{headerRows:1,body:f,widths:["20%","20%","20%"]},layout:{fillColor:function(I){return I===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:C,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},v=new Date,S=v.toLocaleDateString("en-GB").split("/").reverse().join("-"),w=v.toLocaleTimeString("en-GB").replace(/:/g,"-"),u=this.ekyc_mode==1?`nfsa_gp_drilldown_reports_${S}_${w}.pdf`:`non_nfsa_gp_drilldown_reports_${S}_${w}.pdf`;mi.default.createPdf(_).download(u,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-e-kyc-mode-gp-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],["style","color: #fd7b03;",4,"ngIf"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],[2,"color","#fd7b03"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,Fg,2,0)(11,Zg,23,8),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ft,ot,K,q,J,it]});let i=s;return i})();var _i=j(ut()),ba=j(ht());function tC(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function eC(i,s){i&1&&(t(0,"h4",26),a(1,"Drill-Down Report - e-KYC through OTP"),e())}function iC(i,s){i&1&&(t(0,"h4",26),a(1,"Drill-Down Report - e-KYC through Biometric"),e())}function nC(i,s){if(i&1){let o=U();t(0,"button",27),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",28),a(2,"Download PDF "),e()}}function oC(i,s){i&1&&(t(0,"button",29),m(1,"i",30),a(2,"Downloading "),e())}function aC(i,s){if(i&1){let o=U();t(0,"button",27),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",28),a(2,"Download EXCEL "),e()}}function rC(i,s){i&1&&(t(0,"button",29),m(1,"i",30),a(2,"Downloading "),e())}var sC=(i,s)=>s.id,lC=(i,s,o)=>["/department/portal/ekycmode/ward-user-list",i,s,o],cC=(i,s)=>({ekyc_mode:i,installment:s});function dC(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",35),a(5),e()(),t(6,"td"),a(7),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),T("routerLink",Ft(5,lC,o.district_id,o.ulb_id,o.ward_id))("queryParams",Lt(9,cC,r.ekyc_mode,r.installment)),l(1),dt(" ",o.ward_no," "),l(2),p(o==null?null:o.applications_received)}}function pC(i,s){if(i&1&&(t(0,"table",31)(1,"thead",32)(2,"tr")(3,"th",33),a(4,"Sl.#"),e(),t(5,"th",33),a(6,"WARD"),e()(),t(7,"tr")(8,"th"),a(9),e()()(),t(10,"tbody",34),F(11,dC,8,12,"tr",null,sC),e()()),i&2){let o=h(2);l(9),p(o.ekyc_mode==1?"E-KYC through OTP":"E-KYC through BIOMETRIC"),l(2),V(o.filteredWardStats)}}function mC(i,s){i&1&&a(0," No Data Found ")}function _C(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11),b(2,eC,2,0,"h4",12)(3,iC,2,0,"h4",12),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e(),t(8,"li",16),a(9),e()()()(),t(10,"div",17)(11,"div",18)(12,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(13,"i",20),e(),t(14,"div",21),b(15,nC,3,0,"button",22)(16,oC,3,0),e(),t(17,"div",23),b(18,aC,3,0,"button",22)(19,rC,3,0),e()()(),t(20,"div",24),b(21,pC,13,1,"table",25)(22,mC,1,0),e()}if(i&2){let o=h();l(2),T("ngIf",o.ekyc_mode==1),l(1),T("ngIf",o.ekyc_mode==5),l(4),p(o.filteredWardStats[0].district_name),l(2),p(o.filteredWardStats[0].ulb_name),l(3),T("ngModel",o.searchTerm),l(3),E(15,o.isExportInProgress?16:15),l(3),E(18,o.isExportInProgressExcel?19:18),l(3),E(21,o.filteredWardStats&&o.filteredWardStats.length>0?21:22)}}var va=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.district_id="",this.wardStats=[],this.ulb_id="",this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.params.subscribe(n=>{this.district_id=n.district_id,this.ulb_id=n.id}),this.route.queryParams.subscribe(n=>{this.ekyc_mode=n.ekyc_mode,this.installment=n.installment,this.fetchWardStats(this.ulb_id)})}fetchWardStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/ward-count?ulb_id=${n}&ekyc_mode=${this.ekyc_mode}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.wardStats=r.data},r=>{this.isStatsLoading=!1,this.wardStats=[]})}get filteredWardStats(){return this.searchTerm?this.wardStats.filter(n=>n.ward_no.toLowerCase().includes(this.searchTerm.toLowerCase())):this.wardStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.wardStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",ULB:u.ulb_name?u.ulb_name.toUpperCase():"","WARD NO.":u.ward_no?u.ward_no.toUpperCase():"",[this.ekyc_mode==1?"E-KYC through OTP":"E-KYC through BIOMETRIC"]:u?.applications_received})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=this.ekyc_mode==1?`otp_ward_drilldown_reports_${C}_${g}.xlsx`:`biometrics_ward_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){_i.default.vfs=ba.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.wardStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=[[{text:"SI#",fontSize:10},{text:"WARD NO.",fontSize:10},{text:[this.ekyc_mode==1?"E-KYC through OTP":"E-KYC through BIOMETRIC"],fontSize:10}]];this.wardStats.forEach((I,R)=>{f.push([{text:(R+1).toString().toUpperCase(),fontSize:9},{text:(I.ward_no||"").toUpperCase(),fontSize:9},{text:I?.applications_received,fontSize:9}])});let d=new Date,C=`Timestamp: ${d.toLocaleDateString()}, ${d.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,g=this.ekyc_mode==1?"DRILL-DOWN REPORT - e-KYC THROUGH OTP WARD WISE":"DRILL-DOWN REPORT - e-KYC THROUGH BIOMETRIC WARD WISE",_={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK/ULB: ${c}`,style:"breadcrumb",margin:[0,0,0,10]},{text:g,style:"header"},{table:{headerRows:1,body:f,widths:["33%","33%","33%"]},layout:{fillColor:function(I){return I===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:C,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},v=new Date,S=v.toLocaleDateString("en-GB").split("/").reverse().join("-"),w=v.toLocaleTimeString("en-GB").replace(/:/g,"-"),u=this.ekyc_mode==1?`otp_ward_drilldown_reports_${S}_${w}.pdf`:`biometrics_ward_drilldown_reports_${S}_${w}.pdf`;_i.default.createPdf(_).download(u,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-e-kyc-mode-ward-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],["style","color: #fd7b03;",4,"ngIf"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],[2,"color","#fd7b03"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,tC,2,0)(11,_C,23,8),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ft,ot,K,q,J]});let i=s;return i})();var fi=j(ut()),Ea=j(ht());function fC(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function uC(i,s){i&1&&(t(0,"h4",26),a(1,"Drill-Down Report - e-KYC through OTP"),e())}function hC(i,s){i&1&&(t(0,"h4",26),a(1,"Drill-Down Report - e-KYC through Biometric"),e())}function SC(i,s){if(i&1){let o=U();t(0,"button",27),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",28),a(2,"Download PDF "),e()}}function xC(i,s){i&1&&(t(0,"button",29),m(1,"i",30),a(2,"Downloading "),e())}function gC(i,s){if(i&1){let o=U();t(0,"button",27),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",28),a(2,"Download EXCEL "),e()}}function CC(i,s){i&1&&(t(0,"button",29),m(1,"i",30),a(2,"Downloading "),e())}var bC=(i,s)=>s.id,vC=(i,s,o,n)=>["/department/portal/ekycmode/village-user-list",i,s,o,n],EC=(i,s)=>({ekyc_mode:i,installment:s});function wC(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",35),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),T("routerLink",Yt(7,vC,o.district_id,o.block_id,o.gp_id,o.village_id))("queryParams",Lt(12,EC,r.ekyc_mode,r.installment)),l(1),dt(" ",P(6,5,o.village_name)," "),l(3),p(o==null?null:o.applications_received)}}function TC(i,s){if(i&1&&(t(0,"table",31)(1,"thead",32)(2,"tr")(3,"th",33),a(4,"Sl.#"),e(),t(5,"th",33),a(6,"VILLAGE"),e()(),t(7,"tr")(8,"th"),a(9),e()()(),t(10,"tbody",34),F(11,wC,9,15,"tr",null,bC),e()()),i&2){let o=h(2);l(9),p(o.ekyc_mode==1?"E-KYC through OTP":"E-KYC through BIOMETRIC"),l(2),V(o.filteredVillageStats)}}function LC(i,s){i&1&&a(0," No Data Found ")}function IC(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11),b(2,uC,2,0,"h4",12)(3,hC,2,0,"h4",12),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e(),t(8,"li",15),a(9),e(),t(10,"li",16),a(11),e()()()(),t(12,"div",17)(13,"div",18)(14,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(15,"i",20),e(),t(16,"div",21),b(17,SC,3,0,"button",22)(18,xC,3,0),e(),t(19,"div",23),b(20,gC,3,0,"button",22)(21,CC,3,0),e()()(),t(22,"div",24),b(23,TC,13,1,"table",25)(24,LC,1,0),e()}if(i&2){let o=h();l(2),T("ngIf",o.ekyc_mode==1),l(1),T("ngIf",o.ekyc_mode==5),l(4),p(o.filteredVillageStats[0].district_name),l(2),p(o.filteredVillageStats[0].block_name),l(2),p(o.filteredVillageStats[0].gp_name),l(3),T("ngModel",o.searchTerm),l(3),E(17,o.isExportInProgress?18:17),l(3),E(20,o.isExportInProgressExcel?21:20),l(3),E(23,o.filteredVillageStats&&o.filteredVillageStats.length>0?23:24)}}var wa=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.gp_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.block_id,this.gp_id=n.id}),this.route.queryParams.subscribe(n=>{this.ekyc_mode=n.ekyc_mode,this.installment=n.installment,this.fetchvillageStats(this.gp_id)})}fetchvillageStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/village-count?gp_id=${n}&ekyc_mode=${this.ekyc_mode}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.villageStats=r.data},r=>{this.isStatsLoading=!1,this.villageStats=[]})}get filteredVillageStats(){return this.searchTerm?this.villageStats.filter(n=>n.village_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.villageStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.villageStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",BLOCK:u.block_name?u.block_name.toUpperCase():"",GP:u.gp_name?u.gp_name.toUpperCase():"",VILLAGE:u.village_name?u.village_name.toUpperCase():"",[this.ekyc_mode==1?"E-KYC through OTP":"E-KYC through BIOMETRIC"]:u?.applications_received})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=this.ekyc_mode==1?`otp_village_drilldown_reports_${C}_${g}.xlsx`:`biometrics_village_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){fi.default.vfs=Ea.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.villageStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=(n.gp_name||n.ward_no||"N/A").toUpperCase(),d=[[{text:"SI#",fontSize:10},{text:"VILLAGE",fontSize:10},{text:[this.ekyc_mode==1?"E-KYC through OTP":"E-KYC through BIOMETRIC"],fontSize:10}]];this.villageStats.forEach((R,z)=>{d.push([{text:(z+1).toString().toUpperCase(),fontSize:9},{text:(R.village_name||"").toUpperCase(),fontSize:9},{text:R?.applications_received,fontSize:9}])});let C=new Date,g=`Timestamp: ${C.toLocaleDateString()}, ${C.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,_=this.ekyc_mode==1?"DRILL-DOWN REPORT - e-KYC THROUGH OTP VILLAGE WISE":"DRILL-DOWN REPORT - e-KYC THROUGH BIOMETRIC VILLAGE WISE",v={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK: ${c} > GP:${f}`,style:"breadcrumb",margin:[0,0,0,10]},{text:_,style:"header"},{table:{headerRows:1,body:d,widths:["20%","20%","20%"]},layout:{fillColor:function(R){return R===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:g,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},S=new Date,w=S.toLocaleDateString("en-GB").split("/").reverse().join("-"),u=S.toLocaleTimeString("en-GB").replace(/:/g,"-"),I=this.ekyc_mode==1?`otp_village_drilldown_reports_${w}_${u}.pdf`:`biometrics_village_drilldown_reports_${w}_${u}.pdf`;fi.default.createPdf(v).download(I,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-e-kyc-mode-village-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],["style","color: #fd7b03;",4,"ngIf"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],[2,"color","#fd7b03"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,fC,2,0)(11,IC,25,9),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ft,ot,K,q,J,it]});let i=s;return i})();var ui=j(ut()),Ta=j(ht());function yC(i,s){i&1&&(t(0,"h4",33),a(1,"Detailed Report - e-KYC Through OTP"),e())}function kC(i,s){i&1&&(t(0,"h4",33),a(1,"Detailed Report - e-KYC Through Biometric"),e())}function PC(i,s){if(i&1&&(t(0,"div",34)(1,"div",35)(2,"nav",36)(3,"ol",37)(4,"li",38),a(5),e(),t(6,"li",38),a(7),e(),t(8,"li",38),a(9),e(),t(10,"li",39),a(11),e()()()()()),i&2){let o=h();l(5),p(o.filteredVillageUserStats[0].district_name),l(2),p(o.filteredVillageUserStats[0].block_name),l(2),p(o.filteredVillageUserStats[0].gp_name),l(2),p(o.filteredVillageUserStats[0].village_name)}}function DC(i,s){i&1&&(t(0,"button",40),m(1,"i",41),a(2,"Search "),e())}function AC(i,s){i&1&&(t(0,"button",42),m(1,"i",43),a(2," Searching ..."),e())}function UC(i,s){i&1&&(m(0,"i",44),a(1," We are fetching the data, please wait. "))}function NC(i,s){if(i&1){let o=U();t(0,"button",59),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",60),a(2,"Download to PDF "),e()}}function RC(i,s){i&1&&(t(0,"button",61),m(1,"i",43),a(2,"Downloading "),e())}function OC(i,s){if(i&1){let o=U();t(0,"button",59),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",60),a(2,"Download to EXCEL "),e()}}function BC(i,s){i&1&&(t(0,"button",61),m(1,"i",43),a(2,"Downloading "),e())}var WC=(i,s)=>s.id;function MC(i,s){if(i&1&&(t(0,"td"),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit;l(1),p(P(2,1,o.village_name))}}function FC(i,s){i&1&&m(0,"td")}function VC(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),b(3,MC,3,3,"td")(4,FC,1,0),t(5,"td"),a(6),k(7,"uppercase"),e(),t(8,"td"),a(9),k(10,"uppercase"),e(),t(11,"td"),a(12),k(13,"uppercase"),e(),t(14,"td"),a(15),k(16,"uppercase"),e(),t(17,"td"),a(18),k(19,"uppercase"),e(),t(20,"td"),a(21),k(22,"uppercase"),e(),t(23,"td"),a(24),k(25,"uppercase"),e(),t(26,"td"),a(27),e(),t(28,"td"),a(29),k(30,"uppercase"),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(1),E(3,o.village_name?3:4),l(3),p(P(7,11,o.category)),l(3),p(P(10,13,o.application_number)),l(3),p(P(13,15,r.appService.dateFormat(o.application_date))),l(3),p(P(16,17,o.applicant_name)),l(3),p(P(19,19,o.spouse_or_father_name)),l(3),p(P(22,21,o.social_category)),l(3),p(P(25,23,o.pwd_status)),l(3),p(o.alt_mobile_number),l(2),p(P(30,25,o.application_status))}}function zC(i,s){if(i&1&&(t(0,"table",62)(1,"thead",63)(2,"tr")(3,"th"),a(4,"SI#"),e(),t(5,"th"),a(6,"VILLAGE"),e(),t(7,"th"),a(8,"CATEGORY"),e(),t(9,"th"),a(10,"APPLICATION NO."),e(),t(11,"th"),a(12,"APPLICATION DATE"),e(),t(13,"th"),a(14,"APPLICANT NAME"),e(),t(15,"th"),a(16,"FATHER/HUSBAND NAME"),e(),t(17,"th"),a(18,"SOCIAL CATEGORY"),e(),t(19,"th"),a(20,"PWD"),e(),t(21,"th"),a(22,"MOBILE NO."),e(),t(23,"th"),a(24,"APPLICATION STATUS"),e()()(),t(25,"tbody"),F(26,VC,31,27,"tr",null,WC),e()()),i&2){let o=h(2);l(26),V(o.filteredVillageUserStats)}}function jC(i,s){i&1&&(t(0,"h5",64),a(1,"No data available"),e())}function $C(i,s){i&1&&(t(0,"div",65),a(1,"Loading.. "),m(2,"i",66),e())}function GC(i,s){i&1&&(t(0,"span"),m(1,"i",44),a(2," Loading..."),e())}function XC(i,s){i&1&&(t(0,"span"),a(1,"Load More"),e())}function YC(i,s){if(i&1){let o=U();t(0,"div",67)(1,"button",68),L("click",function(){D(o);let r=h(2);return A(r.loadMore())}),b(2,GC,3,0,"span",69)(3,XC,2,0,"span",69),e()()}if(i&2){let o=h(2);l(2),T("ngIf",o.isLoadMoreInProgress),l(1),T("ngIf",!o.isLoadMoreInProgress)}}function HC(i,s){if(i&1){let o=U();t(0,"div",34)(1,"div",45)(2,"h5",46),a(3," Number of records found : "),t(4,"span",47),a(5),e()()(),t(6,"div",48)(7,"div",49)(8,"input",50),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(9,"i",51),e(),t(10,"div",52),b(11,NC,3,0,"button",53)(12,RC,3,0),e(),t(13,"div",54),b(14,OC,3,0,"button",53)(15,BC,3,0),e()()(),t(16,"div",55),b(17,zC,28,0,"table",56)(18,jC,2,0)(19,$C,3,0,"div",57),e(),b(20,YC,4,2,"div",58)}if(i&2){let o=h();l(5),p(o.count),l(3),T("ngModel",o.searchTerm),l(3),E(11,o.isExportInProgress?12:11),l(3),E(14,o.isExportInProgressExcel?15:14),l(3),E(17,o.filteredVillageUserStats&&o.filteredVillageUserStats.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),l(2),E(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),l(1),T("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var La=(()=>{let s=class s{constructor(n,r,c,f,d,C,g,_){this.route=n,this.router=r,this.formService=c,this.appService=f,this.httpClient=d,this.toastService=C,this.authService=g,this.masterDataService=_,this.isStatsLoading=!1,this.userStats=[],this.block_id="",this.gp_id="",this.village_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.limit=this.appService.loadmorelimit,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.count=0,this.searchForm=new kt({a_category:new nt(""),social_category:new nt(""),pwd_status:new nt(""),submit_date:new nt(""),a_status:new nt("")})}ngOnInit(){this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.block_id,this.gp_id=n.gp_id,this.village_id=n.id}),this.route.queryParams.subscribe(n=>{this.ekyc_mode=n.ekyc_mode,this.installment=n.installment,this.fetchuserStats(this.village_id)})}fetchuserStats(n,r=!1){this.isStatsLoading=!0;let c=new st;c=c.set("gp_id",this.gp_id),c=c.set("village_id",n),c=c.set("offset",this.offset),c=c.set("limit",this.limit),this.ekyc_mode!==void 0&&(c=c.set("ekyc_mode",this.ekyc_mode.toString())),this.installment!==void 0&&(c=c.set("installment",this.installment.toString()));let f=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:c,headers:f}).subscribe(d=>{this.isStatsLoading=!1,this.count=d.count,d.data&&d.data.length>0?(this.application_list=this.application_list.concat(d.data),this.offset+=d.data.length,this.hasMoreRecords=d.data.length===this.limit):this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)},d=>{this.isStatsLoading=!1,this.application_list=[],this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)})}get filteredVillageUserStats(){if(!this.searchTerm)return this.application_list;let n=this.searchTerm.toLowerCase();return this.application_list.filter(r=>r.village_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.category?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.application_number?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_date).toLowerCase().includes(this.searchTerm.toLowerCase())||r.applicant_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.spouse_or_father_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.dob).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.social_category).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.pwd_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.alt_mobile_number).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.payment_status).toLowerCase().includes(this.searchTerm.toLowerCase()))}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status,_=new st;_=_.set("gp_id",this.gp_id),r&&(_=_.set("village_id",r)),c&&(_=_.set("category",c)),f&&(_=_.set("social_category",f)),d&&(_=_.set("pwd_status",d)),g&&(_=_.set("application_status",g)),_=_.set("offset",this.offset),_=_.set("limit",this.limit),this.ekyc_mode!==void 0&&(_=_.set("ekyc_mode",this.ekyc_mode.toString())),this.installment!==void 0&&(_=_.set("installment",this.installment.toString()));let v=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:_,headers:v}).subscribe(S=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=S.count,S.data&&S.data.length>0?(this.application_list=this.application_list.concat(S.data),this.offset+=S.data.length,this.hasMoreRecords=S.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},S=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}exportToExcel(){let n=new st,r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;n=n.set("gp_id",this.gp_id),r&&(n=n.set("village_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),g&&(n=n.set("application_status",g)),n=n.set("export_all","1"),this.ekyc_mode!==void 0&&(n=n.set("ekyc_mode",this.ekyc_mode.toString())),this.installment!==void 0&&(n=n.set("installment",this.installment.toString()));let _=new rt({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgressExcel=!1;let S=v.data.map((y,B)=>({"SI#":B+1,DISTRICT:y.district_name?y.district_name.toUpperCase():"",BLOCK:y.block_name?y.block_name.toUpperCase():"",GP:y.gp_name?y.gp_name.toUpperCase():"",VILLAGE:y.village_name?y.village_name.toUpperCase():"",CATEGORY:y.category.toUpperCase(),"APPLICATION NO.":y.application_number.toUpperCase(),"APPLICATION DATE":this.appService.dateFormat(y.application_date),"APPLICANT NAME":y.applicant_name.toUpperCase(),"FATHER/HUSBAND NAME":y.spouse_or_father_name.toUpperCase(),"SOCIAL CATEGORY":y.social_category.toUpperCase(),PWD:y.pwd_status.toUpperCase(),"MOBILE NO.":y.alt_mobile_number,"APPLICATION STATUS":y.application_status.toUpperCase()})),w=N.json_to_sheet(S),u=N.book_new();N.book_append_sheet(u,w,"Applications");let I=Z(u,{bookType:"xlsx",type:"array"}),R=new Date,z=R.toLocaleDateString("en-GB").split("/").reverse().join("-"),at=R.toLocaleTimeString("en-GB").replace(/:/g,"-"),ct=this.ekyc_mode==1?`otp_application_status_reports_${z}_${at}.xlsx`:`biometrics_application_status_reports_${z}_${at}.xlsx`,lt=new Blob([I],{type:"application/octet-stream"}),O=document.createElement("a"),et=window.URL.createObjectURL(lt);O.href=et,O.download=ct,O.click(),window.URL.revokeObjectURL(et)},v=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",v)})}exportToPDF(){ui.default.vfs=Ta.default.pdfMake.vfs;let n=new st,r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;n=n.set("gp_id",this.gp_id),r&&(n=n.set("village_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),g&&(n=n.set("application_status",g)),n=n.set("export_all","1"),this.ekyc_mode!==void 0&&(n=n.set("ekyc_mode",this.ekyc_mode.toString())),this.installment!==void 0&&(n=n.set("installment",this.installment.toString()));let _=new rt({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgress=!1;let S=v.data[0]||{},w=(S.district_name||"N/A").toUpperCase(),u=(S.block_name||S.ulb_name||"N/A").toUpperCase(),I=(S.gp_name||S.ward_no||"N/A").toUpperCase(),R=(S.village_name||"").toUpperCase(),z=[[{text:"SI#",fontSize:10},{text:"CATEGORY",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICATION DATE.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"SOCIAL CATEGORY",fontSize:10},{text:"PWD",fontSize:10},{text:"MOBILE NO",fontSize:10},{text:"APPLICATION STATUS",fontSize:10}]];v.data.forEach((It,jt)=>{z.push([{text:(jt+1).toString().toUpperCase(),fontSize:9},{text:(It.category||"").toUpperCase(),fontSize:9},{text:(It.application_number||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(It.application_date)||"",fontSize:9},{text:(It.applicant_name||"").toUpperCase(),fontSize:9},{text:(It.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:(It.social_category||"").toUpperCase(),fontSize:9},{text:(It.pwd_status||"").toUpperCase(),fontSize:9},{text:(It.alt_mobile_number||"").toUpperCase(),fontSize:9},{text:(It.application_status||"").toUpperCase(),fontSize:9}])});let at=new Date,ct=`Timestamp: ${at.toLocaleDateString()}, ${at.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,lt=this.ekyc_mode==1?"DETAILED REPORT - e-KYC THROUGH OTP":"DETAILED REPORT - e-KYC THROUGH BIOMETRIC",O={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${w} > BLOCK: ${u} > GP: ${I} >VILLAGE: ${R}`,style:"breadcrumb",margin:[0,0,0,10]},{text:lt,style:"header"},{table:{headerRows:1,body:z,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]},layout:{fillColor:function(It){return It===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:ct,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},et=new Date,y=et.toLocaleDateString("en-GB").split("/").reverse().join("-"),B=et.toLocaleTimeString("en-GB").replace(/:/g,"-"),W=this.ekyc_mode==1?`otp_application_status_reports_${y}_${B}.pdf`:`biometrics_application_status_reports_${y}_${B}.pdf`;ui.default.createPdf(O).download(W)},v=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",v)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(Ot),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-e-kyc-mode-village-user-list"]],decls:68,vars:6,consts:[[1,"container-fluid","drilldown-reports"],[1,"d-flex","justify-content-between","w-100","mb-3"],["style","color: #fd7b03;",4,"ngIf"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],["class","row mb-2"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-2"],[1,"col-md-3"],["for","a_category",1,"fw-bold"],["formControlName","a_category","id","a_category",1,"form-select","my-2"],["value",""],["value","1"],["value","0"],["for","social_category",1,"fw-bold"],["formControlName","social_category","id","social_category",1,"form-select","my-2"],["value","2"],["value","3"],["value","4"],["for","a_status",1,"fw-bold"],["formControlName","a_status","id","a_status",1,"form-select","my-2"],["value","7"],["for","pwd_status",1,"fw-bold"],["formControlName","pwd_status","id","pwd_status",1,"form-select","my-2"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[2,"color","#fd7b03"],[1,"row","mb-2"],[1,"col-md-7"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"fa","fa-spinner","fa-spin"],[1,"col-md-5"],[1,"card-title"],["id","recordCount"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports detail"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports","detail"],[1,"text-light",2,"background-color","#fd7b03"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"],[4,"ngIf"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),b(2,yC,2,0,"h4",2)(3,kC,2,0,"h4",2),t(4,"div",3)(5,"a",4),L("click",function(){return c.appService.goBack()}),t(6,"button",5),m(7,"i",6),a(8," Back"),e()()()(),b(9,PC,12,4,"div",7),t(10,"div",8)(11,"form",9),L("ngSubmit",function(){return c.onSearch()}),t(12,"div",10)(13,"div",11)(14,"label",12),a(15," Category "),e(),t(16,"select",13)(17,"option",14),a(18,"Choose Category"),e(),t(19,"option",15),a(20,"NFSA"),e(),t(21,"option",16),a(22,"NON-NFSA"),e()()(),t(23,"div",11)(24,"label",17),a(25," Social Category "),e(),t(26,"select",18)(27,"option",14),a(28,"Choose Social Category"),e(),t(29,"option",15),a(30,"Un-Reserved"),e(),t(31,"option",19),a(32,"OBC"),e(),t(33,"option",20),a(34,"SC"),e(),t(35,"option",21),a(36,"ST"),e()()(),t(37,"div",11)(38,"label",22),a(39," Application Status "),e(),t(40,"select",23)(41,"option",14),a(42,"Choose Status"),e(),t(43,"option",24),a(44,"Under Process"),e(),t(45,"option",15),a(46,"Approved"),e(),t(47,"option",19),a(48,"Rejected"),e()()(),t(49,"div",11)(50,"label",25),a(51," PWD "),e(),t(52,"select",26)(53,"option",14),a(54,"Choose PWD Status"),e(),t(55,"option",15),a(56,"Yes "),e(),t(57,"option",16),a(58,"NO"),e()()()(),t(59,"div",27)(60,"div",28),b(61,DC,3,0,"button",29)(62,AC,3,0),e()()()(),t(63,"div",30)(64,"div",31)(65,"div",32),b(66,UC,2,0)(67,HC,21,7),e()()()()),r&2&&(l(2),T("ngIf",c.ekyc_mode==1),l(1),T("ngIf",c.ekyc_mode==5),l(6),E(9,c.filteredVillageUserStats&&c.filteredVillageUserStats.length>0?9:-1),l(2),T("formGroup",c.searchForm),l(50),E(61,c.isFormSearchInProgress?62:61),l(5),E(66,c.isStatsLoading?66:67))},dependencies:[ft,Pt,Nt,Rt,K,Ut,q,yt,J,Dt,At,it]});let i=s;return i})();var hi=j(ut()),Ia=j(ht());function KC(i,s){i&1&&(t(0,"h4",33),a(1,"DETAILED REPORT - e-KYC THROUGH OTP"),e())}function qC(i,s){i&1&&(t(0,"h4",33),a(1,"DETAILED REPORT - e-KYC THROUGH BIOMETRIC"),e())}function JC(i,s){if(i&1&&(t(0,"div",34)(1,"div",35)(2,"nav",36)(3,"ol",37)(4,"li",38),a(5),e(),t(6,"li",38),a(7),e(),t(8,"li",39),a(9),e()()()()()),i&2){let o=h();l(5),p(o.filteredWardUserStats[0].district_name),l(2),p(o.filteredWardUserStats[0].ulb_name),l(2),p(o.filteredWardUserStats[0].ward_no)}}function QC(i,s){i&1&&(t(0,"button",40),m(1,"i",41),a(2,"Search "),e())}function ZC(i,s){i&1&&(t(0,"button",42),m(1,"i",43),a(2," Searching ..."),e())}function t2(i,s){i&1&&(m(0,"i",44),a(1," We are fetching the data, please wait. "))}function e2(i,s){if(i&1){let o=U();t(0,"button",59),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",60),a(2,"Download to PDF "),e()}}function i2(i,s){i&1&&(t(0,"button",61),m(1,"i",43),a(2,"Downloading "),e())}function n2(i,s){if(i&1){let o=U();t(0,"button",59),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",60),a(2,"Download to EXCEL "),e()}}function o2(i,s){i&1&&(t(0,"button",61),m(1,"i",43),a(2,"Downloading "),e())}var a2=(i,s)=>s.id;function r2(i,s){if(i&1&&(t(0,"td"),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit;l(1),p(P(2,1,o.ward_no))}}function s2(i,s){i&1&&m(0,"td")}function l2(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),b(3,r2,3,3,"td")(4,s2,1,0),t(5,"td"),a(6),k(7,"uppercase"),e(),t(8,"td"),a(9),k(10,"uppercase"),e(),t(11,"td"),a(12),k(13,"uppercase"),e(),t(14,"td"),a(15),k(16,"uppercase"),e(),t(17,"td"),a(18),k(19,"uppercase"),e(),t(20,"td"),a(21),k(22,"uppercase"),e(),t(23,"td"),a(24),k(25,"uppercase"),e(),t(26,"td"),a(27),e(),t(28,"td"),a(29),k(30,"uppercase"),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(1),E(3,o.ward_no?3:4),l(3),p(P(7,11,o.category)),l(3),p(P(10,13,o.application_number)),l(3),p(P(13,15,r.appService.dateFormat(o.application_date))),l(3),p(P(16,17,o.applicant_name)),l(3),p(P(19,19,o.spouse_or_father_name)),l(3),p(P(22,21,o.social_category)),l(3),p(P(25,23,o.pwd_status)),l(3),p(o.alt_mobile_number),l(2),p(P(30,25,o.application_status))}}function c2(i,s){if(i&1&&(t(0,"table",62)(1,"thead",63)(2,"tr")(3,"th"),a(4,"SI#"),e(),t(5,"th"),a(6,"WARD NO."),e(),t(7,"th"),a(8,"CATEGORY"),e(),t(9,"th"),a(10,"APPLICATION NO."),e(),t(11,"th"),a(12,"APPLICATION DATE"),e(),t(13,"th"),a(14,"APPLICANT NAME"),e(),t(15,"th"),a(16,"FATHER/HUSBAND NAME"),e(),t(17,"th"),a(18,"SOCIAL CATEGORY"),e(),t(19,"th"),a(20,"PWD"),e(),t(21,"th"),a(22,"MOBILE NO."),e(),t(23,"th"),a(24,"APPLICATION STATUS"),e()()(),t(25,"tbody"),F(26,l2,31,27,"tr",null,a2),e()()),i&2){let o=h(2);l(26),V(o.filteredWardUserStats)}}function d2(i,s){i&1&&(t(0,"h5",64),a(1,"No data available"),e())}function p2(i,s){i&1&&(t(0,"div",65),a(1,"Loading.. "),m(2,"i",66),e())}function m2(i,s){i&1&&(t(0,"span"),m(1,"i",44),a(2," Loading..."),e())}function _2(i,s){i&1&&(t(0,"span"),a(1,"Load More"),e())}function f2(i,s){if(i&1){let o=U();t(0,"div",67)(1,"button",68),L("click",function(){D(o);let r=h(2);return A(r.loadMore())}),b(2,m2,3,0,"span",69)(3,_2,2,0,"span",69),e()()}if(i&2){let o=h(2);l(2),T("ngIf",o.isLoadMoreInProgress),l(1),T("ngIf",!o.isLoadMoreInProgress)}}function u2(i,s){if(i&1){let o=U();t(0,"div",34)(1,"div",45)(2,"h5",46),a(3," Number of records found : "),t(4,"span",47),a(5),e()()(),t(6,"div",48)(7,"div",49)(8,"input",50),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(9,"i",51),e(),t(10,"div",52),b(11,e2,3,0,"button",53)(12,i2,3,0),e(),t(13,"div",54),b(14,n2,3,0,"button",53)(15,o2,3,0),e()()(),t(16,"div",55),b(17,c2,28,0,"table",56)(18,d2,2,0)(19,p2,3,0,"div",57),e(),b(20,f2,4,2,"div",58)}if(i&2){let o=h();l(5),p(o.count),l(3),T("ngModel",o.searchTerm),l(3),E(11,o.isExportInProgress?12:11),l(3),E(14,o.isExportInProgressExcel?15:14),l(3),E(17,o.filteredWardUserStats&&o.filteredWardUserStats.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),l(2),E(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),l(1),T("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var ya=(()=>{let s=class s{constructor(n,r,c,f,d,C,g,_){this.route=n,this.router=r,this.formService=c,this.appService=f,this.httpClient=d,this.toastService=C,this.authService=g,this.masterDataService=_,this.isStatsLoading=!1,this.userStats=[],this.ulb_id="",this.ward_id="",this.village_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.limit=this.appService.loadmorelimit,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.count=0,this.searchForm=new kt({a_category:new nt(""),social_category:new nt(""),pwd_status:new nt(""),submit_date:new nt(""),a_status:new nt("")})}ngOnInit(){this.route.params.subscribe(n=>{this.district_id=n.district_id,this.ulb_id=n.ulb_id,this.ward_id=n.id}),this.route.queryParams.subscribe(n=>{this.ekyc_mode=n.ekyc_mode,this.installment=n.installment,this.fetchuserStats(this.ward_id)})}fetchuserStats(n,r=!1){this.isStatsLoading=!0;let c=new st;c=c.set("ward_id",n),c=c.set("offset",this.offset),c=c.set("limit",this.limit),this.ekyc_mode!==void 0&&(c=c.set("ekyc_mode",this.ekyc_mode.toString())),this.installment!==void 0&&(c=c.set("installment",this.installment.toString()));let f=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:c,headers:f}).subscribe(d=>{this.isStatsLoading=!1,this.count=d.count,d.data&&d.data.length>0?(this.application_list=this.application_list.concat(d.data),this.offset+=d.data.length,this.hasMoreRecords=d.data.length===this.limit):this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)},d=>{this.isStatsLoading=!1,this.application_list=[],this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)})}get filteredWardUserStats(){if(!this.searchTerm)return this.application_list;let n=this.searchTerm.toLowerCase();return this.application_list.filter(r=>r.ward_no?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.category?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.application_number?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_date).toLowerCase().includes(this.searchTerm.toLowerCase())||r.applicant_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.spouse_or_father_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.dob).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.social_category).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.pwd_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.alt_mobile_number).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.payment_status).toLowerCase().includes(this.searchTerm.toLowerCase()))}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status,_=new st;r&&(_=_.set("ward_id",r)),c&&(_=_.set("category",c)),f&&(_=_.set("social_category",f)),d&&(_=_.set("pwd_status",d)),g&&(_=_.set("application_status",g)),_=_.set("offset",this.offset),_=_.set("limit",this.limit),this.ekyc_mode!==void 0&&(_=_.set("ekyc_mode",this.ekyc_mode.toString())),this.installment!==void 0&&(_=_.set("installment",this.installment.toString()));let v=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:_,headers:v}).subscribe(S=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=S.count,S.data&&S.data.length>0?(this.application_list=this.application_list.concat(S.data),this.offset+=S.data.length,this.hasMoreRecords=S.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},S=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}exportToExcel(){let n=new st,r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;r&&(n=n.set("ward_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),g&&(n=n.set("application_status",g)),n=n.set("export_all","1"),this.ekyc_mode!==void 0&&(n=n.set("ekyc_mode",this.ekyc_mode.toString())),this.installment!==void 0&&(n=n.set("installment",this.installment.toString()));let _=new rt({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgressExcel=!1;let S=v.data.map((y,B)=>({"SI#":B+1,DISTRICT:y.district_name?y.district_name.toUpperCase():"",ULB:y.ulb_name?y.ulb_name.toUpperCase():"","WARD NO.":y.ward_no?y.ward_no.toUpperCase():"",CATEGORY:y.category.toUpperCase(),"APPLICATION NO.":y.application_number.toUpperCase(),"APPLICATION DATE":this.appService.dateFormat(y.application_date),"APPLICANT NAME":y.applicant_name.toUpperCase(),"FATHER/HUSBAND NAME":y.spouse_or_father_name.toUpperCase(),"SOCIAL CATEGORY":y.social_category.toUpperCase(),PWD:y.pwd_status.toUpperCase(),"MOBILE NO.":y.alt_mobile_number,"APPLICATION STATUS":y.application_status.toUpperCase()})),w=N.json_to_sheet(S),u=N.book_new();N.book_append_sheet(u,w,"Applications");let I=Z(u,{bookType:"xlsx",type:"array"}),R=new Date,z=R.toLocaleDateString("en-GB").split("/").reverse().join("-"),at=R.toLocaleTimeString("en-GB").replace(/:/g,"-"),ct=this.ekyc_mode==1?`otp_application_status_reports_${z}_${at}.xlsx`:`biometrics_application_status_reports_${z}_${at}.xlsx`,lt=new Blob([I],{type:"application/octet-stream"}),O=document.createElement("a"),et=window.URL.createObjectURL(lt);O.href=et,O.download=ct,O.click(),window.URL.revokeObjectURL(et)},v=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",v)})}exportToPDF(){hi.default.vfs=Ia.default.pdfMake.vfs;let n=new st,r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;r&&(n=n.set("ward_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),g&&(n=n.set("application_status",g)),n=n.set("export_all","1"),this.ekyc_mode!==void 0&&(n=n.set("ekyc_mode",this.ekyc_mode.toString())),this.installment!==void 0&&(n=n.set("installment",this.installment.toString()));let _=new rt({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgress=!1;let S=v.data[0]||{},w=(S.district_name||"N/A").toUpperCase(),u=(S.block_name||S.ulb_name||"N/A").toUpperCase(),I=(S.gp_name||S.ward_no||"N/A").toUpperCase(),R=[[{text:"SI#",fontSize:10},{text:"CATEGORY",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICATION DATE.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"SOCIAL CATEGORY",fontSize:10},{text:"PWD",fontSize:10},{text:"MOBILE NO",fontSize:10},{text:"APPLICATION STATUS",fontSize:10}]];v.data.forEach((W,It)=>{R.push([{text:(It+1).toString().toUpperCase(),fontSize:9},{text:(W.category||"").toUpperCase(),fontSize:9},{text:(W.application_number||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(W.application_date)||"",fontSize:9},{text:(W.applicant_name||"").toUpperCase(),fontSize:9},{text:(W.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:(W.social_category||"").toUpperCase(),fontSize:9},{text:(W.pwd_status||"").toUpperCase(),fontSize:9},{text:(W.alt_mobile_number||"").toUpperCase(),fontSize:9},{text:(W.application_status||"").toUpperCase(),fontSize:9}])});let z=new Date,at=`Timestamp: ${z.toLocaleDateString()}, ${z.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,ct=this.ekyc_mode==1?"DETAILED REPORT - e-KYC THROUGH OTP":"DETAILED REPORT - e-KYC THROUGH BIOMETRIC",lt={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${w} > ULB: ${u} > WARD: ${I}`,style:"breadcrumb",margin:[0,0,0,10]},{text:ct,style:"header"},{table:{headerRows:1,body:R,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]},layout:{fillColor:function(W){return W===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:at,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},O=new Date,et=O.toLocaleDateString("en-GB").split("/").reverse().join("-"),y=O.toLocaleTimeString("en-GB").replace(/:/g,"-"),B=this.ekyc_mode==1?`otp_application_status_reports_${et}_${y}.pdf`:`biometrics_application_status_reports_${et}_${y}.pdf`;hi.default.createPdf(lt).download(B)},v=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",v)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(Ot),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-e-kyc-mode-ward-user-list"]],decls:68,vars:6,consts:[[1,"container-fluid","drilldown-reports"],[1,"d-flex","justify-content-between","w-100","mb-3"],["style","color: #fd7b03;",4,"ngIf"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],["class","row mb-2"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-2"],[1,"col-md-3"],["for","a_category",1,"fw-bold"],["formControlName","a_category","id","a_category",1,"form-select","my-2"],["value",""],["value","1"],["value","0"],["for","social_category",1,"fw-bold"],["formControlName","social_category","id","social_category",1,"form-select","my-2"],["value","2"],["value","3"],["value","4"],["for","a_status",1,"fw-bold"],["formControlName","a_status","id","a_status",1,"form-select","my-2"],["value","7"],["for","pwd_status",1,"fw-bold"],["formControlName","pwd_status","id","pwd_status",1,"form-select","my-2"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[2,"color","#fd7b03"],[1,"row","mb-2"],[1,"col-md-7"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"fa","fa-spinner","fa-spin"],[1,"col-md-5"],[1,"card-title"],["id","recordCount"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports detail"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports","detail"],[1,"text-light",2,"background-color","#fd7b03"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"],[4,"ngIf"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),b(2,KC,2,0,"h4",2)(3,qC,2,0,"h4",2),t(4,"div",3)(5,"a",4),L("click",function(){return c.appService.goBack()}),t(6,"button",5),m(7,"i",6),a(8," Back"),e()()()(),b(9,JC,10,3,"div",7),t(10,"div",8)(11,"form",9),L("ngSubmit",function(){return c.onSearch()}),t(12,"div",10)(13,"div",11)(14,"label",12),a(15," Category "),e(),t(16,"select",13)(17,"option",14),a(18,"Choose Category"),e(),t(19,"option",15),a(20,"NFSA"),e(),t(21,"option",16),a(22,"NON-NFSA"),e()()(),t(23,"div",11)(24,"label",17),a(25," Social Category "),e(),t(26,"select",18)(27,"option",14),a(28,"Choose Social Category"),e(),t(29,"option",15),a(30,"Un-Reserved"),e(),t(31,"option",19),a(32,"OBC"),e(),t(33,"option",20),a(34,"SC"),e(),t(35,"option",21),a(36,"ST"),e()()(),t(37,"div",11)(38,"label",22),a(39," Application Status "),e(),t(40,"select",23)(41,"option",14),a(42,"Choose Status"),e(),t(43,"option",24),a(44,"Under Process"),e(),t(45,"option",15),a(46,"Approved"),e(),t(47,"option",19),a(48,"Rejected"),e()()(),t(49,"div",11)(50,"label",25),a(51," PWD "),e(),t(52,"select",26)(53,"option",14),a(54,"Choose PWD Status"),e(),t(55,"option",15),a(56,"Yes "),e(),t(57,"option",16),a(58,"NO"),e()()()(),t(59,"div",27)(60,"div",28),b(61,QC,3,0,"button",29)(62,ZC,3,0),e()()()(),t(63,"div",30)(64,"div",31)(65,"div",32),b(66,t2,2,0)(67,u2,21,7),e()()()()),r&2&&(l(2),T("ngIf",c.ekyc_mode==1),l(1),T("ngIf",c.ekyc_mode==5),l(6),E(9,c.filteredWardUserStats&&c.filteredWardUserStats.length>0?9:-1),l(2),T("formGroup",c.searchForm),l(50),E(61,c.isFormSearchInProgress?62:61),l(5),E(66,c.isStatsLoading?66:67))},dependencies:[ft,Pt,Nt,Rt,K,Ut,q,yt,J,Dt,At,it]});let i=s;return i})();var Si=j(ut()),ka=j(ht());function h2(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function S2(i,s){i&1&&(t(0,"h4",22),a(1,"Drill-Down Report - GENERAL"),e())}function x2(i,s){i&1&&(t(0,"h4",22),a(1,"Drill-Down Report - OBC"),e())}function g2(i,s){i&1&&(t(0,"h4",22),a(1,"Drill-Down Report - SC"),e())}function C2(i,s){i&1&&(t(0,"h4",22),a(1,"Drill-Down Report - ST"),e())}function b2(i,s){if(i&1){let o=U();t(0,"button",23),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",24),a(2,"Download PDF "),e()}}function v2(i,s){i&1&&(t(0,"button",25),m(1,"i",26),a(2,"Downloading "),e())}function E2(i,s){if(i&1){let o=U();t(0,"button",23),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",24),a(2,"Download EXCEL "),e()}}function w2(i,s){i&1&&(t(0,"button",25),m(1,"i",26),a(2,"Downloading "),e())}var T2=(i,s)=>s.id;function L2(i,s){if(i&1&&(t(0,"td"),a(1),e(),t(2,"td"),a(3),e(),t(4,"td"),a(5),e()),i&2){let o=h().$implicit;l(1),p(o==null?null:o.count_general),l(2),p(o==null?null:o.approved_applications_general),l(2),p(o==null?null:o.count_general_rejected)}}function I2(i,s){if(i&1&&(t(0,"td"),a(1),e(),t(2,"td"),a(3),e(),t(4,"td"),a(5),e()),i&2){let o=h().$implicit;l(1),p(o==null?null:o.count_obc),l(2),p(o==null?null:o.approved_applications_obc),l(2),p(o==null?null:o.count_obc_rejected)}}function y2(i,s){if(i&1&&(t(0,"td"),a(1),e(),t(2,"td"),a(3),e(),t(4,"td"),a(5),e()),i&2){let o=h().$implicit;l(1),p(o==null?null:o.count_sc),l(2),p(o==null?null:o.approved_applications_sc),l(2),p(o==null?null:o.count_sc_rejected)}}function k2(i,s){if(i&1&&(t(0,"td"),a(1),e(),t(2,"td"),a(3),e(),t(4,"td"),a(5),e()),i&2){let o=h().$implicit;l(1),p(o==null?null:o.count_st),l(2),p(o==null?null:o.approved_applications_st),l(2),p(o==null?null:o.count_st_rejected)}}var P2=i=>["/department/portal/soc_cat/block-ulb-stats",i],D2=(i,s)=>({social_category:i,installment:s});function A2(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",32),a(5),k(6,"uppercase"),e()(),b(7,L2,6,3)(8,I2,6,3)(9,y2,6,3)(10,k2,6,3),e()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),T("routerLink",pt(10,P2,o.district_id))("queryParams",Lt(12,D2,r.social_category,r.installment)),l(1),dt(" ",P(6,8,o.district_name)," "),l(2),E(7,r.card_name=="general"?7:-1),l(1),E(8,r.card_name=="obc"?8:-1),l(1),E(9,r.card_name=="sc"?9:-1),l(1),E(10,r.card_name=="st"?10:-1)}}function U2(i,s){if(i&1&&(t(0,"table",27)(1,"thead",28)(2,"tr")(3,"th",29),a(4,"Sl.#"),e(),t(5,"th",29),a(6,"DISTRICT"),e(),t(7,"th",30),a(8,"APPLICATION DETAILS"),e()(),t(9,"tr")(10,"th"),a(11,"RECEIVED"),e(),t(12,"th"),a(13,"APPROVED"),e(),t(14,"th"),a(15,"REJECTED"),e()()(),t(16,"tbody",31),F(17,A2,11,15,"tr",null,T2),e()()),i&2){let o=h(2);l(17),V(o.filteredDistrictStats)}}function N2(i,s){i&1&&a(0," No Data Found ")}function R2(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11),b(2,S2,2,0,"h4",12)(3,x2,2,0,"h4",12)(4,g2,2,0,"h4",12)(5,C2,2,0,"h4",12),e(),t(6,"div",13)(7,"div",14)(8,"input",15),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(9,"i",16),e(),t(10,"div",17),b(11,b2,3,0,"button",18)(12,v2,3,0),e(),t(13,"div",19),b(14,E2,3,0,"button",18)(15,w2,3,0),e()()(),t(16,"div",20),b(17,U2,19,0,"table",21)(18,N2,1,0),e()}if(i&2){let o=h();l(2),T("ngIf",o.social_category==1),l(1),T("ngIf",o.social_category==2),l(1),T("ngIf",o.social_category==3),l(1),T("ngIf",o.social_category==4),l(3),T("ngModel",o.searchTerm),l(3),E(11,o.isExportInProgress?12:11),l(3),E(14,o.isExportInProgressExcel?15:14),l(3),E(17,o.filteredDistrictStats&&o.filteredDistrictStats.length>0?17:18)}}var Pa=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.districtStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.social_category=n.social_category,this.installment=n.installment,this.card_name=n.card_name,console.log(this.social_category),this.fetchDistrictStats()})}fetchDistrictStats(){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?card_name=${this.card_name}&social_category=${this.social_category}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isStatsLoading=!1,this.districtStats=n.data},n=>{this.isStatsLoading=!1,this.districtStats=[]})}getTotalRejected(n){let r=parseInt((n.nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10),c=parseInt((n.non_nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10);return(r+c).toLocaleString()}get filteredDistrictStats(){return this.searchTerm?this.districtStats.filter(n=>n.district_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.districtStats}exportToExcel(){this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?card_name=${this.card_name}&social_category=${this.social_category}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isExportInProgressExcel=!1;let r=n.data.map((I,R)=>{let z={"SI#":R+1,DISTRICT:I.district_name.toUpperCase()};return this.card_name=="general"?Wt(Bt({},z),{"APPLICATION RECEIVED":I?.count_general,"APPLICATION APPROVED":I?.approved_applications_general,"APPLICATION REJECTED":I?.count_general_rejected}):this.card_name=="obc"?Wt(Bt({},z),{"APPLICATION RECEIVED":I?.count_obc,"APPLICATION APPROVED":I?.approved_applications_obc,"APPLICATION REJECTED":I?.count_obc_rejected}):this.card_name=="sc"?Wt(Bt({},z),{"APPLICATION RECEIVED":I?.count_sc,"APPLICATION APPROVED":I?.approved_applications_sc,"APPLICATION REJECTED":I?.count_sc_rejected}):this.card_name=="st"?Wt(Bt({},z),{"APPLICATION RECEIVED":I?.count_st,"APPLICATION APPROVED":I?.approved_applications_st,"APPLICATION REJECTED":I?.count_st_rejected}):z}),c=N.json_to_sheet(r),f=N.book_new();N.book_append_sheet(f,c,"Applications");let d=Z(f,{bookType:"xlsx",type:"array"}),C=new Date,g=C.toLocaleDateString("en-GB").split("/").reverse().join("-"),_=C.toLocaleTimeString("en-GB").replace(/:/g,"-"),v=this.social_category==1?`soc_cat_gen_district_drilldown_reports_${g}_${_}.xlsx`:this.social_category==2?`soc_cat_obc_district_drilldown_reports_${g}_${_}.xlsx`:this.social_category==3?`soc_cat_sc_district_drilldown_reports_${g}_${_}.xlsx`:this.social_category==4?`soc_cat_st_district_drilldown_reports_${g}_${_}.xlsx`:"",S=new Blob([d],{type:"application/octet-stream"}),w=document.createElement("a"),u=window.URL.createObjectURL(S);w.href=u,w.download=v,w.click(),window.URL.revokeObjectURL(u)},n=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",n)})}exportToPDF(){Si.default.vfs=ka.default.pdfMake.vfs,this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?card_name=${this.card_name}&social_category=${this.social_category}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isExportInProgress=!1;let r=[[{text:"SI#",fontSize:10},{text:"DISTRICT",fontSize:10},{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"APPLICATION REJECTED",fontSize:10}]];n.data.forEach((w,u)=>{r.push([{text:(u+1).toString().toUpperCase(),fontSize:9},{text:(w.district_name||"").toUpperCase(),fontSize:9},{text:this.card_name=="general"?w?.count_general:this.card_name=="obc"?w?.count_obc:this.card_name=="sc"?w?.count_sc:this.card_name=="st"?w?.count_st:"",fontSize:9},{text:this.card_name=="general"?w?.approved_applications_general:this.card_name=="obc"?w?.approved_applications_obc:this.card_name=="sc"?w?.approved_applications_sc:this.card_name=="st"?w?.approved_applications_st:"",fontSize:9},{text:this.card_name=="general"?w?.count_general_rejected:this.card_name=="obc"?w?.count_obc_rejected:this.card_name=="sc"?w?.count_sc_rejected:this.card_name=="st"?w?.count_st_rejected:"",fontSize:9}])});let c=new Date,f=`Timestamp: ${c.toLocaleDateString()}, ${c.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,C={pageOrientation:"landscape",pageSize:"A4",content:[{text:this.social_category==1?"DRILL-DOWN REPORT GENERAL DISTRICT-WISE":this.social_category==2?"DRILL-DOWN REPORT OBC DISTRICT-WISE":this.social_category==3?"DRILL-DOWN REPORT SC DISTRICT-WISE":this.social_category==4?"DRILL-DOWN REPORT ST DISTRICT-WISE":"",style:"header"},{table:{headerRows:1,body:r,widths:["9%","13%","13%","13%","13%"]},layout:{fillColor:function(w){return w===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:f,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},g=new Date,_=g.toLocaleDateString("en-GB").split("/").reverse().join("-"),v=g.toLocaleTimeString("en-GB").replace(/:/g,"-"),S=this.social_category==1?`soc_cat_gen_district_drilldown_reports_${_}_${v}.pdf`:this.social_category==2?`soc_cat_obc_district_drilldown_reports_${_}_${v}.pdf`:this.social_category==3?`soc_cat_sc_district_drilldown_reports_${_}_${v}.pdf`:this.social_category==4?`soc_cat_st_district_drilldown_reports_${_}_${v}.pdf`:"";Si.default.createPdf(C).download(S)},n=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",n)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-soc-cat-district-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],["style","color: #fd7b03;",4,"ngIf"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],[2,"color","#fd7b03"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],["colspan","3",1,"text-center"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,h2,2,0)(11,R2,19,8),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ft,ot,K,q,J,it]});let i=s;return i})();var xi=j(ut()),Da=j(ht());function O2(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function B2(i,s){i&1&&(t(0,"h4",25),a(1,"Drill-Down Report - GENERAL"),e())}function W2(i,s){i&1&&(t(0,"h4",25),a(1,"Drill-Down Report - OBC"),e())}function M2(i,s){i&1&&(t(0,"h4",25),a(1,"Drill-Down Report - SC"),e())}function F2(i,s){i&1&&(t(0,"h4",25),a(1,"Drill-Down Report - ST"),e())}function V2(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",27),a(2,"Download PDF "),e()}}function z2(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}function j2(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",27),a(2,"Download EXCEL "),e()}}function $2(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}var G2=(i,s)=>s.id,X2=(i,s)=>["/department/portal/soc_cat/gp-stats",i,s],Aa=(i,s)=>({social_category:i,installment:s});function Y2(i,s){if(i&1&&(t(0,"a",36),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit,n=h(3);T("routerLink",Lt(5,X2,o.district_id,o.block_id))("queryParams",Lt(8,Aa,n.social_category,n.installment)),l(1),dt(" ",P(2,3,o.block_name)," ")}}var H2=(i,s)=>["/department/portal/soc_cat/ward-stats",i,s];function K2(i,s){if(i&1&&(t(0,"a",36),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit,n=h(3);T("routerLink",Lt(5,H2,o.district_id,o.ulb_id))("queryParams",Lt(8,Aa,n.social_category,n.installment)),l(1),dt(" ",P(2,3,o.ulb_name)," ")}}function q2(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td"),b(4,Y2,3,11,"a",35)(5,K2,3,11),e(),t(6,"td"),a(7),e(),t(8,"td"),a(9),e(),t(10,"td"),a(11),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),E(4,o.block_id?4:5),l(3),p(o==null?null:o.applications_received),l(2),p(o==null?null:o.approved_application),l(2),p(r.getTotalRejected(o))}}function J2(i,s){if(i&1&&(t(0,"table",30)(1,"thead",31)(2,"tr")(3,"th",32),a(4,"Sl.#"),e(),t(5,"th",32),a(6,"BLOCK/ULB"),e(),t(7,"th",33),a(8,"APPLICATION DETAILS"),e()(),t(9,"tr")(10,"th"),a(11,"RECEIVED"),e(),t(12,"th"),a(13,"APPROVED"),e(),t(14,"th"),a(15,"REJECTED"),e()()(),t(16,"tbody",34),F(17,q2,12,5,"tr",null,G2),e()()),i&2){let o=h(2);l(17),V(o.filteredBlockStats)}}function Q2(i,s){i&1&&a(0," No Data Found ")}function Z2(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11),b(2,B2,2,0,"h4",12)(3,W2,2,0,"h4",12)(4,M2,2,0,"h4",12)(5,F2,2,0,"h4",12),t(6,"nav",13)(7,"ol",14)(8,"li",15),a(9),e()()()(),t(10,"div",16)(11,"div",17)(12,"input",18),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(13,"i",19),e(),t(14,"div",20),b(15,V2,3,0,"button",21)(16,z2,3,0),e(),t(17,"div",22),b(18,j2,3,0,"button",21)(19,$2,3,0),e()()(),t(20,"div",23),b(21,J2,19,0,"table",24)(22,Q2,1,0),e()}if(i&2){let o=h();l(2),T("ngIf",o.social_category==1),l(1),T("ngIf",o.social_category==2),l(1),T("ngIf",o.social_category==3),l(1),T("ngIf",o.social_category==4),l(4),p(o.filteredBlockStats[0].district_name),l(3),T("ngModel",o.searchTerm),l(3),E(15,o.isExportInProgress?16:15),l(3),E(18,o.isExportInProgressExcel?19:18),l(3),E(21,o.filteredBlockStats&&o.filteredBlockStats.length>0?21:22)}}var Ua=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.districtStats=[],this.district_id="",this.blockStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.params.subscribe(n=>{let r=n.id;this.district_id=r}),this.route.queryParams.subscribe(n=>{this.social_category=n.social_category,this.installment=n.installment,console.log("social_category:",this.social_category),this.fetchblockStats(this.district_id)})}fetchblockStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/block-count?district_id=${n}&social_category=${this.social_category}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.blockStats=r.data,this.fetchulbStats(n)},r=>{this.isStatsLoading=!1,this.blockStats=[]})}fetchulbStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/ulb-count?district_id=${n}&social_category=${this.social_category}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.blockStats=[...this.blockStats,...r.data]},r=>{this.isStatsLoading=!1})}getTotalRejected(n){let r=parseInt((n.nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10),c=parseInt((n.non_nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10);return(r+c).toLocaleString()}get filteredBlockStats(){return this.searchTerm?this.blockStats.filter(n=>n.block_name&&n.block_name.toLowerCase().includes(this.searchTerm.toLowerCase())||n.ulb_name&&n.ulb_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.blockStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.blockStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name,"BLOCK/ULB":(u.block_name||u.ulb_name).toUpperCase(),"APPLICATION RECEIVED":u?.applications_received,"APPLICATION APPROVED":u?.approved_application,"APPLICATION REJECTED":this.getTotalRejected(u)})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=this.social_category==1?`soc_cat_gen_block_ulb_drilldown_reports_${C}_${g}.xlsx`:this.social_category==2?`soc_cat_obc_block_ulb_drilldown_reports_${C}_${g}.xlsx`:this.social_category==3?`soc_cat_sc_block_ulb_drilldown_reports_${C}_${g}.xlsx`:this.social_category==4?`soc_cat_st_block_ulb_drilldown_reports_${C}_${g}.xlsx`:"",v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){xi.default.vfs=Da.default.pdfMake.vfs,this.isExportInProgress=!0;let r=((this.blockStats[0]||{}).district_name||"N/A").toUpperCase(),c=[[{text:"SI#",fontSize:10},{text:"BLOCK/ULB",fontSize:10},{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"APPLICATION REJECTED",fontSize:10}]];this.blockStats.forEach((u,I)=>{c.push([{text:(I+1).toString().toUpperCase(),fontSize:9},{text:(u.block_name||u.ulb_name||"").toUpperCase(),fontSize:9},{text:u?.applications_received,fontSize:9},{text:u?.approved_application,fontSize:9},{text:this.getTotalRejected(u),fontSize:9}])});let f=new Date,d=`Timestamp: ${f.toLocaleDateString()}, ${f.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,C=this.social_category==1?"DRILL-DOWN REPORT GENERAL BLOCK-ULB WISE":this.social_category==2?"DRILL-DOWN REPORT OBC BLOCK-ULB WISE":this.social_category==3?"DRILL-DOWN REPORT SC BLOCK-ULB WISE":this.social_category==4?"DRILL-DOWN REPORT ST BLOCK-ULB WISE":"",g={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r}`,style:"breadcrumb",margin:[0,0,0,10]},{text:C,style:"header"},{table:{headerRows:1,body:c,widths:["9%","13%","13%","13%","13%"]},layout:{fillColor:function(u){return u===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:d,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},_=new Date,v=_.toLocaleDateString("en-GB").split("/").reverse().join("-"),S=_.toLocaleTimeString("en-GB").replace(/:/g,"-"),w=this.social_category==1?`soc_cat_gen_block_ulb_drilldown_reports_${v}_${S}.pdf`:this.social_category==2?`soc_cat_obc_block_ulb_drilldown_reports_${v}_${S}.pdf`:this.social_category==3?`soc_cat_sc_block_ulb_drilldown_reports_${v}_${S}.pdf`:this.social_category==4?`soc_cat_st_block_ulb_drilldown_reports_${v}_${S}.pdf`:"";xi.default.createPdf(g).download(w,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-soc-cat-block-ulb-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],["style","color: #fd7b03;",4,"ngIf"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],[2,"color","#fd7b03"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],["colspan","3",1,"text-center"],[2,"font-size","14px"],["style","text-decoration: none",3,"routerLink","queryParams"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,O2,2,0)(11,Z2,23,9),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ft,ot,K,q,J,it]});let i=s;return i})();var gi=j(ut()),Na=j(ht());function tb(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function eb(i,s){i&1&&(t(0,"h4",26),a(1,"Drill-Down Report - GENERAL"),e())}function ib(i,s){i&1&&(t(0,"h4",26),a(1,"Drill-Down Report - OBC"),e())}function nb(i,s){i&1&&(t(0,"h4",26),a(1,"Drill-Down Report - SC"),e())}function ob(i,s){i&1&&(t(0,"h4",26),a(1,"Drill-Down Report - ST"),e())}function ab(i,s){if(i&1){let o=U();t(0,"button",27),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",28),a(2,"Download PDF "),e()}}function rb(i,s){i&1&&(t(0,"button",29),m(1,"i",30),a(2,"Downloading "),e())}function sb(i,s){if(i&1){let o=U();t(0,"button",27),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",28),a(2,"Download EXCEL "),e()}}function lb(i,s){i&1&&(t(0,"button",29),m(1,"i",30),a(2,"Downloading "),e())}var cb=(i,s)=>s.id,db=(i,s,o)=>["/department/portal/soc_cat/village-stats",i,s,o],pb=(i,s)=>({social_category:i,installment:s});function mb(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",36),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e(),t(9,"td"),a(10),e(),t(11,"td"),a(12),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),T("routerLink",Ft(9,db,o.district_id,o.block_id,o.gp_id))("queryParams",Lt(13,pb,r.social_category,r.installment)),l(1),dt(" ",P(6,7,o.gp_name)," "),l(3),p(o==null?null:o.applications_received),l(2),p(o==null?null:o.approved_application),l(2),p(r.getTotalRejected(o))}}function _b(i,s){if(i&1&&(t(0,"table",31)(1,"thead",32)(2,"tr")(3,"th",33),a(4,"Sl.#"),e(),t(5,"th",33),a(6,"GRAM PANCHAYAT"),e(),t(7,"th",34),a(8,"APPLICATION DETAILS"),e()(),t(9,"tr")(10,"th"),a(11,"RECEIVED"),e(),t(12,"th"),a(13,"APPROVED"),e(),t(14,"th"),a(15,"REJECTED"),e()()(),t(16,"tbody",35),F(17,mb,13,16,"tr",null,cb),e()()),i&2){let o=h(2);l(17),V(o.filteredGpStats)}}function fb(i,s){i&1&&a(0," No Data Found ")}function ub(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11),b(2,eb,2,0,"h4",12)(3,ib,2,0,"h4",12)(4,nb,2,0,"h4",12)(5,ob,2,0,"h4",12),t(6,"nav",13)(7,"ol",14)(8,"li",15),a(9),e(),t(10,"li",16),a(11),e()()()(),t(12,"div",17)(13,"div",18)(14,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(15,"i",20),e(),t(16,"div",21),b(17,ab,3,0,"button",22)(18,rb,3,0),e(),t(19,"div",23),b(20,sb,3,0,"button",22)(21,lb,3,0),e()()(),t(22,"div",24),b(23,_b,19,0,"table",25)(24,fb,1,0),e()}if(i&2){let o=h();l(2),T("ngIf",o.social_category==1),l(1),T("ngIf",o.social_category==2),l(1),T("ngIf",o.social_category==3),l(1),T("ngIf",o.social_category==4),l(4),p(o.filteredGpStats[0].district_name),l(2),p(o.filteredGpStats[0].block_name),l(3),T("ngModel",o.searchTerm),l(3),E(17,o.isExportInProgress?18:17),l(3),E(20,o.isExportInProgressExcel?21:20),l(3),E(23,o.filteredGpStats&&o.filteredGpStats.length>0?23:24)}}var Ra=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.district_id="",this.gpStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.id}),this.route.queryParams.subscribe(n=>{this.social_category=n.social_category,this.installment=n.installment,console.log("social_category:",this.social_category),this.fetchgpStats(this.block_id)})}fetchgpStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/gp-count?block_id=${n}&social_category=${this.social_category}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.gpStats=r.data},r=>{this.isStatsLoading=!1,this.gpStats=[]})}getTotalRejected(n){let r=parseInt((n.nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10),c=parseInt((n.non_nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10);return(r+c).toLocaleString()}get filteredGpStats(){return this.searchTerm?this.gpStats.filter(n=>n.gp_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.gpStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.gpStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",BLOCK:u.block_name?u.block_name.toUpperCase():"",GP:u.gp_name?u.gp_name.toUpperCase():"","APPLICATION RECEIVED":u?.applications_received,"APPLICATION APPROVED":u?.approved_application,"APPLICATION REJECTED":this.getTotalRejected(u)})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=this.social_category==1?`soc_cat_gen_gp_drilldown_reports_${C}_${g}.xlsx`:this.social_category==2?`soc_cat_obc_gp_drilldown_reports_${C}_${g}.xlsx`:this.social_category==3?`soc_cat_sc_gp_drilldown_reports_${C}_${g}.xlsx`:this.social_category==4?`soc_cat_st_gp_drilldown_reports_${C}_${g}.xlsx`:"",v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){gi.default.vfs=Na.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.gpStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=[[{text:"SI#",fontSize:10},{text:"GP",fontSize:10},{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"APPLICATION REJECTED",fontSize:10}]];this.gpStats.forEach((I,R)=>{f.push([{text:(R+1).toString().toUpperCase(),fontSize:9},{text:(I.gp_name||"").toUpperCase(),fontSize:9},{text:I?.applications_received,fontSize:9},{text:I?.approved_application,fontSize:9},{text:this.getTotalRejected(I),fontSize:9}])});let d=new Date,C=`Timestamp: ${d.toLocaleDateString()}, ${d.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,g=this.social_category==1?"DRILL-DOWN REPORT GENERAL GP WISE":this.social_category==2?"DRILL-DOWN REPORT OBC GP WISE":this.social_category==3?"DRILL-DOWN REPORT SC GP WISE":this.social_category==4?"DRILL-DOWN REPORT ST GP WISE":"",_={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK: ${c}`,style:"breadcrumb",margin:[0,0,0,10]},{text:g,style:"header"},{table:{headerRows:1,body:f,widths:["9%","13%","13%","13%","13%"]},layout:{fillColor:function(I){return I===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:C,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},v=new Date,S=v.toLocaleDateString("en-GB").split("/").reverse().join("-"),w=v.toLocaleTimeString("en-GB").replace(/:/g,"-"),u=this.social_category==1?`soc_cat_gen_gp_drilldown_reports_${S}_${w}.pdf`:this.social_category==2?`soc_cat_obc_gp_drilldown_reports_${S}_${w}.pdf`:this.social_category==3?`soc_cat_sc_gp_drilldown_reports_${S}_${w}.pdf`:this.social_category==4?`soc_cat_st_gp_drilldown_reports_${S}_${w}.pdf`:"";gi.default.createPdf(_).download(u,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-soc-cat-gp-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],["style","color: #fd7b03;",4,"ngIf"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],[2,"color","#fd7b03"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],["colspan","3",1,"text-center"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,tb,2,0)(11,ub,25,10),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ft,ot,K,q,J,it]});let i=s;return i})();var Ci=j(ut()),Oa=j(ht());function hb(i,s){i&1&&(t(0,"h4",29),a(1,"Detailed Report - GENERAL"),e())}function Sb(i,s){i&1&&(t(0,"h4",29),a(1,"Detailed Report - OBC"),e())}function xb(i,s){i&1&&(t(0,"h4",29),a(1,"Detailed Report - SC"),e())}function gb(i,s){i&1&&(t(0,"h4",29),a(1,"Detailed Report - ST"),e())}function Cb(i,s){if(i&1&&(t(0,"div",30)(1,"div",31)(2,"nav",32)(3,"ol",33)(4,"li",34),a(5),e(),t(6,"li",34),a(7),e(),t(8,"li",35),a(9),e()()()()()),i&2){let o=h();l(5),p(o.filteredWardUserStats[0].district_name),l(2),p(o.filteredWardUserStats[0].ulb_name),l(2),p(o.filteredWardUserStats[0].ward_no)}}function bb(i,s){i&1&&(t(0,"button",36),m(1,"i",37),a(2,"Search "),e())}function vb(i,s){i&1&&(t(0,"button",38),m(1,"i",39),a(2," Searching ..."),e())}function Eb(i,s){i&1&&(m(0,"i",40),a(1," We are fetching the data, please wait. "))}function wb(i,s){if(i&1){let o=U();t(0,"button",55),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",56),a(2,"Download to PDF "),e()}}function Tb(i,s){i&1&&(t(0,"button",57),m(1,"i",39),a(2,"Downloading "),e())}function Lb(i,s){if(i&1){let o=U();t(0,"button",55),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",56),a(2,"Download to EXCEL "),e()}}function Ib(i,s){i&1&&(t(0,"button",57),m(1,"i",39),a(2,"Downloading "),e())}var yb=(i,s)=>s.id;function kb(i,s){if(i&1&&(t(0,"td"),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit;l(1),p(P(2,1,o.ward_no))}}function Pb(i,s){i&1&&m(0,"td")}function Db(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),b(3,kb,3,3,"td")(4,Pb,1,0),t(5,"td"),a(6),k(7,"uppercase"),e(),t(8,"td"),a(9),k(10,"uppercase"),e(),t(11,"td"),a(12),k(13,"uppercase"),e(),t(14,"td"),a(15),k(16,"uppercase"),e(),t(17,"td"),a(18),k(19,"uppercase"),e(),t(20,"td"),a(21),k(22,"uppercase"),e(),t(23,"td"),a(24),k(25,"uppercase"),e(),t(26,"td"),a(27),e(),t(28,"td"),a(29),k(30,"uppercase"),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(1),E(3,o.ward_no?3:4),l(3),p(P(7,11,o.category)),l(3),p(P(10,13,o.application_number)),l(3),p(P(13,15,r.appService.dateFormat(o.application_date))),l(3),p(P(16,17,o.applicant_name)),l(3),p(P(19,19,o.spouse_or_father_name)),l(3),p(P(22,21,o.social_category)),l(3),p(P(25,23,o.pwd_status)),l(3),p(o.alt_mobile_number),l(2),p(P(30,25,o.application_status))}}function Ab(i,s){if(i&1&&(t(0,"table",58)(1,"thead",59)(2,"tr")(3,"th"),a(4,"SI#"),e(),t(5,"th"),a(6,"WARD NO."),e(),t(7,"th"),a(8,"CATEGORY"),e(),t(9,"th"),a(10,"APPLICATION NO."),e(),t(11,"th"),a(12,"APPLICATION DATE"),e(),t(13,"th"),a(14,"APPLICANT NAME"),e(),t(15,"th"),a(16,"FATHER/HUSBAND NAME"),e(),t(17,"th"),a(18,"SOCIAL CATEGORY"),e(),t(19,"th"),a(20,"PWD"),e(),t(21,"th"),a(22,"MOBILE NO."),e(),t(23,"th"),a(24,"APPLICATION STATUS"),e()()(),t(25,"tbody"),F(26,Db,31,27,"tr",null,yb),e()()),i&2){let o=h(2);l(26),V(o.filteredWardUserStats)}}function Ub(i,s){i&1&&(t(0,"h5",60),a(1,"No data available"),e())}function Nb(i,s){i&1&&(t(0,"div",61),a(1,"Loading.. "),m(2,"i",62),e())}function Rb(i,s){i&1&&(t(0,"span"),m(1,"i",40),a(2," Loading..."),e())}function Ob(i,s){i&1&&(t(0,"span"),a(1,"Load More"),e())}function Bb(i,s){if(i&1){let o=U();t(0,"div",63)(1,"button",64),L("click",function(){D(o);let r=h(2);return A(r.loadMore())}),b(2,Rb,3,0,"span",65)(3,Ob,2,0,"span",65),e()()}if(i&2){let o=h(2);l(2),T("ngIf",o.isLoadMoreInProgress),l(1),T("ngIf",!o.isLoadMoreInProgress)}}function Wb(i,s){if(i&1){let o=U();t(0,"div",30)(1,"div",41)(2,"h5",42),a(3," Number of records found : "),t(4,"span",43),a(5),e()()(),t(6,"div",44)(7,"div",45)(8,"input",46),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(9,"i",47),e(),t(10,"div",48),b(11,wb,3,0,"button",49)(12,Tb,3,0),e(),t(13,"div",50),b(14,Lb,3,0,"button",49)(15,Ib,3,0),e()()(),t(16,"div",51),b(17,Ab,28,0,"table",52)(18,Ub,2,0)(19,Nb,3,0,"div",53),e(),b(20,Bb,4,2,"div",54)}if(i&2){let o=h();l(5),p(o.count),l(3),T("ngModel",o.searchTerm),l(3),E(11,o.isExportInProgress?12:11),l(3),E(14,o.isExportInProgressExcel?15:14),l(3),E(17,o.filteredWardUserStats&&o.filteredWardUserStats.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),l(2),E(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),l(1),T("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var Ba=(()=>{let s=class s{constructor(n,r,c,f,d,C,g,_){this.route=n,this.router=r,this.formService=c,this.appService=f,this.httpClient=d,this.toastService=C,this.authService=g,this.masterDataService=_,this.isStatsLoading=!1,this.userStats=[],this.ulb_id="",this.ward_id="",this.village_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.limit=this.appService.loadmorelimit,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.count=0,this.searchForm=new kt({a_category:new nt(""),social_category:new nt(""),pwd_status:new nt(""),submit_date:new nt(""),a_status:new nt("")})}ngOnInit(){this.route.params.subscribe(n=>{this.district_id=n.district_id,this.ulb_id=n.ulb_id,this.ward_id=n.id}),this.route.queryParams.subscribe(n=>{this.social_category=n.social_category,this.installment=n.installment,console.log("social_category:",this.social_category),this.fetchuserStats(this.ward_id)})}fetchuserStats(n,r=!1){this.isStatsLoading=!0;let c=new st;c=c.set("ward_id",n),c=c.set("offset",this.offset),c=c.set("limit",this.limit),this.social_category!==void 0&&(c=c.set("social_category",this.social_category.toString())),this.installment!==void 0&&(c=c.set("installment",this.installment.toString()));let f=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:c,headers:f}).subscribe(d=>{this.isStatsLoading=!1,this.count=d.count,d.data&&d.data.length>0?(this.application_list=this.application_list.concat(d.data),this.offset+=d.data.length,this.hasMoreRecords=d.data.length===this.limit):this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)},d=>{this.isStatsLoading=!1,this.application_list=[],this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)})}get filteredWardUserStats(){if(!this.searchTerm)return this.application_list;let n=this.searchTerm.toLowerCase();return this.application_list.filter(r=>r.ward_no?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.category?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.application_number?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_date).toLowerCase().includes(this.searchTerm.toLowerCase())||r.applicant_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.spouse_or_father_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.dob).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.social_category).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.pwd_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.alt_mobile_number).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.payment_status).toLowerCase().includes(this.searchTerm.toLowerCase()))}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.a_status,g=new st;r&&(g=g.set("ward_id",r)),c&&(g=g.set("category",c)),d&&(g=g.set("pwd_status",d)),C&&(g=g.set("application_status",C)),g=g.set("offset",this.offset),g=g.set("limit",this.limit),this.social_category!==void 0&&(g=g.set("social_category",this.social_category.toString())),this.installment!==void 0&&(g=g.set("installment",this.installment.toString()));let _=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:g,headers:_}).subscribe(v=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=v.count,v.data&&v.data.length>0?(this.application_list=this.application_list.concat(v.data),this.offset+=v.data.length,this.hasMoreRecords=v.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},v=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}exportToExcel(){let n=new st,r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.a_status;r&&(n=n.set("ward_id",r)),c&&(n=n.set("category",c)),d&&(n=n.set("pwd_status",d)),C&&(n=n.set("application_status",C)),n=n.set("export_all","1"),this.social_category!==void 0&&(n=n.set("social_category",this.social_category.toString())),this.installment!==void 0&&(n=n.set("installment",this.installment.toString()));let g=new rt({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:g,responseType:"json"}).subscribe(_=>{this.isExportInProgressExcel=!1;let v=_.data.map((et,y)=>({"SI#":y+1,DISTRICT:et.district_name?et.district_name.toUpperCase():"",ULB:et.ulb_name?et.ulb_name.toUpperCase():"","WARD NO.":et.ward_no?et.ward_no.toUpperCase():"",CATEGORY:et.category.toUpperCase(),"APPLICATION NO.":et.application_number.toUpperCase(),"APPLICATION DATE":this.appService.dateFormat(et.application_date),"APPLICANT NAME":et.applicant_name.toUpperCase(),"FATHER/HUSBAND NAME":et.spouse_or_father_name.toUpperCase(),"SOCIAL CATEGORY":et.social_category.toUpperCase(),PWD:et.pwd_status.toUpperCase(),"MOBILE NO.":et.alt_mobile_number,"APPLICATION STATUS":et.application_status.toUpperCase()})),S=N.json_to_sheet(v),w=N.book_new();N.book_append_sheet(w,S,"Applications");let u=Z(w,{bookType:"xlsx",type:"array"}),I=new Date,R=I.toLocaleDateString("en-GB").split("/").reverse().join("-"),z=I.toLocaleTimeString("en-GB").replace(/:/g,"-"),at=this.social_category==1?`soc_cat_gen_application_status_reports_${R}_${z}.xlsx`:this.social_category==2?`soc_cat_obc_application_status_reports_${R}_${z}.xlsx`:this.social_category==3?`soc_cat_sc_application_status_reports_${R}_${z}.xlsx`:this.social_category==4?`soc_cat_application_status_reports_${R}_${z}.xlsx`:"",ct=new Blob([u],{type:"application/octet-stream"}),lt=document.createElement("a"),O=window.URL.createObjectURL(ct);lt.href=O,lt.download=at,lt.click(),window.URL.revokeObjectURL(O)},_=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",_)})}exportToPDF(){Ci.default.vfs=Oa.default.pdfMake.vfs;let n=new st,r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.a_status;r&&(n=n.set("ward_id",r)),c&&(n=n.set("category",c)),d&&(n=n.set("pwd_status",d)),C&&(n=n.set("application_status",C)),n=n.set("export_all","1"),this.social_category!==void 0&&(n=n.set("social_category",this.social_category.toString())),this.installment!==void 0&&(n=n.set("installment",this.installment.toString()));let g=new rt({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:g,responseType:"json"}).subscribe(_=>{this.isExportInProgress=!1;let v=_.data[0]||{},S=(v.district_name||"N/A").toUpperCase(),w=(v.block_name||v.ulb_name||"N/A").toUpperCase(),u=(v.gp_name||v.ward_no||"N/A").toUpperCase(),I=[[{text:"SI#",fontSize:10},{text:"CATEGORY",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICATION DATE.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"SOCIAL CATEGORY",fontSize:10},{text:"PWD",fontSize:10},{text:"MOBILE NO",fontSize:10},{text:"APPLICATION STATUS",fontSize:10}]];_.data.forEach((B,W)=>{I.push([{text:(W+1).toString().toUpperCase(),fontSize:9},{text:(B.category||"").toUpperCase(),fontSize:9},{text:(B.application_number||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(B.application_date)||"",fontSize:9},{text:(B.applicant_name||"").toUpperCase(),fontSize:9},{text:(B.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:(B.social_category||"").toUpperCase(),fontSize:9},{text:(B.pwd_status||"").toUpperCase(),fontSize:9},{text:(B.alt_mobile_number||"").toUpperCase(),fontSize:9},{text:(B.application_status||"").toUpperCase(),fontSize:9}])});let R=new Date,z=`Timestamp: ${R.toLocaleDateString()}, ${R.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,at=this.social_category==1?"DETAILED REPORT - GENERAL":this.social_category==2?"DETAILED REPORT - OBC":this.social_category==3?"DETAILED REPORT - SC":this.social_category==4?"DETAILED REPORT - ST":"",ct={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${S} > ULB: ${w} > WARD: ${u}`,style:"breadcrumb",margin:[0,0,0,10]},{text:at,style:"header"},{table:{headerRows:1,body:I,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]},layout:{fillColor:function(B){return B===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:z,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},lt=new Date,O=lt.toLocaleDateString("en-GB").split("/").reverse().join("-"),et=lt.toLocaleTimeString("en-GB").replace(/:/g,"-"),y=this.social_category==1?`soc_cat_gen_application_status_reports_${O}_${et}.pdf`:this.social_category==2?`soc_cat_obc_application_status_reports_${O}_${et}.pdf`:this.social_category==3?`soc_cat_sc_application_status_reports_${O}_${et}.pdf`:this.social_category==4?`soc_cat_st_application_status_reports_${O}_${et}.pdf`:"";Ci.default.createPdf(ct).download(y)},_=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",_)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(Ot),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-soc-cat-ward-user-list"]],decls:56,vars:8,consts:[[1,"container-fluid","drilldown-reports"],[1,"d-flex","justify-content-between","w-100","mb-3"],["style","color: #fd7b03;",4,"ngIf"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],["class","row mb-2"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-2"],[1,"col-md-4"],["for","a_category",1,"fw-bold"],["formControlName","a_category","id","a_category",1,"form-select","my-2"],["value",""],["value","1"],["value","0"],["for","a_status",1,"fw-bold"],["formControlName","a_status","id","a_status",1,"form-select","my-2"],["value","7"],["value","2"],["for","pwd_status",1,"fw-bold"],["formControlName","pwd_status","id","pwd_status",1,"form-select","my-2"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[2,"color","#fd7b03"],[1,"row","mb-2"],[1,"col-md-7"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"fa","fa-spinner","fa-spin"],[1,"col-md-5"],[1,"card-title"],["id","recordCount"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports detail"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports","detail"],[1,"text-light",2,"background-color","#fd7b03"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"],[4,"ngIf"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),b(2,hb,2,0,"h4",2)(3,Sb,2,0,"h4",2)(4,xb,2,0,"h4",2)(5,gb,2,0,"h4",2),t(6,"div",3)(7,"a",4),L("click",function(){return c.appService.goBack()}),t(8,"button",5),m(9,"i",6),a(10," Back"),e()()()(),b(11,Cb,10,3,"div",7),t(12,"div",8)(13,"form",9),L("ngSubmit",function(){return c.onSearch()}),t(14,"div",10)(15,"div",11)(16,"label",12),a(17," Category "),e(),t(18,"select",13)(19,"option",14),a(20,"Choose Category"),e(),t(21,"option",15),a(22,"NFSA"),e(),t(23,"option",16),a(24,"NON-NFSA"),e()()(),t(25,"div",11)(26,"label",17),a(27," Application Status "),e(),t(28,"select",18)(29,"option",14),a(30,"Choose Status"),e(),t(31,"option",19),a(32,"Under Process"),e(),t(33,"option",15),a(34,"Approved"),e(),t(35,"option",20),a(36,"Rejected"),e()()(),t(37,"div",11)(38,"label",21),a(39," PWD "),e(),t(40,"select",22)(41,"option",14),a(42,"Choose PWD Status"),e(),t(43,"option",15),a(44,"Yes "),e(),t(45,"option",16),a(46,"NO"),e()()()(),t(47,"div",23)(48,"div",24),b(49,bb,3,0,"button",25)(50,vb,3,0),e()()()(),t(51,"div",26)(52,"div",27)(53,"div",28),b(54,Eb,2,0)(55,Wb,21,7),e()()()()),r&2&&(l(2),T("ngIf",c.social_category==1),l(1),T("ngIf",c.social_category==2),l(1),T("ngIf",c.social_category==3),l(1),T("ngIf",c.social_category==4),l(6),E(11,c.filteredWardUserStats&&c.filteredWardUserStats.length>0?11:-1),l(2),T("formGroup",c.searchForm),l(36),E(49,c.isFormSearchInProgress?50:49),l(5),E(54,c.isStatsLoading?54:55))},dependencies:[ft,Pt,Nt,Rt,K,Ut,q,yt,J,Dt,At,it]});let i=s;return i})();var bi=j(ut()),Wa=j(ht());function Mb(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function Fb(i,s){i&1&&(t(0,"h4",26),a(1,"Drill-Down Report - GENERAL"),e())}function Vb(i,s){i&1&&(t(0,"h4",26),a(1,"Drill-Down Report - OBC"),e())}function zb(i,s){i&1&&(t(0,"h4",26),a(1,"Drill-Down Report - SC"),e())}function jb(i,s){i&1&&(t(0,"h4",26),a(1,"Drill-Down Report - ST"),e())}function $b(i,s){if(i&1){let o=U();t(0,"button",27),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",28),a(2,"Download PDF "),e()}}function Gb(i,s){i&1&&(t(0,"button",29),m(1,"i",30),a(2,"Downloading "),e())}function Xb(i,s){if(i&1){let o=U();t(0,"button",27),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",28),a(2,"Download EXCEL "),e()}}function Yb(i,s){i&1&&(t(0,"button",29),m(1,"i",30),a(2,"Downloading "),e())}var Hb=(i,s)=>s.id,Kb=(i,s,o,n)=>["/department/portal/soc_cat/village-user-list",i,s,o,n],qb=(i,s)=>({social_category:i,installment:s});function Jb(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",36),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e(),t(9,"td"),a(10),e(),t(11,"td"),a(12),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),T("routerLink",Yt(9,Kb,o.district_id,o.block_id,o.gp_id,o.village_id))("queryParams",Lt(14,qb,r.social_category,r.installment)),l(1),dt(" ",P(6,7,o.village_name)," "),l(3),p(o==null?null:o.applications_received),l(2),p(o==null?null:o.approved_application),l(2),p(r.getTotalRejected(o))}}function Qb(i,s){if(i&1&&(t(0,"table",31)(1,"thead",32)(2,"tr")(3,"th",33),a(4,"Sl.#"),e(),t(5,"th",33),a(6,"VILLAGE"),e(),t(7,"th",34),a(8,"APPLICATION DETAILS"),e()(),t(9,"tr")(10,"th"),a(11,"RECEIVED"),e(),t(12,"th"),a(13,"APPROVED"),e(),t(14,"th"),a(15,"REJECTED"),e()()(),t(16,"tbody",35),F(17,Jb,13,17,"tr",null,Hb),e()()),i&2){let o=h(2);l(17),V(o.filteredVillageStats)}}function Zb(i,s){i&1&&a(0," No Data Found ")}function tv(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11),b(2,Fb,2,0,"h4",12)(3,Vb,2,0,"h4",12)(4,zb,2,0,"h4",12)(5,jb,2,0,"h4",12),t(6,"nav",13)(7,"ol",14)(8,"li",15),a(9),e(),t(10,"li",15),a(11),e(),t(12,"li",16),a(13),e()()()(),t(14,"div",17)(15,"div",18)(16,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(17,"i",20),e(),t(18,"div",21),b(19,$b,3,0,"button",22)(20,Gb,3,0),e(),t(21,"div",23),b(22,Xb,3,0,"button",22)(23,Yb,3,0),e()()(),t(24,"div",24),b(25,Qb,19,0,"table",25)(26,Zb,1,0),e()}if(i&2){let o=h();l(2),T("ngIf",o.social_category==1),l(1),T("ngIf",o.social_category==2),l(1),T("ngIf",o.social_category==3),l(1),T("ngIf",o.social_category==4),l(4),p(o.filteredVillageStats[0].district_name),l(2),p(o.filteredVillageStats[0].block_name),l(2),p(o.filteredVillageStats[0].gp_name),l(3),T("ngModel",o.searchTerm),l(3),E(19,o.isExportInProgress?20:19),l(3),E(22,o.isExportInProgressExcel?23:22),l(3),E(25,o.filteredVillageStats&&o.filteredVillageStats.length>0?25:26)}}var Ma=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.gp_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.block_id,this.gp_id=n.id}),this.route.queryParams.subscribe(n=>{this.social_category=n.social_category,this.installment=n.installment,this.fetchvillageStats(this.gp_id)})}fetchvillageStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/village-count?gp_id=${n}&social_category=${this.social_category}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.villageStats=r.data},r=>{this.isStatsLoading=!1,this.villageStats=[]})}getTotalRejected(n){let r=parseInt((n.nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10),c=parseInt((n.non_nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10);return(r+c).toLocaleString()}get filteredVillageStats(){return this.searchTerm?this.villageStats.filter(n=>n.village_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.villageStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.villageStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",BLOCK:u.block_name?u.block_name.toUpperCase():"",GP:u.gp_name?u.gp_name.toUpperCase():"",VILLAGE:u.village_name?u.village_name.toUpperCase():"","APPLICATION APPROVED":u?.approved_application,"APPLICATION REJECTED":this.getTotalRejected(u)})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=this.social_category==1?`soc_cat_gen_village_drilldown_reports_${C}_${g}.xlsx`:this.social_category==2?`soc_cat_obc_village_drilldown_reports_${C}_${g}.xlsx`:this.social_category==3?`soc_cat_sc_village_drilldown_reports_${C}_${g}.xlsx`:this.social_category==4?`soc_cat_st_village_drilldown_reports_${C}_${g}.xlsx`:"",v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){bi.default.vfs=Wa.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.villageStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=(n.gp_name||n.ward_no||"N/A").toUpperCase(),d=[[{text:"SI#",fontSize:10},{text:"VILLAGE",fontSize:10},{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"APPLICATION REJECTED",fontSize:10}]];this.villageStats.forEach((R,z)=>{d.push([{text:(z+1).toString().toUpperCase(),fontSize:9},{text:(R.village_name||"").toUpperCase(),fontSize:9},{text:R?.applications_received,fontSize:9},{text:R?.approved_application,fontSize:9},{text:this.getTotalRejected(R),fontSize:9}])});let C=new Date,g=`Timestamp: ${C.toLocaleDateString()}, ${C.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,_=this.social_category==1?"DRILL-DOWN REPORT GENERAL VILLAGE WISE":this.social_category==2?"DRILL-DOWN REPORT OBC VILLAGE WISE":this.social_category==3?"DRILL-DOWN REPORT SC VILLAGE WISE":this.social_category==4?"DRILL-DOWN REPORT ST VILLAGE WISE":"",v={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK: ${c} > GP:${f}`,style:"breadcrumb",margin:[0,0,0,10]},{text:_,style:"header"},{table:{headerRows:1,body:d,widths:["9%","13%","13%","13%","13%"]},layout:{fillColor:function(R){return R===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:g,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},S=new Date,w=S.toLocaleDateString("en-GB").split("/").reverse().join("-"),u=S.toLocaleTimeString("en-GB").replace(/:/g,"-"),I=this.social_category==1?`soc_cat_gen_village_drilldown_reports_${w}_${u}.pdf`:this.social_category==2?`soc_cat_obc_village_drilldown_reports_${w}_${u}.pdf`:this.social_category==3?`soc_cat_sc_village_drilldown_reports_${w}_${u}.pdf`:this.social_category==4?`soc_cat_st_village_drilldown_reports_${w}_${u}.pdf`:"";bi.default.createPdf(v).download(I,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-soc-cat-village-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],["style","color: #fd7b03;",4,"ngIf"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],[2,"color","#fd7b03"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],["colspan","3",1,"text-center"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,Mb,2,0)(11,tv,27,11),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ft,ot,K,q,J,it]});let i=s;return i})();var vi=j(ut()),Fa=j(ht());function ev(i,s){i&1&&(t(0,"h4",29),a(1,"Detailed Report - GENERAL"),e())}function iv(i,s){i&1&&(t(0,"h4",29),a(1,"Detailed Report - OBC"),e())}function nv(i,s){i&1&&(t(0,"h4",29),a(1,"Detailed Report - SC"),e())}function ov(i,s){i&1&&(t(0,"h4",29),a(1,"Detailed Report - ST"),e())}function av(i,s){if(i&1&&(t(0,"div",30)(1,"div",31)(2,"nav",32)(3,"ol",33)(4,"li",34),a(5),e(),t(6,"li",34),a(7),e(),t(8,"li",34),a(9),e(),t(10,"li",35),a(11),e()()()()()),i&2){let o=h();l(5),p(o.filteredVillageUserStats[0].district_name),l(2),p(o.filteredVillageUserStats[0].block_name),l(2),p(o.filteredVillageUserStats[0].gp_name),l(2),p(o.filteredVillageUserStats[0].village_name)}}function rv(i,s){i&1&&(t(0,"button",36),m(1,"i",37),a(2,"Search "),e())}function sv(i,s){i&1&&(t(0,"button",38),m(1,"i",39),a(2," Searching ..."),e())}function lv(i,s){i&1&&(m(0,"i",40),a(1," We are fetching the data, please wait. "))}function cv(i,s){if(i&1){let o=U();t(0,"button",55),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",56),a(2,"Download to PDF "),e()}}function dv(i,s){i&1&&(t(0,"button",57),m(1,"i",39),a(2,"Downloading "),e())}function pv(i,s){if(i&1){let o=U();t(0,"button",55),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",56),a(2,"Download to EXCEL "),e()}}function mv(i,s){i&1&&(t(0,"button",57),m(1,"i",39),a(2,"Downloading "),e())}var _v=(i,s)=>s.id;function fv(i,s){if(i&1&&(t(0,"td"),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit;l(1),p(P(2,1,o.village_name))}}function uv(i,s){i&1&&m(0,"td")}function hv(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),b(3,fv,3,3,"td")(4,uv,1,0),t(5,"td"),a(6),k(7,"uppercase"),e(),t(8,"td"),a(9),k(10,"uppercase"),e(),t(11,"td"),a(12),k(13,"uppercase"),e(),t(14,"td"),a(15),k(16,"uppercase"),e(),t(17,"td"),a(18),k(19,"uppercase"),e(),t(20,"td"),a(21),k(22,"uppercase"),e(),t(23,"td"),a(24),k(25,"uppercase"),e(),t(26,"td"),a(27),e(),t(28,"td"),a(29),k(30,"uppercase"),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(1),E(3,o.village_name?3:4),l(3),p(P(7,11,o.category)),l(3),p(P(10,13,o.application_number)),l(3),p(P(13,15,r.appService.dateFormat(o.application_date))),l(3),p(P(16,17,o.applicant_name)),l(3),p(P(19,19,o.spouse_or_father_name)),l(3),p(P(22,21,o.social_category)),l(3),p(P(25,23,o.pwd_status)),l(3),p(o.alt_mobile_number),l(2),p(P(30,25,o.application_status))}}function Sv(i,s){if(i&1&&(t(0,"table",58)(1,"thead",59)(2,"tr")(3,"th"),a(4,"SI#"),e(),t(5,"th"),a(6,"WARD NO."),e(),t(7,"th"),a(8,"CATEGORY"),e(),t(9,"th"),a(10,"APPLICATION NO."),e(),t(11,"th"),a(12,"APPLICATION DATE"),e(),t(13,"th"),a(14,"APPLICANT NAME"),e(),t(15,"th"),a(16,"FATHER/HUSBAND NAME"),e(),t(17,"th"),a(18,"SOCIAL CATEGORY"),e(),t(19,"th"),a(20,"PWD"),e(),t(21,"th"),a(22,"MOBILE NO."),e(),t(23,"th"),a(24,"APPLICATION STATUS"),e()()(),t(25,"tbody"),F(26,hv,31,27,"tr",null,_v),e()()),i&2){let o=h(2);l(26),V(o.filteredVillageUserStats)}}function xv(i,s){i&1&&(t(0,"h5",60),a(1,"No data available"),e())}function gv(i,s){i&1&&(t(0,"div",61),a(1,"Loading.. "),m(2,"i",62),e())}function Cv(i,s){i&1&&(t(0,"span"),m(1,"i",40),a(2," Loading..."),e())}function bv(i,s){i&1&&(t(0,"span"),a(1,"Load More"),e())}function vv(i,s){if(i&1){let o=U();t(0,"div",63)(1,"button",64),L("click",function(){D(o);let r=h(2);return A(r.loadMore())}),b(2,Cv,3,0,"span",65)(3,bv,2,0,"span",65),e()()}if(i&2){let o=h(2);l(2),T("ngIf",o.isLoadMoreInProgress),l(1),T("ngIf",!o.isLoadMoreInProgress)}}function Ev(i,s){if(i&1){let o=U();t(0,"div",30)(1,"div",41)(2,"h5",42),a(3," Number of records found : "),t(4,"span",43),a(5),e()()(),t(6,"div",44)(7,"div",45)(8,"input",46),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(9,"i",47),e(),t(10,"div",48),b(11,cv,3,0,"button",49)(12,dv,3,0),e(),t(13,"div",50),b(14,pv,3,0,"button",49)(15,mv,3,0),e()()(),t(16,"div",51),b(17,Sv,28,0,"table",52)(18,xv,2,0)(19,gv,3,0,"div",53),e(),b(20,vv,4,2,"div",54)}if(i&2){let o=h();l(5),p(o.count),l(3),T("ngModel",o.searchTerm),l(3),E(11,o.isExportInProgress?12:11),l(3),E(14,o.isExportInProgressExcel?15:14),l(3),E(17,o.filteredVillageUserStats&&o.filteredVillageUserStats.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),l(2),E(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),l(1),T("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var Va=(()=>{let s=class s{constructor(n,r,c,f,d,C,g,_){this.route=n,this.router=r,this.formService=c,this.appService=f,this.httpClient=d,this.toastService=C,this.authService=g,this.masterDataService=_,this.isStatsLoading=!1,this.userStats=[],this.block_id="",this.gp_id="",this.village_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.limit=this.appService.loadmorelimit,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.count=0,this.searchForm=new kt({a_category:new nt(""),social_category:new nt(""),pwd_status:new nt(""),submit_date:new nt(""),a_status:new nt("")})}ngOnInit(){this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.block_id,this.gp_id=n.gp_id,this.village_id=n.id}),this.route.queryParams.subscribe(n=>{this.social_category=n.social_category,this.installment=n.installment,this.fetchuserStats(this.village_id)})}fetchuserStats(n,r=!1){this.isStatsLoading=!0;let c=new st;c=c.set("gp_id",this.gp_id),c=c.set("village_id",n),c=c.set("offset",this.offset),c=c.set("limit",this.limit),this.social_category!==void 0&&(c=c.set("social_category",this.social_category.toString())),this.installment!==void 0&&(c=c.set("installment",this.installment.toString()));let f=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:c,headers:f}).subscribe(d=>{this.isStatsLoading=!1,this.count=d.count,d.data&&d.data.length>0?(this.application_list=this.application_list.concat(d.data),this.offset+=d.data.length,this.hasMoreRecords=d.data.length===this.limit):this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)},d=>{this.isStatsLoading=!1,this.application_list=[],this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)})}get filteredVillageUserStats(){if(!this.searchTerm)return this.application_list;let n=this.searchTerm.toLowerCase();return this.application_list.filter(r=>r.village_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.category?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.application_number?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_date).toLowerCase().includes(this.searchTerm.toLowerCase())||r.applicant_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.spouse_or_father_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.dob).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.social_category).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.pwd_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.alt_mobile_number).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.payment_status).toLowerCase().includes(this.searchTerm.toLowerCase()))}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.a_status,g=new st;g=g.set("gp_id",this.gp_id),r&&(g=g.set("village_id",r)),c&&(g=g.set("category",c)),d&&(g=g.set("pwd_status",d)),C&&(g=g.set("application_status",C)),g=g.set("offset",this.offset),g=g.set("limit",this.limit),this.social_category!==void 0&&(g=g.set("social_category",this.social_category.toString())),this.installment!==void 0&&(g=g.set("installment",this.installment.toString()));let _=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:g,headers:_}).subscribe(v=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=v.count,v.data&&v.data.length>0?(this.application_list=this.application_list.concat(v.data),this.offset+=v.data.length,this.hasMoreRecords=v.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},v=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}exportToExcel(){let n=new st,r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.a_status;n=n.set("gp_id",this.gp_id),r&&(n=n.set("village_id",r)),c&&(n=n.set("category",c)),d&&(n=n.set("pwd_status",d)),C&&(n=n.set("application_status",C)),n=n.set("export_all","1"),this.social_category!==void 0&&(n=n.set("social_category",this.social_category.toString())),this.installment!==void 0&&(n=n.set("installment",this.installment.toString()));let g=new rt({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:g,responseType:"json"}).subscribe(_=>{this.isExportInProgressExcel=!1;let v=_.data.map((et,y)=>({"SI#":y+1,DISTRICT:et.district_name?et.district_name.toUpperCase():"",BLOCK:et.block_name?et.block_name.toUpperCase():"",GP:et.gp_name?et.gp_name.toUpperCase():"",VILLAGE:et.village_name?et.village_name.toUpperCase():"",CATEGORY:et.category.toUpperCase(),"APPLICATION NO.":et.application_number.toUpperCase(),"APPLICATION DATE":this.appService.dateFormat(et.application_date),"APPLICANT NAME":et.applicant_name.toUpperCase(),"FATHER/HUSBAND NAME":et.spouse_or_father_name.toUpperCase(),"SOCIAL CATEGORY":et.social_category.toUpperCase(),PWD:et.pwd_status.toUpperCase(),"MOBILE NO.":et.alt_mobile_number,"APPLICATION STATUS":et.application_status.toUpperCase()})),S=N.json_to_sheet(v),w=N.book_new();N.book_append_sheet(w,S,"Applications");let u=Z(w,{bookType:"xlsx",type:"array"}),I=new Date,R=I.toLocaleDateString("en-GB").split("/").reverse().join("-"),z=I.toLocaleTimeString("en-GB").replace(/:/g,"-"),at=this.social_category==1?`soc_cat_gen_application_status_reports_${R}_${z}.xlsx`:this.social_category==2?`soc_cat_obc_application_status_reports_${R}_${z}.xlsx`:this.social_category==3?`soc_cat_sc_application_status_reports_${R}_${z}.xlsx`:this.social_category==4?`soc_cat_application_status_reports_${R}_${z}.xlsx`:"",ct=new Blob([u],{type:"application/octet-stream"}),lt=document.createElement("a"),O=window.URL.createObjectURL(ct);lt.href=O,lt.download=at,lt.click(),window.URL.revokeObjectURL(O)},_=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",_)})}exportToPDF(){vi.default.vfs=Fa.default.pdfMake.vfs;let n=new st,r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.a_status;n=n.set("gp_id",this.gp_id),r&&(n=n.set("village_id",r)),c&&(n=n.set("category",c)),d&&(n=n.set("pwd_status",d)),C&&(n=n.set("application_status",C)),n=n.set("export_all","1"),this.social_category!==void 0&&(n=n.set("social_category",this.social_category.toString())),this.installment!==void 0&&(n=n.set("installment",this.installment.toString()));let g=new rt({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:g,responseType:"json"}).subscribe(_=>{this.isExportInProgress=!1;let v=_.data[0]||{},S=(v.district_name||"N/A").toUpperCase(),w=(v.block_name||v.ulb_name||"N/A").toUpperCase(),u=(v.gp_name||v.ward_no||"N/A").toUpperCase(),I=(v.village_name||"").toUpperCase(),R=[[{text:"SI#",fontSize:10},{text:"CATEGORY",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICATION DATE.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"SOCIAL CATEGORY",fontSize:10},{text:"PWD",fontSize:10},{text:"MOBILE NO",fontSize:10},{text:"APPLICATION STATUS",fontSize:10}]];_.data.forEach((W,It)=>{R.push([{text:(It+1).toString().toUpperCase(),fontSize:9},{text:(W.category||"").toUpperCase(),fontSize:9},{text:(W.application_number||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(W.application_date)||"",fontSize:9},{text:(W.applicant_name||"").toUpperCase(),fontSize:9},{text:(W.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:(W.social_category||"").toUpperCase(),fontSize:9},{text:(W.pwd_status||"").toUpperCase(),fontSize:9},{text:(W.alt_mobile_number||"").toUpperCase(),fontSize:9},{text:(W.application_status||"").toUpperCase(),fontSize:9}])});let z=new Date,at=`Timestamp: ${z.toLocaleDateString()}, ${z.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,ct=this.social_category==1?"DETAILED REPORT - GENERAL":this.social_category==2?"DETAILED REPORT - OBC":this.social_category==3?"DETAILED REPORT - SC":this.social_category==4?"DETAILED REPORT - ST":"",lt={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${S} > BLOCK: ${w} > GP: ${u} >VILLAGE: ${I}`,style:"breadcrumb",margin:[0,0,0,10]},{text:ct,style:"header"},{table:{headerRows:1,body:R,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]},layout:{fillColor:function(W){return W===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:at,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},O=new Date,et=O.toLocaleDateString("en-GB").split("/").reverse().join("-"),y=O.toLocaleTimeString("en-GB").replace(/:/g,"-"),B=this.social_category==1?`soc_cat_gen_application_status_reports_${et}_${y}.pdf`:this.social_category==2?`soc_cat_obc_application_status_reports_${et}_${y}.pdf`:this.social_category==3?`soc_cat_sc_application_status_reports_${et}_${y}.pdf`:this.social_category==4?`soc_cat_st_application_status_reports_${et}_${y}.pdf`:"";vi.default.createPdf(lt).download(B)},_=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",_)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(Ot),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-soc-cat-village-user-list"]],decls:56,vars:8,consts:[[1,"container-fluid","drilldown-reports"],[1,"d-flex","justify-content-between","w-100","mb-3"],["style","color: #fd7b03;",4,"ngIf"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],["class","row mb-2"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-2"],[1,"col-md-4"],["for","a_category",1,"fw-bold"],["formControlName","a_category","id","a_category",1,"form-select","my-2"],["value",""],["value","1"],["value","0"],["for","a_status",1,"fw-bold"],["formControlName","a_status","id","a_status",1,"form-select","my-2"],["value","7"],["value","2"],["for","pwd_status",1,"fw-bold"],["formControlName","pwd_status","id","pwd_status",1,"form-select","my-2"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[2,"color","#fd7b03"],[1,"row","mb-2"],[1,"col-md-7"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"fa","fa-spinner","fa-spin"],[1,"col-md-5"],[1,"card-title"],["id","recordCount"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports detail"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports","detail"],[1,"text-light",2,"background-color","#fd7b03"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"],[4,"ngIf"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),b(2,ev,2,0,"h4",2)(3,iv,2,0,"h4",2)(4,nv,2,0,"h4",2)(5,ov,2,0,"h4",2),t(6,"div",3)(7,"a",4),L("click",function(){return c.appService.goBack()}),t(8,"button",5),m(9,"i",6),a(10," Back"),e()()()(),b(11,av,12,4,"div",7),t(12,"div",8)(13,"form",9),L("ngSubmit",function(){return c.onSearch()}),t(14,"div",10)(15,"div",11)(16,"label",12),a(17," Category "),e(),t(18,"select",13)(19,"option",14),a(20,"Choose Category"),e(),t(21,"option",15),a(22,"NFSA"),e(),t(23,"option",16),a(24,"NON-NFSA"),e()()(),t(25,"div",11)(26,"label",17),a(27," Application Status "),e(),t(28,"select",18)(29,"option",14),a(30,"Choose Status"),e(),t(31,"option",19),a(32,"Under Process"),e(),t(33,"option",15),a(34,"Approved"),e(),t(35,"option",20),a(36,"Rejected"),e()()(),t(37,"div",11)(38,"label",21),a(39," PWD "),e(),t(40,"select",22)(41,"option",14),a(42,"Choose PWD Status"),e(),t(43,"option",15),a(44,"Yes "),e(),t(45,"option",16),a(46,"NO"),e()()()(),t(47,"div",23)(48,"div",24),b(49,rv,3,0,"button",25)(50,sv,3,0),e()()()(),t(51,"div",26)(52,"div",27)(53,"div",28),b(54,lv,2,0)(55,Ev,21,7),e()()()()),r&2&&(l(2),T("ngIf",c.social_category==1),l(1),T("ngIf",c.social_category==2),l(1),T("ngIf",c.social_category==3),l(1),T("ngIf",c.social_category==4),l(6),E(11,c.filteredVillageUserStats&&c.filteredVillageUserStats.length>0?11:-1),l(2),T("formGroup",c.searchForm),l(36),E(49,c.isFormSearchInProgress?50:49),l(5),E(54,c.isStatsLoading?54:55))},dependencies:[ft,Pt,Nt,Rt,K,Ut,q,yt,J,Dt,At,it]});let i=s;return i})();var Ei=j(ut()),za=j(ht());function wv(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function Tv(i,s){i&1&&(t(0,"h4",26),a(1,"Drill-Down Report - GENERAL"),e())}function Lv(i,s){i&1&&(t(0,"h4",26),a(1,"Drill-Down Report - OBC"),e())}function Iv(i,s){i&1&&(t(0,"h4",26),a(1,"Drill-Down Report - SC"),e())}function yv(i,s){i&1&&(t(0,"h4",26),a(1,"Drill-Down Report - ST"),e())}function kv(i,s){if(i&1){let o=U();t(0,"button",27),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",28),a(2,"Download PDF "),e()}}function Pv(i,s){i&1&&(t(0,"button",29),m(1,"i",30),a(2,"Downloading "),e())}function Dv(i,s){if(i&1){let o=U();t(0,"button",27),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",28),a(2,"Download EXCEL "),e()}}function Av(i,s){i&1&&(t(0,"button",29),m(1,"i",30),a(2,"Downloading "),e())}var Uv=(i,s)=>s.id,Nv=(i,s,o)=>["/department/portal/soc_cat/ward-user-list",i,s,o],Rv=(i,s)=>({social_category:i,installment:s});function Ov(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",36),a(5),e()(),t(6,"td"),a(7),e(),t(8,"td"),a(9),e(),t(10,"td"),a(11),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),T("routerLink",Ft(7,Nv,o.district_id,o.ulb_id,o.ward_id))("queryParams",Lt(11,Rv,r.social_category,r.installment)),l(1),dt(" ",o.ward_no," "),l(2),p(o==null?null:o.applications_received),l(2),p(o==null?null:o.approved_application),l(2),p(r.getTotalRejected(o))}}function Bv(i,s){if(i&1&&(t(0,"table",31)(1,"thead",32)(2,"tr")(3,"th",33),a(4,"Sl.#"),e(),t(5,"th",33),a(6,"WARD"),e(),t(7,"th",34),a(8,"APPLICATION DETAILS"),e()(),t(9,"tr")(10,"th"),a(11,"RECEIVED"),e(),t(12,"th"),a(13,"APPROVED"),e(),t(14,"th"),a(15,"REJECTED"),e()()(),t(16,"tbody",35),F(17,Ov,12,14,"tr",null,Uv),e()()),i&2){let o=h(2);l(17),V(o.filteredWardStats)}}function Wv(i,s){i&1&&a(0," No Data Found ")}function Mv(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11),b(2,Tv,2,0,"h4",12)(3,Lv,2,0,"h4",12)(4,Iv,2,0,"h4",12)(5,yv,2,0,"h4",12),t(6,"nav",13)(7,"ol",14)(8,"li",15),a(9),e(),t(10,"li",16),a(11),e()()()(),t(12,"div",17)(13,"div",18)(14,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(15,"i",20),e(),t(16,"div",21),b(17,kv,3,0,"button",22)(18,Pv,3,0),e(),t(19,"div",23),b(20,Dv,3,0,"button",22)(21,Av,3,0),e()()(),t(22,"div",24),b(23,Bv,19,0,"table",25)(24,Wv,1,0),e()}if(i&2){let o=h();l(2),T("ngIf",o.social_category==1),l(1),T("ngIf",o.social_category==2),l(1),T("ngIf",o.social_category==3),l(1),T("ngIf",o.social_category==4),l(4),p(o.filteredWardStats[0].district_name),l(2),p(o.filteredWardStats[0].ulb_name),l(3),T("ngModel",o.searchTerm),l(3),E(17,o.isExportInProgress?18:17),l(3),E(20,o.isExportInProgressExcel?21:20),l(3),E(23,o.filteredWardStats&&o.filteredWardStats.length>0?23:24)}}var ja=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.district_id="",this.wardStats=[],this.ulb_id="",this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.params.subscribe(n=>{this.district_id=n.district_id,this.ulb_id=n.id}),this.route.queryParams.subscribe(n=>{this.social_category=n.social_category,this.installment=n.installment,console.log("social_category:",this.social_category),this.fetchWardStats(this.ulb_id)})}fetchWardStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/ward-count?ulb_id=${n}&social_category=${this.social_category}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.wardStats=r.data},r=>{this.isStatsLoading=!1,this.wardStats=[]})}getTotalRejected(n){let r=parseInt((n.nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10),c=parseInt((n.non_nfsa_rejected_application||"0").toString().replace(/,/g,"").trim(),10);return(r+c).toLocaleString()}get filteredWardStats(){return this.searchTerm?this.wardStats.filter(n=>n.ward_no.toLowerCase().includes(this.searchTerm.toLowerCase())):this.wardStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.wardStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",ULB:u.ulb_name?u.ulb_name.toUpperCase():"","WARD NO.":u.ward_no?u.ward_no.toUpperCase():"","APPLICATION RECEIVED":u?.applications_received,"APPLICATION APPROVED":u?.approved_application,"APPLICATION REJECTED":this.getTotalRejected(u)})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=this.social_category==1?`soc_cat_gen_village_drilldown_reports_${C}_${g}.xlsx`:this.social_category==2?`soc_cat_obc_ward_drilldown_reports_${C}_${g}.xlsx`:this.social_category==3?`soc_cat_sc_ward_drilldown_reports_${C}_${g}.xlsx`:this.social_category==4?`soc_cat_st_ward_drilldown_reports_${C}_${g}.xlsx`:"",v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){Ei.default.vfs=za.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.wardStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=[[{text:"SI#",fontSize:10},{text:"WARD NO.",fontSize:10},{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"APPLICATION REJECTED",fontSize:10}]];this.wardStats.forEach((I,R)=>{f.push([{text:(R+1).toString().toUpperCase(),fontSize:9},{text:(I.ward_no||"").toUpperCase(),fontSize:9},{text:I?.applications_received,fontSize:9},{text:I?.approved_application,fontSize:9},{text:this.getTotalRejected(I),fontSize:9}])});let d=new Date,C=`Timestamp: ${d.toLocaleDateString()}, ${d.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,g=this.social_category==1?"DRILL-DOWN REPORT GENERAL WARD WISE":this.social_category==2?"DRILL-DOWN REPORT OBC WARD WISE":this.social_category==3?"DRILL-DOWN REPORT SC WARD WISE":this.social_category==4?"DRILL-DOWN REPORT ST WARD WISE":"",_={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK/ULB: ${c}`,style:"breadcrumb",margin:[0,0,0,10]},{text:g,style:"header"},{table:{headerRows:1,body:f,widths:["9%","13%","13%","13%","13%"]},layout:{fillColor:function(I){return I===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:C,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},v=new Date,S=v.toLocaleDateString("en-GB").split("/").reverse().join("-"),w=v.toLocaleTimeString("en-GB").replace(/:/g,"-"),u=this.social_category==1?`soc_cat_gen_ward_drilldown_reports_${S}_${w}.pdf`:this.social_category==2?`soc_cat_obc_ward_drilldown_reports_${S}_${w}.pdf`:this.social_category==3?`soc_cat_sc_ward_drilldown_reports_${S}_${w}.pdf`:this.social_category==4?`soc_cat_st_ward_drilldown_reports_${S}_${w}.pdf`:"";Ei.default.createPdf(_).download(u,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-soc-cat-ward-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],["style","color: #fd7b03;",4,"ngIf"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],[2,"color","#fd7b03"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],["colspan","3",1,"text-center"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,wv,2,0)(11,Mv,25,10),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ft,ot,K,q,J]});let i=s;return i})();var wi=j(ut()),$a=j(ht());function Fv(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function Vv(i,s){if(i&1&&(t(0,"h4",22),a(1),e()),i&2){let o=h(2);l(1),dt(" ",o.payment_status=="S00"&&o.payment_mode=="APBS"?"Drill-Down Report - DBT Success":o.payment_status=="NS00"&&o.payment_mode=="APBS"?"Drill-Down Report - DBT Failed":o.payment_status=="S00"&&o.payment_mode=="WALLET"?"Drill-Down Report - CBDC Success":o.payment_status=="NS00"&&o.payment_mode=="WALLET"?"Drill-Down Report - CBDC Failed":""," ")}}function zv(i,s){if(i&1){let o=U();t(0,"button",23),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",24),a(2,"Download PDF "),e()}}function jv(i,s){i&1&&(t(0,"button",25),m(1,"i",26),a(2,"Downloading "),e())}function $v(i,s){if(i&1){let o=U();t(0,"button",23),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",24),a(2,"Download EXCEL "),e()}}function Gv(i,s){i&1&&(t(0,"button",25),m(1,"i",26),a(2,"Downloading "),e())}var Xv=(i,s)=>s==null?null:s.id;function Yv(i,s){i&1&&(t(0,"th"),a(1,"PAYMENT SUCCESS"),e())}function Hv(i,s){i&1&&(t(0,"th"),a(1,"PAYMENT FAILED"),e())}function Kv(i,s){if(i&1&&(t(0,"td"),a(1),e()),i&2){let o=h().$implicit;l(1),p(o==null?null:o.payment_success_dbt)}}function qv(i,s){if(i&1&&(t(0,"td"),a(1),e()),i&2){let o=h().$implicit;l(1),p(o==null?null:o.payment_fail_dbt)}}function Jv(i,s){if(i&1&&(t(0,"td"),a(1),e()),i&2){let o=h().$implicit;l(1),p(o==null?null:o.payment_success_cbdc)}}var Qv=i=>["/department/portal/payment/block-ulb-stats",i],Zv=(i,s,o)=>({payment_status:i,payment_mode:s,installment:o});function tE(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",32),a(5),k(6,"uppercase"),e()(),b(7,Kv,2,1,"td",30)(8,qv,2,1,"td",30)(9,Jv,2,1,"td",30),e()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),T("routerLink",pt(9,Qv,o==null?null:o.district_id))("queryParams",Ft(11,Zv,r.payment_status,r.payment_mode,r.installment)),l(1),dt(" ",P(6,7,o==null?null:o.district_name)," "),l(2),T("ngIf",r.card_name=="pay_succ_dbt"),l(1),T("ngIf",r.card_name=="pay_fail_dbt"),l(1),T("ngIf",r.card_name=="pay_succ_cbdc")}}function eE(i,s){if(i&1&&(t(0,"table",27)(1,"thead",28)(2,"tr")(3,"th",29),a(4,"Sl.#"),e(),t(5,"th",29),a(6,"DISTRICT"),e()(),t(7,"tr"),b(8,Yv,2,0,"th",30)(9,Hv,2,0,"th",30),e()(),t(10,"tbody",31),F(11,tE,10,15,"tr",null,Xv),e()()),i&2){let o=h(2);l(8),T("ngIf",o.payment_status=="S00"),l(1),T("ngIf",o.payment_status=="NS00"),l(2),V(o.filteredDistrictStats)}}function iE(i,s){i&1&&a(0," No Data Found ")}function nE(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11),b(2,Vv,2,1,"h4",12),e(),t(3,"div",13)(4,"div",14)(5,"input",15),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(6,"i",16),e(),t(7,"div",17),b(8,zv,3,0,"button",18)(9,jv,3,0),e(),t(10,"div",19),b(11,$v,3,0,"button",18)(12,Gv,3,0),e()()(),t(13,"div",20),b(14,eE,13,2,"table",21)(15,iE,1,0),e()}if(i&2){let o=h();l(2),T("ngIf",o.payment_status&&o.payment_mode),l(3),T("ngModel",o.searchTerm),l(3),E(8,o.isExportInProgress?9:8),l(3),E(11,o.isExportInProgressExcel?12:11),l(3),E(14,o.filteredDistrictStats&&o.filteredDistrictStats.length>0?14:15)}}var Ga=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.districtStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.payment_status=n.payment_status,this.payment_mode=n.payment_mode,this.installment=n.installment,this.card_name=n.card_name,this.fetchDistrictStats()})}fetchDistrictStats(){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?card_name=${this.card_name}&payment_status=${this.payment_status}&payment_mode=${this.payment_mode}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isStatsLoading=!1,this.districtStats=n.data},n=>{this.isStatsLoading=!1,this.districtStats=[]})}get filteredDistrictStats(){return this.searchTerm?this.districtStats.filter(n=>n?.district_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.districtStats}exportToExcel(){this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?card_name=${this.card_name}&payment_status=${this.payment_status}&payment_mode=${this.payment_mode}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isExportInProgressExcel=!1;let r=n.data.map((I,R)=>{let z={"SI#":R+1,DISTRICT:I?.district_name.toUpperCase()};return this.card_name=="pay_succ_dbt"?Wt(Bt({},z),{"PAYMENT SUCCESS":I?.payment_success_dbt}):this.card_name=="pay_fail_dbt"?Wt(Bt({},z),{"PAYMENT FAILED":I?.payment_fail_dbt}):this.card_name=="pay_succ_cbdc"?Wt(Bt({},z),{"PAYMENT SUCCESS":I?.payment_success_cbdc}):z}),c=N.json_to_sheet(r),f=N.book_new();N.book_append_sheet(f,c,"Applications");let d=Z(f,{bookType:"xlsx",type:"array"}),C=new Date,g=C.toLocaleDateString("en-GB").split("/").reverse().join("-"),_=C.toLocaleTimeString("en-GB").replace(/:/g,"-"),v=this.payment_status=="S00"&&this.payment_mode=="APBS"?`payement_success_dbt_district_drilldown_reports_${g}_${_}.xlsx`:this.payment_status=="NS00"&&this.payment_mode=="APBS"?`payement_faild_dbt_district_drilldown_reports_${g}_${_}.xlsx`:this.payment_status=="S00"&&this.payment_mode=="WALLET"?`payement_sucess_cbdc_district_drilldown_reports_${g}_${_}.xlsx`:this.payment_status=="NS00"&&this.payment_mode=="WALLET"?`payement_faild_cbdc_district_drilldown_reports_${g}_${_}.xlsx`:"",S=new Blob([d],{type:"application/octet-stream"}),w=document.createElement("a"),u=window.URL.createObjectURL(S);w.href=u,w.download=v,w.click(),window.URL.revokeObjectURL(u)},n=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",n)})}exportToPDF(){wi.default.vfs=$a.default.pdfMake.vfs,this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?card_name=${this.card_name}&payment_status=${this.payment_status}&payment_mode=${this.payment_mode}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isExportInProgress=!1;let r=[[{text:"SI#",fontSize:10},{text:"DISTRICT",fontSize:10},{text:this.card_name=="pay_succ_dbt"?"PAYMENT SUCCESS":this.payment_status=="pay_fail_dbt"?"PAYMENT FAILED":this.payment_status=="pay_succ_cbdc"?"PAYMENT SUCCESS":"",fontSize:10}]];n.data.forEach((w,u)=>{r.push([{text:(u+1).toString().toUpperCase(),fontSize:9},{text:(w?.district_name||"").toUpperCase(),fontSize:9},{text:this.card_name=="pay_succ_dbt"?w?.payment_success_dbt:this.card_name=="pay_fail_dbt"?w?.payment_fail_dbt:this.card_name=="pay_succ_cbdc"?w?.payment_success_cbdc:"",fontSize:9}])});let c=new Date,f=`Timestamp: ${c.toLocaleDateString()}, ${c.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,C={pageOrientation:"landscape",pageSize:"A4",content:[{text:this.payment_status=="S00"&&this.payment_mode=="APBS"?"PAYMENT SUCCESS THROUGH DBT REPORT DISTRICT-WISE":this.payment_status=="NS00"&&this.payment_mode=="APBS"?"PAYMENT FAILD THROUGH DBT REPORT DISTRICT-WISE":this.payment_status=="S00"&&this.payment_mode=="WALLET"?"PAYMENT SUCCESS THROUGH CBDC REPORT DISTRICT-WISE":this.payment_status=="NS00"&&this.payment_mode=="WALLET"?"PAYMENT FAILD THROUGH CBDC REPORT DISTRICT-WISE":"",style:"header"},{table:{headerRows:1,body:r,widths:["10%","18%","18%"]},layout:{fillColor:function(w){return w===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:f,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},g=new Date,_=g.toLocaleDateString("en-GB").split("/").reverse().join("-"),v=g.toLocaleTimeString("en-GB").replace(/:/g,"-"),S=this.payment_status=="S00"&&this.payment_mode=="APBS"?`payement_success_dbt_district_drilldown_reports_${_}_${v}.pdf`:this.payment_status=="NS00"&&this.payment_mode=="APBS"?`payement_faild_dbt_district_drilldown_reports_${_}_${v}.pdf`:this.payment_status=="S00"&&this.payment_mode=="WALLET"?`payement_sucess_cbdc_district_drilldown_reports_${_}_${v}.pdf`:this.payment_status=="NS00"&&this.payment_mode=="WALLET"?`payement_faild_cbdc_district_drilldown_reports_${_}_${v}.pdf`:"";wi.default.createPdf(C).download(S)},n=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",n)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-ps-district-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["routerLink","/department/portal/dashboard/",1,"me-2"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],["style","color: #fd7b03;",4,"ngIf"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],[2,"color","#fd7b03"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],[4,"ngIf"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4)(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,Fv,2,0)(11,nE,16,5),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ft,ot,K,q,J,it]});let i=s;return i})();var Ti=j(ut()),Xa=j(ht());function oE(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function aE(i,s){if(i&1&&(t(0,"h4",25),a(1),e()),i&2){let o=h(2);l(1),dt(" ",o.payment_status=="S00"&&o.payment_mode=="APBS"?"Drill-Down Report - DBT Success":o.payment_status=="NS00"&&o.payment_mode=="APBS"?"Drill-Down Report - DBT Failed":o.payment_status=="S00"&&o.payment_mode=="WALLET"?"Drill-Down Report - CBDC Success":o.payment_status=="NS00"&&o.payment_mode=="WALLET"?"Drill-Down Report - CBDC Failed":""," ")}}function rE(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",27),a(2,"Download PDF "),e()}}function sE(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}function lE(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",27),a(2,"Download EXCEL "),e()}}function cE(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}var dE=(i,s)=>s.id;function pE(i,s){i&1&&(t(0,"th"),a(1,"PAYMENT SUCCESS"),e())}function mE(i,s){i&1&&(t(0,"th"),a(1,"PAYMENT FAILED"),e())}var _E=(i,s)=>["/department/portal/payment/gp-stats",i,s],Ya=(i,s,o)=>({payment_status:i,payment_mode:s,installment:o});function fE(i,s){if(i&1&&(t(0,"a",36),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit,n=h(3);T("routerLink",Lt(5,_E,o.district_id,o.block_id))("queryParams",Ft(8,Ya,n.payment_status,n.payment_mode,n.installment)),l(1),dt(" ",P(2,3,o.block_name)," ")}}var uE=(i,s)=>["/department/portal/payment/ward-stats",i,s];function hE(i,s){if(i&1&&(t(0,"a",36),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit,n=h(3);T("routerLink",Lt(5,uE,o.district_id,o.ulb_id))("queryParams",Ft(8,Ya,n.payment_status,n.payment_mode,n.installment)),l(1),dt(" ",P(2,3,o.ulb_name)," ")}}function SE(i,s){if(i&1&&(t(0,"td"),a(1),e()),i&2){let o=h().$implicit;l(1),p(o==null?null:o.payment_success)}}function xE(i,s){if(i&1&&(t(0,"td"),a(1),e()),i&2){let o=h().$implicit;l(1),p(o==null?null:o.payment_fail)}}function gE(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td"),b(4,fE,3,12,"a",35)(5,hE,3,12),e(),b(6,SE,2,1,"td",33)(7,xE,2,1,"td",33),e()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),E(4,o.block_id?4:5),l(2),T("ngIf",r.payment_status=="S00"),l(1),T("ngIf",r.payment_status=="NS00")}}function CE(i,s){if(i&1&&(t(0,"table",30)(1,"thead",31)(2,"tr")(3,"th",32),a(4,"Sl.#"),e(),t(5,"th",32),a(6,"BLOCK/ULB"),e()(),t(7,"tr"),b(8,pE,2,0,"th",33)(9,mE,2,0,"th",33),e()(),t(10,"tbody",34),F(11,gE,8,4,"tr",null,dE),e()()),i&2){let o=h(2);l(8),T("ngIf",o.payment_status=="S00"),l(1),T("ngIf",o.payment_status=="NS00"),l(2),V(o.filteredBlockStats)}}function bE(i,s){i&1&&a(0," No Data Found ")}function vE(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11),b(2,aE,2,1,"h4",12),t(3,"nav",13)(4,"ol",14)(5,"li",15),a(6),e()()()(),t(7,"div",16)(8,"div",17)(9,"input",18),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(10,"i",19),e(),t(11,"div",20),b(12,rE,3,0,"button",21)(13,sE,3,0),e(),t(14,"div",22),b(15,lE,3,0,"button",21)(16,cE,3,0),e()()(),t(17,"div",23),b(18,CE,13,2,"table",24)(19,bE,1,0),e()}if(i&2){let o=h();l(2),T("ngIf",o.payment_status&&o.payment_mode),l(4),p(o.filteredBlockStats[0].district_name),l(3),T("ngModel",o.searchTerm),l(3),E(12,o.isExportInProgress?13:12),l(3),E(15,o.isExportInProgressExcel?16:15),l(3),E(18,o.filteredBlockStats&&o.filteredBlockStats.length>0?18:19)}}var Ha=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.districtStats=[],this.district_id="",this.blockStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.params.subscribe(n=>{let r=n.id;this.district_id=r}),this.route.queryParams.subscribe(n=>{this.payment_status=n.payment_status,this.payment_mode=n.payment_mode,this.installment=n.installment,this.fetchblockStats(this.district_id)})}fetchblockStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/block-count?district_id=${n}&payment_status=${this.payment_status}&payment_mode=${this.payment_mode}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.blockStats=r.data,this.fetchulbStats(n)},r=>{this.isStatsLoading=!1,this.blockStats=[]})}fetchulbStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/ulb-count?district_id=${n}&payment_status=${this.payment_status}&payment_mode=${this.payment_mode}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.blockStats=[...this.blockStats,...r.data]},r=>{this.isStatsLoading=!1})}get filteredBlockStats(){return this.searchTerm?this.blockStats.filter(n=>n?.block_name&&n?.block_name.toLowerCase().includes(this.searchTerm.toLowerCase())||n?.ulb_name&&n?.ulb_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.blockStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.blockStats.map((u,I)=>{let R={"SI#":I+1,DISTRICT:u?.district_name.toUpperCase(),"BLOCK/ULB":u?.block_name?.toUpperCase()||u?.ulb_name?.toUpperCase()};return this.payment_status=="S00"?Wt(Bt({},R),{"PAYMENT SUCCESS":u?.payment_success}):this.payment_status=="NS00"?Wt(Bt({},R),{"PAYMENT FAILED":u?.payment_fail}):R}),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=this.payment_status=="S00"&&this.payment_mode=="APBS"?`payement_success_dbt_block_ulb_drilldown_reports_${C}_${g}.xlsx`:this.payment_status=="NS00"&&this.payment_mode=="APBS"?`payement_faild_dbt_block_ulb_drilldown_reports_${C}_${g}.xlsx`:this.payment_status=="S00"&&this.payment_mode=="WALLET"?`payement_sucess_cbdc_block_ulb_drilldown_reports_${C}_${g}.xlsx`:this.payment_status=="NS00"&&this.payment_mode=="WALLET"?`payement_faild_cbdc_block_ulb_drilldown_reports_${C}_${g}.xlsx`:"",v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){Ti.default.vfs=Xa.default.pdfMake.vfs,this.isExportInProgress=!0;let r=((this.blockStats[0]||{}).district_name||"N/A").toUpperCase(),c=[[{text:"SI#",fontSize:10},{text:"BLOCK/ULB",fontSize:10},{text:this.payment_status=="S00"?"PAYMENT SUCCESS":this.payment_status=="NS00"?"PAYMENT FAILED":"",fontSize:10}]];this.blockStats.forEach((u,I)=>{c.push([{text:(I+1).toString().toUpperCase(),fontSize:9},{text:(u?.block_name||u?.ulb_name||"").toUpperCase(),fontSize:9},{text:this.payment_status=="S00"?u?.payment_success:this.payment_status=="NS00"?u?.payment_fail:"",fontSize:9}])});let f=new Date,d=`Timestamp: ${f.toLocaleDateString()}, ${f.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,C=this.payment_status=="S00"&&this.payment_mode=="APBS"?"PAYMENT SUCCESS THROUGH DBT REPORT BLOCK-ULB WISE":this.payment_status=="NS00"&&this.payment_mode=="APBS"?"PAYMENT FAILD THROUGH DBT REPORT BLOCK-ULB WISE":this.payment_status=="S00"&&this.payment_mode=="WALLET"?"PAYMENT SUCCESS THROUGH CBDC REPORT BLOCK-ULB WISE":this.payment_status=="NS00"&&this.payment_mode=="WALLET"?"PAYMENT FAILD THROUGH CBDC REPORT BLOCK-ULB WISE":"",g={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r}`,style:"breadcrumb",margin:[0,0,0,10]},{text:C,style:"header"},{table:{headerRows:1,body:c,widths:["10%","18%","18%"]},layout:{fillColor:function(u){return u===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:d,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},_=new Date,v=_.toLocaleDateString("en-GB").split("/").reverse().join("-"),S=_.toLocaleTimeString("en-GB").replace(/:/g,"-"),w=this.payment_status=="S00"&&this.payment_mode=="APBS"?`payement_success_dbt_block_ulb_drilldown_reports_${v}_${S}.pdf`:this.payment_status=="NS00"&&this.payment_mode=="APBS"?`payement_faild_dbt_block_ulb_drilldown_reports_${v}_${S}.pdf`:this.payment_status=="S00"&&this.payment_mode=="WALLET"?`payement_sucess_cbdc_block_ulb_drilldown_reports_${v}_${S}.pdf`:this.payment_status=="NS00"&&this.payment_mode=="WALLET"?`payement_faild_cbdc_block_ulb_drilldown_reports_${v}_${S}.pdf`:"";Ti.default.createPdf(g).download(w,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-ps-block-ulb-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],["style","color: #fd7b03;",4,"ngIf"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],[2,"color","#fd7b03"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],[4,"ngIf"],[2,"font-size","14px"],["style","text-decoration: none",3,"routerLink","queryParams"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,oE,2,0)(11,vE,20,6),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ft,ot,K,q,J,it]});let i=s;return i})();var Li=j(ut()),Ka=j(ht());function EE(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function wE(i,s){if(i&1&&(t(0,"h4",26),a(1),e()),i&2){let o=h(2);l(1),dt(" ",o.payment_status=="S00"&&o.payment_mode=="APBS"?"Drill-Down Report - DBT Success":o.payment_status=="NS00"&&o.payment_mode=="APBS"?"Drill-Down Report - DBT Failed":o.payment_status=="S00"&&o.payment_mode=="WALLET"?"Drill-Down Report - CBDC Success":o.payment_status=="NS00"&&o.payment_mode=="WALLET"?"Drill-Down Report - CBDC Failed":""," ")}}function TE(i,s){if(i&1){let o=U();t(0,"button",27),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",28),a(2,"Download PDF "),e()}}function LE(i,s){i&1&&(t(0,"button",29),m(1,"i",30),a(2,"Downloading "),e())}function IE(i,s){if(i&1){let o=U();t(0,"button",27),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",28),a(2,"Download EXCEL "),e()}}function yE(i,s){i&1&&(t(0,"button",29),m(1,"i",30),a(2,"Downloading "),e())}var kE=(i,s)=>s==null?null:s.id;function PE(i,s){i&1&&(t(0,"th"),a(1,"PAYMENT SUCCESS"),e())}function DE(i,s){i&1&&(t(0,"th"),a(1,"PAYMENT FAILED"),e())}function AE(i,s){if(i&1&&(t(0,"td"),a(1),e()),i&2){let o=h().$implicit;l(1),p(o==null?null:o.payment_success)}}function UE(i,s){if(i&1&&(t(0,"td"),a(1),e()),i&2){let o=h().$implicit;l(1),p(o==null?null:o.payment_fail)}}var NE=(i,s,o)=>["/department/portal/payment/village-stats",i,s,o],RE=(i,s,o)=>({payment_status:i,payment_mode:s,installment:o});function OE(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",36),a(5),k(6,"uppercase"),e()(),b(7,AE,2,1,"td",34)(8,UE,2,1,"td",34),e()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),T("routerLink",Ft(8,NE,o==null?null:o.district_id,o==null?null:o.block_id,o==null?null:o.gp_id))("queryParams",Ft(12,RE,r.payment_status,r.payment_mode,r.installment)),l(1),dt(" ",P(6,6,o==null?null:o.gp_name)," "),l(2),T("ngIf",r.payment_status=="S00"),l(1),T("ngIf",r.payment_status=="NS00")}}function BE(i,s){if(i&1&&(t(0,"table",31)(1,"thead",32)(2,"tr")(3,"th",33),a(4,"Sl.#"),e(),t(5,"th",33),a(6,"GRAM PANCHAYAT"),e()(),t(7,"tr"),b(8,PE,2,0,"th",34)(9,DE,2,0,"th",34),e()(),t(10,"tbody",35),F(11,OE,9,16,"tr",null,kE),e()()),i&2){let o=h(2);l(8),T("ngIf",o.payment_status=="S00"),l(1),T("ngIf",o.payment_status=="NS00"),l(2),V(o.filteredGpStats)}}function WE(i,s){i&1&&a(0," No Data Found ")}function ME(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11),b(2,wE,2,1,"h4",12),t(3,"nav",13)(4,"ol",14)(5,"li",15),a(6),e(),t(7,"li",16),a(8),e()()()(),t(9,"div",17)(10,"div",18)(11,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(12,"i",20),e(),t(13,"div",21),b(14,TE,3,0,"button",22)(15,LE,3,0),e(),t(16,"div",23),b(17,IE,3,0,"button",22)(18,yE,3,0),e()()(),t(19,"div",24),b(20,BE,13,2,"table",25)(21,WE,1,0),e()}if(i&2){let o=h();l(2),T("ngIf",o.payment_status&&o.payment_mode),l(4),p(o.filteredGpStats[0].district_name),l(2),p(o.filteredGpStats[0].block_name),l(3),T("ngModel",o.searchTerm),l(3),E(14,o.isExportInProgress?15:14),l(3),E(17,o.isExportInProgressExcel?18:17),l(3),E(20,o.filteredGpStats&&o.filteredGpStats.length>0?20:21)}}var qa=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.district_id="",this.gpStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.id}),this.route.queryParams.subscribe(n=>{this.payment_status=n.payment_status,this.payment_mode=n.payment_mode,this.installment=n.installment,this.fetchgpStats(this.block_id)})}fetchgpStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/gp-count?block_id=${n}&payment_status=${this.payment_status}&payment_mode=${this.payment_mode}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.gpStats=r.data},r=>{this.isStatsLoading=!1,this.gpStats=[]})}get filteredGpStats(){return this.searchTerm?this.gpStats.filter(n=>n?.gp_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.gpStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.gpStats.map((u,I)=>{let R={"SI#":I+1,DISTRICT:u?.district_name.toUpperCase(),BLOCK:u.block_name?u.block_name.toUpperCase():"",GP:u.gp_name?u.gp_name.toUpperCase():""};return this.payment_status=="S00"?Wt(Bt({},R),{"PAYMENT SUCCESS":u?.payment_success}):this.payment_status=="NS00"?Wt(Bt({},R),{"PAYMENT FAILED":u?.payment_fail}):R}),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=this.payment_status=="S00"&&this.payment_mode=="APBS"?`payement_success_dbt_gp_drilldown_reports_${C}_${g}.xlsx`:this.payment_status=="NS00"&&this.payment_mode=="APBS"?`payement_faild_dbt_gp_drilldown_reports_${C}_${g}.xlsx`:this.payment_status=="S00"&&this.payment_mode=="WALLET"?`payement_sucess_cbdc_gp_drilldown_reports_${C}_${g}.xlsx`:this.payment_status=="NS00"&&this.payment_mode=="WALLET"?`payement_faild_cbdc_gp_drilldown_reports_${C}_${g}.xlsx`:"",v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){Li.default.vfs=Ka.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.gpStats[0]||{},r=(n?.district_name||"N/A").toUpperCase(),c=(n?.block_name||n?.ulb_name||"N/A").toUpperCase(),f=[[{text:"SI#",fontSize:10},{text:"GP",fontSize:10},{text:this.payment_status=="S00"?"PAYMENT SUCCESS":this.payment_status=="NS00"?"PAYMENT FAILED":"",fontSize:10}]];this.gpStats.forEach((I,R)=>{f.push([{text:(R+1).toString().toUpperCase(),fontSize:9},{text:(I?.gp_name||"").toUpperCase(),fontSize:9},{text:this.payment_status=="S00"?I?.payment_success:this.payment_status=="NS00"?I?.payment_fail:"",fontSize:9}])});let d=new Date,C=`Timestamp: ${d.toLocaleDateString()}, ${d.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,g=this.payment_status=="S00"&&this.payment_mode=="APBS"?"PAYMENT SUCCESS THROUGH DBT REPORT GP WISE":this.payment_status=="NS00"&&this.payment_mode=="APBS"?"PAYMENT FAILD THROUGH DBT REPORT GP WISE":this.payment_status=="S00"&&this.payment_mode=="WALLET"?"PAYMENT SUCCESS THROUGH CBDC REPORT GP WISE":this.payment_status=="NS00"&&this.payment_mode=="WALLET"?"PAYMENT FAILD THROUGH CBDC REPORT GP WISE":"",_={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK: ${c}`,style:"breadcrumb",margin:[0,0,0,10]},{text:g,style:"header"},{table:{headerRows:1,body:f,widths:["10%","18%","18%"]},layout:{fillColor:function(I){return I===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:C,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},v=new Date,S=v.toLocaleDateString("en-GB").split("/").reverse().join("-"),w=v.toLocaleTimeString("en-GB").replace(/:/g,"-"),u=this.payment_status=="S00"&&this.payment_mode=="APBS"?`payement_success_dbt_gp_drilldown_reports_${S}_${w}.pdf`:this.payment_status=="NS00"&&this.payment_mode=="APBS"?`payement_faild_dbt_gp_drilldown_reports_${S}_${w}.pdf`:this.payment_status=="S00"&&this.payment_mode=="WALLET"?`payement_sucess_cbdc_gp_drilldown_reports_${S}_${w}.pdf`:this.payment_status=="NS00"&&this.payment_mode=="WALLET"?`payement_faild_cbdc_gp_drilldown_reports_${S}_${w}.pdf`:"";Li.default.createPdf(_).download(u,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-ps-gp-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],["style","color: #fd7b03;",4,"ngIf"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],[2,"color","#fd7b03"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],[4,"ngIf"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,EE,2,0)(11,ME,22,7),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ft,ot,K,q,J,it]});let i=s;return i})();var Ii=j(ut()),Ja=j(ht());function FE(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function VE(i,s){if(i&1&&(t(0,"h4",26),a(1),e()),i&2){let o=h(2);l(1),dt(" ",o.payment_status=="S00"&&o.payment_mode=="APBS"?"Drill-Down Report - DBT Success":o.payment_status=="NS00"&&o.payment_mode=="APBS"?"Drill-Down Report - DBT Failed":o.payment_status=="S00"&&o.payment_mode=="WALLET"?"Drill-Down Report - CBDC Success":o.payment_status=="NS00"&&o.payment_mode=="WALLET"?"Drill-Down Report - CBDC Failed":""," ")}}function zE(i,s){if(i&1){let o=U();t(0,"button",27),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",28),a(2,"Download PDF "),e()}}function jE(i,s){i&1&&(t(0,"button",29),m(1,"i",30),a(2,"Downloading "),e())}function $E(i,s){if(i&1){let o=U();t(0,"button",27),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",28),a(2,"Download EXCEL "),e()}}function GE(i,s){i&1&&(t(0,"button",29),m(1,"i",30),a(2,"Downloading "),e())}var XE=(i,s)=>s==null?null:s.id;function YE(i,s){i&1&&(t(0,"th"),a(1,"PAYMENT SUCCESS"),e())}function HE(i,s){i&1&&(t(0,"th"),a(1,"PAYMENT FAILED"),e())}function KE(i,s){if(i&1&&(t(0,"td"),a(1),e()),i&2){let o=h().$implicit;l(1),p(o==null?null:o.payment_success)}}function qE(i,s){if(i&1&&(t(0,"td"),a(1),e()),i&2){let o=h().$implicit;l(1),p(o==null?null:o.payment_fail)}}var JE=(i,s,o)=>["/department/portal/payment/ward-user-list",i,s,o],QE=(i,s,o)=>({payment_status:i,payment_mode:s,installment:o});function ZE(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",36),a(5),e()(),b(6,KE,2,1,"td",34)(7,qE,2,1,"td",34),e()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),T("routerLink",Ft(6,JE,o==null?null:o.district_id,o==null?null:o.ulb_id,o==null?null:o.ward_id))("queryParams",Ft(10,QE,r.payment_status,r.payment_mode,r.installment)),l(1),dt(" ",o==null?null:o.ward_no," "),l(1),T("ngIf",r.payment_status=="S00"),l(1),T("ngIf",r.payment_status=="NS00")}}function tw(i,s){if(i&1&&(t(0,"table",31)(1,"thead",32)(2,"tr")(3,"th",33),a(4,"Sl.#"),e(),t(5,"th",33),a(6,"WARD"),e()(),t(7,"tr"),b(8,YE,2,0,"th",34)(9,HE,2,0,"th",34),e()(),t(10,"tbody",35),F(11,ZE,8,14,"tr",null,XE),e()()),i&2){let o=h(2);l(8),T("ngIf",o.payment_status=="S00"),l(1),T("ngIf",o.payment_status=="NS00"),l(2),V(o.filteredWardStats)}}function ew(i,s){i&1&&a(0," No Data Found ")}function iw(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11),b(2,VE,2,1,"h4",12),t(3,"nav",13)(4,"ol",14)(5,"li",15),a(6),e(),t(7,"li",16),a(8),e()()()(),t(9,"div",17)(10,"div",18)(11,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(12,"i",20),e(),t(13,"div",21),b(14,zE,3,0,"button",22)(15,jE,3,0),e(),t(16,"div",23),b(17,$E,3,0,"button",22)(18,GE,3,0),e()()(),t(19,"div",24),b(20,tw,13,2,"table",25)(21,ew,1,0),e()}if(i&2){let o=h();l(2),T("ngIf",o.payment_status&&o.payment_mode),l(4),p(o.filteredWardStats[0].district_name),l(2),p(o.filteredWardStats[0].ulb_name),l(3),T("ngModel",o.searchTerm),l(3),E(14,o.isExportInProgress?15:14),l(3),E(17,o.isExportInProgressExcel?18:17),l(3),E(20,o.filteredWardStats&&o.filteredWardStats.length>0?20:21)}}var Qa=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.district_id="",this.wardStats=[],this.ulb_id="",this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.params.subscribe(n=>{this.district_id=n.district_id,this.ulb_id=n.id}),this.route.queryParams.subscribe(n=>{this.payment_status=n.payment_status,this.payment_mode=n.payment_mode,this.installment=n.installment,this.fetchWardStats(this.ulb_id)})}fetchWardStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/ward-count?ulb_id=${n}&payment_status=${this.payment_status}&payment_mode=${this.payment_mode}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.wardStats=r.data},r=>{this.isStatsLoading=!1,this.wardStats=[]})}get filteredWardStats(){return this.searchTerm?this.wardStats.filter(n=>n.ward_no.toLowerCase().includes(this.searchTerm.toLowerCase())):this.wardStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.wardStats.map((u,I)=>{let R={"SI#":I+1,DISTRICT:u?.district_name.toUpperCase(),ULB:u.ulb_name?u.ulb_name.toUpperCase():"","WARD NO.":u.ward_no?u.ward_no.toUpperCase():""};return this.payment_status=="S00"?Wt(Bt({},R),{"PAYMENT SUCCESS":u?.payment_success}):this.payment_status=="NS00"?Wt(Bt({},R),{"PAYMENT FAILED":u?.payment_fail}):R}),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=this.payment_status=="S00"&&this.payment_mode=="APBS"?`payement_success_dbt_ward_drilldown_reports_${C}_${g}.xlsx`:this.payment_status=="NS00"&&this.payment_mode=="APBS"?`payement_faild_dbt_ward_drilldown_reports_${C}_${g}.xlsx`:this.payment_status=="S00"&&this.payment_mode=="WALLET"?`payement_sucess_cbdc_ward_drilldown_reports_${C}_${g}.xlsx`:this.payment_status=="NS00"&&this.payment_mode=="WALLET"?`payement_faild_cbdc_ward_drilldown_reports_${C}_${g}.xlsx`:"",v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){Ii.default.vfs=Ja.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.wardStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=[[{text:"SI#",fontSize:10},{text:"WARD NO.",fontSize:10},{text:this.payment_status=="S00"?"PAYMENT SUCCESS":this.payment_status=="NS00"?"PAYMENT FAILED":"",fontSize:10}]];this.wardStats.forEach((I,R)=>{f.push([{text:(R+1).toString().toUpperCase(),fontSize:9},{text:(I.ward_no||"").toUpperCase(),fontSize:9},{text:this.payment_status=="S00"?I?.payment_success:this.payment_status=="NS00"?I?.payment_fail:"",fontSize:9}])});let d=new Date,C=`Timestamp: ${d.toLocaleDateString()}, ${d.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,g=this.payment_status=="S00"&&this.payment_mode=="APBS"?"PAYMENT SUCCESS THROUGH DBT REPORT WARD WISE":this.payment_status=="NS00"&&this.payment_mode=="APBS"?"PAYMENT FAILD THROUGH DBT REPORT WARD WISE":this.payment_status=="S00"&&this.payment_mode=="WALLET"?"PAYMENT SUCCESS THROUGH CBDC REPORT WARD WISE":this.payment_status=="NS00"&&this.payment_mode=="WALLET"?"PAYMENT FAILD THROUGH CBDC REPORT WARD WISE":"",_={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK/ULB: ${c}`,style:"breadcrumb",margin:[0,0,0,10]},{text:g,style:"header"},{table:{headerRows:1,body:f,widths:["10%","18%","18%"]},layout:{fillColor:function(I){return I===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:C,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},v=new Date,S=v.toLocaleDateString("en-GB").split("/").reverse().join("-"),w=v.toLocaleTimeString("en-GB").replace(/:/g,"-"),u=this.payment_status=="S00"&&this.payment_mode=="APBS"?`payement_success_dbt_ward_drilldown_reports_${S}_${w}.pdf`:this.payment_status=="NS00"&&this.payment_mode=="APBS"?`payement_faild_dbt_ward_drilldown_reports_${S}_${w}.pdf`:this.payment_status=="S00"&&this.payment_mode=="WALLET"?`payement_sucess_cbdc_ward_drilldown_reports_${S}_${w}.pdf`:this.payment_status=="NS00"&&this.payment_mode=="WALLET"?`payement_faild_cbdc_ward_drilldown_reports_${S}_${w}.pdf`:"";Ii.default.createPdf(_).download(u,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-ps-ward-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],["style","color: #fd7b03;",4,"ngIf"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],[2,"color","#fd7b03"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],[4,"ngIf"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,FE,2,0)(11,iw,22,7),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ft,ot,K,q,J]});let i=s;return i})();var yi=j(ut()),Za=j(ht());function nw(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function ow(i,s){if(i&1&&(t(0,"h4",26),a(1),e()),i&2){let o=h(2);l(1),dt(" ",o.payment_status=="S00"&&o.payment_mode=="APBS"?"Drill-Down Report - DBT Success":o.payment_status=="NS00"&&o.payment_mode=="APBS"?"Drill-Down Report - DBT Failed":o.payment_status=="S00"&&o.payment_mode=="WALLET"?"Drill-Down Report - CBDC Success":o.payment_status=="NS00"&&o.payment_mode=="WALLET"?"Drill-Down Report - CBDC Failed":""," ")}}function aw(i,s){if(i&1){let o=U();t(0,"button",27),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",28),a(2,"Download PDF "),e()}}function rw(i,s){i&1&&(t(0,"button",29),m(1,"i",30),a(2,"Downloading "),e())}function sw(i,s){if(i&1){let o=U();t(0,"button",27),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",28),a(2,"Download EXCEL "),e()}}function lw(i,s){i&1&&(t(0,"button",29),m(1,"i",30),a(2,"Downloading "),e())}var cw=(i,s)=>s.id;function dw(i,s){i&1&&(t(0,"th"),a(1,"PAYMENT SUCCESS"),e())}function pw(i,s){i&1&&(t(0,"th"),a(1,"PAYMENT FAILED"),e())}function mw(i,s){if(i&1&&(t(0,"td"),a(1),e()),i&2){let o=h().$implicit;l(1),p(o==null?null:o.payment_success)}}function _w(i,s){if(i&1&&(t(0,"td"),a(1),e()),i&2){let o=h().$implicit;l(1),p(o==null?null:o.payment_fail)}}var fw=(i,s,o,n)=>["/department/portal/payment/village-user-list",i,s,o,n],uw=(i,s,o)=>({payment_status:i,payment_mode:s,installment:o});function hw(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",36),a(5),k(6,"uppercase"),e()(),b(7,mw,2,1,"td",34)(8,_w,2,1,"td",34),e()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),T("routerLink",Yt(8,fw,o.district_id,o.block_id,o.gp_id,o.village_id))("queryParams",Ft(13,uw,r.payment_status,r.payment_mode,r.installment)),l(1),dt(" ",P(6,6,o.village_name)," "),l(2),T("ngIf",r.payment_status=="S00"),l(1),T("ngIf",r.payment_status=="NS00")}}function Sw(i,s){if(i&1&&(t(0,"table",31)(1,"thead",32)(2,"tr")(3,"th",33),a(4,"Sl.#"),e(),t(5,"th",33),a(6,"VILLAGE"),e()(),t(7,"tr"),b(8,dw,2,0,"th",34)(9,pw,2,0,"th",34),e()(),t(10,"tbody",35),F(11,hw,9,17,"tr",null,cw),e()()),i&2){let o=h(2);l(8),T("ngIf",o.payment_status=="S00"),l(1),T("ngIf",o.payment_status=="NS00"),l(2),V(o.filteredVillageStats)}}function xw(i,s){i&1&&a(0," No Data Found ")}function gw(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11),b(2,ow,2,1,"h4",12),t(3,"nav",13)(4,"ol",14)(5,"li",15),a(6),e(),t(7,"li",15),a(8),e(),t(9,"li",16),a(10),e()()()(),t(11,"div",17)(12,"div",18)(13,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(14,"i",20),e(),t(15,"div",21),b(16,aw,3,0,"button",22)(17,rw,3,0),e(),t(18,"div",23),b(19,sw,3,0,"button",22)(20,lw,3,0),e()()(),t(21,"div",24),b(22,Sw,13,2,"table",25)(23,xw,1,0),e()}if(i&2){let o=h();l(2),T("ngIf",o.payment_status&&o.payment_mode),l(4),p(o.filteredVillageStats[0].district_name),l(2),p(o.filteredVillageStats[0].block_name),l(2),p(o.filteredVillageStats[0].gp_name),l(3),T("ngModel",o.searchTerm),l(3),E(16,o.isExportInProgress?17:16),l(3),E(19,o.isExportInProgressExcel?20:19),l(3),E(22,o.filteredVillageStats&&o.filteredVillageStats.length>0?22:23)}}var tr=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.gp_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.block_id,this.gp_id=n.id}),this.route.queryParams.subscribe(n=>{this.payment_status=n.payment_status,this.payment_mode=n.payment_mode,this.installment=n.installment,this.fetchvillageStats(this.gp_id)})}fetchvillageStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/village-count?gp_id=${n}&payment_status=${this.payment_status}&payment_mode=${this.payment_mode}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.villageStats=r.data},r=>{this.isStatsLoading=!1,this.villageStats=[]})}get filteredVillageStats(){return this.searchTerm?this.villageStats.filter(n=>n?.village_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.villageStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.villageStats.map((u,I)=>{let R={"SI#":I+1,DISTRICT:u?.district_name.toUpperCase(),BLOCK:u.block_name?u.block_name.toUpperCase():"",GP:u.gp_name?u.gp_name.toUpperCase():"",VILLAGE:u.village_name?u.village_name.toUpperCase():""};return this.payment_status=="S00"?Wt(Bt({},R),{"PAYMENT SUCCESS":u?.payment_success}):this.payment_status=="NS00"?Wt(Bt({},R),{"PAYMENT FAILED":u?.payment_fail}):R}),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=this.payment_status=="S00"&&this.payment_mode=="APBS"?`payement_success_dbt_village_drilldown_reports_${C}_${g}.xlsx`:this.payment_status=="NS00"&&this.payment_mode=="APBS"?`payement_faild_dbt_village_drilldown_reports_${C}_${g}.xlsx`:this.payment_status=="S00"&&this.payment_mode=="WALLET"?`payement_sucess_cbdc_village_drilldown_reports_${C}_${g}.xlsx`:this.payment_status=="NS00"&&this.payment_mode=="WALLET"?`payement_faild_cbdc_village_drilldown_reports_${C}_${g}.xlsx`:"",v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){yi.default.vfs=Za.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.villageStats[0]||{},r=(n?.district_name||"N/A").toUpperCase(),c=(n?.block_name||n?.ulb_name||"N/A").toUpperCase(),f=(n?.gp_name||n?.ward_no||"N/A").toUpperCase(),d=[[{text:"SI#",fontSize:10},{text:"VILLAGE",fontSize:10},{text:this.payment_status=="S00"?"PAYMENT SUCCESS":this.payment_status=="NS00"?"PAYMENT FAILED":"",fontSize:10}]];this.villageStats.forEach((R,z)=>{d.push([{text:(z+1).toString().toUpperCase(),fontSize:9},{text:(R?.village_name||"").toUpperCase(),fontSize:9},{text:this.payment_status=="S00"?R?.payment_success:this.payment_status=="NS00"?R?.payment_fail:"",fontSize:9}])});let C=new Date,g=`Timestamp: ${C.toLocaleDateString()}, ${C.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,_=this.payment_status=="S00"&&this.payment_mode=="APBS"?"PAYMENT SUCCESS THROUGH DBT REPORT VILLAGE WISE":this.payment_status=="NS00"&&this.payment_mode=="APBS"?"PAYMENT FAILD THROUGH DBT REPORT VILLAGE WISE":this.payment_status=="S00"&&this.payment_mode=="WALLET"?"PAYMENT SUCCESS THROUGH CBDC REPORT VILLAGE WISE":this.payment_status=="NS00"&&this.payment_mode=="WALLET"?"PAYMENT FAILD THROUGH CBDC REPORT VILLAGE WISE":"",v={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK: ${c} > GP:${f}`,style:"breadcrumb",margin:[0,0,0,10]},{text:_,style:"header"},{table:{headerRows:1,body:d,widths:["10%","18%","18%"]},layout:{fillColor:function(R){return R===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:g,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},S=new Date,w=S.toLocaleDateString("en-GB").split("/").reverse().join("-"),u=S.toLocaleTimeString("en-GB").replace(/:/g,"-"),I=this.payment_status=="S00"&&this.payment_mode=="APBS"?`payement_success_dbt_village_drilldown_reports_${w}_${u}.pdf`:this.payment_status=="NS00"&&this.payment_mode=="APBS"?`payement_faild_dbt_village_drilldown_reports_${w}_${u}.pdf`:this.payment_status=="S00"&&this.payment_mode=="WALLET"?`payement_sucess_cbdc_village_drilldown_reports_${w}_${u}.pdf`:this.payment_status=="NS00"&&this.payment_mode=="WALLET"?`payement_faild_cbdc_village_drilldown_reports_${w}_${u}.pdf`:"";yi.default.createPdf(v).download(I,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-ps-village-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],["style","color: #fd7b03;",4,"ngIf"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],[2,"color","#fd7b03"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],[4,"ngIf"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,nw,2,0)(11,gw,24,8),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ft,ot,K,q,J,it]});let i=s;return i})();var ki=j(ut()),er=j(ht());function Cw(i,s){if(i&1&&(t(0,"h4",30),a(1),e()),i&2){let o=h();l(1),dt(" ",o.payment_status=="S00"&&o.payment_mode=="APBS"?"Detailed Report - DBT Success":o.payment_status=="NS00"&&o.payment_mode=="APBS"?"Detailed Report - DBT Failed":o.payment_status=="S00"&&o.payment_mode=="WALLET"?"Detailed Report - CBDC Success":o.payment_status=="NS00"&&o.payment_mode=="WALLET"?"Detailed Report - CBDC Failed":""," ")}}function bw(i,s){if(i&1&&(t(0,"div",31)(1,"div",32)(2,"nav",33)(3,"ol",34)(4,"li",35),a(5),e(),t(6,"li",35),a(7),e(),t(8,"li",35),a(9),e(),t(10,"li",36),a(11),e()()()()()),i&2){let o=h();l(5),dt(" ",o.filteredVillageUserStats[0].district_name," "),l(2),dt(" ",o.filteredVillageUserStats[0].block_name," "),l(2),dt(" ",o.filteredVillageUserStats[0].gp_name," "),l(2),dt(" ",o.filteredVillageUserStats[0].village_name," ")}}function vw(i,s){i&1&&(t(0,"button",37),m(1,"i",38),a(2,"Search "),e())}function Ew(i,s){i&1&&(t(0,"button",39),m(1,"i",40),a(2," Searching ... "),e())}function ww(i,s){i&1&&(m(0,"i",41),a(1," We are fetching the data, please wait. "))}function Tw(i,s){if(i&1){let o=U();t(0,"button",56),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",57),a(2,"Download to PDF "),e()}}function Lw(i,s){i&1&&(t(0,"button",58),m(1,"i",40),a(2,"Downloading "),e())}function Iw(i,s){if(i&1){let o=U();t(0,"button",56),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",57),a(2,"Download to EXCEL "),e()}}function yw(i,s){i&1&&(t(0,"button",58),m(1,"i",40),a(2,"Downloading "),e())}var kw=(i,s)=>s.id;function Pw(i,s){if(i&1&&(t(0,"td"),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit;l(1),p(P(2,1,o.village_name))}}function Dw(i,s){i&1&&m(0,"td")}function Aw(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),b(3,Pw,3,3,"td")(4,Dw,1,0),t(5,"td"),a(6),k(7,"uppercase"),e(),t(8,"td"),a(9),k(10,"uppercase"),e(),t(11,"td"),a(12),k(13,"uppercase"),e(),t(14,"td"),a(15),k(16,"uppercase"),e(),t(17,"td"),a(18),k(19,"uppercase"),e(),t(20,"td"),a(21),k(22,"uppercase"),e(),t(23,"td"),a(24),k(25,"uppercase"),e(),t(26,"td"),a(27),e(),t(28,"td"),a(29),e(),t(30,"td"),a(31),e(),t(32,"td"),a(33),k(34,"uppercase"),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(1),E(3,o.village_name?3:4),l(3),p(P(7,13,o.category)),l(3),p(P(10,15,o.application_number)),l(3),dt(" ",P(13,17,r.appService.dateFormat(o.application_date))," "),l(3),p(P(16,19,o.applicant_name)),l(3),p(P(19,21,o.spouse_or_father_name)),l(3),p(P(22,23,o.social_category)),l(3),p(P(25,25,o.pwd_status)),l(3),p(o.alt_mobile_number),l(2),p(r.getBankName(o==null?null:o.bank_name)),l(2),p(r.maskAccountNumber(o.account_number)),l(2),p(P(34,27,r.appService.dateFormat(o.payment_date)))}}function Uw(i,s){if(i&1&&(t(0,"table",59)(1,"thead",60)(2,"tr")(3,"th"),a(4,"SI#"),e(),t(5,"th"),a(6,"VILLAGE"),e(),t(7,"th"),a(8,"CATEGORY"),e(),t(9,"th"),a(10,"APPLICATION NO."),e(),t(11,"th"),a(12,"APPLICATION DATE"),e(),t(13,"th"),a(14,"APPLICANT NAME"),e(),t(15,"th"),a(16,"FATHER/HUSBAND NAME"),e(),t(17,"th"),a(18,"SOCIAL CATEGORY"),e(),t(19,"th"),a(20,"PWD"),e(),t(21,"th"),a(22,"MOBILE NO."),e(),t(23,"th"),a(24,"BANK NAME"),e(),t(25,"th"),a(26,"ACCOUNT NUMBER"),e(),t(27,"th"),a(28,"PAYMENT DATE"),e()()(),t(29,"tbody"),F(30,Aw,35,29,"tr",null,kw),e()()),i&2){let o=h(2);l(30),V(o.filteredVillageUserStats)}}function Nw(i,s){i&1&&(t(0,"h5",61),a(1,"No data available"),e())}function Rw(i,s){i&1&&(t(0,"div",62),a(1," Loading.. "),m(2,"i",63),e())}function Ow(i,s){i&1&&(t(0,"span"),m(1,"i",41),a(2," Loading..."),e())}function Bw(i,s){i&1&&(t(0,"span"),a(1,"Load More"),e())}function Ww(i,s){if(i&1){let o=U();t(0,"div",64)(1,"button",65),L("click",function(){D(o);let r=h(2);return A(r.loadMore())}),b(2,Ow,3,0,"span",66)(3,Bw,2,0,"span",66),e()()}if(i&2){let o=h(2);l(2),T("ngIf",o.isLoadMoreInProgress),l(1),T("ngIf",!o.isLoadMoreInProgress)}}function Mw(i,s){if(i&1){let o=U();t(0,"div",31)(1,"div",42)(2,"h5",43),a(3," Number of records found : "),t(4,"span",44),a(5),e()()(),t(6,"div",45)(7,"div",46)(8,"input",47),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(9,"i",48),e(),t(10,"div",49),b(11,Tw,3,0,"button",50)(12,Lw,3,0),e(),t(13,"div",51),b(14,Iw,3,0,"button",50)(15,yw,3,0),e()()(),t(16,"div",52),b(17,Uw,32,0,"table",53)(18,Nw,2,0)(19,Rw,3,0,"div",54),e(),b(20,Ww,4,2,"div",55)}if(i&2){let o=h();l(5),p(o.count),l(3),T("ngModel",o.searchTerm),l(3),E(11,o.isExportInProgress?12:11),l(3),E(14,o.isExportInProgressExcel?15:14),l(3),E(17,o.filteredVillageUserStats&&o.filteredVillageUserStats.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),l(2),E(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),l(1),T("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var ir=(()=>{let s=class s{constructor(n,r,c,f,d,C,g,_){this.route=n,this.router=r,this.formService=c,this.appService=f,this.httpClient=d,this.toastService=C,this.authService=g,this.masterDataService=_,this.isStatsLoading=!1,this.userStats=[],this.block_id="",this.gp_id="",this.village_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.limit=this.appService.loadmorelimit,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.count=0,this.bankList=[],this.searchForm=new kt({a_category:new nt(""),social_category:new nt(""),pwd_status:new nt(""),submit_date:new nt("")})}ngOnInit(){this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.block_id,this.gp_id=n.gp_id,this.village_id=n.id}),this.route.queryParams.subscribe(n=>{this.payment_status=n.payment_status,this.payment_mode=n.payment_mode,this.installment=n.installment,this.fetchuserStats(this.village_id)}),this.loadBankJSON()}maskAccountNumber(n){return n?n.slice(0,-4).replace(/./g,"X")+n.slice(-4):""}fetchuserStats(n,r=!1){this.isStatsLoading=!0;let c=new st;c=c.set("gp_id",this.gp_id),c=c.set("village_id",n),c=c.set("offset",this.offset),c=c.set("limit",this.limit),this.payment_status!==void 0&&(c=c.set("payment_status",this.payment_status.toString())),this.installment!==void 0&&(c=c.set("installment",this.installment.toString())),c=c.set("payment_mode",this.payment_mode);let f=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:c,headers:f}).subscribe(d=>{this.isStatsLoading=!1,this.count=d.count,d.data&&d.data.length>0?(d.data.forEach(C=>{C.account_number&&(C.account_number=this.maskAccountNumber(C.account_number))}),this.application_list=this.application_list.concat(d.data),this.offset+=d.data.length,this.hasMoreRecords=d.data.length===this.limit):this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)},d=>{this.isStatsLoading=!1,this.application_list=[],this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)})}get filteredVillageUserStats(){if(!this.searchTerm)return this.application_list;let n=this.searchTerm.toLowerCase();return this.application_list.filter(r=>r.village_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.category?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.application_number?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_date).toLowerCase().includes(this.searchTerm.toLowerCase())||r.applicant_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.spouse_or_father_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.dob).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.social_category).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.pwd_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.alt_mobile_number).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.payment_status).toLowerCase().includes(this.searchTerm.toLowerCase()))}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=new st;g=g.set("gp_id",this.gp_id),r&&(g=g.set("village_id",r)),c&&(g=g.set("category",c)),f&&(g=g.set("social_category",f)),d&&(g=g.set("pwd_status",d)),C&&(g=g.set("submission_date",C)),g=g.set("offset",this.offset),g=g.set("limit",this.limit),this.payment_status!==void 0&&(g=g.set("payment_status",this.payment_status.toString())),this.installment!==void 0&&(g=g.set("installment",this.installment.toString())),g=g.set("payment_mode",this.payment_mode);let _=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:g,headers:_}).subscribe(v=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=v.count,v.data&&v.data.length>0?(this.application_list=this.application_list.concat(v.data),this.offset+=v.data.length,this.hasMoreRecords=v.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},v=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}loadBankJSON(){let r=this.appService.baseUrl.replace("/api","");fetch(`${r}/cdn/assets/response_bank.json`).then(c=>c.json()).then(c=>{this.bankList=c}).catch(c=>{console.error("Error fetching JSON data:",c)})}getBankName(n){if(n==null)return"";let r=this.bankList.find(c=>c.id.toString()===n.toString());return r?r.bank_name:""}exportToExcel(){let n=new st,r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date;n=n.set("gp_id",this.gp_id),r&&(n=n.set("village_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),C&&(n=n.set("submission_date",C)),n=n.set("export_all","1"),this.payment_status!==void 0&&(n=n.set("payment_status",this.payment_status.toString())),this.installment!==void 0&&(n=n.set("installment",this.installment.toString())),n=n.set("payment_mode",this.payment_mode);let g=new rt({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:g,responseType:"json"}).subscribe(_=>{this.isExportInProgressExcel=!1;let v=_.data.map((et,y)=>({"SI#":y+1,DISTRICT:et.district_name?et.district_name.toUpperCase():"",BLOCK:et.block_name?et.block_name.toUpperCase():"",GP:et.gp_name?et.gp_name.toUpperCase():"",VILLAGE:et.village_name?et.village_name.toUpperCase():"",CATEGORY:et.category.toUpperCase(),"APPLICATION NO.":et.application_number.toUpperCase(),"APPLICATION DATE":this.appService.dateFormat(et.application_date),"APPLICANT NAME":et.applicant_name.toUpperCase(),"FATHER/HUSBAND NAME":et.spouse_or_father_name.toUpperCase(),"SOCIAL CATEGORY":et.social_category.toUpperCase(),PWD:et.pwd_status.toUpperCase(),"MOBILE NO.":et.alt_mobile_number,"BANK NAME":this.getBankName(et.bank_name),"ACCOUNT NUMBER":this.maskAccountNumber(et.account_number),"PAYMENT DATE":this.appService.dateFormat(et.payment_date)})),S=N.json_to_sheet(v),w=N.book_new();N.book_append_sheet(w,S,"Applications");let u=Z(w,{bookType:"xlsx",type:"array"}),I=new Date,R=I.toLocaleDateString("en-GB").split("/").reverse().join("-"),z=I.toLocaleTimeString("en-GB").replace(/:/g,"-"),at=this.payment_status=="S00"&&this.payment_mode=="APBS"?`Detailed_Report_DBT_Success_vill_${R}_${z}.xlsx`:this.payment_status=="NS00"&&this.payment_mode=="APBS"?`Detailed_Report_DBT_Failed_vill_${R}_${z}.xlsx`:this.payment_status=="S00"&&this.payment_mode=="WALLET"?`Detailed_Report_CBDC_Success_vill_${R}_${z}.xlsx`:this.payment_status=="NS00"&&this.payment_mode=="WALLET"?`Detailed_Report_BDC_Failed_vill_${R}_${z}.xlsx`:"",ct=new Blob([u],{type:"application/octet-stream"}),lt=document.createElement("a"),O=window.URL.createObjectURL(ct);lt.href=O,lt.download=at,lt.click(),window.URL.revokeObjectURL(O)},_=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",_)})}exportToPDF(){ki.default.vfs=er.default.pdfMake.vfs;let n=new st,r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date;n=n.set("gp_id",this.gp_id),r&&(n=n.set("village_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),C&&(n=n.set("submission_date",C)),n=n.set("export_all","1"),this.payment_status!==void 0&&(n=n.set("payment_status",this.payment_status.toString())),this.installment!==void 0&&(n=n.set("installment",this.installment.toString())),n=n.set("payment_mode",this.payment_mode);let g=new rt({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:g,responseType:"json"}).subscribe(_=>{this.isExportInProgress=!1;let v=_.data[0]||{},S=(v.district_name||"N/A").toUpperCase(),w=(v.block_name||v.ulb_name||"N/A").toUpperCase(),u=(v.gp_name||v.ward_no||"N/A").toUpperCase(),I=(v.village_name||"").toUpperCase(),R=[[{text:"SI#",fontSize:10},{text:"CATEGORY",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICATION DATE.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"SOCIAL CATEGORY",fontSize:10},{text:"PWD",fontSize:10},{text:"MOBILE NO",fontSize:10},{text:"BANK NAME",fontSize:10},{text:"ACCOUNT NUMBER",fontSize:10},{text:"PAYMENT DATE",fontSize:10}]];_.data.forEach((W,It)=>{R.push([{text:(It+1).toString().toUpperCase(),fontSize:9},{text:(W.category||"").toUpperCase(),fontSize:9},{text:(W.application_number||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(W.application_date)||"",fontSize:9},{text:(W.applicant_name||"").toUpperCase(),fontSize:9},{text:(W.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:(W.social_category||"").toUpperCase(),fontSize:9},{text:(W.pwd_status||"").toUpperCase(),fontSize:9},{text:(W.alt_mobile_number||"").toUpperCase(),fontSize:9},{text:this.getBankName(W.bank_name)||"",fontSize:9},{text:this.maskAccountNumber(W.account_number)||"",fontSize:9},{text:this.appService.dateFormat(W.payment_date)||"",fontSize:9}])});let z=new Date,at=`Timestamp: ${z.toLocaleDateString()}, ${z.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,ct=this.payment_status=="S00"&&this.payment_mode=="APBS"?"DETAILED REPORT - DBT SUCCESS":this.payment_status=="NS00"&&this.payment_mode=="APBS"?"DETAILED REPORT - DBT FAILED":this.payment_status=="S00"&&this.payment_mode=="WALLET"?"DETAILED REPORT - CBDC SUCCESS":this.payment_status=="NS00"&&this.payment_mode=="WALLET"?"DETAILED REPORT - CBDC FAILED":"",lt={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${S} > BLOCK: ${w} > GP: ${u} >VILLAGE: ${I}`,style:"breadcrumb",margin:[0,0,0,10]},{text:ct,style:"header"},{table:{headerRows:1,body:R,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]},layout:{fillColor:function(W){return W===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:at,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},O=new Date,et=O.toLocaleDateString("en-GB").split("/").reverse().join("-"),y=O.toLocaleTimeString("en-GB").replace(/:/g,"-"),B=this.payment_status=="S00"&&this.payment_mode=="APBS"?`Detailed_Report_DBT_Success_vill_${et}_${y}.pdf`:this.payment_status=="NS00"&&this.payment_mode=="APBS"?`Detailed_Report_DBT_Failed_vill_${et}_${y}.pdf`:this.payment_status=="S00"&&this.payment_mode=="WALLET"?`Detailed_Report_CBDC_Success_vill_${et}_${y}.pdf`:this.payment_status=="NS00"&&this.payment_mode=="WALLET"?`Detailed_Report_BDC_Failed_vill_${et}_${y}.pdf`:"";ki.default.createPdf(lt).download(B)},_=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",_)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(Ot),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-ps-village-user-list"]],decls:55,vars:5,consts:[[1,"container-fluid","drilldown-reports"],[1,"d-flex","justify-content-between","w-100","mb-3"],["style","color: #fd7b03",4,"ngIf"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],["class","row mb-2"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-2"],[1,"col-md-4"],["for","a_category",1,"fw-bold"],["formControlName","a_category","id","a_category",1,"form-select","my-2"],["value",""],["value","1"],["value","0"],["for","social_category",1,"fw-bold"],["formControlName","social_category","id","social_category",1,"form-select","my-2"],["value","2"],["value","3"],["value","4"],["for","pwd_status",1,"fw-bold"],["formControlName","pwd_status","id","pwd_status",1,"form-select","my-2"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[2,"color","#fd7b03"],[1,"row","mb-2"],[1,"col-md-7"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"fa","fa-spinner","fa-spin"],[1,"col-md-5"],[1,"card-title"],["id","recordCount"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style",`
                  background-color: #ffe8d0;
                  color: #fd7b03;
                  font-weight: 620;
                `,"type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports detail"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports","detail"],[1,"text-light",2,"background-color","#fd7b03"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"],[4,"ngIf"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),b(2,Cw,2,1,"h4",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back "),e()()()(),b(8,bw,12,4,"div",7),t(9,"div",8)(10,"form",9),L("ngSubmit",function(){return c.onSearch()}),t(11,"div",10)(12,"div",11)(13,"label",12),a(14," Category "),e(),t(15,"select",13)(16,"option",14),a(17,"Choose Category"),e(),t(18,"option",15),a(19,"NFSA"),e(),t(20,"option",16),a(21,"NON-NFSA"),e()()(),t(22,"div",11)(23,"label",17),a(24," Social Category "),e(),t(25,"select",18)(26,"option",14),a(27,"Choose Social Category"),e(),t(28,"option",15),a(29,"Un-Reserved"),e(),t(30,"option",19),a(31,"OBC"),e(),t(32,"option",20),a(33,"SC"),e(),t(34,"option",21),a(35,"ST"),e()()(),t(36,"div",11)(37,"label",22),a(38," PWD "),e(),t(39,"select",23)(40,"option",14),a(41,"Choose PWD Status"),e(),t(42,"option",15),a(43,"Yes"),e(),t(44,"option",16),a(45,"NO"),e()()()(),t(46,"div",24)(47,"div",25),b(48,vw,3,0,"button",26)(49,Ew,3,0),e()()()(),t(50,"div",27)(51,"div",28)(52,"div",29),b(53,ww,2,0)(54,Mw,21,7),e()()()()),r&2&&(l(2),T("ngIf",c.payment_status&&c.payment_mode),l(6),E(8,c.filteredVillageUserStats&&c.filteredVillageUserStats.length>0?8:-1),l(2),T("formGroup",c.searchForm),l(38),E(48,c.isFormSearchInProgress?49:48),l(5),E(53,c.isStatsLoading?53:54))},dependencies:[ft,Pt,Nt,Rt,K,Ut,q,yt,J,Dt,At,it]});let i=s;return i})();var Pi=j(ut()),nr=j(ht());function Fw(i,s){if(i&1&&(t(0,"h4",30),a(1),e()),i&2){let o=h();l(1),dt(" ",o.payment_status=="S00"&&o.payment_mode=="APBS"?"Detailed Report - DBT Success":o.payment_status=="NS00"&&o.payment_mode=="APBS"?"Detailed Report - DBT Failed":o.payment_status=="S00"&&o.payment_mode=="WALLET"?"Detailed Report - CBDC Success":o.payment_status=="NS00"&&o.payment_mode=="WALLET"?"Detailed Report - CBDC Failed":""," ")}}function Vw(i,s){if(i&1&&(t(0,"div",31)(1,"div",32)(2,"nav",33)(3,"ol",34)(4,"li",35),a(5),e(),t(6,"li",35),a(7),e(),t(8,"li",36),a(9),e()()()()()),i&2){let o=h();l(5),dt(" ",o.filteredWardUserStats[0].district_name," "),l(2),dt(" ",o.filteredWardUserStats[0].ulb_name," "),l(2),dt(" ",o.filteredWardUserStats[0].ward_no," ")}}function zw(i,s){i&1&&(t(0,"button",37),m(1,"i",38),a(2,"Search "),e())}function jw(i,s){i&1&&(t(0,"button",39),m(1,"i",40),a(2," Searching ... "),e())}function $w(i,s){i&1&&(m(0,"i",41),a(1," We are fetching the data, please wait. "))}function Gw(i,s){if(i&1){let o=U();t(0,"button",56),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",57),a(2,"Download to PDF "),e()}}function Xw(i,s){i&1&&(t(0,"button",58),m(1,"i",40),a(2,"Downloading "),e())}function Yw(i,s){if(i&1){let o=U();t(0,"button",56),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",57),a(2,"Download to EXCEL "),e()}}function Hw(i,s){i&1&&(t(0,"button",58),m(1,"i",40),a(2,"Downloading "),e())}var Kw=(i,s)=>s.id;function qw(i,s){if(i&1&&(t(0,"td"),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit;l(1),p(P(2,1,o.ward_no))}}function Jw(i,s){i&1&&m(0,"td")}function Qw(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),b(3,qw,3,3,"td")(4,Jw,1,0),t(5,"td"),a(6),k(7,"uppercase"),e(),t(8,"td"),a(9),k(10,"uppercase"),e(),t(11,"td"),a(12),k(13,"uppercase"),e(),t(14,"td"),a(15),k(16,"uppercase"),e(),t(17,"td"),a(18),k(19,"uppercase"),e(),t(20,"td"),a(21),k(22,"uppercase"),e(),t(23,"td"),a(24),k(25,"uppercase"),e(),t(26,"td"),a(27),e(),t(28,"td"),a(29),e(),t(30,"td"),a(31),e(),t(32,"td"),a(33),k(34,"uppercase"),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(1),E(3,o.ward_no?3:4),l(3),p(P(7,13,o.category)),l(3),p(P(10,15,o.application_number)),l(3),dt(" ",P(13,17,r.appService.dateFormat(o.application_date))," "),l(3),p(P(16,19,o.applicant_name)),l(3),p(P(19,21,o.spouse_or_father_name)),l(3),p(P(22,23,o.social_category)),l(3),p(P(25,25,o.pwd_status)),l(3),p(o.alt_mobile_number),l(2),p(r.getBankName(o==null?null:o.bank_name)),l(2),p(r.maskAccountNumber(o.account_number)),l(2),p(P(34,27,r.appService.dateFormat(o.payment_date)))}}function Zw(i,s){if(i&1&&(t(0,"table",59)(1,"thead",60)(2,"tr")(3,"th"),a(4,"SI#"),e(),t(5,"th"),a(6,"WARD NO."),e(),t(7,"th"),a(8,"CATEGORY"),e(),t(9,"th"),a(10,"APPLICATION NO."),e(),t(11,"th"),a(12,"APPLICATION DATE"),e(),t(13,"th"),a(14,"APPLICANT NAME"),e(),t(15,"th"),a(16,"FATHER/HUSBAND NAME"),e(),t(17,"th"),a(18,"SOCIAL CATEGORY"),e(),t(19,"th"),a(20,"PWD"),e(),t(21,"th"),a(22,"MOBILE NO."),e(),t(23,"th"),a(24,"BANK NAME"),e(),t(25,"th"),a(26,"ACCOUNT NUMBER"),e(),t(27,"th"),a(28,"PAYMENT DATE"),e()()(),t(29,"tbody"),F(30,Qw,35,29,"tr",null,Kw),e()()),i&2){let o=h(2);l(30),V(o.filteredWardUserStats)}}function tT(i,s){i&1&&(t(0,"h5",61),a(1,"No data available"),e())}function eT(i,s){i&1&&(t(0,"div",62),a(1," Loading.. "),m(2,"i",63),e())}function iT(i,s){i&1&&(t(0,"span"),m(1,"i",41),a(2," Loading..."),e())}function nT(i,s){i&1&&(t(0,"span"),a(1,"Load More"),e())}function oT(i,s){if(i&1){let o=U();t(0,"div",64)(1,"button",65),L("click",function(){D(o);let r=h(2);return A(r.loadMore())}),b(2,iT,3,0,"span",66)(3,nT,2,0,"span",66),e()()}if(i&2){let o=h(2);l(2),T("ngIf",o.isLoadMoreInProgress),l(1),T("ngIf",!o.isLoadMoreInProgress)}}function aT(i,s){if(i&1){let o=U();t(0,"div",31)(1,"div",42)(2,"h5",43),a(3," Number of records found : "),t(4,"span",44),a(5),e()()(),t(6,"div",45)(7,"div",46)(8,"input",47),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(9,"i",48),e(),t(10,"div",49),b(11,Gw,3,0,"button",50)(12,Xw,3,0),e(),t(13,"div",51),b(14,Yw,3,0,"button",50)(15,Hw,3,0),e()()(),t(16,"div",52),b(17,Zw,32,0,"table",53)(18,tT,2,0)(19,eT,3,0,"div",54),e(),b(20,oT,4,2,"div",55)}if(i&2){let o=h();l(5),p(o.count),l(3),T("ngModel",o.searchTerm),l(3),E(11,o.isExportInProgress?12:11),l(3),E(14,o.isExportInProgressExcel?15:14),l(3),E(17,o.filteredWardUserStats&&o.filteredWardUserStats.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),l(2),E(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),l(1),T("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var or=(()=>{let s=class s{constructor(n,r,c,f,d,C,g,_){this.route=n,this.router=r,this.formService=c,this.appService=f,this.httpClient=d,this.toastService=C,this.authService=g,this.masterDataService=_,this.isStatsLoading=!1,this.userStats=[],this.ulb_id="",this.ward_id="",this.village_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.limit=this.appService.loadmorelimit,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.count=0,this.bankList=[],this.maskedAccountNumber=[],this.searchForm=new kt({a_category:new nt(""),social_category:new nt(""),pwd_status:new nt(""),submit_date:new nt("")})}ngOnInit(){this.route.params.subscribe(n=>{this.district_id=n.district_id,this.ulb_id=n.ulb_id,this.ward_id=n.id}),this.route.queryParams.subscribe(n=>{this.payment_status=n.payment_status,this.payment_mode=n.payment_mode,this.installment=n.installment,this.fetchuserStats(this.ward_id)})}maskAccountNumber(n){return n?n.slice(0,-4).replace(/./g,"X")+n.slice(-4):""}fetchuserStats(n,r=!1){this.isStatsLoading=!0;let c=new st;c=c.set("ward_id",n),c=c.set("offset",this.offset),c=c.set("limit",this.limit),this.payment_status!==void 0&&(c=c.set("payment_status",this.payment_status.toString())),this.installment!==void 0&&(c=c.set("installment",this.installment.toString())),c=c.set("payment_mode",this.payment_mode);let f=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:c,headers:f}).subscribe(d=>{this.isStatsLoading=!1,this.count=d.count,d.data&&d.data.length>0?(d.data.forEach(C=>{C.account_number&&(C.account_number=this.maskAccountNumber(C.account_number))}),this.application_list=this.application_list.concat(d.data),this.offset+=d.data.length,this.hasMoreRecords=d.data.length===this.limit):this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)},d=>{this.isStatsLoading=!1,this.application_list=[],this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)})}get filteredWardUserStats(){if(!this.searchTerm)return this.application_list;let n=this.searchTerm.toLowerCase();return this.application_list.filter(r=>r.ward_no?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.category?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.application_number?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_date).toLowerCase().includes(this.searchTerm.toLowerCase())||r.applicant_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.spouse_or_father_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.dob).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.social_category).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.pwd_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.alt_mobile_number).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.payment_status).toLowerCase().includes(this.searchTerm.toLowerCase()))}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=new st;r&&(C=C.set("ward_id",r)),c&&(C=C.set("category",c)),f&&(C=C.set("social_category",f)),d&&(C=C.set("pwd_status",d)),C=C.set("offset",this.offset),C=C.set("limit",this.limit),this.payment_status!==void 0&&(C=C.set("payment_status",this.payment_status.toString())),this.installment!==void 0&&(C=C.set("installment",this.installment.toString())),C=C.set("payment_mode",this.payment_mode);let g=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:C,headers:g}).subscribe(_=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=_.count,_.data&&_.data.length>0?(this.application_list=this.application_list.concat(_.data),this.offset+=_.data.length,this.hasMoreRecords=_.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},_=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}loadBankJSON(){let r=this.appService.baseUrl.replace("/api","");fetch(`${r}/cdn/assets/response_bank.json`).then(c=>c.json()).then(c=>{this.bankList=c}).catch(c=>{console.error("Error fetching JSON data:",c)})}getBankName(n){if(n==null)return"";let r=this.bankList.find(c=>c.id.toString()===n.toString());return r?r.bank_name:""}exportToExcel(){let n=new st,r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status;r&&(n=n.set("ward_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),n=n.set("export_all","1"),this.payment_status!==void 0&&(n=n.set("payment_status",this.payment_status.toString())),this.installment!==void 0&&(n=n.set("installment",this.installment.toString())),n=n.set("payment_mode",this.payment_mode);let C=new rt({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:C,responseType:"json"}).subscribe(g=>{this.isExportInProgressExcel=!1;let _=g.data.map((O,et)=>({"SI#":et+1,DISTRICT:O.district_name?O.district_name.toUpperCase():"",ULB:O.ulb_name?O.ulb_name.toUpperCase():"","WARD NO.":O.ward_no?O.ward_no.toUpperCase():"",CATEGORY:O.category.toUpperCase(),"APPLICATION NO.":O.application_number.toUpperCase(),"APPLICATION DATE":this.appService.dateFormat(O.application_date),"APPLICANT NAME":O.applicant_name.toUpperCase(),"FATHER/HUSBAND NAME":O.spouse_or_father_name.toUpperCase(),"SOCIAL CATEGORY":O.social_category.toUpperCase(),PWD:O.pwd_status.toUpperCase(),"MOBILE NO.":O.alt_mobile_number,"BANK NAME":this.getBankName(O.bank_name),"ACCOUNT NUMBER":this.maskAccountNumber(O.account_number),"PAYMENT DATE":this.appService.dateFormat(O.payment_date)})),v=N.json_to_sheet(_),S=N.book_new();N.book_append_sheet(S,v,"Applications");let w=Z(S,{bookType:"xlsx",type:"array"}),u=new Date,I=u.toLocaleDateString("en-GB").split("/").reverse().join("-"),R=u.toLocaleTimeString("en-GB").replace(/:/g,"-"),z=this.payment_status=="S00"&&this.payment_mode=="APBS"?`Detailed_Report_DBT_Success_ward_${I}_${R}.xlsx`:this.payment_status=="NS00"&&this.payment_mode=="APBS"?`Detailed_Report_DBT_Failed_ward_${I}_${R}.xlsx`:this.payment_status=="S00"&&this.payment_mode=="WALLET"?`Detailed_Report_CBDC_Success_ward_${I}_${R}.xlsx`:this.payment_status=="NS00"&&this.payment_mode=="WALLET"?`Detailed_Report_BDC_Failed_ward_${I}_${R}.xlsx`:"",at=new Blob([w],{type:"application/octet-stream"}),ct=document.createElement("a"),lt=window.URL.createObjectURL(at);ct.href=lt,ct.download=z,ct.click(),window.URL.revokeObjectURL(lt)},g=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",g)})}exportToPDF(){Pi.default.vfs=nr.default.pdfMake.vfs;let n=new st,r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status;r&&(n=n.set("ward_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),n=n.set("export_all","1"),this.payment_status!==void 0&&(n=n.set("payment_status",this.payment_status.toString())),this.installment!==void 0&&(n=n.set("installment",this.installment.toString())),n=n.set("payment_mode",this.payment_mode);let C=new rt({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:C,responseType:"json"}).subscribe(g=>{this.isExportInProgress=!1;let _=g.data[0]||{},v=(_.district_name||"N/A").toUpperCase(),S=(_.block_name||_.ulb_name||"N/A").toUpperCase(),w=(_.gp_name||_.ward_no||"N/A").toUpperCase(),u=[[{text:"SI#",fontSize:10},{text:"CATEGORY",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICATION DATE.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"SOCIAL CATEGORY",fontSize:10},{text:"PWD",fontSize:10},{text:"MOBILE NO",fontSize:10},{text:"BANK NAME",fontSize:10},{text:"ACCOUNT NUMBER",fontSize:10},{text:"PAYMENT DATE",fontSize:10}]];g.data.forEach((y,B)=>{u.push([{text:(B+1).toString().toUpperCase(),fontSize:9},{text:(y.category||"").toUpperCase(),fontSize:9},{text:(y.application_number||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(y.application_date)||"",fontSize:9},{text:(y.applicant_name||"").toUpperCase(),fontSize:9},{text:(y.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:(y.social_category||"").toUpperCase(),fontSize:9},{text:(y.pwd_status||"").toUpperCase(),fontSize:9},{text:(y.alt_mobile_number||"").toUpperCase(),fontSize:9},{text:this.getBankName(y.bank_name)||"",fontSize:9},{text:this.maskAccountNumber(y.account_number)||"",fontSize:9},{text:this.appService.dateFormat(y.payment_date)||"",fontSize:9}])});let I=new Date,R=`Timestamp: ${I.toLocaleDateString()}, ${I.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,z=this.payment_status=="S00"&&this.payment_mode=="APBS"?"DETAILED REPORT - DBT SUCCESS":this.payment_status=="NS00"&&this.payment_mode=="APBS"?"DETAILED REPORT - DBT FAILED":this.payment_status=="S00"&&this.payment_mode=="WALLET"?"DETAILED REPORT - CBDC SUCCESS":this.payment_status=="NS00"&&this.payment_mode=="WALLET"?"DETAILED REPORT - CBDC FAILED":"",at={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${v} > ULB: ${S} > WARD: ${w}`,style:"breadcrumb",margin:[0,0,0,10]},{text:z,style:"header"},{table:{headerRows:1,body:u,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]},layout:{fillColor:function(y){return y===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:R,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},ct=new Date,lt=ct.toLocaleDateString("en-GB").split("/").reverse().join("-"),O=ct.toLocaleTimeString("en-GB").replace(/:/g,"-"),et=this.payment_status=="S00"&&this.payment_mode=="APBS"?`Detailed_Report_DBT_Success_ward_${lt}_${O}.pdf`:this.payment_status=="NS00"&&this.payment_mode=="APBS"?`Detailed_Report_DBT_Failed_ward_${lt}_${O}.pdf`:this.payment_status=="S00"&&this.payment_mode=="WALLET"?`Detailed_Report_CBDC_Success_ward_${lt}_${O}.pdf`:this.payment_status=="NS00"&&this.payment_mode=="WALLET"?`Detailed_Report_BDC_Failed_ward_${lt}_${O}.pdf`:"";Pi.default.createPdf(at).download(et)},g=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",g)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(Ot),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-ps-ward-user-list"]],decls:55,vars:5,consts:[[1,"container-fluid","drilldown-reports"],[1,"d-flex","justify-content-between","w-100","mb-3"],["style","color: #fd7b03",4,"ngIf"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],["class","row mb-2"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-2"],[1,"col-md-4"],["for","a_category",1,"fw-bold"],["formControlName","a_category","id","a_category",1,"form-select","my-2"],["value",""],["value","1"],["value","0"],["for","social_category",1,"fw-bold"],["formControlName","social_category","id","social_category",1,"form-select","my-2"],["value","2"],["value","3"],["value","4"],["for","pwd_status",1,"fw-bold"],["formControlName","pwd_status","id","pwd_status",1,"form-select","my-2"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[2,"color","#fd7b03"],[1,"row","mb-2"],[1,"col-md-7"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"fa","fa-spinner","fa-spin"],[1,"col-md-5"],[1,"card-title"],["id","recordCount"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style",`
                  background-color: #ffe8d0;
                  color: #fd7b03;
                  font-weight: 620;
                `,"type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports detail"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports","detail"],[1,"text-light",2,"background-color","#fd7b03"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"],[4,"ngIf"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),b(2,Fw,2,1,"h4",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back "),e()()()(),b(8,Vw,10,3,"div",7),t(9,"div",8)(10,"form",9),L("ngSubmit",function(){return c.onSearch()}),t(11,"div",10)(12,"div",11)(13,"label",12),a(14," Category "),e(),t(15,"select",13)(16,"option",14),a(17,"Choose Category"),e(),t(18,"option",15),a(19,"NFSA"),e(),t(20,"option",16),a(21,"NON-NFSA"),e()()(),t(22,"div",11)(23,"label",17),a(24," Social Category "),e(),t(25,"select",18)(26,"option",14),a(27,"Choose Social Category"),e(),t(28,"option",15),a(29,"Un-Reserved"),e(),t(30,"option",19),a(31,"OBC"),e(),t(32,"option",20),a(33,"SC"),e(),t(34,"option",21),a(35,"ST"),e()()(),t(36,"div",11)(37,"label",22),a(38," PWD "),e(),t(39,"select",23)(40,"option",14),a(41,"Choose PWD Status"),e(),t(42,"option",15),a(43,"Yes"),e(),t(44,"option",16),a(45,"NO"),e()()()(),t(46,"div",24)(47,"div",25),b(48,zw,3,0,"button",26)(49,jw,3,0),e()()()(),t(50,"div",27)(51,"div",28)(52,"div",29),b(53,$w,2,0)(54,aT,21,7),e()()()()),r&2&&(l(2),T("ngIf",c.payment_status&&c.payment_mode),l(6),E(8,c.filteredWardUserStats&&c.filteredWardUserStats.length>0?8:-1),l(2),T("formGroup",c.searchForm),l(38),E(48,c.isFormSearchInProgress?49:48),l(5),E(53,c.isStatsLoading?53:54))},dependencies:[ft,Pt,Nt,Rt,K,Ut,q,yt,J,Dt,At,it]});let i=s;return i})();var Di=j(ut()),ar=j(ht());function rT(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function sT(i,s){i&1&&(t(0,"h4",22),a(1,"Social Categrory General Reports"),e())}function lT(i,s){i&1&&(t(0,"h4",22),a(1,"Social Categrory OBC Reports"),e())}function cT(i,s){i&1&&(t(0,"h4",22),a(1,"Social Categrory SC Reports"),e())}function dT(i,s){i&1&&(t(0,"h4",22),a(1,"Social Categrory ST Reports"),e())}function pT(i,s){if(i&1){let o=U();t(0,"button",23),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",24),a(2,"Download PDF "),e()}}function mT(i,s){i&1&&(t(0,"button",25),m(1,"i",26),a(2,"Downloading "),e())}function _T(i,s){if(i&1){let o=U();t(0,"button",23),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",24),a(2,"Download EXCEL "),e()}}function fT(i,s){i&1&&(t(0,"button",25),m(1,"i",26),a(2,"Downloading "),e())}var uT=(i,s)=>s.id,hT=i=>["/department/portal/soc_cat/block-ulb-stats",i],ST=i=>({social_category:i});function xT(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",33),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e(),t(9,"td"),a(10),e(),t(11,"td"),a(12),e(),t(13,"td"),a(14),e(),t(15,"td"),a(16),e(),t(17,"td"),a(18),e(),t(19,"td"),a(20),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),T("routerLink",pt(13,hT,o.district_id))("queryParams",pt(15,ST,r.social_category)),l(1),dt(" ",P(6,11,o.district_name)," "),l(3),p(o.applications_received),l(2),p(o.under_process),l(2),p(o.rejected_application),l(2),p(o.approved_application),l(2),p(o.payment_processed),l(2),p(o.payment_success),l(2),p(o.payment_fail)}}function gT(i,s){if(i&1&&(t(0,"table",27)(1,"thead",28)(2,"tr")(3,"th",29),a(4,"Sl.#"),e(),t(5,"th",29),a(6,"DISTRICT"),e(),t(7,"th",30),a(8,"APPLICATION DETAILS"),e(),t(9,"th",31),a(10,"PAYMENT DETAILS"),e()(),t(11,"tr")(12,"th"),a(13,"RECEIVED"),e(),t(14,"th"),a(15,"UNDER PROCESS"),e(),t(16,"th"),a(17,"REJECTED"),e(),t(18,"th"),a(19,"APPROVED"),e(),t(20,"th"),a(21,"PAYMENT PROCESSED"),e(),t(22,"th"),a(23,"PAYMENT SUCCESS"),e(),t(24,"th"),a(25,"PAYMENT FAILED"),e()()(),t(26,"tbody",32),F(27,xT,21,17,"tr",null,uT),e()()),i&2){let o=h(2);l(27),V(o.filteredDistrictStats)}}function CT(i,s){i&1&&a(0," No Data Found ")}function bT(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11),b(2,sT,2,0,"h4",12)(3,lT,2,0,"h4",12)(4,cT,2,0,"h4",12)(5,dT,2,0,"h4",12),e(),t(6,"div",13)(7,"div",14)(8,"input",15),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(9,"i",16),e(),t(10,"div",17),b(11,pT,3,0,"button",18)(12,mT,3,0),e(),t(13,"div",19),b(14,_T,3,0,"button",18)(15,fT,3,0),e()()(),t(16,"div",20),b(17,gT,29,0,"table",21)(18,CT,1,0),e()}if(i&2){let o=h();l(2),T("ngIf",o.social_category==1),l(1),T("ngIf",o.social_category==2),l(1),T("ngIf",o.social_category==3),l(1),T("ngIf",o.social_category==4),l(3),T("ngModel",o.searchTerm),l(3),E(11,o.isExportInProgress?12:11),l(3),E(14,o.isExportInProgressExcel?15:14),l(3),E(17,o.filteredDistrictStats&&o.filteredDistrictStats.length>0?17:18)}}var rr=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.districtStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.social_category=n.social_category,console.log(this.social_category),this.fetchDistrictStats()})}fetchDistrictStats(){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?social_category=${this.social_category}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isStatsLoading=!1,this.districtStats=n.data},n=>{this.isStatsLoading=!1,this.districtStats=[]})}get filteredDistrictStats(){return this.searchTerm?this.districtStats.filter(n=>n.district_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.districtStats}exportToExcel(){this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?social_category=${this.social_category}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isExportInProgressExcel=!1;let r=n.data.map((I,R)=>({"SI#":R+1,DISTRICT:I.district_name.toUpperCase(),"APPLICATION RECEIVED":I.applications_received,"APPLICATION UNDER PROCESS":I.under_process,"APPLICATION REJECTED":I.rejected_application,"APPLICATION APPROVED":I.approved_application,"PAYMENT PROCESSED":I.payment_processed,"PAYMENT SUCCESS":I.payment_success,"PAYMENT FAILED":I.payment_fail})),c=N.json_to_sheet(r),f=N.book_new();N.book_append_sheet(f,c,"Applications");let d=Z(f,{bookType:"xlsx",type:"array"}),C=new Date,g=C.toLocaleDateString("en-GB").split("/").reverse().join("-"),_=C.toLocaleTimeString("en-GB").replace(/:/g,"-"),v=this.social_category==1?`soc_cat_gen_district_drilldown_reports_${g}_${_}.xlsx`:this.social_category==2?`soc_cat_obc_district_drilldown_reports_${g}_${_}.xlsx`:this.social_category==3?`soc_cat_sc_district_drilldown_reports_${g}_${_}.xlsx`:this.social_category==4?`soc_cat_st_district_drilldown_reports_${g}_${_}.xlsx`:"",S=new Blob([d],{type:"application/octet-stream"}),w=document.createElement("a"),u=window.URL.createObjectURL(S);w.href=u,w.download=v,w.click(),window.URL.revokeObjectURL(u)},n=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",n)})}exportToPDF(){Di.default.vfs=ar.default.pdfMake.vfs,this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?social_category=${this.social_category}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isExportInProgress=!1;let r=[[{text:"SI#",fontSize:10},{text:"DISTRICT",fontSize:10},{text:"APPLICATION RECEIVED",fontSize:10},{text:"APPLICATION UNDER PROCESS.",fontSize:10},{text:"APPLICATION REJECTED",fontSize:10},{text:"APPLICATION APPROVED",fontSize:10},{text:"PAYMENT PROCESSED",fontSize:10},{text:"PAYMENT SUCCESS",fontSize:10},{text:"PAYMENT FAILED",fontSize:10}]];n.data.forEach((v,S)=>{r.push([{text:(S+1).toString().toUpperCase(),fontSize:9},{text:(v.district_name||"").toUpperCase(),fontSize:9},{text:v.applications_received,fontSize:9},{text:v.under_process,fontSize:9},{text:v.rejected_application,fontSize:9},{text:v.approved_application,fontSize:9},{text:v.payment_processed,fontSize:9},{text:v.payment_success,fontSize:9},{text:v.payment_fail,fontSize:9}])});let f={pageOrientation:"landscape",pageSize:"A4",content:[{text:this.social_category==1?"SOCIAL CATEGORY GENERAL REPORT DISTRICT-WISE":this.social_category==2?"SOCIAL CATEGORY OBC REPORT DISTRICT-WISE":this.social_category==3?"SOCIAL CATEGORY SC REPORT DISTRICT-WISE":this.social_category==4?"SOCIAL CATEGORY ST REPORT DISTRICT-WISE":"",style:"header"},{table:{headerRows:1,body:r,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto"]},layout:{fillColor:function(v){return v===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=this.social_category==1?`soc_cat_gen_district_drilldown_reports_${C}_${g}.pdf`:this.social_category==2?`soc_cat_obc_district_drilldown_reports_${C}_${g}.pdf`:this.social_category==3?`soc_cat_sc_district_drilldown_reports_${C}_${g}.pdf`:this.social_category==4?`soc_cat_st_district_drilldown_reports_${C}_${g}.pdf`:"";Di.default.createPdf(f).download(_)},n=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",n)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-age-district-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["routerLink","/department/portal/dashboard/",1,"me-2"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],["style","color: #fd7b03;",4,"ngIf"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],[2,"color","#fd7b03"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],["colspan","4",1,"text-center"],["colspan","3",1,"text-center"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4)(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,rT,2,0)(11,bT,19,8),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ft,ot,K,q,J,it]});let i=s;return i})();var sr=(()=>{let s=class s{};s.\u0275fac=function(r){return new(r||s)},s.\u0275cmp=M({type:s,selectors:[["app-age-block-ulb-wise"]],decls:2,vars:0,template:function(r,c){r&1&&(t(0,"p"),a(1,"age-block-ulb-wise works!"),e())}});let i=s;return i})();var lr=(()=>{let s=class s{};s.\u0275fac=function(r){return new(r||s)},s.\u0275cmp=M({type:s,selectors:[["app-age-gp-wise"]],decls:2,vars:0,template:function(r,c){r&1&&(t(0,"p"),a(1,"age-gp-wise works!"),e())}});let i=s;return i})();var cr=(()=>{let s=class s{};s.\u0275fac=function(r){return new(r||s)},s.\u0275cmp=M({type:s,selectors:[["app-age-ward-wise"]],decls:2,vars:0,template:function(r,c){r&1&&(t(0,"p"),a(1,"age-ward-wise works!"),e())}});let i=s;return i})();var dr=(()=>{let s=class s{};s.\u0275fac=function(r){return new(r||s)},s.\u0275cmp=M({type:s,selectors:[["app-age-village-wise"]],decls:2,vars:0,template:function(r,c){r&1&&(t(0,"p"),a(1,"age-village-wise works!"),e())}});let i=s;return i})();var pr=(()=>{let s=class s{};s.\u0275fac=function(r){return new(r||s)},s.\u0275cmp=M({type:s,selectors:[["app-age-village-user-list"]],decls:2,vars:0,template:function(r,c){r&1&&(t(0,"p"),a(1,"age-village-user-list works!"),e())}});let i=s;return i})();var mr=(()=>{let s=class s{};s.\u0275fac=function(r){return new(r||s)},s.\u0275cmp=M({type:s,selectors:[["app-age-ward-user-list"]],decls:2,vars:0,template:function(r,c){r&1&&(t(0,"p"),a(1,"age-ward-user-list works!"),e())}});let i=s;return i})();var Ai=j(ut()),_r=j(ht());function vT(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function ET(i,s){i&1&&(t(0,"h4",22),a(1,"Drill-Down Report - e-KYC Completed"),e())}function wT(i,s){i&1&&(t(0,"h4",22),a(1,"Drill-Down Report - e-KYC Pending"),e())}function TT(i,s){if(i&1){let o=U();t(0,"button",23),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",24),a(2,"Download PDF "),e()}}function LT(i,s){i&1&&(t(0,"button",25),m(1,"i",26),a(2,"Downloading "),e())}function IT(i,s){if(i&1){let o=U();t(0,"button",23),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",24),a(2,"Download EXCEL "),e()}}function yT(i,s){i&1&&(t(0,"button",25),m(1,"i",26),a(2,"Downloading "),e())}var kT=(i,s)=>s.id;function PT(i,s){if(i&1&&(t(0,"td"),a(1),e()),i&2){let o=h().$implicit;l(1),p(o==null?null:o.count_ekyc_complited)}}function DT(i,s){if(i&1&&(t(0,"td"),a(1),e()),i&2){let o=h().$implicit;l(1),p(o==null?null:o.count_ekyc_pending)}}var AT=i=>["/department/portal/ekycstats/block-ulb-stats",i],UT=(i,s)=>({ekyc_status:i,installment:s});function NT(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",31),a(5),k(6,"uppercase"),e()(),b(7,PT,2,1,"td",32)(8,DT,2,1,"td",32),e()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),T("routerLink",pt(8,AT,o.district_id))("queryParams",Lt(10,UT,r.ekyc_status,r.installment)),l(1),dt(" ",P(6,6,o.district_name)," "),l(2),T("ngIf",r.card_name=="ekyc_completed"),l(1),T("ngIf",r.card_name=="ekyc_pending")}}function RT(i,s){if(i&1&&(t(0,"table",27)(1,"thead",28)(2,"tr")(3,"th",29),a(4,"Sl.#"),e(),t(5,"th",29),a(6,"DISTRICT"),e()(),t(7,"tr")(8,"th",29),a(9),e()()(),t(10,"tbody",30),F(11,NT,9,13,"tr",null,kT),e()()),i&2){let o=h(2);l(9),p(o.ekyc_status==1?"E-KYC COMPLETED":"E-KYC PENDING"),l(2),V(o.filteredDistrictStats)}}function OT(i,s){i&1&&a(0," No Data Found ")}function BT(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11),b(2,ET,2,0,"h4",12)(3,wT,2,0,"h4",12),e(),t(4,"div",13)(5,"div",14)(6,"input",15),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(7,"i",16),e(),t(8,"div",17),b(9,TT,3,0,"button",18)(10,LT,3,0),e(),t(11,"div",19),b(12,IT,3,0,"button",18)(13,yT,3,0),e()()(),t(14,"div",20),b(15,RT,13,1,"table",21)(16,OT,1,0),e()}if(i&2){let o=h();l(2),T("ngIf",o.ekyc_status==1),l(1),T("ngIf",o.ekyc_status==0),l(3),T("ngModel",o.searchTerm),l(3),E(9,o.isExportInProgress?10:9),l(3),E(12,o.isExportInProgressExcel?13:12),l(3),E(15,o.filteredDistrictStats&&o.filteredDistrictStats.length>0?15:16)}}var fr=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.districtStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.ekyc_status=n.ekyc_status,this.installment=n.installment,this.card_name=n.card_name,console.log(this.card_name),this.fetchDistrictStats()})}fetchDistrictStats(){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?ekyc_status=${this.ekyc_status}&card_name=${this.card_name}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isStatsLoading=!1,this.districtStats=n.data},n=>{this.isStatsLoading=!1,this.districtStats=[]})}get filteredDistrictStats(){return this.searchTerm?this.districtStats.filter(n=>n.district_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.districtStats}exportToExcel(){this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?ekyc_status=${this.ekyc_status}&card_name=${this.card_name}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isExportInProgressExcel=!1;let r=n.data.map((I,R)=>{let z={"SI#":R+1,DISTRICT:I.district_name.toUpperCase(),[this.ekyc_status==1?"E-KYC COMPLETED":"E-KYC PENDING"]:I?.count_ekyc_complited};return this.card_name=="ekyc_completed"?Wt(Bt({},z),{"E-KYC COMPLETED":I?.count_ekyc_complited}):this.card_name=="ekyc_pending"?Wt(Bt({},z),{"E-KYC PENDING":I?.count_ekyc_pending}):z}),c=N.json_to_sheet(r),f=N.book_new();N.book_append_sheet(f,c,"Applications");let d=Z(f,{bookType:"xlsx",type:"array"}),C=new Date,g=C.toLocaleDateString("en-GB").split("/").reverse().join("-"),_=C.toLocaleTimeString("en-GB").replace(/:/g,"-"),v=this.ekyc_status==1?`ekyc_complete_district_drilldown_reports_${g}_${_}.xlsx`:`ekyc_pending_district_drilldown_reports_${g}_${_}.xlsx`,S=new Blob([d],{type:"application/octet-stream"}),w=document.createElement("a"),u=window.URL.createObjectURL(S);w.href=u,w.download=v,w.click(),window.URL.revokeObjectURL(u)},n=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",n)})}exportToPDF(){Ai.default.vfs=_r.default.pdfMake.vfs,this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?ekyc_status=${this.ekyc_status}&card_name=${this.card_name}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isExportInProgress=!1;let r=[[{text:"SI#",fontSize:10},{text:"DISTRICT",fontSize:10},{text:[this.ekyc_status==1?"E-KYC COMPLETED":"E-KYC PENDING"],fontSize:10}]];n.data.forEach((w,u)=>{r.push([{text:(u+1).toString().toUpperCase(),fontSize:9},{text:(w.district_name||"").toUpperCase(),fontSize:9},{text:[this.ekyc_status==1?w?.count_ekyc_complited:w?.count_ekyc_pending],fontSize:9}])});let c=new Date,f=`Timestamp: ${c.toLocaleDateString()}, ${c.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,C={pageOrientation:"landscape",pageSize:"A4",content:[{text:this.ekyc_status==1?"DRILL-DOWN REPORT - e-KYC COMPLETED DISTRICT-WISE":"DRILL-DOWN REPORT - e-KYC PENDING DISTRICT-WISE",style:"header"},{table:{headerRows:1,body:r,widths:["20%","20%","20%"]},layout:{fillColor:function(w){return w===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:f,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},g=new Date,_=g.toLocaleDateString("en-GB").split("/").reverse().join("-"),v=g.toLocaleTimeString("en-GB").replace(/:/g,"-"),S=this.ekyc_status==1?`ekyc_complete_district_drilldown_reports_${_}_${v}.pdf`:`ekyc_pending_district_drilldown_reports_${_}_${v}.pdf`;Ai.default.createPdf(C).download(S)},n=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",n)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-ekycstat-district-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],["style","color: #fd7b03;",4,"ngIf"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],[2,"color","#fd7b03"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"],[4,"ngIf"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,vT,2,0)(11,BT,17,6),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ft,ot,K,q,J,it]});let i=s;return i})();var Ui=j(ut()),ur=j(ht());function WT(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function MT(i,s){i&1&&(t(0,"h4",25),a(1,"Drill-Down Report - e-KYC Completed"),e())}function FT(i,s){i&1&&(t(0,"h4",25),a(1,"Drill-Down Report - e-KYC Pending"),e())}function VT(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",27),a(2,"Download PDF "),e()}}function zT(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}function jT(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",27),a(2,"Download EXCEL "),e()}}function $T(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}var GT=(i,s)=>s.id,XT=(i,s)=>["/department/portal/ekycstats/gp-stats",i,s],hr=(i,s)=>({ekyc_status:i,installment:s});function YT(i,s){if(i&1&&(t(0,"a",35),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit,n=h(3);T("routerLink",Lt(5,XT,o.district_id,o.block_id))("queryParams",Lt(8,hr,n.ekyc_status,n.installment)),l(1),dt(" ",P(2,3,o.block_name)," ")}}var HT=(i,s)=>["/department/portal/ekycstats/ward-stats",i,s];function KT(i,s){if(i&1&&(t(0,"a",35),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit,n=h(3);T("routerLink",Lt(5,HT,o.district_id,o.ulb_id))("queryParams",Lt(8,hr,n.ekyc_status,n.installment)),l(1),dt(" ",P(2,3,o.ulb_name)," ")}}function qT(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td"),b(4,YT,3,11,"a",34)(5,KT,3,11),e(),t(6,"td"),a(7),e()()),i&2){let o=s.$implicit,n=s.$index;l(2),p(n+1),l(2),E(4,o.block_id?4:5),l(3),p(o==null?null:o.applications_received)}}function JT(i,s){if(i&1&&(t(0,"table",30)(1,"thead",31)(2,"tr")(3,"th",32),a(4,"Sl.#"),e(),t(5,"th",32),a(6,"BLOCK/ULB"),e()(),t(7,"tr")(8,"th"),a(9),e()()(),t(10,"tbody",33),F(11,qT,8,3,"tr",null,GT),e()()),i&2){let o=h(2);l(9),p(o.ekyc_status==1?"EKYC-COMPLETED":"EKYC-PENDING"),l(2),V(o.filteredBlockStats)}}function QT(i,s){i&1&&a(0," No Data Found ")}function ZT(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11),b(2,MT,2,0,"h4",12)(3,FT,2,0,"h4",12),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e()()()(),t(8,"div",16)(9,"div",17)(10,"input",18),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(11,"i",19),e(),t(12,"div",20),b(13,VT,3,0,"button",21)(14,zT,3,0),e(),t(15,"div",22),b(16,jT,3,0,"button",21)(17,$T,3,0),e()()(),t(18,"div",23),b(19,JT,13,1,"table",24)(20,QT,1,0),e()}if(i&2){let o=h();l(2),T("ngIf",o.ekyc_status==1),l(1),T("ngIf",o.ekyc_status==0),l(4),p(o.filteredBlockStats[0].district_name),l(3),T("ngModel",o.searchTerm),l(3),E(13,o.isExportInProgress?14:13),l(3),E(16,o.isExportInProgressExcel?17:16),l(3),E(19,o.filteredBlockStats&&o.filteredBlockStats.length>0?19:20)}}var Sr=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.districtStats=[],this.district_id="",this.blockStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.params.subscribe(n=>{let r=n.id;this.district_id=r}),this.route.queryParams.subscribe(n=>{this.ekyc_status=n.ekyc_status,this.installment=n.installment,this.fetchblockStats(this.district_id)})}fetchblockStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/block-count?district_id=${n}&ekyc_status=${this.ekyc_status}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.blockStats=r.data,this.fetchulbStats(n)},r=>{this.isStatsLoading=!1,this.blockStats=[]})}fetchulbStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/ulb-count?district_id=${n}&ekyc_status=${this.ekyc_status}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.blockStats=[...this.blockStats,...r.data]},r=>{this.isStatsLoading=!1})}get filteredBlockStats(){return this.searchTerm?this.blockStats.filter(n=>n.block_name&&n.block_name.toLowerCase().includes(this.searchTerm.toLowerCase())||n.ulb_name&&n.ulb_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.blockStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.blockStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name,"BLOCK/ULB":(u.block_name||u.ulb_name).toUpperCase(),[this.ekyc_status==1?"E-KYC COMPLETED":"E-KYC PENDING"]:u?.applications_received})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=this.ekyc_status==1?`ekyc_complete_block_ulb_drilldown_reports_${C}_${g}.xlsx`:`ekyc_pending_block_ulb_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){Ui.default.vfs=ur.default.pdfMake.vfs,this.isExportInProgress=!0;let r=((this.blockStats[0]||{}).district_name||"N/A").toUpperCase(),c=[[{text:"SI#",fontSize:10},{text:"BLOCK/ULB",fontSize:10},{text:[this.ekyc_status==1?"EKYC-COMPLETED":"EKYC-PENDING"],fontSize:10}]];this.blockStats.forEach((u,I)=>{c.push([{text:(I+1).toString().toUpperCase(),fontSize:9},{text:(u.block_name||u.ulb_name||"").toUpperCase(),fontSize:9},{text:u?.applications_received,fontSize:9}])});let f=new Date,d=`Timestamp: ${f.toLocaleDateString()}, ${f.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,C=this.ekyc_status==1?"DRILL-DOWN REPORT - e-KYC COMPLETED BLOCK-ULB WISE":"DRILL-DOWN REPORT - e-KYC PENDING BLOCK-ULB WISE",g={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r}`,style:"breadcrumb",margin:[0,0,0,10]},{text:C,style:"header"},{table:{headerRows:1,body:c,widths:["20%","20%","20%"]},layout:{fillColor:function(u){return u===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:d,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},_=new Date,v=_.toLocaleDateString("en-GB").split("/").reverse().join("-"),S=_.toLocaleTimeString("en-GB").replace(/:/g,"-"),w=this.ekyc_status==1?`ekyc_complete_block_ulb_drilldown_reports_${v}_${S}.pdf`:`ekyc_pending_block_ulb_drilldown_reports_${v}_${S}.pdf`;Ui.default.createPdf(g).download(w,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-ekycstat-block-ulb-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],["style","color: #fd7b03;",4,"ngIf"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],[2,"color","#fd7b03"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],[2,"font-size","14px"],["style","text-decoration: none",3,"routerLink","queryParams"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,WT,2,0)(11,ZT,21,7),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ft,ot,K,q,J,it]});let i=s;return i})();var Ni=j(ut()),xr=j(ht());function t3(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function e3(i,s){i&1&&(t(0,"h4",26),a(1,"Drill-Down Report - e-KYC Completed"),e())}function i3(i,s){i&1&&(t(0,"h4",26),a(1,"Drill-Down Report - e-KYC Pending"),e())}function n3(i,s){if(i&1){let o=U();t(0,"button",27),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",28),a(2,"Download PDF "),e()}}function o3(i,s){i&1&&(t(0,"button",29),m(1,"i",30),a(2,"Downloading "),e())}function a3(i,s){if(i&1){let o=U();t(0,"button",27),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",28),a(2,"Download EXCEL "),e()}}function r3(i,s){i&1&&(t(0,"button",29),m(1,"i",30),a(2,"Downloading "),e())}var s3=(i,s)=>s.id,l3=(i,s,o)=>["/department/portal/ekycstats/village-stats",i,s,o],c3=(i,s)=>({ekyc_status:i,installment:s});function d3(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",35),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),T("routerLink",Ft(7,l3,o.district_id,o.block_id,o.gp_id))("queryParams",Lt(11,c3,r.ekyc_status,r.installment)),l(1),dt(" ",P(6,5,o.gp_name)," "),l(3),p(o==null?null:o.applications_received)}}function p3(i,s){if(i&1&&(t(0,"table",31)(1,"thead",32)(2,"tr")(3,"th",33),a(4,"Sl.#"),e(),t(5,"th",33),a(6,"GRAM PANCHAYAT"),e()(),t(7,"tr")(8,"th"),a(9),e()()(),t(10,"tbody",34),F(11,d3,9,14,"tr",null,s3),e()()),i&2){let o=h(2);l(9),p(o.ekyc_status==1?"EKYC-COMPLETED":"EKYC-PENDING"),l(2),V(o.filteredGpStats)}}function m3(i,s){i&1&&a(0," No Data Found ")}function _3(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11),b(2,e3,2,0,"h4",12)(3,i3,2,0,"h4",12),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e(),t(8,"li",16),a(9),e()()()(),t(10,"div",17)(11,"div",18)(12,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(13,"i",20),e(),t(14,"div",21),b(15,n3,3,0,"button",22)(16,o3,3,0),e(),t(17,"div",23),b(18,a3,3,0,"button",22)(19,r3,3,0),e()()(),t(20,"div",24),b(21,p3,13,1,"table",25)(22,m3,1,0),e()}if(i&2){let o=h();l(2),T("ngIf",o.ekyc_status==1),l(1),T("ngIf",o.ekyc_status==0),l(4),p(o.filteredGpStats[0].district_name),l(2),p(o.filteredGpStats[0].block_name),l(3),T("ngModel",o.searchTerm),l(3),E(15,o.isExportInProgress?16:15),l(3),E(18,o.isExportInProgressExcel?19:18),l(3),E(21,o.filteredGpStats&&o.filteredGpStats.length>0?21:22)}}var gr=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.district_id="",this.gpStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.id}),this.route.queryParams.subscribe(n=>{this.ekyc_status=n.ekyc_status,this.installment=n.installment,this.fetchgpStats(this.block_id)})}fetchgpStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/gp-count?block_id=${n}&ekyc_status=${this.ekyc_status}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.gpStats=r.data},r=>{this.isStatsLoading=!1,this.gpStats=[]})}get filteredGpStats(){return this.searchTerm?this.gpStats.filter(n=>n.gp_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.gpStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.gpStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",BLOCK:u.block_name?u.block_name.toUpperCase():"",GP:u.gp_name?u.gp_name.toUpperCase():"",[this.ekyc_status==1?"EKYC_COMPLETED":"EKYC-PENDING"]:u?.applications_received})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=this.ekyc_status==1?`ekyc_complete_gp_drilldown_reports_${C}_${g}.xlsx`:`ekyc_pending_gp_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){Ni.default.vfs=xr.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.gpStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=[[{text:"SI#",fontSize:10},{text:"GP",fontSize:10},{text:[this.ekyc_status==1?"EKYC-COMPLETED":"EKYC-PENDING"],fontSize:10}]];this.gpStats.forEach((I,R)=>{f.push([{text:(R+1).toString().toUpperCase(),fontSize:9},{text:(I.gp_name||"").toUpperCase(),fontSize:9},{text:I?.applications_received,fontSize:9}])});let d=new Date,C=`Timestamp: ${d.toLocaleDateString()}, ${d.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,g=this.ekyc_status==1?"DRILL-DOWN REPORT - e-KYC COMPLETED GP WISE":"DRILL-DOWN REPORT - e-KYC PENDING GP WISE",_={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK: ${c}`,style:"breadcrumb",margin:[0,0,0,10]},{text:g,style:"header"},{table:{headerRows:1,body:f,widths:["20%","20%","20%"]},layout:{fillColor:function(I){return I===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:C,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},v=new Date,S=v.toLocaleDateString("en-GB").split("/").reverse().join("-"),w=v.toLocaleTimeString("en-GB").replace(/:/g,"-"),u=this.ekyc_status==1?`ekyc_complete_gp_drilldown_reports_${S}_${w}.pdf`:`ekyc_pending_gp_drilldown_reports_${S}_${w}.pdf`;Ni.default.createPdf(_).download(u,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-ekycstat-gp-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],["style","color: #fd7b03;",4,"ngIf"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],[2,"color","#fd7b03"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,t3,2,0)(11,_3,23,8),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ft,ot,K,q,J,it]});let i=s;return i})();var Ri=j(ut()),Cr=j(ht());function f3(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function u3(i,s){i&1&&(t(0,"h4",26),a(1,"Drill-Down Report - e-KYC Completed"),e())}function h3(i,s){i&1&&(t(0,"h4",26),a(1,"Drill-Down Report - e-KYC Pending"),e())}function S3(i,s){if(i&1){let o=U();t(0,"button",27),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",28),a(2,"Download PDF "),e()}}function x3(i,s){i&1&&(t(0,"button",29),m(1,"i",30),a(2,"Downloading "),e())}function g3(i,s){if(i&1){let o=U();t(0,"button",27),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",28),a(2,"Download EXCEL "),e()}}function C3(i,s){i&1&&(t(0,"button",29),m(1,"i",30),a(2,"Downloading "),e())}var b3=(i,s)=>s.id,v3=(i,s,o)=>["/department/portal/ekycstats/ward-user-list",i,s,o],E3=(i,s)=>({ekyc_status:i,installment:s});function w3(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",36),a(5),e()(),t(6,"td"),a(7),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),T("routerLink",Ft(5,v3,o.district_id,o.ulb_id,o.ward_id))("queryParams",Lt(9,E3,r.ekyc_status,r.installment)),l(1),dt(" ",o.ward_no," "),l(2),p(o==null?null:o.applications_received)}}function T3(i,s){if(i&1&&(t(0,"table",31)(1,"thead",32)(2,"tr")(3,"th",33),a(4,"Sl.#"),e(),t(5,"th",33),a(6,"WARD"),e(),t(7,"th",34),a(8,"APPLICATION DETAILS"),e()(),t(9,"tr")(10,"th"),a(11),e()()(),t(12,"tbody",35),F(13,w3,8,12,"tr",null,b3),e()()),i&2){let o=h(2);l(11),p(o.ekyc_status==1?"EKYC-COMPLETED":"EKYC-PENDING"),l(2),V(o.filteredWardStats)}}function L3(i,s){i&1&&a(0," No Data Found ")}function I3(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11),b(2,u3,2,0,"h4",12)(3,h3,2,0,"h4",12),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e(),t(8,"li",16),a(9),e()()()(),t(10,"div",17)(11,"div",18)(12,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(13,"i",20),e(),t(14,"div",21),b(15,S3,3,0,"button",22)(16,x3,3,0),e(),t(17,"div",23),b(18,g3,3,0,"button",22)(19,C3,3,0),e()()(),t(20,"div",24),b(21,T3,15,1,"table",25)(22,L3,1,0),e()}if(i&2){let o=h();l(2),T("ngIf",o.ekyc_status==1),l(1),T("ngIf",o.ekyc_status==0),l(4),p(o.filteredWardStats[0].district_name),l(2),p(o.filteredWardStats[0].ulb_name),l(3),T("ngModel",o.searchTerm),l(3),E(15,o.isExportInProgress?16:15),l(3),E(18,o.isExportInProgressExcel?19:18),l(3),E(21,o.filteredWardStats&&o.filteredWardStats.length>0?21:22)}}var br=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.district_id="",this.wardStats=[],this.ulb_id="",this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.params.subscribe(n=>{this.district_id=n.district_id,this.ulb_id=n.id}),this.route.queryParams.subscribe(n=>{this.ekyc_status=n.ekyc_status,this.installment=n.installment,this.fetchWardStats(this.ulb_id)})}fetchWardStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/ward-count?ulb_id=${n}&ekyc_status=${this.ekyc_status}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.wardStats=r.data},r=>{this.isStatsLoading=!1,this.wardStats=[]})}get filteredWardStats(){return this.searchTerm?this.wardStats.filter(n=>n.ward_no.toLowerCase().includes(this.searchTerm.toLowerCase())):this.wardStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.wardStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",ULB:u.ulb_name?u.ulb_name.toUpperCase():"","WARD NO.":u.ward_no?u.ward_no.toUpperCase():"",[this.ekyc_status==1?"EKYC-COMPLETED":"EKYC-PENDING"]:u?.applications_received})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=this.ekyc_status==1?`ekyc_complete_ward_drilldown_reports_${C}_${g}.xlsx`:`ekyc_pending_ward_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){Ri.default.vfs=Cr.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.wardStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=[[{text:"SI#",fontSize:10},{text:"WARD NO.",fontSize:10},{text:[this.ekyc_status==1?"EKYC-COMPLETED":"EKYC-PENDING"],fontSize:10}]];this.wardStats.forEach((I,R)=>{f.push([{text:(R+1).toString().toUpperCase(),fontSize:9},{text:(I.ward_no||"").toUpperCase(),fontSize:9},{text:I?.applications_received,fontSize:9}])});let d=new Date,C=`Timestamp: ${d.toLocaleDateString()}, ${d.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,g=this.ekyc_status==1?"DRILL-DOWN REPORT - e-KYC COMPLETED WARD WISE":"DRILL-DOWN REPORT - e-KYC PENDING WARD WISE",_={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK/ULB: ${c}`,style:"breadcrumb",margin:[0,0,0,10]},{text:g,style:"header"},{table:{headerRows:1,body:f,widths:["20%","20%","20%"]},layout:{fillColor:function(I){return I===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:C,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},v=new Date,S=v.toLocaleDateString("en-GB").split("/").reverse().join("-"),w=v.toLocaleTimeString("en-GB").replace(/:/g,"-"),u=this.ekyc_status==1?`ekyc_complete_ward_drilldown_reports_${S}_${w}.pdf`:`ekyc_pending_ward_drilldown_reports_${S}_${w}.pdf`;Ri.default.createPdf(_).download(u,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-ekycstat-ward-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],["style","color: #fd7b03;",4,"ngIf"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],[2,"color","#fd7b03"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],["colspan","3",1,"text-center"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,f3,2,0)(11,I3,23,8),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ft,ot,K,q,J]});let i=s;return i})();var Oi=j(ut()),vr=j(ht());function y3(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function k3(i,s){i&1&&(t(0,"h4",26),a(1,"Drill-Down Report - e-KYC Completed"),e())}function P3(i,s){i&1&&(t(0,"h4",26),a(1,"Drill-Down Report - e-KYC Pending"),e())}function D3(i,s){if(i&1){let o=U();t(0,"button",27),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",28),a(2,"Download PDF "),e()}}function A3(i,s){i&1&&(t(0,"button",29),m(1,"i",30),a(2,"Downloading "),e())}function U3(i,s){if(i&1){let o=U();t(0,"button",27),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",28),a(2,"Download EXCEL "),e()}}function N3(i,s){i&1&&(t(0,"button",29),m(1,"i",30),a(2,"Downloading "),e())}var R3=(i,s)=>s.id,O3=(i,s,o,n)=>["/department/portal/ekycstats/village-user-list",i,s,o,n],B3=(i,s)=>({ekyc_status:i,installment:s});function W3(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",35),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),T("routerLink",Yt(7,O3,o.district_id,o.block_id,o.gp_id,o.village_id))("queryParams",Lt(12,B3,r.ekyc_status,r.installment)),l(1),dt(" ",P(6,5,o.village_name)," "),l(3),p(o==null?null:o.applications_received)}}function M3(i,s){if(i&1&&(t(0,"table",31)(1,"thead",32)(2,"tr")(3,"th",33),a(4,"Sl.#"),e(),t(5,"th",33),a(6,"VILLAGE"),e()(),t(7,"tr")(8,"th"),a(9),e()()(),t(10,"tbody",34),F(11,W3,9,15,"tr",null,R3),e()()),i&2){let o=h(2);l(9),p(o.ekyc_status==1?"EKYC-COMPLETED":"EKYC-PENDING"),l(2),V(o.filteredVillageStats)}}function F3(i,s){i&1&&a(0," No Data Found ")}function V3(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11),b(2,k3,2,0,"h4",12)(3,P3,2,0,"h4",12),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e(),t(8,"li",15),a(9),e(),t(10,"li",16),a(11),e()()()(),t(12,"div",17)(13,"div",18)(14,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(15,"i",20),e(),t(16,"div",21),b(17,D3,3,0,"button",22)(18,A3,3,0),e(),t(19,"div",23),b(20,U3,3,0,"button",22)(21,N3,3,0),e()()(),t(22,"div",24),b(23,M3,13,1,"table",25)(24,F3,1,0),e()}if(i&2){let o=h();l(2),T("ngIf",o.ekyc_status==1),l(1),T("ngIf",o.ekyc_status==0),l(4),p(o.filteredVillageStats[0].district_name),l(2),p(o.filteredVillageStats[0].block_name),l(2),p(o.filteredVillageStats[0].gp_name),l(3),T("ngModel",o.searchTerm),l(3),E(17,o.isExportInProgress?18:17),l(3),E(20,o.isExportInProgressExcel?21:20),l(3),E(23,o.filteredVillageStats&&o.filteredVillageStats.length>0?23:24)}}var Er=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.gp_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.block_id,this.gp_id=n.id}),this.route.queryParams.subscribe(n=>{this.ekyc_status=n.ekyc_status,this.installment=n.installment,this.fetchvillageStats(this.gp_id)})}fetchvillageStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/village-count?gp_id=${n}&ekyc_status=${this.ekyc_status}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.villageStats=r.data},r=>{this.isStatsLoading=!1,this.villageStats=[]})}get filteredVillageStats(){return this.searchTerm?this.villageStats.filter(n=>n.village_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.villageStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.villageStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",BLOCK:u.block_name?u.block_name.toUpperCase():"",GP:u.gp_name?u.gp_name.toUpperCase():"",VILLAGE:u.village_name?u.village_name.toUpperCase():"",[this.ekyc_status==1?"EKYC-COMPLETED":"EKYC-PENDING"]:u?.applications_received})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=this.ekyc_status==1?`ekyc_complete_village_drilldown_reports_${C}_${g}.xlsx`:`ekyc_pending_village_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){Oi.default.vfs=vr.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.villageStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=(n.gp_name||n.ward_no||"N/A").toUpperCase(),d=[[{text:"SI#",fontSize:10},{text:"VILLAGE",fontSize:10},{text:[this.ekyc_status==1?"EKYC-COMPLETED":"EKYC-PENDING"],fontSize:10}]];this.villageStats.forEach((R,z)=>{d.push([{text:(z+1).toString().toUpperCase(),fontSize:9},{text:(R.village_name||"").toUpperCase(),fontSize:9},{text:R?.applications_received,fontSize:9}])});let C=new Date,g=`Timestamp: ${C.toLocaleDateString()}, ${C.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,_=this.ekyc_status==1?"DRILL-DOWN REPORT - e-KYC COMPLETED VILLAGE WISE":"DRILL-DOWN REPORT - e-KYC PENDING VILLAGE WISE",v={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK: ${c} > GP:${f}`,style:"breadcrumb",margin:[0,0,0,10]},{text:_,style:"header"},{table:{headerRows:1,body:d,widths:["20%","20%","20%"]},layout:{fillColor:function(R){return R===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:g,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},S=new Date,w=S.toLocaleDateString("en-GB").split("/").reverse().join("-"),u=S.toLocaleTimeString("en-GB").replace(/:/g,"-"),I=this.ekyc_status==1?`ekyc_complete_village_drilldown_reports_${w}_${u}.pdf`:`ekyc_pending_village_drilldown_reports_${w}_${u}.pdf`;Oi.default.createPdf(v).download(I,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-ekycstat-village-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],["style","color: #fd7b03;",4,"ngIf"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],[2,"color","#fd7b03"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,y3,2,0)(11,V3,25,9),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ft,ot,K,q,J,it]});let i=s;return i})();var Bi=j(ut()),wr=j(ht());function z3(i,s){i&1&&(t(0,"h4",33),a(1,"Detailed Report - e-KYC Completed"),e())}function j3(i,s){i&1&&(t(0,"h4",33),a(1,"Detailed Report - e-KYC Pending"),e())}function $3(i,s){if(i&1&&(t(0,"div",34)(1,"div",35)(2,"nav",36)(3,"ol",37)(4,"li",38),a(5),e(),t(6,"li",38),a(7),e(),t(8,"li",38),a(9),e(),t(10,"li",39),a(11),e()()()()()),i&2){let o=h();l(5),p(o.filteredVillageUserStats[0].district_name),l(2),p(o.filteredVillageUserStats[0].block_name),l(2),p(o.filteredVillageUserStats[0].gp_name),l(2),p(o.filteredVillageUserStats[0].village_name)}}function G3(i,s){i&1&&(t(0,"button",40),m(1,"i",41),a(2,"Search "),e())}function X3(i,s){i&1&&(t(0,"button",42),m(1,"i",43),a(2," Searching ..."),e())}function Y3(i,s){i&1&&(m(0,"i",44),a(1," We are fetching the data, please wait. "))}function H3(i,s){if(i&1){let o=U();t(0,"button",59),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",60),a(2,"Download to PDF "),e()}}function K3(i,s){i&1&&(t(0,"button",61),m(1,"i",43),a(2,"Downloading "),e())}function q3(i,s){if(i&1){let o=U();t(0,"button",59),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",60),a(2,"Download to EXCEL "),e()}}function J3(i,s){i&1&&(t(0,"button",61),m(1,"i",43),a(2,"Downloading "),e())}var Q3=(i,s)=>s.id;function Z3(i,s){if(i&1&&(t(0,"td"),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit;l(1),p(P(2,1,o.village_name))}}function tL(i,s){i&1&&m(0,"td")}function eL(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),b(3,Z3,3,3,"td")(4,tL,1,0),t(5,"td"),a(6),k(7,"uppercase"),e(),t(8,"td"),a(9),k(10,"uppercase"),e(),t(11,"td"),a(12),k(13,"uppercase"),e(),t(14,"td"),a(15),k(16,"uppercase"),e(),t(17,"td"),a(18),k(19,"uppercase"),e(),t(20,"td"),a(21),k(22,"uppercase"),e(),t(23,"td"),a(24),k(25,"uppercase"),e(),t(26,"td"),a(27),e(),t(28,"td"),a(29),k(30,"uppercase"),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(1),E(3,o.village_name?3:4),l(3),p(P(7,11,o.category)),l(3),p(P(10,13,o.application_number)),l(3),p(P(13,15,r.appService.dateFormat(o.application_date))),l(3),p(P(16,17,o.applicant_name)),l(3),p(P(19,19,o.spouse_or_father_name)),l(3),p(P(22,21,o.social_category)),l(3),p(P(25,23,o.pwd_status)),l(3),p(o.alt_mobile_number),l(2),p(P(30,25,o.application_status))}}function iL(i,s){if(i&1&&(t(0,"table",62)(1,"thead",63)(2,"tr")(3,"th"),a(4,"SI#"),e(),t(5,"th"),a(6,"VILLAGE"),e(),t(7,"th"),a(8,"CATEGORY"),e(),t(9,"th"),a(10,"APPLICATION NO."),e(),t(11,"th"),a(12,"APPLICATION DATE"),e(),t(13,"th"),a(14,"APPLICANT NAME"),e(),t(15,"th"),a(16,"FATHER/HUSBAND NAME"),e(),t(17,"th"),a(18,"SOCIAL CATEGORY"),e(),t(19,"th"),a(20,"PWD"),e(),t(21,"th"),a(22,"MOBILE NO."),e(),t(23,"th"),a(24,"APPLICATION STATUS"),e()()(),t(25,"tbody"),F(26,eL,31,27,"tr",null,Q3),e()()),i&2){let o=h(2);l(26),V(o.filteredVillageUserStats)}}function nL(i,s){i&1&&(t(0,"h5",64),a(1,"No data available"),e())}function oL(i,s){i&1&&(t(0,"div",65),a(1,"Loading.. "),m(2,"i",66),e())}function aL(i,s){i&1&&(t(0,"span"),m(1,"i",44),a(2," Loading..."),e())}function rL(i,s){i&1&&(t(0,"span"),a(1,"Load More"),e())}function sL(i,s){if(i&1){let o=U();t(0,"div",67)(1,"button",68),L("click",function(){D(o);let r=h(2);return A(r.loadMore())}),b(2,aL,3,0,"span",69)(3,rL,2,0,"span",69),e()()}if(i&2){let o=h(2);l(2),T("ngIf",o.isLoadMoreInProgress),l(1),T("ngIf",!o.isLoadMoreInProgress)}}function lL(i,s){if(i&1){let o=U();t(0,"div",34)(1,"div",45)(2,"h5",46),a(3," Number of records found : "),t(4,"span",47),a(5),e()()(),t(6,"div",48)(7,"div",49)(8,"input",50),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(9,"i",51),e(),t(10,"div",52),b(11,H3,3,0,"button",53)(12,K3,3,0),e(),t(13,"div",54),b(14,q3,3,0,"button",53)(15,J3,3,0),e()()(),t(16,"div",55),b(17,iL,28,0,"table",56)(18,nL,2,0)(19,oL,3,0,"div",57),e(),b(20,sL,4,2,"div",58)}if(i&2){let o=h();l(5),p(o.count),l(3),T("ngModel",o.searchTerm),l(3),E(11,o.isExportInProgress?12:11),l(3),E(14,o.isExportInProgressExcel?15:14),l(3),E(17,o.filteredVillageUserStats&&o.filteredVillageUserStats.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),l(2),E(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),l(1),T("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var Tr=(()=>{let s=class s{constructor(n,r,c,f,d,C,g,_){this.route=n,this.router=r,this.formService=c,this.appService=f,this.httpClient=d,this.toastService=C,this.authService=g,this.masterDataService=_,this.isStatsLoading=!1,this.userStats=[],this.block_id="",this.gp_id="",this.village_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.limit=this.appService.loadmorelimit,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.count=0,this.searchForm=new kt({a_category:new nt(""),social_category:new nt(""),pwd_status:new nt(""),submit_date:new nt(""),a_status:new nt("")})}ngOnInit(){this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.block_id,this.gp_id=n.gp_id,this.village_id=n.id}),this.route.queryParams.subscribe(n=>{this.ekyc_status=n.ekyc_status,this.installment=n.installment,this.fetchuserStats(this.village_id)})}fetchuserStats(n,r=!1){this.isStatsLoading=!0;let c=new st;c=c.set("gp_id",this.gp_id),c=c.set("village_id",n),c=c.set("offset",this.offset),c=c.set("limit",this.limit),this.ekyc_status!==void 0&&(c=c.set("ekyc_status",this.ekyc_status.toString())),this.installment!==void 0&&(c=c.set("installment",this.installment.toString()));let f=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:c,headers:f}).subscribe(d=>{this.isStatsLoading=!1,this.count=d.count,d.data&&d.data.length>0?(this.application_list=this.application_list.concat(d.data),this.offset+=d.data.length,this.hasMoreRecords=d.data.length===this.limit):this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)},d=>{this.isStatsLoading=!1,this.application_list=[],this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)})}get filteredVillageUserStats(){if(!this.searchTerm)return this.application_list;let n=this.searchTerm.toLowerCase();return this.application_list.filter(r=>r.village_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.category?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.application_number?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_date).toLowerCase().includes(this.searchTerm.toLowerCase())||r.applicant_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.spouse_or_father_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.dob).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.social_category).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.pwd_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.alt_mobile_number).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.payment_status).toLowerCase().includes(this.searchTerm.toLowerCase()))}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status,_=new st;_=_.set("gp_id",this.gp_id),r&&(_=_.set("village_id",r)),c&&(_=_.set("category",c)),f&&(_=_.set("social_category",f)),d&&(_=_.set("pwd_status",d)),g&&(_=_.set("application_status",g)),_=_.set("offset",this.offset),_=_.set("limit",this.limit),this.ekyc_status!==void 0&&(_=_.set("ekyc_status",this.ekyc_status.toString())),this.installment!==void 0&&(_=_.set("installment",this.installment.toString()));let v=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:_,headers:v}).subscribe(S=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=S.count,S.data&&S.data.length>0?(this.application_list=this.application_list.concat(S.data),this.offset+=S.data.length,this.hasMoreRecords=S.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},S=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}exportToExcel(){let n=new st,r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;n=n.set("gp_id",this.gp_id),r&&(n=n.set("village_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),g&&(n=n.set("application_status",g)),n=n.set("export_all","1"),this.ekyc_status!==void 0&&(n=n.set("ekyc_status",this.ekyc_status.toString())),this.installment!==void 0&&(n=n.set("installment",this.installment.toString()));let _=new rt({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgressExcel=!1;let S=v.data.map((y,B)=>({"SI#":B+1,DISTRICT:y.district_name?y.district_name.toUpperCase():"",BLOCK:y.block_name?y.block_name.toUpperCase():"",GP:y.gp_name?y.gp_name.toUpperCase():"",VILLAGE:y.village_name?y.village_name.toUpperCase():"",CATEGORY:y.category.toUpperCase(),"APPLICATION NO.":y.application_number.toUpperCase(),"APPLICATION DATE":this.appService.dateFormat(y.application_date),"APPLICANT NAME":y.applicant_name.toUpperCase(),"FATHER/HUSBAND NAME":y.spouse_or_father_name.toUpperCase(),"SOCIAL CATEGORY":y.social_category.toUpperCase(),PWD:y.pwd_status.toUpperCase(),"MOBILE NO.":y.alt_mobile_number,"APPLICATION STATUS":y.application_status.toUpperCase()})),w=N.json_to_sheet(S),u=N.book_new();N.book_append_sheet(u,w,"Applications");let I=Z(u,{bookType:"xlsx",type:"array"}),R=new Date,z=R.toLocaleDateString("en-GB").split("/").reverse().join("-"),at=R.toLocaleTimeString("en-GB").replace(/:/g,"-"),ct=this.ekyc_status==1?`ekyc_complete__application_status_reports_${z}_${at}.xlsx`:`ekyc_pending_application_status_reports_${z}_${at}.xlsx`,lt=new Blob([I],{type:"application/octet-stream"}),O=document.createElement("a"),et=window.URL.createObjectURL(lt);O.href=et,O.download=ct,O.click(),window.URL.revokeObjectURL(et)},v=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",v)})}exportToPDF(){Bi.default.vfs=wr.default.pdfMake.vfs;let n=new st,r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;n=n.set("gp_id",this.gp_id),r&&(n=n.set("village_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),g&&(n=n.set("application_status",g)),n=n.set("export_all","1"),this.ekyc_status!==void 0&&(n=n.set("ekyc_status",this.ekyc_status.toString())),this.installment!==void 0&&(n=n.set("installment",this.installment.toString()));let _=new rt({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgress=!1;let S=v.data[0]||{},w=(S.district_name||"N/A").toUpperCase(),u=(S.block_name||S.ulb_name||"N/A").toUpperCase(),I=(S.gp_name||S.ward_no||"N/A").toUpperCase(),R=(S.village_name||"").toUpperCase(),z=[[{text:"SI#",fontSize:10},{text:"CATEGORY",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICATION DATE.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"SOCIAL CATEGORY",fontSize:10},{text:"PWD",fontSize:10},{text:"MOBILE NO",fontSize:10},{text:"APPLICATION STATUS",fontSize:10}]];v.data.forEach((It,jt)=>{z.push([{text:(jt+1).toString().toUpperCase(),fontSize:9},{text:(It.category||"").toUpperCase(),fontSize:9},{text:(It.application_number||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(It.application_date)||"",fontSize:9},{text:(It.applicant_name||"").toUpperCase(),fontSize:9},{text:(It.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:(It.social_category||"").toUpperCase(),fontSize:9},{text:(It.pwd_status||"").toUpperCase(),fontSize:9},{text:(It.alt_mobile_number||"").toUpperCase(),fontSize:9},{text:(It.application_status||"").toUpperCase(),fontSize:9}])});let at=new Date,ct=`Timestamp: ${at.toLocaleDateString()}, ${at.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,lt=this.ekyc_status==1?"DETAILED REPORT - eKYC COMPLETED":"DETAILED REPORT - eKYC PENDING",O={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${w} > BLOCK: ${u} > GP: ${I} >VILLAGE: ${R}`,style:"breadcrumb",margin:[0,0,0,10]},{text:lt,style:"header"},{table:{headerRows:1,body:z,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]},layout:{fillColor:function(It){return It===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:ct,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},et=new Date,y=et.toLocaleDateString("en-GB").split("/").reverse().join("-"),B=et.toLocaleTimeString("en-GB").replace(/:/g,"-"),W=this.ekyc_status==1?`ekyc_complete_application_status_reports_${y}_${B}.pdf`:`ekyc_pending_application_status_reports_${y}_${B}.pdf`;Bi.default.createPdf(O).download(W)},v=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",v)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(Ot),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-ekycstat-village-user-list"]],decls:68,vars:6,consts:[[1,"container-fluid","drilldown-reports"],[1,"d-flex","justify-content-between","w-100","mb-3"],["style","color: #fd7b03;",4,"ngIf"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],["class","row mb-2"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-2"],[1,"col-md-3"],["for","a_category",1,"fw-bold"],["formControlName","a_category","id","a_category",1,"form-select","my-2"],["value",""],["value","1"],["value","0"],["for","social_category",1,"fw-bold"],["formControlName","social_category","id","social_category",1,"form-select","my-2"],["value","2"],["value","3"],["value","4"],["for","a_status",1,"fw-bold"],["formControlName","a_status","id","a_status",1,"form-select","my-2"],["value","7"],["for","pwd_status",1,"fw-bold"],["formControlName","pwd_status","id","pwd_status",1,"form-select","my-2"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[2,"color","#fd7b03"],[1,"row","mb-2"],[1,"col-md-7"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"fa","fa-spinner","fa-spin"],[1,"col-md-5"],[1,"card-title"],["id","recordCount"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports detail"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports","detail"],[1,"text-light",2,"background-color","#fd7b03"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"],[4,"ngIf"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),b(2,z3,2,0,"h4",2)(3,j3,2,0,"h4",2),t(4,"div",3)(5,"a",4),L("click",function(){return c.appService.goBack()}),t(6,"button",5),m(7,"i",6),a(8," Back"),e()()()(),b(9,$3,12,4,"div",7),t(10,"div",8)(11,"form",9),L("ngSubmit",function(){return c.onSearch()}),t(12,"div",10)(13,"div",11)(14,"label",12),a(15," Category "),e(),t(16,"select",13)(17,"option",14),a(18,"Choose Category"),e(),t(19,"option",15),a(20,"NFSA"),e(),t(21,"option",16),a(22,"NON-NFSA"),e()()(),t(23,"div",11)(24,"label",17),a(25," Social Category "),e(),t(26,"select",18)(27,"option",14),a(28,"Choose Social Category"),e(),t(29,"option",15),a(30,"Un-Reserved"),e(),t(31,"option",19),a(32,"OBC"),e(),t(33,"option",20),a(34,"SC"),e(),t(35,"option",21),a(36,"ST"),e()()(),t(37,"div",11)(38,"label",22),a(39," Application Status "),e(),t(40,"select",23)(41,"option",14),a(42,"Choose Status"),e(),t(43,"option",24),a(44,"Under Process"),e(),t(45,"option",15),a(46,"Approved"),e(),t(47,"option",19),a(48,"Rejected"),e()()(),t(49,"div",11)(50,"label",25),a(51," PWD "),e(),t(52,"select",26)(53,"option",14),a(54,"Choose PWD Status"),e(),t(55,"option",15),a(56,"Yes "),e(),t(57,"option",16),a(58,"NO"),e()()()(),t(59,"div",27)(60,"div",28),b(61,G3,3,0,"button",29)(62,X3,3,0),e()()()(),t(63,"div",30)(64,"div",31)(65,"div",32),b(66,Y3,2,0)(67,lL,21,7),e()()()()),r&2&&(l(2),T("ngIf",c.ekyc_status==1),l(1),T("ngIf",c.ekyc_status==0),l(6),E(9,c.filteredVillageUserStats&&c.filteredVillageUserStats.length>0?9:-1),l(2),T("formGroup",c.searchForm),l(50),E(61,c.isFormSearchInProgress?62:61),l(5),E(66,c.isStatsLoading?66:67))},dependencies:[ft,Pt,Nt,Rt,K,Ut,q,yt,J,Dt,At,it]});let i=s;return i})();var Wi=j(ut()),Lr=j(ht());function cL(i,s){i&1&&(t(0,"h4",33),a(1,"Detailed Report - e-KYC Completed"),e())}function dL(i,s){i&1&&(t(0,"h4",33),a(1,"Detailed Report - e-KYC Pending"),e())}function pL(i,s){if(i&1&&(t(0,"div",34)(1,"div",35)(2,"nav",36)(3,"ol",37)(4,"li",38),a(5),e(),t(6,"li",38),a(7),e(),t(8,"li",39),a(9),e()()()()()),i&2){let o=h();l(5),p(o.filteredWardUserStats[0].district_name),l(2),p(o.filteredWardUserStats[0].ulb_name),l(2),p(o.filteredWardUserStats[0].ward_no)}}function mL(i,s){i&1&&(t(0,"button",40),m(1,"i",41),a(2,"Search "),e())}function _L(i,s){i&1&&(t(0,"button",42),m(1,"i",43),a(2," Searching ..."),e())}function fL(i,s){i&1&&(m(0,"i",44),a(1," We are fetching the data, please wait. "))}function uL(i,s){if(i&1){let o=U();t(0,"button",59),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",60),a(2,"Download to PDF "),e()}}function hL(i,s){i&1&&(t(0,"button",61),m(1,"i",43),a(2,"Downloading "),e())}function SL(i,s){if(i&1){let o=U();t(0,"button",59),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",60),a(2,"Download to EXCEL "),e()}}function xL(i,s){i&1&&(t(0,"button",61),m(1,"i",43),a(2,"Downloading "),e())}var gL=(i,s)=>s.id;function CL(i,s){if(i&1&&(t(0,"td"),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit;l(1),p(P(2,1,o.ward_no))}}function bL(i,s){i&1&&m(0,"td")}function vL(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),b(3,CL,3,3,"td")(4,bL,1,0),t(5,"td"),a(6),k(7,"uppercase"),e(),t(8,"td"),a(9),k(10,"uppercase"),e(),t(11,"td"),a(12),k(13,"uppercase"),e(),t(14,"td"),a(15),k(16,"uppercase"),e(),t(17,"td"),a(18),k(19,"uppercase"),e(),t(20,"td"),a(21),k(22,"uppercase"),e(),t(23,"td"),a(24),k(25,"uppercase"),e(),t(26,"td"),a(27),e(),t(28,"td"),a(29),k(30,"uppercase"),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(1),E(3,o.ward_no?3:4),l(3),p(P(7,11,o.category)),l(3),p(P(10,13,o.application_number)),l(3),p(P(13,15,r.appService.dateFormat(o.application_date))),l(3),p(P(16,17,o.applicant_name)),l(3),p(P(19,19,o.spouse_or_father_name)),l(3),p(P(22,21,o.social_category)),l(3),p(P(25,23,o.pwd_status)),l(3),p(o.alt_mobile_number),l(2),p(P(30,25,o.application_status))}}function EL(i,s){if(i&1&&(t(0,"table",62)(1,"thead",63)(2,"tr")(3,"th"),a(4,"SI#"),e(),t(5,"th"),a(6,"WARD NO."),e(),t(7,"th"),a(8,"CATEGORY"),e(),t(9,"th"),a(10,"APPLICATION NO."),e(),t(11,"th"),a(12,"APPLICATION DATE"),e(),t(13,"th"),a(14,"APPLICANT NAME"),e(),t(15,"th"),a(16,"FATHER/HUSBAND NAME"),e(),t(17,"th"),a(18,"SOCIAL CATEGORY"),e(),t(19,"th"),a(20,"PWD"),e(),t(21,"th"),a(22,"MOBILE NO."),e(),t(23,"th"),a(24,"APPLICATION STATUS"),e()()(),t(25,"tbody"),F(26,vL,31,27,"tr",null,gL),e()()),i&2){let o=h(2);l(26),V(o.filteredWardUserStats)}}function wL(i,s){i&1&&(t(0,"h5",64),a(1,"No data available"),e())}function TL(i,s){i&1&&(t(0,"div",65),a(1,"Loading.. "),m(2,"i",66),e())}function LL(i,s){i&1&&(t(0,"span"),m(1,"i",44),a(2," Loading..."),e())}function IL(i,s){i&1&&(t(0,"span"),a(1,"Load More"),e())}function yL(i,s){if(i&1){let o=U();t(0,"div",67)(1,"button",68),L("click",function(){D(o);let r=h(2);return A(r.loadMore())}),b(2,LL,3,0,"span",69)(3,IL,2,0,"span",69),e()()}if(i&2){let o=h(2);l(2),T("ngIf",o.isLoadMoreInProgress),l(1),T("ngIf",!o.isLoadMoreInProgress)}}function kL(i,s){if(i&1){let o=U();t(0,"div",34)(1,"div",45)(2,"h5",46),a(3," Number of records found : "),t(4,"span",47),a(5),e()()(),t(6,"div",48)(7,"div",49)(8,"input",50),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(9,"i",51),e(),t(10,"div",52),b(11,uL,3,0,"button",53)(12,hL,3,0),e(),t(13,"div",54),b(14,SL,3,0,"button",53)(15,xL,3,0),e()()(),t(16,"div",55),b(17,EL,28,0,"table",56)(18,wL,2,0)(19,TL,3,0,"div",57),e(),b(20,yL,4,2,"div",58)}if(i&2){let o=h();l(5),p(o.count),l(3),T("ngModel",o.searchTerm),l(3),E(11,o.isExportInProgress?12:11),l(3),E(14,o.isExportInProgressExcel?15:14),l(3),E(17,o.filteredWardUserStats&&o.filteredWardUserStats.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),l(2),E(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),l(1),T("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var Ir=(()=>{let s=class s{constructor(n,r,c,f,d,C,g,_){this.route=n,this.router=r,this.formService=c,this.appService=f,this.httpClient=d,this.toastService=C,this.authService=g,this.masterDataService=_,this.isStatsLoading=!1,this.userStats=[],this.ulb_id="",this.ward_id="",this.village_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.limit=this.appService.loadmorelimit,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.count=0,this.searchForm=new kt({a_category:new nt(""),social_category:new nt(""),pwd_status:new nt(""),submit_date:new nt(""),a_status:new nt("")})}ngOnInit(){this.route.params.subscribe(n=>{this.district_id=n.district_id,this.ulb_id=n.ulb_id,this.ward_id=n.id}),this.route.queryParams.subscribe(n=>{this.ekyc_status=n.ekyc_status,this.installment=n.installment,this.fetchuserStats(this.ward_id)})}fetchuserStats(n,r=!1){this.isStatsLoading=!0;let c=new st;c=c.set("ward_id",n),c=c.set("offset",this.offset),c=c.set("limit",this.limit),this.ekyc_status!==void 0&&(c=c.set("ekyc_status",this.ekyc_status.toString())),this.installment!==void 0&&(c=c.set("installment",this.installment.toString()));let f=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:c,headers:f}).subscribe(d=>{this.isStatsLoading=!1,this.count=d.count,d.data&&d.data.length>0?(this.application_list=this.application_list.concat(d.data),this.offset+=d.data.length,this.hasMoreRecords=d.data.length===this.limit):this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)},d=>{this.isStatsLoading=!1,this.application_list=[],this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)})}get filteredWardUserStats(){if(!this.searchTerm)return this.application_list;let n=this.searchTerm.toLowerCase();return this.application_list.filter(r=>r.ward_no?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.category?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.application_number?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_date).toLowerCase().includes(this.searchTerm.toLowerCase())||r.applicant_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.spouse_or_father_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.dob).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.social_category).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.pwd_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.alt_mobile_number).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.payment_status).toLowerCase().includes(this.searchTerm.toLowerCase()))}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status,_=new st;r&&(_=_.set("ward_id",r)),c&&(_=_.set("category",c)),f&&(_=_.set("social_category",f)),d&&(_=_.set("pwd_status",d)),g&&(_=_.set("application_status",g)),_=_.set("offset",this.offset),_=_.set("limit",this.limit),this.ekyc_status!==void 0&&(_=_.set("ekyc_status",this.ekyc_status.toString())),this.installment!==void 0&&(_=_.set("installment",this.installment.toString()));let v=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:_,headers:v}).subscribe(S=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=S.count,S.data&&S.data.length>0?(this.application_list=this.application_list.concat(S.data),this.offset+=S.data.length,this.hasMoreRecords=S.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},S=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}exportToExcel(){let n=new st,r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;r&&(n=n.set("ward_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),g&&(n=n.set("application_status",g)),n=n.set("export_all","1"),this.ekyc_status!==void 0&&(n=n.set("ekyc_status",this.ekyc_status.toString())),this.installment!==void 0&&(n=n.set("installment",this.installment.toString()));let _=new rt({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgressExcel=!1;let S=v.data.map((y,B)=>({"SI#":B+1,DISTRICT:y.district_name?y.district_name.toUpperCase():"",ULB:y.ulb_name?y.ulb_name.toUpperCase():"","WARD NO.":y.ward_no?y.ward_no.toUpperCase():"",CATEGORY:y.category.toUpperCase(),"APPLICATION NO.":y.application_number.toUpperCase(),"APPLICATION DATE":this.appService.dateFormat(y.application_date),"APPLICANT NAME":y.applicant_name.toUpperCase(),"FATHER/HUSBAND NAME":y.spouse_or_father_name.toUpperCase(),"SOCIAL CATEGORY":y.social_category.toUpperCase(),PWD:y.pwd_status.toUpperCase(),"MOBILE NO.":y.alt_mobile_number,"APPLICATION STATUS":y.application_status.toUpperCase()})),w=N.json_to_sheet(S),u=N.book_new();N.book_append_sheet(u,w,"Applications");let I=Z(u,{bookType:"xlsx",type:"array"}),R=new Date,z=R.toLocaleDateString("en-GB").split("/").reverse().join("-"),at=R.toLocaleTimeString("en-GB").replace(/:/g,"-"),ct=this.ekyc_status==1?`ekyc_complete_status_reports_${z}_${at}.xlsx`:`ekyc_pending_application_status_reports_${z}_${at}.xlsx`,lt=new Blob([I],{type:"application/octet-stream"}),O=document.createElement("a"),et=window.URL.createObjectURL(lt);O.href=et,O.download=ct,O.click(),window.URL.revokeObjectURL(et)},v=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",v)})}exportToPDF(){Wi.default.vfs=Lr.default.pdfMake.vfs;let n=new st,r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;r&&(n=n.set("ward_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),g&&(n=n.set("application_status",g)),n=n.set("export_all","1"),this.ekyc_status!==void 0&&(n=n.set("ekyc_status",this.ekyc_status.toString())),this.installment!==void 0&&(n=n.set("installment",this.installment.toString()));let _=new rt({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgress=!1;let S=v.data[0]||{},w=(S.district_name||"N/A").toUpperCase(),u=(S.block_name||S.ulb_name||"N/A").toUpperCase(),I=(S.gp_name||S.ward_no||"N/A").toUpperCase(),R=[[{text:"SI#",fontSize:10},{text:"CATEGORY",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICATION DATE.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"SOCIAL CATEGORY",fontSize:10},{text:"PWD",fontSize:10},{text:"MOBILE NO",fontSize:10},{text:"APPLICATION STATUS",fontSize:10}]];v.data.forEach((W,It)=>{R.push([{text:(It+1).toString().toUpperCase(),fontSize:9},{text:(W.category||"").toUpperCase(),fontSize:9},{text:(W.application_number||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(W.application_date)||"",fontSize:9},{text:(W.applicant_name||"").toUpperCase(),fontSize:9},{text:(W.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:(W.social_category||"").toUpperCase(),fontSize:9},{text:(W.pwd_status||"").toUpperCase(),fontSize:9},{text:(W.alt_mobile_number||"").toUpperCase(),fontSize:9},{text:(W.application_status||"").toUpperCase(),fontSize:9}])});let z=new Date,at=`Timestamp: ${z.toLocaleDateString()}, ${z.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,ct=this.ekyc_status==1?"DETAILED REPORT - eKYC COMPLETED":"DETAILED REPORT - eKYC PENDING",lt={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${w} > ULB: ${u} > WARD: ${I}`,style:"breadcrumb",margin:[0,0,0,10]},{text:ct,style:"header"},{table:{headerRows:1,body:R,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]},layout:{fillColor:function(W){return W===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:at,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},O=new Date,et=O.toLocaleDateString("en-GB").split("/").reverse().join("-"),y=O.toLocaleTimeString("en-GB").replace(/:/g,"-"),B=this.ekyc_status==1?`ekyc_complete_application_status_reports_${et}_${y}.pdf`:`ekyc_pending_application_status_reports_${et}_${y}.pdf`;Wi.default.createPdf(lt).download(B)},v=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",v)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(Ot),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-ekycstat-ward-user-list"]],decls:68,vars:6,consts:[[1,"container-fluid","drilldown-reports"],[1,"d-flex","justify-content-between","w-100","mb-3"],["style","color: #fd7b03;",4,"ngIf"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],["class","row mb-2"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-2"],[1,"col-md-3"],["for","a_category",1,"fw-bold"],["formControlName","a_category","id","a_category",1,"form-select","my-2"],["value",""],["value","1"],["value","0"],["for","social_category",1,"fw-bold"],["formControlName","social_category","id","social_category",1,"form-select","my-2"],["value","2"],["value","3"],["value","4"],["for","a_status",1,"fw-bold"],["formControlName","a_status","id","a_status",1,"form-select","my-2"],["value","7"],["for","pwd_status",1,"fw-bold"],["formControlName","pwd_status","id","pwd_status",1,"form-select","my-2"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[2,"color","#fd7b03"],[1,"row","mb-2"],[1,"col-md-7"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"fa","fa-spinner","fa-spin"],[1,"col-md-5"],[1,"card-title"],["id","recordCount"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports detail"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports","detail"],[1,"text-light",2,"background-color","#fd7b03"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"],[4,"ngIf"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),b(2,cL,2,0,"h4",2)(3,dL,2,0,"h4",2),t(4,"div",3)(5,"a",4),L("click",function(){return c.appService.goBack()}),t(6,"button",5),m(7,"i",6),a(8," Back"),e()()()(),b(9,pL,10,3,"div",7),t(10,"div",8)(11,"form",9),L("ngSubmit",function(){return c.onSearch()}),t(12,"div",10)(13,"div",11)(14,"label",12),a(15," Category "),e(),t(16,"select",13)(17,"option",14),a(18,"Choose Category"),e(),t(19,"option",15),a(20,"NFSA"),e(),t(21,"option",16),a(22,"NON-NFSA"),e()()(),t(23,"div",11)(24,"label",17),a(25," Social Category "),e(),t(26,"select",18)(27,"option",14),a(28,"Choose Social Category"),e(),t(29,"option",15),a(30,"Un-Reserved"),e(),t(31,"option",19),a(32,"OBC"),e(),t(33,"option",20),a(34,"SC"),e(),t(35,"option",21),a(36,"ST"),e()()(),t(37,"div",11)(38,"label",22),a(39," Application Status "),e(),t(40,"select",23)(41,"option",14),a(42,"Choose Status"),e(),t(43,"option",24),a(44,"Under Process"),e(),t(45,"option",15),a(46,"Approved"),e(),t(47,"option",19),a(48,"Rejected"),e()()(),t(49,"div",11)(50,"label",25),a(51," PWD "),e(),t(52,"select",26)(53,"option",14),a(54,"Choose PWD Status"),e(),t(55,"option",15),a(56,"Yes "),e(),t(57,"option",16),a(58,"NO"),e()()()(),t(59,"div",27)(60,"div",28),b(61,mL,3,0,"button",29)(62,_L,3,0),e()()()(),t(63,"div",30)(64,"div",31)(65,"div",32),b(66,fL,2,0)(67,kL,21,7),e()()()()),r&2&&(l(2),T("ngIf",c.ekyc_status==1),l(1),T("ngIf",c.ekyc_status==0),l(6),E(9,c.filteredWardUserStats&&c.filteredWardUserStats.length>0?9:-1),l(2),T("formGroup",c.searchForm),l(50),E(61,c.isFormSearchInProgress?62:61),l(5),E(66,c.isStatsLoading?66:67))},dependencies:[ft,Pt,Nt,Rt,K,Ut,q,yt,J,Dt,At,it]});let i=s;return i})();var Mi=j(ut()),yr=j(ht());function PL(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function DL(i,s){if(i&1){let o=U();t(0,"button",22),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",23),a(2,"Download PDF "),e()}}function AL(i,s){i&1&&(t(0,"button",24),m(1,"i",25),a(2,"Downloading "),e())}function UL(i,s){if(i&1){let o=U();t(0,"button",22),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",23),a(2,"Download EXCEL "),e()}}function NL(i,s){i&1&&(t(0,"button",24),m(1,"i",25),a(2,"Downloading "),e())}var RL=(i,s)=>s.id,OL=i=>({installment:i});function BL(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",29),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),$t("routerLink","/department/portal/npci_failed/block-ulb-stats/",o.district_id,""),T("queryParams",pt(7,OL,r.installment)),l(1),p(P(6,5,o.district_name)),l(3),p(o==null?null:o.count_dbt_not_enabled)}}function WL(i,s){if(i&1&&(t(0,"table",26)(1,"thead",27)(2,"tr")(3,"th"),a(4,"Sl.#"),e(),t(5,"th"),a(6,"DISTRICT"),e(),t(7,"th"),a(8,"DBT Not Enabled"),e()()(),t(9,"tbody",28),F(10,BL,9,9,"tr",null,RL),e()()),i&2){let o=h(2);l(10),V(o.filteredDistrictStats)}}function ML(i,s){i&1&&a(0," No Data Found ")}function FL(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - DBT Not Enabled"),e()(),t(4,"div",13)(5,"div",14)(6,"input",15),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(7,"i",16),e(),t(8,"div",17),b(9,DL,3,0,"button",18)(10,AL,3,0),e(),t(11,"div",19),b(12,UL,3,0,"button",18)(13,NL,3,0),e()()(),t(14,"div",20),b(15,WL,12,0,"table",21)(16,ML,1,0),e()}if(i&2){let o=h();l(6),T("ngModel",o.searchTerm),l(3),E(9,o.isExportInProgress?10:9),l(3),E(12,o.isExportInProgressExcel?13:12),l(3),E(15,o.filteredDistrictStats&&o.filteredDistrictStats.length>0?15:16)}}var kr=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.router=n,this.route=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.districtStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment,this.card_name=n.card_name,this.fetchDistrictStats()})}fetchDistrictStats(){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?npci_failed=2&installment=${this.installment}&card_name=${this.card_name}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isStatsLoading=!1,this.districtStats=n.data},n=>{this.isStatsLoading=!1,this.districtStats=[]})}get filteredDistrictStats(){return this.searchTerm?this.districtStats.filter(n=>n.district_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.districtStats}exportToExcel(){this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?npci_failed=2&installment=${this.installment}&card_name=${this.card_name}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isExportInProgressExcel=!1;let r=n.data.map((I,R)=>({"SI#":R+1,DISTRICT:I.district_name.toUpperCase(),"DBT Not Enabled":I?.count_dbt_not_enabled})),c=N.json_to_sheet(r),f=N.book_new();N.book_append_sheet(f,c,"Applications");let d=Z(f,{bookType:"xlsx",type:"array"}),C=new Date,g=C.toLocaleDateString("en-GB").split("/").reverse().join("-"),_=C.toLocaleTimeString("en-GB").replace(/:/g,"-"),v=`npci_failed_district_drilldown_reports_${g}_${_}.xlsx`,S=new Blob([d],{type:"application/octet-stream"}),w=document.createElement("a"),u=window.URL.createObjectURL(S);w.href=u,w.download=v,w.click(),window.URL.revokeObjectURL(u)},n=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",n)})}exportToPDF(){Mi.default.vfs=yr.default.pdfMake.vfs,this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?npci_failed=2&installment=${this.installment}&card_name=${this.card_name}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isExportInProgress=!1;let r=[[{text:"SI#",fontSize:10},{text:"DISTRICT",fontSize:10},{text:"DBT Not Enabled",fontSize:10}]];n.data.forEach((S,w)=>{r.push([{text:(w+1).toString().toUpperCase(),fontSize:9},{text:(S.district_name||"").toUpperCase(),fontSize:9},{text:S?.count_dbt_not_enabled,fontSize:9}])});let c=new Date,f=`Timestamp: ${c.toLocaleDateString()}, ${c.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,d={pageOrientation:"landscape",pageSize:"A4",content:[{text:"DRILL-DOWN REPORT - NPCI-FAILED DISTRICT WISE",style:"header"},{table:{headerRows:1,body:r,widths:["20%","50%","30%"]},layout:{fillColor:function(S){return S===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:f,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},C=new Date,g=C.toLocaleDateString("en-GB").split("/").reverse().join("-"),_=C.toLocaleTimeString("en-GB").replace(/:/g,"-"),v=`npci_failed_district_drilldown_reports_${g}_${_}.pdf`;Mi.default.createPdf(d).download(v)},n=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",n)})}};s.\u0275fac=function(r){return new(r||s)(x(G),x(tt),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-nf-district-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,PL,2,0)(11,FL,17,4),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var Fi=j(ut()),Pr=j(ht());function VL(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function zL(i,s){if(i&1){let o=U();t(0,"button",25),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",26),a(2,"Download PDF "),e()}}function jL(i,s){i&1&&(t(0,"button",27),m(1,"i",28),a(2,"Downloading "),e())}function $L(i,s){if(i&1){let o=U();t(0,"button",25),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",26),a(2,"Download EXCEL "),e()}}function GL(i,s){i&1&&(t(0,"button",27),m(1,"i",28),a(2,"Downloading "),e())}var XL=(i,s)=>s.id,Dr=i=>({installment:i});function YL(i,s){if(i&1&&(t(0,"a",33),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit,n=h(3);Vt("routerLink","/department/portal/npci_failed/gp-stats/",o.district_id,"/",o.block_id,""),T("queryParams",pt(6,Dr,n.installment)),l(1),p(P(2,4,o.block_name))}}function HL(i,s){if(i&1&&(t(0,"a",33),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit,n=h(3);Vt("routerLink","/department/portal/npci_failed/ward-stats/",o.district_id,"/",o.ulb_id,""),T("queryParams",pt(6,Dr,n.installment)),l(1),p(P(2,4,o.ulb_name))}}function KL(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td"),b(4,YL,3,8,"a",32)(5,HL,3,8),e(),t(6,"td"),a(7),e()()),i&2){let o=s.$implicit,n=s.$index;l(2),p(n+1),l(2),E(4,o.block_id?4:5),l(3),p(o==null?null:o.applications_received)}}function qL(i,s){if(i&1&&(t(0,"table",29)(1,"thead",30)(2,"tr")(3,"th"),a(4,"Sl.#"),e(),t(5,"th"),a(6,"BLOCK/ULB"),e(),t(7,"th"),a(8,"DBT Not Enabled"),e()()(),t(9,"tbody",31),F(10,KL,8,3,"tr",null,XL),e()()),i&2){let o=h(2);l(10),V(o.filteredBlockStats)}}function JL(i,s){i&1&&a(0," No Data Found ")}function QL(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - DBT Not Enabled"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e()()()(),t(8,"div",16)(9,"div",17)(10,"input",18),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(11,"i",19),e(),t(12,"div",20),b(13,zL,3,0,"button",21)(14,jL,3,0),e(),t(15,"div",22),b(16,$L,3,0,"button",21)(17,GL,3,0),e()()(),t(18,"div",23),b(19,qL,12,0,"table",24)(20,JL,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredBlockStats[0].district_name),l(3),T("ngModel",o.searchTerm),l(3),E(13,o.isExportInProgress?14:13),l(3),E(16,o.isExportInProgressExcel?17:16),l(3),E(19,o.filteredBlockStats&&o.filteredBlockStats.length>0?19:20)}}var Ar=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.districtStats=[],this.district_id="",this.blockStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{let r=n.id;this.district_id=r,this.fetchblockStats(r)})}fetchblockStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/block-count?district_id=${n}&npci_failed=2&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.blockStats=r.data,this.fetchulbStats(n)},r=>{this.isStatsLoading=!1,this.blockStats=[]})}fetchulbStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/ulb-count?district_id=${n}&npci_failed=2&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.blockStats=[...this.blockStats,...r.data]},r=>{this.isStatsLoading=!1})}get filteredBlockStats(){return this.searchTerm?this.blockStats.filter(n=>n.block_name&&n.block_name.toLowerCase().includes(this.searchTerm.toLowerCase())||n.ulb_name&&n.ulb_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.blockStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.blockStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name,"BLOCK/ULB":(u.block_name||u.ulb_name).toUpperCase(),"DBT Not Enabled":u?.applications_received})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`npci_failed_block_ulb_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){Fi.default.vfs=Pr.default.pdfMake.vfs,this.isExportInProgress=!0;let r=((this.blockStats[0]||{}).district_name||"N/A").toUpperCase(),c=[[{text:"SI#",fontSize:10},{text:"BLOCK/ULB",fontSize:10},{text:"DBT Not Enabled",fontSize:10}]];this.blockStats.forEach((w,u)=>{c.push([{text:(u+1).toString().toUpperCase(),fontSize:9},{text:(w.block_name||w.ulb_name||"").toUpperCase(),fontSize:9},{text:w?.applications_received,fontSize:9}])});let f=new Date,d=`Timestamp: ${f.toLocaleDateString()}, ${f.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,C={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - NPCI-FAILED BLOCK-ULB WISE",style:"header"},{table:{headerRows:1,body:c,widths:["20%","50%","30%"]},layout:{fillColor:function(w){return w===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:d,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},g=new Date,_=g.toLocaleDateString("en-GB").split("/").reverse().join("-"),v=g.toLocaleTimeString("en-GB").replace(/:/g,"-"),S=`npci_failed_block_ulb_drilldown_reports_${_}_${v}.pdf`;Fi.default.createPdf(C).download(S,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-nf-block-ulb-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],[2,"font-size","14px"],["style","text-decoration: none",3,"routerLink","queryParams"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,VL,2,0)(11,QL,21,5),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var Vi=j(ut()),Ur=j(ht());function ZL(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function tI(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",27),a(2,"Download PDF "),e()}}function eI(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}function iI(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",27),a(2,"Download EXCEL "),e()}}function nI(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}var oI=(i,s)=>s.id,aI=i=>({installment:i});function rI(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",33),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),Mt("routerLink","/department/portal/npci_failed/village-stats/",o.district_id,"/",o.block_id,"/",o.gp_id,""),T("queryParams",pt(9,aI,r.installment)),l(1),p(P(6,7,o.gp_name)),l(3),p(o==null?null:o.applications_received)}}function sI(i,s){if(i&1&&(t(0,"table",30)(1,"thead",31)(2,"tr")(3,"th"),a(4,"Sl.#"),e(),t(5,"th"),a(6,"GRAM PANCHAYAT"),e(),t(7,"th"),a(8,"DBT Not Enabled"),e()()(),t(9,"tbody",32),F(10,rI,9,11,"tr",null,oI),e()()),i&2){let o=h(2);l(10),V(o.filteredGpStats)}}function lI(i,s){i&1&&a(0," No Data Found ")}function cI(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - DBT Not Enabled"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e(),t(8,"li",16),a(9),e()()()(),t(10,"div",17)(11,"div",18)(12,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(13,"i",20),e(),t(14,"div",21),b(15,tI,3,0,"button",22)(16,eI,3,0),e(),t(17,"div",23),b(18,iI,3,0,"button",22)(19,nI,3,0),e()()(),t(20,"div",24),b(21,sI,12,0,"table",25)(22,lI,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredGpStats[0].district_name),l(2),p(o.filteredGpStats[0].block_name),l(3),T("ngModel",o.searchTerm),l(3),E(15,o.isExportInProgress?16:15),l(3),E(18,o.isExportInProgressExcel?19:18),l(3),E(21,o.filteredGpStats&&o.filteredGpStats.length>0?21:22)}}var Nr=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.district_id="",this.gpStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.id,this.fetchgpStats(this.block_id)})}fetchgpStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/gp-count?block_id=${n}&npci_failed=2&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.gpStats=r.data},r=>{this.isStatsLoading=!1,this.gpStats=[]})}get filteredGpStats(){return this.searchTerm?this.gpStats.filter(n=>n.gp_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.gpStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.gpStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",BLOCK:u.block_name?u.block_name.toUpperCase():"",GP:u.gp_name?u.gp_name.toUpperCase():"","DBT Not Enabled":u?.applications_received})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`npci_failed_gp_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){Vi.default.vfs=Ur.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.gpStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=[[{text:"SI#",fontSize:10},{text:"GP",fontSize:10},{text:"DBT Not Enabled",fontSize:10}]];this.gpStats.forEach((u,I)=>{f.push([{text:(I+1).toString().toUpperCase(),fontSize:9},{text:(u.gp_name||"").toUpperCase(),fontSize:9},{text:u?.applications_received,fontSize:9}])});let d=new Date,C=`Timestamp: ${d.toLocaleDateString()}, ${d.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,g={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK: ${c}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - NPCI-FAILED GP WISE",style:"header"},{table:{headerRows:1,body:f,widths:["20%","50%","30%"]},layout:{fillColor:function(u){return u===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:C,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},_=new Date,v=_.toLocaleDateString("en-GB").split("/").reverse().join("-"),S=_.toLocaleTimeString("en-GB").replace(/:/g,"-"),w=`npci_failed_gp_drilldown_reports_${v}_${S}.pdf`;Vi.default.createPdf(g).download(w,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-nf-gp-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,ZL,2,0)(11,cI,23,6),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var zi=j(ut()),Rr=j(ht());function dI(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function pI(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",27),a(2,"Download PDF "),e()}}function mI(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}function _I(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",27),a(2,"Download EXCEL "),e()}}function fI(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}var uI=(i,s)=>s.id,hI=i=>({installment:i});function SI(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",34),a(5),e()(),t(6,"td"),a(7),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),Mt("routerLink","/department/portal/npci_failed/ward-user-list/",o.district_id,"/",o.ulb_id,"/",o.ward_id,""),T("queryParams",pt(7,hI,r.installment)),l(1),p(o.ward_no),l(2),p(o==null?null:o.applications_received)}}function xI(i,s){if(i&1&&(t(0,"table",30)(1,"thead",31)(2,"tr")(3,"th",32),a(4,"Sl.#"),e(),t(5,"th",32),a(6,"WARD"),e(),t(7,"th"),a(8,"DBT Not Enabled"),e()()(),t(9,"tbody",33),F(10,SI,8,9,"tr",null,uI),e()()),i&2){let o=h(2);l(10),V(o.filteredWardStats)}}function gI(i,s){i&1&&a(0," No Data Found ")}function CI(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - DBT Not Enabled"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e(),t(8,"li",16),a(9),e()()()(),t(10,"div",17)(11,"div",18)(12,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(13,"i",20),e(),t(14,"div",21),b(15,pI,3,0,"button",22)(16,mI,3,0),e(),t(17,"div",23),b(18,_I,3,0,"button",22)(19,fI,3,0),e()()(),t(20,"div",24),b(21,xI,12,0,"table",25)(22,gI,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredWardStats[0].district_name),l(2),p(o.filteredWardStats[0].ulb_name),l(3),T("ngModel",o.searchTerm),l(3),E(15,o.isExportInProgress?16:15),l(3),E(18,o.isExportInProgressExcel?19:18),l(3),E(21,o.filteredWardStats&&o.filteredWardStats.length>0?21:22)}}var Or=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.district_id="",this.wardStats=[],this.ulb_id="",this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.ulb_id=n.id,this.fetchWardStats(this.ulb_id)})}fetchWardStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/ward-count?ulb_id=${n}&npci_failed=2&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.wardStats=r.data},r=>{this.isStatsLoading=!1,this.wardStats=[]})}get filteredWardStats(){return this.searchTerm?this.wardStats.filter(n=>n.ward_no.toLowerCase().includes(this.searchTerm.toLowerCase())):this.wardStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.wardStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",ULB:u.ulb_name?u.ulb_name.toUpperCase():"","WARD NO.":u.ward_no?u.ward_no.toUpperCase():"","DBT Not Enabled":u?.applications_received})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`npci_failed_ward_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){zi.default.vfs=Rr.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.wardStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=[[{text:"SI#",fontSize:10},{text:"WARD NO.",fontSize:10},{text:"DBT Not Enabled",fontSize:10}]];this.wardStats.forEach((u,I)=>{f.push([{text:(I+1).toString().toUpperCase(),fontSize:9},{text:(u.ward_no||"").toUpperCase(),fontSize:9},{text:u?.applications_received,fontSize:9}])});let d=new Date,C=`Timestamp: ${d.toLocaleDateString()}, ${d.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,g={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK/ULB: ${c}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - NPCI-FAILED WARD WISE",style:"header"},{table:{headerRows:1,body:f,widths:["20%","50%","30%"]},layout:{fillColor:function(u){return u===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:C,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},_=new Date,v=_.toLocaleDateString("en-GB").split("/").reverse().join("-"),S=_.toLocaleTimeString("en-GB").replace(/:/g,"-"),w=`npci_failed_ward_drilldown_reports_${v}_${S}.pdf`;zi.default.createPdf(g).download(w,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-nf-ward-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,dI,2,0)(11,CI,23,6),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J]});let i=s;return i})();var ji=j(ut()),Br=j(ht());function bI(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function vI(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",27),a(2,"Download PDF "),e()}}function EI(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}function wI(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",27),a(2,"Download EXCEL "),e()}}function TI(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}var LI=(i,s)=>s.id,II=i=>({installment:i});function yI(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",33),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),Gt("routerLink","/department/portal/npci_failed/village-user-list/",o.district_id,"/",o.block_id,"/",o.gp_id,"/",o.village_id,""),T("queryParams",pt(10,II,r.installment)),l(1),p(P(6,8,o.village_name)),l(3),p(o==null?null:o.applications_received)}}function kI(i,s){if(i&1&&(t(0,"table",30)(1,"thead",31)(2,"tr")(3,"th"),a(4,"Sl.#"),e(),t(5,"th"),a(6,"VILLAGE"),e(),t(7,"th"),a(8,"DBT Not Enabled"),e()()(),t(9,"tbody",32),F(10,yI,9,12,"tr",null,LI),e()()),i&2){let o=h(2);l(10),V(o.filteredVillageStats)}}function PI(i,s){i&1&&a(0," No Data Found ")}function DI(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - DBT Not Enabled"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e(),t(8,"li",15),a(9),e(),t(10,"li",16),a(11),e()()()(),t(12,"div",17)(13,"div",18)(14,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(15,"i",20),e(),t(16,"div",21),b(17,vI,3,0,"button",22)(18,EI,3,0),e(),t(19,"div",23),b(20,wI,3,0,"button",22)(21,TI,3,0),e()()(),t(22,"div",24),b(23,kI,12,0,"table",25)(24,PI,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredVillageStats[0].district_name),l(2),p(o.filteredVillageStats[0].block_name),l(2),p(o.filteredVillageStats[0].gp_name),l(3),T("ngModel",o.searchTerm),l(3),E(17,o.isExportInProgress?18:17),l(3),E(20,o.isExportInProgressExcel?21:20),l(3),E(23,o.filteredVillageStats&&o.filteredVillageStats.length>0?23:24)}}var Wr=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.gp_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.block_id,this.gp_id=n.id,this.fetchvillageStats(this.gp_id)})}fetchvillageStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/village-count?gp_id=${n}&npci_failed=2&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.villageStats=r.data},r=>{this.isStatsLoading=!1,this.villageStats=[]})}get filteredVillageStats(){return this.searchTerm?this.villageStats.filter(n=>n.village_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.villageStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.villageStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",BLOCK:u.block_name?u.block_name.toUpperCase():"",GP:u.gp_name?u.gp_name.toUpperCase():"",VILLAGE:u.village_name?u.village_name.toUpperCase():"","DBT Not Enabled":u?.applications_received})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`npci_failed_village_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){ji.default.vfs=Br.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.villageStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=(n.gp_name||n.ward_no||"N/A").toUpperCase(),d=[[{text:"SI#",fontSize:10},{text:"VILLAGE",fontSize:10},{text:"DBT Not Enabled",fontSize:10}]];this.villageStats.forEach((I,R)=>{d.push([{text:(R+1).toString().toUpperCase(),fontSize:9},{text:(I.village_name||"").toUpperCase(),fontSize:9},{text:I?.applications_received,fontSize:9}])});let C=new Date,g=`Timestamp: ${C.toLocaleDateString()}, ${C.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,_={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK: ${c} > GP:${f}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - NPCI-FAILED VILLAGE WISE",style:"header"},{table:{headerRows:1,body:d,widths:["20%","50%","30%"]},layout:{fillColor:function(I){return I===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:g,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},v=new Date,S=v.toLocaleDateString("en-GB").split("/").reverse().join("-"),w=v.toLocaleTimeString("en-GB").replace(/:/g,"-"),u=`npci_failed_village_drilldown_reports_${S}_${w}.pdf`;ji.default.createPdf(_).download(u,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-nf-village-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,bI,2,0)(11,DI,25,7),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var $i=j(ut()),Mr=j(ht());function AI(i,s){if(i&1&&(t(0,"div",30)(1,"div",31)(2,"nav",32)(3,"ol",33)(4,"li",34),a(5),e(),t(6,"li",34),a(7),e(),t(8,"li",34),a(9),e(),t(10,"li",35),a(11),e()()()()()),i&2){let o=h();l(5),p(o.filteredVillageUserStats[0].district_name),l(2),p(o.filteredVillageUserStats[0].block_name),l(2),p(o.filteredVillageUserStats[0].gp_name),l(2),p(o.filteredVillageUserStats[0].village_name)}}function UI(i,s){i&1&&(t(0,"button",36),m(1,"i",37),a(2,"Search "),e())}function NI(i,s){i&1&&(t(0,"button",38),m(1,"i",39),a(2," Searching ..."),e())}function RI(i,s){i&1&&(m(0,"i",40),a(1," We are fetching the data, please wait. "))}function OI(i,s){if(i&1){let o=U();t(0,"button",54),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",55),a(2,"Download to PDF "),e()}}function BI(i,s){i&1&&(t(0,"button",56),m(1,"i",39),a(2,"Downloading "),e())}function WI(i,s){if(i&1){let o=U();t(0,"button",54),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",55),a(2,"Download to EXCEL "),e()}}function MI(i,s){i&1&&(t(0,"button",56),m(1,"i",39),a(2,"Downloading "),e())}var FI=(i,s)=>s.id;function VI(i,s){if(i&1&&(t(0,"td"),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit;l(1),p(P(2,1,o.village_name))}}function zI(i,s){i&1&&m(0,"td")}function jI(i,s){i&1&&(t(0,"td"),a(1,"DBT Not Enabled"),e())}function $I(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),b(3,VI,3,3,"td")(4,zI,1,0),t(5,"td"),a(6),k(7,"uppercase"),e(),t(8,"td"),a(9),k(10,"uppercase"),e(),t(11,"td"),a(12),k(13,"uppercase"),e(),t(14,"td"),a(15),k(16,"uppercase"),e(),t(17,"td"),a(18),k(19,"uppercase"),e(),t(20,"td"),a(21),k(22,"uppercase"),e(),t(23,"td"),a(24),k(25,"uppercase"),e(),t(26,"td"),a(27),e(),b(28,jI,2,0,"td"),t(29,"td"),a(30),k(31,"uppercase"),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(1),E(3,o.village_name?3:4),l(3),p(P(7,12,o.category)),l(3),p(P(10,14,o.application_number)),l(3),p(P(13,16,r.appService.dateFormat(o.application_date))),l(3),p(P(16,18,o.applicant_name)),l(3),p(P(19,20,o.spouse_or_father_name)),l(3),p(P(22,22,o.social_category)),l(3),p(P(25,24,o.pwd_status)),l(3),p(o.alt_mobile_number),l(1),E(28,o.npci_status==2?28:-1),l(2),p(P(31,26,o.npci_remark))}}function GI(i,s){if(i&1&&(t(0,"table",57)(1,"thead",58)(2,"tr")(3,"th"),a(4,"SI#"),e(),t(5,"th"),a(6,"VILLAGE"),e(),t(7,"th"),a(8,"CATEGORY"),e(),t(9,"th"),a(10,"APPLICATION NO."),e(),t(11,"th"),a(12,"APPLICATION DATE"),e(),t(13,"th"),a(14,"APPLICANT NAME"),e(),t(15,"th"),a(16,"FATHER/HUSBAND NAME"),e(),t(17,"th"),a(18,"SOCIAL CATEGORY"),e(),t(19,"th"),a(20,"PWD"),e(),t(21,"th"),a(22,"MOBILE NO."),e(),t(23,"th"),a(24,"NPCI STATUS"),e(),t(25,"th"),a(26,"DBT Not Enabled REASON"),e()()(),t(27,"tbody"),F(28,$I,32,28,"tr",null,FI),e()()),i&2){let o=h(2);l(28),V(o.filteredVillageUserStats)}}function XI(i,s){i&1&&(t(0,"h5",59),a(1,"No data available"),e())}function YI(i,s){i&1&&(t(0,"div",60),a(1,"Loading.. "),m(2,"i",61),e())}function HI(i,s){i&1&&(t(0,"span"),m(1,"i",40),a(2," Loading..."),e())}function KI(i,s){i&1&&(t(0,"span"),a(1,"Load More"),e())}function qI(i,s){if(i&1){let o=U();t(0,"div",62)(1,"button",63),L("click",function(){D(o);let r=h(2);return A(r.loadMore())}),b(2,HI,3,0,"span",64)(3,KI,2,0,"span",64),e()()}if(i&2){let o=h(2);l(2),T("ngIf",o.isLoadMoreInProgress),l(1),T("ngIf",!o.isLoadMoreInProgress)}}function JI(i,s){if(i&1){let o=U();t(0,"div",30)(1,"div",41)(2,"h5",2),a(3," Number of records found : "),t(4,"span",42),a(5),e()()(),t(6,"div",43)(7,"div",44)(8,"input",45),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(9,"i",46),e(),t(10,"div",47),b(11,OI,3,0,"button",48)(12,BI,3,0),e(),t(13,"div",49),b(14,WI,3,0,"button",48)(15,MI,3,0),e()()(),t(16,"div",50),b(17,GI,30,0,"table",51)(18,XI,2,0)(19,YI,3,0,"div",52),e(),b(20,qI,4,2,"div",53)}if(i&2){let o=h();l(5),p(o.count),l(3),T("ngModel",o.searchTerm),l(3),E(11,o.isExportInProgress?12:11),l(3),E(14,o.isExportInProgressExcel?15:14),l(3),E(17,o.filteredVillageUserStats&&o.filteredVillageUserStats.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),l(2),E(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),l(1),T("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var Fr=(()=>{let s=class s{constructor(n,r,c,f,d,C,g,_){this.route=n,this.router=r,this.formService=c,this.appService=f,this.httpClient=d,this.toastService=C,this.authService=g,this.masterDataService=_,this.isStatsLoading=!1,this.userStats=[],this.block_id="",this.gp_id="",this.village_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.limit=this.appService.loadmorelimit,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.count=0,this.searchForm=new kt({a_category:new nt(""),social_category:new nt(""),pwd_status:new nt(""),submit_date:new nt(""),a_status:new nt("")})}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.block_id,this.gp_id=n.gp_id,this.village_id=n.id,this.fetchuserStats(this.village_id)})}fetchuserStats(n,r=!1){this.isStatsLoading=!0;let c=new st;c=c.set("gp_id",this.gp_id),c=c.set("village_id",n),c=c.set("offset",this.offset),c=c.set("limit",this.limit),c=c.set("npci_failed","2"),c=c.set("installment",this.installment);let f=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:c,headers:f}).subscribe(d=>{this.isStatsLoading=!1,this.count=d.count,d.data&&d.data.length>0?(this.application_list=this.application_list.concat(d.data),this.offset+=d.data.length,this.hasMoreRecords=d.data.length===this.limit):this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)},d=>{this.isStatsLoading=!1,this.application_list=[],this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)})}get filteredVillageUserStats(){if(!this.searchTerm)return this.application_list;let n=this.searchTerm.toLowerCase();return this.application_list.filter(r=>r.village_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.category?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.application_number?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_date).toLowerCase().includes(this.searchTerm.toLowerCase())||r.applicant_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.spouse_or_father_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.dob).toLowerCase().includes(this.searchTerm.toLowerCase())||r.social_category?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.pwd_status?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.alt_mobile_number?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.npci_remark?.toLowerCase().includes(this.searchTerm.toLowerCase()))}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status,_=new st;_=_.set("gp_id",this.gp_id),r&&(_=_.set("village_id",r)),c&&(_=_.set("category",c)),f&&(_=_.set("social_category",f)),d&&(_=_.set("pwd_status",d)),_=_.set("offset",this.offset),_=_.set("limit",this.limit),_=_.set("npci_failed","2"),_=_.set("installment",this.installment);let v=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:_,headers:v}).subscribe(S=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=S.count,S.data&&S.data.length>0?(this.application_list=this.application_list.concat(S.data),this.offset+=S.data.length,this.hasMoreRecords=S.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},S=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}exportToExcel(){let n=new st,r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;n=n.set("gp_id",this.gp_id),r&&(n=n.set("village_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),n=n.set("export_all","1"),n=n.set("npci_failed","2"),n=n.set("installment",this.installment);let _=new rt({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgressExcel=!1;let S=v.data.map((y,B)=>({"SI#":B+1,DISTRICT:y.district_name?y.district_name.toUpperCase():"",BLOCK:y.block_name?y.block_name.toUpperCase():"",GP:y.gp_name?y.gp_name.toUpperCase():"",VILLAGE:y.village_name?y.village_name.toUpperCase():"",CATEGORY:y.category.toUpperCase(),"APPLICATION NO.":y.application_number.toUpperCase(),"APPLICATION DATE":this.appService.dateFormat(y.application_date),"APPLICANT NAME":y.applicant_name.toUpperCase(),"FATHER/HUSBAND NAME":y.spouse_or_father_name.toUpperCase(),"SOCIAL CATEGORY":y.social_category.toUpperCase(),PWD:y.pwd_status.toUpperCase(),"MOBILE NO.":y.alt_mobile_number,"NPCI STATUS":y.npci_status=="2"?"DBT Not Enabled":"","DBT Not Enabled REASON":y.npci_remark.toUpperCase()})),w=N.json_to_sheet(S),u=N.book_new();N.book_append_sheet(u,w,"Applications");let I=Z(u,{bookType:"xlsx",type:"array"}),R=new Date,z=R.toLocaleDateString("en-GB").split("/").reverse().join("-"),at=R.toLocaleTimeString("en-GB").replace(/:/g,"-"),ct=`npci_faild__reports_${z}_${at}.xlsx`,lt=new Blob([I],{type:"application/octet-stream"}),O=document.createElement("a"),et=window.URL.createObjectURL(lt);O.href=et,O.download=ct,O.click(),window.URL.revokeObjectURL(et)},v=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",v)})}exportToPDF(){$i.default.vfs=Mr.default.pdfMake.vfs;let n=new st,r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;n=n.set("gp_id",this.gp_id),r&&(n=n.set("village_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),n=n.set("export_all","1"),n=n.set("npci_failed","2"),n=n.set("installment",this.installment);let _=new rt({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgress=!1;let S=v.data[0]||{},w=(S.district_name||"N/A").toUpperCase(),u=(S.block_name||S.ulb_name||"N/A").toUpperCase(),I=(S.gp_name||S.ward_no||"N/A").toUpperCase(),R=(S.village_name||"").toUpperCase(),z=[[{text:"SI#",fontSize:10},{text:"CATEGORY",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICATION DATE.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"SOCIAL CATEGORY",fontSize:10},{text:"PWD",fontSize:10},{text:"MOBILE NO",fontSize:10},{text:"NPCI STATUS",fontSize:10},{text:"DBT Not Enabled REASON",fontSize:10}]];v.data.forEach((W,It)=>{z.push([{text:(It+1).toString().toUpperCase(),fontSize:9},{text:(W.category||"").toUpperCase(),fontSize:9},{text:(W.application_number||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(W.application_date)||"",fontSize:9},{text:(W.applicant_name||"").toUpperCase(),fontSize:9},{text:(W.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:(W.social_category||"").toUpperCase(),fontSize:9},{text:(W.pwd_status||"").toUpperCase(),fontSize:9},{text:(W.alt_mobile_number||"").toUpperCase(),fontSize:9},{text:W.npci_status=="2"?"DBT Not Enabled":"",fontSize:9},{text:(W.npci_remark||"").toUpperCase(),fontSize:9}])});let at=new Date,ct=`Timestamp: ${at.toLocaleDateString()}, ${at.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,lt={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${w} > BLOCK: ${u} > GP: ${I} >VILLAGE: ${R}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DETAILED REPORT - DBT Not Enabled",style:"header"},{table:{headerRows:1,body:z,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]},layout:{fillColor:function(W){return W===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:ct,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},O=new Date,et=O.toLocaleDateString("en-GB").split("/").reverse().join("-"),y=O.toLocaleTimeString("en-GB").replace(/:/g,"-"),B=`npci_faild_reports_${et}_${y}.pdf`;$i.default.createPdf(lt).download(B)},v=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",v)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(Ot),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-nf-village-user-list"]],decls:56,vars:4,consts:[[1,"container-fluid","drilldown-reports"],[1,"d-flex","justify-content-between","w-100","mb-3"],[1,"card-title"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],["class","row mb-2"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-2"],[1,"col-md-4"],["for","a_category",1,"fw-bold"],["id","a_category","formControlName","a_category",1,"form-select","my-2"],["value",""],["value","1"],["value","0"],["for","social_category",1,"fw-bold"],["formControlName","social_category","id","social_category",1,"form-select","my-2"],["value","2"],["value","3"],["value","4"],["for","pwd_status",1,"fw-bold"],["formControlName","pwd_status","id","pwd_status",1,"form-select","my-2"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[1,"row","mb-2"],[1,"col-md-7"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"fa","fa-spinner","fa-spin"],[1,"col-md-5"],["id","recordCount"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports detail"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports","detail"],[1,"text-light",2,"background-color","#fd7b03"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"],[4,"ngIf"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1)(2,"h4",2),a(3,"Detailed Report - DBT Not Enabled"),e(),t(4,"div",3)(5,"a",4),L("click",function(){return c.appService.goBack()}),t(6,"button",5),m(7,"i",6),a(8," Back"),e()()()(),b(9,AI,12,4,"div",7),t(10,"div",8)(11,"form",9),L("ngSubmit",function(){return c.onSearch()}),t(12,"div",10)(13,"div",11)(14,"label",12),a(15," Category "),e(),t(16,"select",13)(17,"option",14),a(18,"Choose Category"),e(),t(19,"option",15),a(20,"NFSA"),e(),t(21,"option",16),a(22,"NON-NFSA"),e()()(),t(23,"div",11)(24,"label",17),a(25," Social Category "),e(),t(26,"select",18)(27,"option",14),a(28,"Choose Social Category"),e(),t(29,"option",15),a(30,"Un-Reserved"),e(),t(31,"option",19),a(32,"OBC"),e(),t(33,"option",20),a(34,"SC"),e(),t(35,"option",21),a(36,"ST"),e()()(),t(37,"div",11)(38,"label",22),a(39," PWD "),e(),t(40,"select",23)(41,"option",14),a(42,"Choose PWD Status"),e(),t(43,"option",15),a(44,"Yes "),e(),t(45,"option",16),a(46,"NO"),e()()()(),t(47,"div",24)(48,"div",25),b(49,UI,3,0,"button",26)(50,NI,3,0),e()()()(),t(51,"div",27)(52,"div",28)(53,"div",29),b(54,RI,2,0)(55,JI,21,7),e()()()()),r&2&&(l(9),E(9,c.filteredVillageUserStats&&c.filteredVillageUserStats.length>0?9:-1),l(2),T("formGroup",c.searchForm),l(38),E(49,c.isFormSearchInProgress?50:49),l(5),E(54,c.isStatsLoading?54:55))},dependencies:[ft,Pt,Nt,Rt,K,Ut,q,yt,J,Dt,At,it]});let i=s;return i})();var Gi=j(ut()),Vr=j(ht());function QI(i,s){if(i&1&&(t(0,"div",30)(1,"div",31)(2,"nav",32)(3,"ol",33)(4,"li",34),a(5),e(),t(6,"li",34),a(7),e(),t(8,"li",35),a(9),e()()()()()),i&2){let o=h();l(5),p(o.filteredWardUserStats[0].district_name),l(2),p(o.filteredWardUserStats[0].ulb_name),l(2),p(o.filteredWardUserStats[0].ward_no)}}function ZI(i,s){i&1&&(t(0,"button",36),m(1,"i",37),a(2,"Search "),e())}function ty(i,s){i&1&&(t(0,"button",38),m(1,"i",39),a(2," Searching ..."),e())}function ey(i,s){i&1&&(m(0,"i",40),a(1," We are fetching the data, please wait. "))}function iy(i,s){if(i&1){let o=U();t(0,"button",54),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",55),a(2,"Download to PDF "),e()}}function ny(i,s){i&1&&(t(0,"button",56),m(1,"i",39),a(2,"Downloading "),e())}function oy(i,s){if(i&1){let o=U();t(0,"button",54),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",55),a(2,"Download to EXCEL "),e()}}function ay(i,s){i&1&&(t(0,"button",56),m(1,"i",39),a(2,"Downloading "),e())}var ry=(i,s)=>s.id;function sy(i,s){if(i&1&&(t(0,"td"),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit;l(1),p(P(2,1,o.ward_no))}}function ly(i,s){i&1&&m(0,"td")}function cy(i,s){i&1&&(t(0,"td"),a(1,"DBT Not Enabled"),e())}function dy(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),b(3,sy,3,3,"td")(4,ly,1,0),t(5,"td"),a(6),k(7,"uppercase"),e(),t(8,"td"),a(9),k(10,"uppercase"),e(),t(11,"td"),a(12),k(13,"uppercase"),e(),t(14,"td"),a(15),k(16,"uppercase"),e(),t(17,"td"),a(18),k(19,"uppercase"),e(),t(20,"td"),a(21),k(22,"uppercase"),e(),t(23,"td"),a(24),k(25,"uppercase"),e(),t(26,"td"),a(27),e(),b(28,cy,2,0,"td"),t(29,"td"),a(30),k(31,"uppercase"),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(1),E(3,o.ward_no?3:4),l(3),p(P(7,12,o.category)),l(3),p(P(10,14,o.application_number)),l(3),p(P(13,16,r.appService.dateFormat(o.application_date))),l(3),p(P(16,18,o.applicant_name)),l(3),p(P(19,20,o.spouse_or_father_name)),l(3),p(P(22,22,o.social_category)),l(3),p(P(25,24,o.pwd_status)),l(3),p(o.alt_mobile_number),l(1),E(28,o.npci_status==2?28:-1),l(2),p(P(31,26,o.npci_remark))}}function py(i,s){if(i&1&&(t(0,"table",57)(1,"thead",58)(2,"tr")(3,"th"),a(4,"SI#"),e(),t(5,"th"),a(6,"WARD NO."),e(),t(7,"th"),a(8,"CATEGORY"),e(),t(9,"th"),a(10,"APPLICATION NO."),e(),t(11,"th"),a(12,"APPLICATION DATE"),e(),t(13,"th"),a(14,"APPLICANT NAME"),e(),t(15,"th"),a(16,"FATHER/HUSBAND NAME"),e(),t(17,"th"),a(18,"SOCIAL CATEGORY"),e(),t(19,"th"),a(20,"PWD"),e(),t(21,"th"),a(22,"MOBILE NO."),e(),t(23,"th"),a(24,"NPCI STATUS"),e(),t(25,"th"),a(26,"DBT Not Enabled REASON"),e()()(),t(27,"tbody"),F(28,dy,32,28,"tr",null,ry),e()()),i&2){let o=h(2);l(28),V(o.filteredWardUserStats)}}function my(i,s){i&1&&(t(0,"h5",59),a(1,"No data available"),e())}function _y(i,s){i&1&&(t(0,"div",60),a(1,"Loading.. "),m(2,"i",61),e())}function fy(i,s){i&1&&(t(0,"span"),m(1,"i",40),a(2," Loading..."),e())}function uy(i,s){i&1&&(t(0,"span"),a(1,"Load More"),e())}function hy(i,s){if(i&1){let o=U();t(0,"div",62)(1,"button",63),L("click",function(){D(o);let r=h(2);return A(r.loadMore())}),b(2,fy,3,0,"span",64)(3,uy,2,0,"span",64),e()()}if(i&2){let o=h(2);l(2),T("ngIf",o.isLoadMoreInProgress),l(1),T("ngIf",!o.isLoadMoreInProgress)}}function Sy(i,s){if(i&1){let o=U();t(0,"div",30)(1,"div",41)(2,"h5",2),a(3," Number of records found : "),t(4,"span",42),a(5),e()()(),t(6,"div",43)(7,"div",44)(8,"input",45),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(9,"i",46),e(),t(10,"div",47),b(11,iy,3,0,"button",48)(12,ny,3,0),e(),t(13,"div",49),b(14,oy,3,0,"button",48)(15,ay,3,0),e()()(),t(16,"div",50),b(17,py,30,0,"table",51)(18,my,2,0)(19,_y,3,0,"div",52),e(),b(20,hy,4,2,"div",53)}if(i&2){let o=h();l(5),p(o.count),l(3),T("ngModel",o.searchTerm),l(3),E(11,o.isExportInProgress?12:11),l(3),E(14,o.isExportInProgressExcel?15:14),l(3),E(17,o.filteredWardUserStats&&o.filteredWardUserStats.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),l(2),E(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),l(1),T("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var zr=(()=>{let s=class s{constructor(n,r,c,f,d,C,g,_){this.route=n,this.router=r,this.formService=c,this.appService=f,this.httpClient=d,this.toastService=C,this.authService=g,this.masterDataService=_,this.isStatsLoading=!1,this.userStats=[],this.ulb_id="",this.ward_id="",this.village_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.limit=this.appService.loadmorelimit,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.count=0,this.searchForm=new kt({a_category:new nt(""),social_category:new nt(""),pwd_status:new nt(""),submit_date:new nt(""),a_status:new nt("")})}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.ulb_id=n.ulb_id,this.ward_id=n.id,this.fetchuserStats(this.ward_id)})}fetchuserStats(n,r=!1){this.isStatsLoading=!0;let c=new st;c=c.set("ward_id",n),c=c.set("offset",this.offset),c=c.set("limit",this.limit),c=c.set("npci_failed","2"),c=c.set("installment",this.installment);let f=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:c,headers:f}).subscribe(d=>{this.isStatsLoading=!1,this.count=d.count,d.data&&d.data.length>0?(this.application_list=this.application_list.concat(d.data),this.offset+=d.data.length,this.hasMoreRecords=d.data.length===this.limit):this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)},d=>{this.isStatsLoading=!1,this.application_list=[],this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)})}get filteredWardUserStats(){if(!this.searchTerm)return this.application_list;let n=this.searchTerm.toLowerCase();return this.application_list.filter(r=>r.ward_no?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.category?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.application_number?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_date).toLowerCase().includes(this.searchTerm.toLowerCase())||r.applicant_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.spouse_or_father_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.dob).toLowerCase().includes(this.searchTerm.toLowerCase())||r.social_category?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.pwd_status?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.alt_mobile_number?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.npci_remark?.toLowerCase().includes(this.searchTerm.toLowerCase()))}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status,_=new st;r&&(_=_.set("ward_id",r)),c&&(_=_.set("category",c)),f&&(_=_.set("social_category",f)),d&&(_=_.set("pwd_status",d)),_=_.set("offset",this.offset),_=_.set("limit",this.limit),_=_.set("npci_failed","2"),_=_.set("installment",this.installment);let v=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:_,headers:v}).subscribe(S=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=S.count,S.data&&S.data.length>0?(this.application_list=this.application_list.concat(S.data),this.offset+=S.data.length,this.hasMoreRecords=S.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},S=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}exportToExcel(){let n=new st,r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;r&&(n=n.set("ward_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),n=n.set("export_all","1"),n=n.set("npci_failed","2"),n=n.set("installment",this.installment);let _=new rt({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgressExcel=!1;let S=v.data.map((y,B)=>({"SI#":B+1,DISTRICT:y.district_name?y.district_name.toUpperCase():"",ULB:y.ulb_name?y.ulb_name.toUpperCase():"","WARD NO.":y.ward_no?y.ward_no.toUpperCase():"",CATEGORY:y.category.toUpperCase(),"APPLICATION NO.":y.application_number.toUpperCase(),"APPLICATION DATE":this.appService.dateFormat(y.application_date),"APPLICANT NAME":y.applicant_name.toUpperCase(),"FATHER/HUSBAND NAME":y.spouse_or_father_name.toUpperCase(),"SOCIAL CATEGORY":y.social_category.toUpperCase(),PWD:y.pwd_status.toUpperCase(),"MOBILE NO.":y.alt_mobile_number,"NPCI STATUS":y.npci_status=="2"?"DBT Not Enabled":"","DBT Not Enabled REASON":y.npci_remark.toUpperCase()})),w=N.json_to_sheet(S),u=N.book_new();N.book_append_sheet(u,w,"Applications");let I=Z(u,{bookType:"xlsx",type:"array"}),R=new Date,z=R.toLocaleDateString("en-GB").split("/").reverse().join("-"),at=R.toLocaleTimeString("en-GB").replace(/:/g,"-"),ct=`npci_faild_reports_${z}_${at}.xlsx`,lt=new Blob([I],{type:"application/octet-stream"}),O=document.createElement("a"),et=window.URL.createObjectURL(lt);O.href=et,O.download=ct,O.click(),window.URL.revokeObjectURL(et)},v=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",v)})}exportToPDF(){Gi.default.vfs=Vr.default.pdfMake.vfs;let n=new st,r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;r&&(n=n.set("ward_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),n=n.set("export_all","1"),n=n.set("npci_failed","2"),n=n.set("installment",this.installment);let _=new rt({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgress=!1;let S=v.data[0]||{},w=(S.district_name||"N/A").toUpperCase(),u=(S.block_name||S.ulb_name||"N/A").toUpperCase(),I=(S.gp_name||S.ward_no||"N/A").toUpperCase(),R=[[{text:"SI#",fontSize:10},{text:"CATEGORY",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICATION DATE.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"SOCIAL CATEGORY",fontSize:10},{text:"PWD",fontSize:10},{text:"MOBILE NO",fontSize:10},{text:"NPCI STATUS",fontSize:10},{text:"DBT Not Enabled REASON",fontSize:10}]];v.data.forEach((B,W)=>{R.push([{text:(W+1).toString().toUpperCase(),fontSize:9},{text:(B.category||"").toUpperCase(),fontSize:9},{text:(B.application_number||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(B.application_date)||"",fontSize:9},{text:(B.applicant_name||"").toUpperCase(),fontSize:9},{text:(B.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:(B.social_category||"").toUpperCase(),fontSize:9},{text:(B.pwd_status||"").toUpperCase(),fontSize:9},{text:(B.alt_mobile_number||"").toUpperCase(),fontSize:9},{text:B.npci_status=="2"?"DBT Not Enabled":"",fontSize:9},{text:(B.npci_remark||"").toUpperCase(),fontSize:9}])});let z=new Date,at=`Timestamp: ${z.toLocaleDateString()}, ${z.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,ct={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${w} > ULB: ${u} > WARD: ${I}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DETAILED REPORT - DBT Not Enabled",style:"header"},{table:{headerRows:1,body:R,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]},layout:{fillColor:function(B){return B===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:at,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},lt=new Date,O=lt.toLocaleDateString("en-GB").split("/").reverse().join("-"),et=lt.toLocaleTimeString("en-GB").replace(/:/g,"-"),y=`npci_failed_reports_${O}_${et}.pdf`;Gi.default.createPdf(ct).download(y)},v=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",v)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(Ot),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-nf-ward-user-list"]],decls:56,vars:4,consts:[[1,"container-fluid","drilldown-reports"],[1,"d-flex","justify-content-between","w-100","mb-3"],[1,"card-title"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],["class","row mb-2"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-2"],[1,"col-md-4"],["for","a_category",1,"fw-bold"],["id","a_category","formControlName","a_category",1,"form-select","my-2"],["value",""],["value","1"],["value","0"],["for","social_category",1,"fw-bold"],["formControlName","social_category","id","social_category",1,"form-select","my-2"],["value","2"],["value","3"],["value","4"],["for","pwd_status",1,"fw-bold"],["formControlName","pwd_status","id","pwd_status",1,"form-select","my-2"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[1,"row","mb-2"],[1,"col-md-7"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"fa","fa-spinner","fa-spin"],[1,"col-md-5"],["id","recordCount"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports detail"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports","detail"],[1,"text-light",2,"background-color","#fd7b03"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"],[4,"ngIf"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1)(2,"h4",2),a(3,"Detailed Report - DBT Not Enabled"),e(),t(4,"div",3)(5,"a",4),L("click",function(){return c.appService.goBack()}),t(6,"button",5),m(7,"i",6),a(8," Back"),e()()()(),b(9,QI,10,3,"div",7),t(10,"div",8)(11,"form",9),L("ngSubmit",function(){return c.onSearch()}),t(12,"div",10)(13,"div",11)(14,"label",12),a(15," Category "),e(),t(16,"select",13)(17,"option",14),a(18,"Choose Category"),e(),t(19,"option",15),a(20,"NFSA"),e(),t(21,"option",16),a(22,"NON-NFSA"),e()()(),t(23,"div",11)(24,"label",17),a(25," Social Category "),e(),t(26,"select",18)(27,"option",14),a(28,"Choose Social Category"),e(),t(29,"option",15),a(30,"Un-Reserved"),e(),t(31,"option",19),a(32,"OBC"),e(),t(33,"option",20),a(34,"SC"),e(),t(35,"option",21),a(36,"ST"),e()()(),t(37,"div",11)(38,"label",22),a(39," PWD "),e(),t(40,"select",23)(41,"option",14),a(42,"Choose PWD Status"),e(),t(43,"option",15),a(44,"Yes "),e(),t(45,"option",16),a(46,"NO"),e()()()(),t(47,"div",24)(48,"div",25),b(49,ZI,3,0,"button",26)(50,ty,3,0),e()()()(),t(51,"div",27)(52,"div",28)(53,"div",29),b(54,ey,2,0)(55,Sy,21,7),e()()()()),r&2&&(l(9),E(9,c.filteredWardUserStats&&c.filteredWardUserStats.length>0?9:-1),l(2),T("formGroup",c.searchForm),l(38),E(49,c.isFormSearchInProgress?50:49),l(5),E(54,c.isStatsLoading?54:55))},dependencies:[ft,Pt,Nt,Rt,K,Ut,q,yt,J,Dt,At,it]});let i=s;return i})();var Xi=j(ut()),jr=j(ht());function xy(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function gy(i,s){if(i&1){let o=U();t(0,"button",22),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",23),a(2,"Download PDF "),e()}}function Cy(i,s){i&1&&(t(0,"button",24),m(1,"i",25),a(2,"Downloading "),e())}function by(i,s){if(i&1){let o=U();t(0,"button",22),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",23),a(2,"Download EXCEL "),e()}}function vy(i,s){i&1&&(t(0,"button",24),m(1,"i",25),a(2,"Downloading "),e())}var Ey=(i,s)=>s.id,wy=i=>({installment:i});function Ty(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",29),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),$t("routerLink","/department/portal/optout/block-ulb-stats/",o.district_id,""),T("queryParams",pt(7,wy,r.installment)),l(1),p(P(6,5,o.district_name)),l(3),p(o==null?null:o.count_opt_out)}}function Ly(i,s){if(i&1&&(t(0,"table",26)(1,"thead",27)(2,"tr")(3,"th"),a(4,"Sl.#"),e(),t(5,"th"),a(6,"DISTRICT"),e(),t(7,"th"),a(8,"OPT OUT"),e()()(),t(9,"tbody",28),F(10,Ty,9,9,"tr",null,Ey),e()()),i&2){let o=h(2);l(10),V(o.filteredDistrictStats)}}function Iy(i,s){i&1&&a(0," No Data Found ")}function yy(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - Opt Out"),e()(),t(4,"div",13)(5,"div",14)(6,"input",15),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(7,"i",16),e(),t(8,"div",17),b(9,gy,3,0,"button",18)(10,Cy,3,0),e(),t(11,"div",19),b(12,by,3,0,"button",18)(13,vy,3,0),e()()(),t(14,"div",20),b(15,Ly,12,0,"table",21)(16,Iy,1,0),e()}if(i&2){let o=h();l(6),T("ngModel",o.searchTerm),l(3),E(9,o.isExportInProgress?10:9),l(3),E(12,o.isExportInProgressExcel?13:12),l(3),E(15,o.filteredDistrictStats&&o.filteredDistrictStats.length>0?15:16)}}var $r=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.router=n,this.route=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.districtStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment,this.card_name=n.card_name,this.fetchDistrictStats()})}fetchDistrictStats(){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?opt_out=1&installment=${this.installment}&card_name=${this.card_name}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isStatsLoading=!1,this.districtStats=n.data},n=>{this.isStatsLoading=!1,this.districtStats=[]})}get filteredDistrictStats(){return this.searchTerm?this.districtStats.filter(n=>n.district_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.districtStats}exportToExcel(){this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?opt_out=1&installment=${this.installment}&card_name=${this.card_name}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isExportInProgressExcel=!1;let r=n.data.map((I,R)=>({"SI#":R+1,DISTRICT:I.district_name.toUpperCase(),"OPT OUT":I?.count_opt_out})),c=N.json_to_sheet(r),f=N.book_new();N.book_append_sheet(f,c,"Applications");let d=Z(f,{bookType:"xlsx",type:"array"}),C=new Date,g=C.toLocaleDateString("en-GB").split("/").reverse().join("-"),_=C.toLocaleTimeString("en-GB").replace(/:/g,"-"),v=`opt_out_district_drilldown_reports_${g}_${_}.xlsx`,S=new Blob([d],{type:"application/octet-stream"}),w=document.createElement("a"),u=window.URL.createObjectURL(S);w.href=u,w.download=v,w.click(),window.URL.revokeObjectURL(u)},n=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",n)})}exportToPDF(){Xi.default.vfs=jr.default.pdfMake.vfs,this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?opt_out=1&installment=${this.installment}&card_name=${this.card_name}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isExportInProgress=!1;let r=[[{text:"SI#",fontSize:10},{text:"DISTRICT",fontSize:10},{text:"OPT OUT",fontSize:10}]];n.data.forEach((S,w)=>{r.push([{text:(w+1).toString().toUpperCase(),fontSize:9},{text:(S.district_name||"").toUpperCase(),fontSize:9},{text:S?.count_opt_out,fontSize:9}])});let c=new Date,f=`Timestamp: ${c.toLocaleDateString()}, ${c.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,d={pageOrientation:"landscape",pageSize:"A4",content:[{text:"DRILL-DOWN REPORT - OPT-OUT DISTRICT WISE",style:"header"},{table:{headerRows:1,body:r,widths:["20%","50%","30%"]},layout:{fillColor:function(S){return S===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:f,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},C=new Date,g=C.toLocaleDateString("en-GB").split("/").reverse().join("-"),_=C.toLocaleTimeString("en-GB").replace(/:/g,"-"),v=`opt_out_district_drilldown_reports_${g}_${_}.pdf`;Xi.default.createPdf(d).download(v)},n=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",n)})}};s.\u0275fac=function(r){return new(r||s)(x(G),x(tt),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-optout-district-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,xy,2,0)(11,yy,17,4),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var Yi=j(ut()),Gr=j(ht());function ky(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function Py(i,s){if(i&1){let o=U();t(0,"button",25),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",26),a(2,"Download PDF "),e()}}function Dy(i,s){i&1&&(t(0,"button",27),m(1,"i",28),a(2,"Downloading "),e())}function Ay(i,s){if(i&1){let o=U();t(0,"button",25),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",26),a(2,"Download EXCEL "),e()}}function Uy(i,s){i&1&&(t(0,"button",27),m(1,"i",28),a(2,"Downloading "),e())}var Ny=(i,s)=>s.id,Xr=i=>({installment:i});function Ry(i,s){if(i&1&&(t(0,"a",33),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit,n=h(3);Vt("routerLink","/department/portal/optout/gp-stats/",o.district_id,"/",o.block_id,""),T("queryParams",pt(6,Xr,n.installment)),l(1),p(P(2,4,o.block_name))}}function Oy(i,s){if(i&1&&(t(0,"a",33),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit,n=h(3);Vt("routerLink","/department/portal/optout/ward-stats/",o.district_id,"/",o.ulb_id,""),T("queryParams",pt(6,Xr,n.installment)),l(1),p(P(2,4,o.ulb_name))}}function By(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td"),b(4,Ry,3,8,"a",32)(5,Oy,3,8),e(),t(6,"td"),a(7),e()()),i&2){let o=s.$implicit,n=s.$index;l(2),p(n+1),l(2),E(4,o.block_id?4:5),l(3),p(o==null?null:o.applications_received)}}function Wy(i,s){if(i&1&&(t(0,"table",29)(1,"thead",30)(2,"tr")(3,"th"),a(4,"Sl.#"),e(),t(5,"th"),a(6,"BLOCK/ULB"),e(),t(7,"th"),a(8,"OPT OUT"),e()()(),t(9,"tbody",31),F(10,By,8,3,"tr",null,Ny),e()()),i&2){let o=h(2);l(10),V(o.filteredBlockStats)}}function My(i,s){i&1&&a(0," No Data Found ")}function Fy(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - Opt Out"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e()()()(),t(8,"div",16)(9,"div",17)(10,"input",18),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(11,"i",19),e(),t(12,"div",20),b(13,Py,3,0,"button",21)(14,Dy,3,0),e(),t(15,"div",22),b(16,Ay,3,0,"button",21)(17,Uy,3,0),e()()(),t(18,"div",23),b(19,Wy,12,0,"table",24)(20,My,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredBlockStats[0].district_name),l(3),T("ngModel",o.searchTerm),l(3),E(13,o.isExportInProgress?14:13),l(3),E(16,o.isExportInProgressExcel?17:16),l(3),E(19,o.filteredBlockStats&&o.filteredBlockStats.length>0?19:20)}}var Yr=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.districtStats=[],this.district_id="",this.blockStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{let r=n.id;this.district_id=r,this.fetchblockStats(r)})}fetchblockStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/block-count?district_id=${n}&opt_out=1&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.blockStats=r.data,this.fetchulbStats(n)},r=>{this.isStatsLoading=!1,this.blockStats=[]})}fetchulbStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/ulb-count?district_id=${n}&opt_out=1&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.blockStats=[...this.blockStats,...r.data]},r=>{this.isStatsLoading=!1})}get filteredBlockStats(){return this.searchTerm?this.blockStats.filter(n=>n.block_name&&n.block_name.toLowerCase().includes(this.searchTerm.toLowerCase())||n.ulb_name&&n.ulb_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.blockStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.blockStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name,"BLOCK/ULB":(u.block_name||u.ulb_name).toUpperCase(),"OPT OUT":u?.applications_received})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`opt_out_block_ulb_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){Yi.default.vfs=Gr.default.pdfMake.vfs,this.isExportInProgress=!0;let r=((this.blockStats[0]||{}).district_name||"N/A").toUpperCase(),c=[[{text:"SI#",fontSize:10},{text:"BLOCK/ULB",fontSize:10},{text:"OPT OUT",fontSize:10}]];this.blockStats.forEach((w,u)=>{c.push([{text:(u+1).toString().toUpperCase(),fontSize:9},{text:(w.block_name||w.ulb_name||"").toUpperCase(),fontSize:9},{text:w?.applications_received,fontSize:9}])});let f=new Date,d=`Timestamp: ${f.toLocaleDateString()}, ${f.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,C={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - OPT-OUT BLOCK-ULB WISE",style:"header"},{table:{headerRows:1,body:c,widths:["20%","50%","30%"]},layout:{fillColor:function(w){return w===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:d,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},g=new Date,_=g.toLocaleDateString("en-GB").split("/").reverse().join("-"),v=g.toLocaleTimeString("en-GB").replace(/:/g,"-"),S=`opt_out_block_ulb_drilldown_reports_${_}_${v}.pdf`;Yi.default.createPdf(C).download(S,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-optout-block-ulb-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],[2,"font-size","14px"],["style","text-decoration: none",3,"routerLink","queryParams"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,ky,2,0)(11,Fy,21,5),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var Hi=j(ut()),Hr=j(ht());function Vy(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function zy(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",27),a(2,"Download PDF "),e()}}function jy(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}function $y(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",27),a(2,"Download EXCEL "),e()}}function Gy(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}var Xy=(i,s)=>s.id,Yy=i=>({installment:i});function Hy(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",33),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),Mt("routerLink","/department/portal/optout/village-stats/",o.district_id,"/",o.block_id,"/",o.gp_id,""),T("queryParams",pt(9,Yy,r.installment)),l(1),p(P(6,7,o.gp_name)),l(3),p(o==null?null:o.applications_received)}}function Ky(i,s){if(i&1&&(t(0,"table",30)(1,"thead",31)(2,"tr")(3,"th"),a(4,"Sl.#"),e(),t(5,"th"),a(6,"GRAM PANCHAYAT"),e(),t(7,"th"),a(8,"Opt Out"),e()()(),t(9,"tbody",32),F(10,Hy,9,11,"tr",null,Xy),e()()),i&2){let o=h(2);l(10),V(o.filteredGpStats)}}function qy(i,s){i&1&&a(0," No Data Found ")}function Jy(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - Opt Out"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e(),t(8,"li",16),a(9),e()()()(),t(10,"div",17)(11,"div",18)(12,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(13,"i",20),e(),t(14,"div",21),b(15,zy,3,0,"button",22)(16,jy,3,0),e(),t(17,"div",23),b(18,$y,3,0,"button",22)(19,Gy,3,0),e()()(),t(20,"div",24),b(21,Ky,12,0,"table",25)(22,qy,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredGpStats[0].district_name),l(2),p(o.filteredGpStats[0].block_name),l(3),T("ngModel",o.searchTerm),l(3),E(15,o.isExportInProgress?16:15),l(3),E(18,o.isExportInProgressExcel?19:18),l(3),E(21,o.filteredGpStats&&o.filteredGpStats.length>0?21:22)}}var Kr=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.district_id="",this.gpStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.id,this.fetchgpStats(this.block_id)})}fetchgpStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/gp-count?block_id=${n}&opt_out=1&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.gpStats=r.data},r=>{this.isStatsLoading=!1,this.gpStats=[]})}get filteredGpStats(){return this.searchTerm?this.gpStats.filter(n=>n.gp_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.gpStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.gpStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",BLOCK:u.block_name?u.block_name.toUpperCase():"",GP:u.gp_name?u.gp_name.toUpperCase():"","OPT OUT":u?.applications_received})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`opt_out_gp_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){Hi.default.vfs=Hr.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.gpStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=[[{text:"SI#",fontSize:10},{text:"GP",fontSize:10},{text:"OPT OUT",fontSize:10}]];this.gpStats.forEach((u,I)=>{f.push([{text:(I+1).toString().toUpperCase(),fontSize:9},{text:(u.gp_name||"").toUpperCase(),fontSize:9},{text:u?.applications_received,fontSize:9}])});let d=new Date,C=`Timestamp: ${d.toLocaleDateString()}, ${d.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,g={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK: ${c}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - OPT-OUT GP WISE",style:"header"},{table:{headerRows:1,body:f,widths:["20%","50%","30%"]},layout:{fillColor:function(u){return u===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:C,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},_=new Date,v=_.toLocaleDateString("en-GB").split("/").reverse().join("-"),S=_.toLocaleTimeString("en-GB").replace(/:/g,"-"),w=`opt_out_gp_drilldown_reports_${v}_${S}.pdf`;Hi.default.createPdf(g).download(w,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-optout-gp-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,Vy,2,0)(11,Jy,23,6),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var Ki=j(ut()),qr=j(ht());function Qy(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function Zy(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",27),a(2,"Download PDF "),e()}}function tk(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}function ek(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",27),a(2,"Download EXCEL "),e()}}function ik(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}var nk=(i,s)=>s.id,ok=i=>({installment:i});function ak(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",34),a(5),e()(),t(6,"td"),a(7),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),Mt("routerLink","/department/portal/optout/ward-user-list/",o.district_id,"/",o.ulb_id,"/",o.ward_id,""),T("queryParams",pt(7,ok,r.installment)),l(1),p(o.ward_no),l(2),p(o==null?null:o.applications_received)}}function rk(i,s){if(i&1&&(t(0,"table",30)(1,"thead",31)(2,"tr")(3,"th",32),a(4,"Sl.#"),e(),t(5,"th",32),a(6,"WARD"),e(),t(7,"th"),a(8,"OPT OUT"),e()()(),t(9,"tbody",33),F(10,ak,8,9,"tr",null,nk),e()()),i&2){let o=h(2);l(10),V(o.filteredWardStats)}}function sk(i,s){i&1&&a(0," No Data Found ")}function lk(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - Opt Out"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e(),t(8,"li",16),a(9),e()()()(),t(10,"div",17)(11,"div",18)(12,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(13,"i",20),e(),t(14,"div",21),b(15,Zy,3,0,"button",22)(16,tk,3,0),e(),t(17,"div",23),b(18,ek,3,0,"button",22)(19,ik,3,0),e()()(),t(20,"div",24),b(21,rk,12,0,"table",25)(22,sk,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredWardStats[0].district_name),l(2),p(o.filteredWardStats[0].ulb_name),l(3),T("ngModel",o.searchTerm),l(3),E(15,o.isExportInProgress?16:15),l(3),E(18,o.isExportInProgressExcel?19:18),l(3),E(21,o.filteredWardStats&&o.filteredWardStats.length>0?21:22)}}var Jr=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.district_id="",this.wardStats=[],this.ulb_id="",this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.ulb_id=n.id,this.fetchWardStats(this.ulb_id)})}fetchWardStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/ward-count?ulb_id=${n}&opt_out=1&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.wardStats=r.data},r=>{this.isStatsLoading=!1,this.wardStats=[]})}get filteredWardStats(){return this.searchTerm?this.wardStats.filter(n=>n.ward_no.toLowerCase().includes(this.searchTerm.toLowerCase())):this.wardStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.wardStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",ULB:u.ulb_name?u.ulb_name.toUpperCase():"","WARD NO.":u.ward_no?u.ward_no.toUpperCase():"","OPT OUT":u?.applications_received})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`opt_out_ward_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){Ki.default.vfs=qr.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.wardStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=[[{text:"SI#",fontSize:10},{text:"WARD NO.",fontSize:10},{text:"OPT OUT",fontSize:10}]];this.wardStats.forEach((u,I)=>{f.push([{text:(I+1).toString().toUpperCase(),fontSize:9},{text:(u.ward_no||"").toUpperCase(),fontSize:9},{text:u?.applications_received,fontSize:9}])});let d=new Date,C=`Timestamp: ${d.toLocaleDateString()}, ${d.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,g={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK/ULB: ${c}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - OPT-OUT WARD WISE",style:"header"},{table:{headerRows:1,body:f,widths:["20%","50%","30%"]},layout:{fillColor:function(u){return u===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:C,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},_=new Date,v=_.toLocaleDateString("en-GB").split("/").reverse().join("-"),S=_.toLocaleTimeString("en-GB").replace(/:/g,"-"),w=`opt_out_ward_drilldown_reports_${v}_${S}.pdf`;Ki.default.createPdf(g).download(w,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-optout-ward-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,Qy,2,0)(11,lk,23,6),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J]});let i=s;return i})();var qi=j(ut()),Qr=j(ht());function ck(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function dk(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",27),a(2,"Download PDF "),e()}}function pk(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}function mk(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",27),a(2,"Download EXCEL "),e()}}function _k(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}var fk=(i,s)=>s.id,uk=i=>({installment:i});function hk(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",33),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),Gt("routerLink","/department/portal/optout/village-user-list/",o.district_id,"/",o.block_id,"/",o.gp_id,"/",o.village_id,""),T("queryParams",pt(10,uk,r.installment)),l(1),p(P(6,8,o.village_name)),l(3),p(o==null?null:o.applications_received)}}function Sk(i,s){if(i&1&&(t(0,"table",30)(1,"thead",31)(2,"tr")(3,"th"),a(4,"Sl.#"),e(),t(5,"th"),a(6,"VILLAGE"),e(),t(7,"th"),a(8,"OPT OUT"),e()()(),t(9,"tbody",32),F(10,hk,9,12,"tr",null,fk),e()()),i&2){let o=h(2);l(10),V(o.filteredVillageStats)}}function xk(i,s){i&1&&a(0," No Data Found ")}function gk(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - Opt Out"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e(),t(8,"li",15),a(9),e(),t(10,"li",16),a(11),e()()()(),t(12,"div",17)(13,"div",18)(14,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(15,"i",20),e(),t(16,"div",21),b(17,dk,3,0,"button",22)(18,pk,3,0),e(),t(19,"div",23),b(20,mk,3,0,"button",22)(21,_k,3,0),e()()(),t(22,"div",24),b(23,Sk,12,0,"table",25)(24,xk,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredVillageStats[0].district_name),l(2),p(o.filteredVillageStats[0].block_name),l(2),p(o.filteredVillageStats[0].gp_name),l(3),T("ngModel",o.searchTerm),l(3),E(17,o.isExportInProgress?18:17),l(3),E(20,o.isExportInProgressExcel?21:20),l(3),E(23,o.filteredVillageStats&&o.filteredVillageStats.length>0?23:24)}}var Zr=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.gp_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.block_id,this.gp_id=n.id,this.fetchvillageStats(this.gp_id)})}fetchvillageStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/village-count?gp_id=${n}&opt_out=1&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.villageStats=r.data},r=>{this.isStatsLoading=!1,this.villageStats=[]})}get filteredVillageStats(){return this.searchTerm?this.villageStats.filter(n=>n.village_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.villageStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.villageStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",BLOCK:u.block_name?u.block_name.toUpperCase():"",GP:u.gp_name?u.gp_name.toUpperCase():"",VILLAGE:u.village_name?u.village_name.toUpperCase():"","OPT OUT":u?.applications_received})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`opt_out_village_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){qi.default.vfs=Qr.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.villageStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=(n.gp_name||n.ward_no||"N/A").toUpperCase(),d=[[{text:"SI#",fontSize:10},{text:"VILLAGE",fontSize:10},{text:"OPT OUT",fontSize:10}]];this.villageStats.forEach((I,R)=>{d.push([{text:(R+1).toString().toUpperCase(),fontSize:9},{text:(I.village_name||"").toUpperCase(),fontSize:9},{text:I?.applications_received,fontSize:9}])});let C=new Date,g=`Timestamp: ${C.toLocaleDateString()}, ${C.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,_={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK: ${c} > GP:${f}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - OPT-OUT VILLAGE WISE",style:"header"},{table:{headerRows:1,body:d,widths:["20%","50%","30%"]},layout:{fillColor:function(I){return I===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:g,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},v=new Date,S=v.toLocaleDateString("en-GB").split("/").reverse().join("-"),w=v.toLocaleTimeString("en-GB").replace(/:/g,"-"),u=`opt_out_village_drilldown_reports_${S}_${w}.pdf`;qi.default.createPdf(_).download(u,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-optout-village-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,ck,2,0)(11,gk,25,7),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var Ji=j(ut()),ts=j(ht());function Ck(i,s){if(i&1&&(t(0,"div",30)(1,"div",31)(2,"nav",32)(3,"ol",33)(4,"li",34),a(5),e(),t(6,"li",34),a(7),e(),t(8,"li",34),a(9),e(),t(10,"li",35),a(11),e()()()()()),i&2){let o=h();l(5),p(o.filteredVillageUserStats[0].district_name),l(2),p(o.filteredVillageUserStats[0].block_name),l(2),p(o.filteredVillageUserStats[0].gp_name),l(2),p(o.filteredVillageUserStats[0].village_name)}}function bk(i,s){i&1&&(t(0,"button",36),m(1,"i",37),a(2,"Search "),e())}function vk(i,s){i&1&&(t(0,"button",38),m(1,"i",39),a(2," Searching ..."),e())}function Ek(i,s){i&1&&(m(0,"i",40),a(1," We are fetching the data, please wait. "))}function wk(i,s){if(i&1){let o=U();t(0,"button",54),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",55),a(2,"Download to PDF "),e()}}function Tk(i,s){i&1&&(t(0,"button",56),m(1,"i",39),a(2,"Downloading "),e())}function Lk(i,s){if(i&1){let o=U();t(0,"button",54),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",55),a(2,"Download to EXCEL "),e()}}function Ik(i,s){i&1&&(t(0,"button",56),m(1,"i",39),a(2,"Downloading "),e())}var yk=(i,s)=>s.id;function kk(i,s){if(i&1&&(t(0,"td"),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit;l(1),p(P(2,1,o.village_name))}}function Pk(i,s){i&1&&m(0,"td")}function Dk(i,s){i&1&&(t(0,"td"),a(1,"OPTED OUT"),e())}function Ak(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),b(3,kk,3,3,"td")(4,Pk,1,0),t(5,"td"),a(6),k(7,"uppercase"),e(),t(8,"td"),a(9),k(10,"uppercase"),e(),t(11,"td"),a(12),k(13,"uppercase"),e(),t(14,"td"),a(15),k(16,"uppercase"),e(),t(17,"td"),a(18),k(19,"uppercase"),e(),t(20,"td"),a(21),k(22,"uppercase"),e(),t(23,"td"),a(24),k(25,"uppercase"),e(),t(26,"td"),a(27),e(),t(28,"td"),a(29),k(30,"uppercase"),e(),b(31,Dk,2,0,"td"),t(32,"td"),a(33),k(34,"uppercase"),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(1),E(3,o.village_name?3:4),l(3),p(P(7,13,o.category)),l(3),p(P(10,15,o.application_number)),l(3),p(P(13,17,r.appService.dateFormat(o.application_date))),l(3),p(P(16,19,o.applicant_name)),l(3),p(P(19,21,o.spouse_or_father_name)),l(3),p(P(22,23,o.social_category)),l(3),p(P(25,25,o.pwd_status)),l(3),p(o.alt_mobile_number),l(2),p(P(30,27,o.application_status)),l(2),E(31,o.is_optout==1?31:-1),l(2),p(P(34,29,o.optout_date))}}function Uk(i,s){if(i&1&&(t(0,"table",57)(1,"thead",58)(2,"tr")(3,"th"),a(4,"SI#"),e(),t(5,"th"),a(6,"VILLAGE"),e(),t(7,"th"),a(8,"CATEGORY"),e(),t(9,"th"),a(10,"APPLICATION NO."),e(),t(11,"th"),a(12,"APPLICATION DATE"),e(),t(13,"th"),a(14,"APPLICANT NAME"),e(),t(15,"th"),a(16,"FATHER/HUSBAND NAME"),e(),t(17,"th"),a(18,"SOCIAL CATEGORY"),e(),t(19,"th"),a(20,"PWD"),e(),t(21,"th"),a(22,"MOBILE NO."),e(),t(23,"th"),a(24,"APPLICATION STATUS"),e(),t(25,"th"),a(26,"OPT OUT STATUS"),e(),t(27,"th"),a(28,"OPT OUT DATE"),e()()(),t(29,"tbody"),F(30,Ak,35,31,"tr",null,yk),e()()),i&2){let o=h(2);l(30),V(o.filteredVillageUserStats)}}function Nk(i,s){i&1&&(t(0,"h5",59),a(1,"No data available"),e())}function Rk(i,s){i&1&&(t(0,"div",60),a(1,"Loading.. "),m(2,"i",61),e())}function Ok(i,s){i&1&&(t(0,"span"),m(1,"i",40),a(2," Loading..."),e())}function Bk(i,s){i&1&&(t(0,"span"),a(1,"Load More"),e())}function Wk(i,s){if(i&1){let o=U();t(0,"div",62)(1,"button",63),L("click",function(){D(o);let r=h(2);return A(r.loadMore())}),b(2,Ok,3,0,"span",64)(3,Bk,2,0,"span",64),e()()}if(i&2){let o=h(2);l(2),T("ngIf",o.isLoadMoreInProgress),l(1),T("ngIf",!o.isLoadMoreInProgress)}}function Mk(i,s){if(i&1){let o=U();t(0,"div",30)(1,"div",41)(2,"h5",2),a(3," Number of records found : "),t(4,"span",42),a(5),e()()(),t(6,"div",43)(7,"div",44)(8,"input",45),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(9,"i",46),e(),t(10,"div",47),b(11,wk,3,0,"button",48)(12,Tk,3,0),e(),t(13,"div",49),b(14,Lk,3,0,"button",48)(15,Ik,3,0),e()()(),t(16,"div",50),b(17,Uk,32,0,"table",51)(18,Nk,2,0)(19,Rk,3,0,"div",52),e(),b(20,Wk,4,2,"div",53)}if(i&2){let o=h();l(5),p(o.count),l(3),T("ngModel",o.searchTerm),l(3),E(11,o.isExportInProgress?12:11),l(3),E(14,o.isExportInProgressExcel?15:14),l(3),E(17,o.filteredVillageUserStats&&o.filteredVillageUserStats.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),l(2),E(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),l(1),T("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var es=(()=>{let s=class s{constructor(n,r,c,f,d,C,g,_){this.route=n,this.router=r,this.formService=c,this.appService=f,this.httpClient=d,this.toastService=C,this.authService=g,this.masterDataService=_,this.isStatsLoading=!1,this.userStats=[],this.block_id="",this.gp_id="",this.village_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.limit=this.appService.loadmorelimit,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.count=0,this.searchForm=new kt({a_category:new nt(""),social_category:new nt(""),pwd_status:new nt(""),submit_date:new nt(""),a_status:new nt("")})}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.block_id,this.gp_id=n.gp_id,this.village_id=n.id,this.fetchuserStats(this.village_id)})}fetchuserStats(n,r=!1){this.isStatsLoading=!0;let c=new st;c=c.set("gp_id",this.gp_id),c=c.set("village_id",n),c=c.set("offset",this.offset),c=c.set("limit",this.limit),c=c.set("opt_out","1"),c=c.set("installment",this.installment);let f=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:c,headers:f}).subscribe(d=>{this.isStatsLoading=!1,this.count=d.count,d.data&&d.data.length>0?(this.application_list=this.application_list.concat(d.data),this.offset+=d.data.length,this.hasMoreRecords=d.data.length===this.limit):this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)},d=>{this.isStatsLoading=!1,this.application_list=[],this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)})}get filteredVillageUserStats(){if(!this.searchTerm)return this.application_list;let n=this.searchTerm.toLowerCase();return this.application_list.filter(r=>r.village_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.category?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.application_number?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_date).toLowerCase().includes(this.searchTerm.toLowerCase())||r.applicant_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.spouse_or_father_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.dob).toLowerCase().includes(this.searchTerm.toLowerCase())||r.social_category?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.pwd_status?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.alt_mobile_number?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.npci_remark?.toLowerCase().includes(this.searchTerm.toLowerCase()))}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status,_=new st;_=_.set("gp_id",this.gp_id),r&&(_=_.set("village_id",r)),c&&(_=_.set("category",c)),f&&(_=_.set("social_category",f)),d&&(_=_.set("pwd_status",d)),_=_.set("offset",this.offset),_=_.set("limit",this.limit),_=_.set("opt_out","1"),_=_.set("installment",this.installment);let v=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:_,headers:v}).subscribe(S=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=S.count,S.data&&S.data.length>0?(this.application_list=this.application_list.concat(S.data),this.offset+=S.data.length,this.hasMoreRecords=S.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},S=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}exportToExcel(){let n=new st,r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;n=n.set("gp_id",this.gp_id),r&&(n=n.set("village_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),n=n.set("export_all","1"),n=n.set("opt_out","1"),n=n.set("installment",this.installment);let _=new rt({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgressExcel=!1;let S=v.data.map((y,B)=>({"SI#":B+1,DISTRICT:y.district_name?y.district_name.toUpperCase():"",BLOCK:y.block_name?y.block_name.toUpperCase():"",GP:y.gp_name?y.gp_name.toUpperCase():"",VILLAGE:y.village_name?y.village_name.toUpperCase():"",CATEGORY:y.category.toUpperCase(),"APPLICATION NO.":y.application_number.toUpperCase(),"APPLICATION DATE":this.appService.dateFormat(y.application_date),"APPLICANT NAME":y.applicant_name.toUpperCase(),"FATHER/HUSBAND NAME":y.spouse_or_father_name.toUpperCase(),"SOCIAL CATEGORY":y.social_category.toUpperCase(),PWD:y.pwd_status.toUpperCase(),"MOBILE NO.":y.alt_mobile_number,"APPLICATION STATUS.":y.application_status,"OPT OUT STATUS":y.is_optout=="1"?"OPTED OUT":"","OPT OUT DATE":y.optout_date})),w=N.json_to_sheet(S),u=N.book_new();N.book_append_sheet(u,w,"Applications");let I=Z(u,{bookType:"xlsx",type:"array"}),R=new Date,z=R.toLocaleDateString("en-GB").split("/").reverse().join("-"),at=R.toLocaleTimeString("en-GB").replace(/:/g,"-"),ct=`opt_out__reports_${z}_${at}.xlsx`,lt=new Blob([I],{type:"application/octet-stream"}),O=document.createElement("a"),et=window.URL.createObjectURL(lt);O.href=et,O.download=ct,O.click(),window.URL.revokeObjectURL(et)},v=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",v)})}exportToPDF(){Ji.default.vfs=ts.default.pdfMake.vfs;let n=new st,r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;n=n.set("gp_id",this.gp_id),r&&(n=n.set("village_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),n=n.set("export_all","1"),n=n.set("opt_out","1"),n=n.set("installment",this.installment);let _=new rt({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgress=!1;let S=v.data[0]||{},w=(S.district_name||"N/A").toUpperCase(),u=(S.block_name||S.ulb_name||"N/A").toUpperCase(),I=(S.gp_name||S.ward_no||"N/A").toUpperCase(),R=(S.village_name||"").toUpperCase(),z=[[{text:"SI#",fontSize:10},{text:"CATEGORY",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICATION DATE.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"SOCIAL CATEGORY",fontSize:10},{text:"PWD",fontSize:10},{text:"MOBILE NO",fontSize:10},{text:"APPLICATION STATUS",fontSize:10},{text:"OPT OUT STATUS",fontSize:10},{text:"OPT OUT DATE",fontSize:10}]];v.data.forEach((W,It)=>{z.push([{text:(It+1).toString().toUpperCase(),fontSize:9},{text:(W.category||"").toUpperCase(),fontSize:9},{text:(W.application_number||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(W.application_date)||"",fontSize:9},{text:(W.applicant_name||"").toUpperCase(),fontSize:9},{text:(W.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:(W.social_category||"").toUpperCase(),fontSize:9},{text:(W.pwd_status||"").toUpperCase(),fontSize:9},{text:(W.alt_mobile_number||"").toUpperCase(),fontSize:9},{text:(W.application_status||"").toUpperCase(),fontSize:9},{text:W.is_optout=="1"?"OPTED OUT":"",fontSize:9},{text:(W.optout_date||"").toUpperCase(),fontSize:9}])});let at=new Date,ct=`Timestamp: ${at.toLocaleDateString()}, ${at.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,lt={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${w} > BLOCK: ${u} > GP: ${I} >VILLAGE: ${R}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DETAILED REPORT - OPT OUT",style:"header"},{table:{headerRows:1,body:z,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]},layout:{fillColor:function(W){return W===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:ct,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},O=new Date,et=O.toLocaleDateString("en-GB").split("/").reverse().join("-"),y=O.toLocaleTimeString("en-GB").replace(/:/g,"-"),B=`opt_out_reports_${et}_${y}.pdf`;Ji.default.createPdf(lt).download(B)},v=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",v)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(Ot),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-optout-village-user-list"]],decls:56,vars:4,consts:[[1,"container-fluid","drilldown-reports"],[1,"d-flex","justify-content-between","w-100","mb-3"],[1,"card-title"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],["class","row mb-2"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-2"],[1,"col-md-4"],["for","a_category",1,"fw-bold"],["id","a_category","formControlName","a_category",1,"form-select","my-2"],["value",""],["value","1"],["value","0"],["for","social_category",1,"fw-bold"],["formControlName","social_category","id","social_category",1,"form-select","my-2"],["value","2"],["value","3"],["value","4"],["for","pwd_status",1,"fw-bold"],["formControlName","pwd_status","id","pwd_status",1,"form-select","my-2"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[1,"row","mb-2"],[1,"col-md-7"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"fa","fa-spinner","fa-spin"],[1,"col-md-5"],["id","recordCount"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports detail"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports","detail"],[1,"text-light",2,"background-color","#fd7b03"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"],[4,"ngIf"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1)(2,"h4",2),a(3,"Detailed Report - Opt Out"),e(),t(4,"div",3)(5,"a",4),L("click",function(){return c.appService.goBack()}),t(6,"button",5),m(7,"i",6),a(8," Back"),e()()()(),b(9,Ck,12,4,"div",7),t(10,"div",8)(11,"form",9),L("ngSubmit",function(){return c.onSearch()}),t(12,"div",10)(13,"div",11)(14,"label",12),a(15," Category "),e(),t(16,"select",13)(17,"option",14),a(18,"Choose Category"),e(),t(19,"option",15),a(20,"NFSA"),e(),t(21,"option",16),a(22,"NON-NFSA"),e()()(),t(23,"div",11)(24,"label",17),a(25," Social Category "),e(),t(26,"select",18)(27,"option",14),a(28,"Choose Social Category"),e(),t(29,"option",15),a(30,"Un-Reserved"),e(),t(31,"option",19),a(32,"OBC"),e(),t(33,"option",20),a(34,"SC"),e(),t(35,"option",21),a(36,"ST"),e()()(),t(37,"div",11)(38,"label",22),a(39," PWD "),e(),t(40,"select",23)(41,"option",14),a(42,"Choose PWD Status"),e(),t(43,"option",15),a(44,"Yes "),e(),t(45,"option",16),a(46,"NO"),e()()()(),t(47,"div",24)(48,"div",25),b(49,bk,3,0,"button",26)(50,vk,3,0),e()()()(),t(51,"div",27)(52,"div",28)(53,"div",29),b(54,Ek,2,0)(55,Mk,21,7),e()()()()),r&2&&(l(9),E(9,c.filteredVillageUserStats&&c.filteredVillageUserStats.length>0?9:-1),l(2),T("formGroup",c.searchForm),l(38),E(49,c.isFormSearchInProgress?50:49),l(5),E(54,c.isStatsLoading?54:55))},dependencies:[ft,Pt,Nt,Rt,K,Ut,q,yt,J,Dt,At,it]});let i=s;return i})();var Qi=j(ut()),is=j(ht());function Fk(i,s){if(i&1&&(t(0,"div",30)(1,"div",31)(2,"nav",32)(3,"ol",33)(4,"li",34),a(5),e(),t(6,"li",34),a(7),e(),t(8,"li",35),a(9),e()()()()()),i&2){let o=h();l(5),p(o.filteredWardUserStats[0].district_name),l(2),p(o.filteredWardUserStats[0].ulb_name),l(2),p(o.filteredWardUserStats[0].ward_no)}}function Vk(i,s){i&1&&(t(0,"button",36),m(1,"i",37),a(2,"Search "),e())}function zk(i,s){i&1&&(t(0,"button",38),m(1,"i",39),a(2," Searching ..."),e())}function jk(i,s){i&1&&(m(0,"i",40),a(1," We are fetching the data, please wait. "))}function $k(i,s){if(i&1){let o=U();t(0,"button",54),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",55),a(2,"Download to PDF "),e()}}function Gk(i,s){i&1&&(t(0,"button",56),m(1,"i",39),a(2,"Downloading "),e())}function Xk(i,s){if(i&1){let o=U();t(0,"button",54),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",55),a(2,"Download to EXCEL "),e()}}function Yk(i,s){i&1&&(t(0,"button",56),m(1,"i",39),a(2,"Downloading "),e())}var Hk=(i,s)=>s.id;function Kk(i,s){if(i&1&&(t(0,"td"),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit;l(1),p(P(2,1,o.ward_no))}}function qk(i,s){i&1&&m(0,"td")}function Jk(i,s){i&1&&(t(0,"td"),a(1,"OPTED OUT"),e())}function Qk(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),b(3,Kk,3,3,"td")(4,qk,1,0),t(5,"td"),a(6),k(7,"uppercase"),e(),t(8,"td"),a(9),k(10,"uppercase"),e(),t(11,"td"),a(12),k(13,"uppercase"),e(),t(14,"td"),a(15),k(16,"uppercase"),e(),t(17,"td"),a(18),k(19,"uppercase"),e(),t(20,"td"),a(21),k(22,"uppercase"),e(),t(23,"td"),a(24),k(25,"uppercase"),e(),t(26,"td"),a(27),e(),t(28,"td"),a(29),k(30,"uppercase"),e(),b(31,Jk,2,0,"td"),t(32,"td"),a(33),k(34,"uppercase"),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(1),E(3,o.ward_no?3:4),l(3),p(P(7,13,o.category)),l(3),p(P(10,15,o.application_number)),l(3),p(P(13,17,r.appService.dateFormat(o.application_date))),l(3),p(P(16,19,o.applicant_name)),l(3),p(P(19,21,o.spouse_or_father_name)),l(3),p(P(22,23,o.social_category)),l(3),p(P(25,25,o.pwd_status)),l(3),p(o.alt_mobile_number),l(2),p(P(30,27,o.application_status)),l(2),E(31,o.is_optout==1?31:-1),l(2),p(P(34,29,o.optout_date))}}function Zk(i,s){if(i&1&&(t(0,"table",57)(1,"thead",58)(2,"tr")(3,"th"),a(4,"SI#"),e(),t(5,"th"),a(6,"WARD NO."),e(),t(7,"th"),a(8,"CATEGORY"),e(),t(9,"th"),a(10,"APPLICATION NO."),e(),t(11,"th"),a(12,"APPLICATION DATE"),e(),t(13,"th"),a(14,"APPLICANT NAME"),e(),t(15,"th"),a(16,"FATHER/HUSBAND NAME"),e(),t(17,"th"),a(18,"SOCIAL CATEGORY"),e(),t(19,"th"),a(20,"PWD"),e(),t(21,"th"),a(22,"MOBILE NO."),e(),t(23,"th"),a(24,"APPLICATION STATUS"),e(),t(25,"th"),a(26,"OPT OUT STATUS"),e(),t(27,"th"),a(28,"OPT OUT DATE"),e()()(),t(29,"tbody"),F(30,Qk,35,31,"tr",null,Hk),e()()),i&2){let o=h(2);l(30),V(o.filteredWardUserStats)}}function tP(i,s){i&1&&(t(0,"h5",59),a(1,"No data available"),e())}function eP(i,s){i&1&&(t(0,"div",60),a(1,"Loading.. "),m(2,"i",61),e())}function iP(i,s){i&1&&(t(0,"span"),m(1,"i",40),a(2," Loading..."),e())}function nP(i,s){i&1&&(t(0,"span"),a(1,"Load More"),e())}function oP(i,s){if(i&1){let o=U();t(0,"div",62)(1,"button",63),L("click",function(){D(o);let r=h(2);return A(r.loadMore())}),b(2,iP,3,0,"span",64)(3,nP,2,0,"span",64),e()()}if(i&2){let o=h(2);l(2),T("ngIf",o.isLoadMoreInProgress),l(1),T("ngIf",!o.isLoadMoreInProgress)}}function aP(i,s){if(i&1){let o=U();t(0,"div",30)(1,"div",41)(2,"h5",2),a(3," Number of records found : "),t(4,"span",42),a(5),e()()(),t(6,"div",43)(7,"div",44)(8,"input",45),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(9,"i",46),e(),t(10,"div",47),b(11,$k,3,0,"button",48)(12,Gk,3,0),e(),t(13,"div",49),b(14,Xk,3,0,"button",48)(15,Yk,3,0),e()()(),t(16,"div",50),b(17,Zk,32,0,"table",51)(18,tP,2,0)(19,eP,3,0,"div",52),e(),b(20,oP,4,2,"div",53)}if(i&2){let o=h();l(5),p(o.count),l(3),T("ngModel",o.searchTerm),l(3),E(11,o.isExportInProgress?12:11),l(3),E(14,o.isExportInProgressExcel?15:14),l(3),E(17,o.filteredWardUserStats&&o.filteredWardUserStats.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),l(2),E(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),l(1),T("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var ns=(()=>{let s=class s{constructor(n,r,c,f,d,C,g,_){this.route=n,this.router=r,this.formService=c,this.appService=f,this.httpClient=d,this.toastService=C,this.authService=g,this.masterDataService=_,this.isStatsLoading=!1,this.userStats=[],this.ulb_id="",this.ward_id="",this.village_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.limit=this.appService.loadmorelimit,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.count=0,this.searchForm=new kt({a_category:new nt(""),social_category:new nt(""),pwd_status:new nt(""),submit_date:new nt(""),a_status:new nt("")})}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.ulb_id=n.ulb_id,this.ward_id=n.id,this.fetchuserStats(this.ward_id)})}fetchuserStats(n,r=!1){this.isStatsLoading=!0;let c=new st;c=c.set("ward_id",n),c=c.set("offset",this.offset),c=c.set("limit",this.limit),c=c.set("opt_out","1"),c=c.set("installment",this.installment);let f=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:c,headers:f}).subscribe(d=>{this.isStatsLoading=!1,this.count=d.count,d.data&&d.data.length>0?(this.application_list=this.application_list.concat(d.data),this.offset+=d.data.length,this.hasMoreRecords=d.data.length===this.limit):this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)},d=>{this.isStatsLoading=!1,this.application_list=[],this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)})}get filteredWardUserStats(){if(!this.searchTerm)return this.application_list;let n=this.searchTerm.toLowerCase();return this.application_list.filter(r=>r.ward_no?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.category?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.application_number?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_date).toLowerCase().includes(this.searchTerm.toLowerCase())||r.applicant_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.spouse_or_father_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.dob).toLowerCase().includes(this.searchTerm.toLowerCase())||r.social_category?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.pwd_status?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.alt_mobile_number?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.npci_remark?.toLowerCase().includes(this.searchTerm.toLowerCase()))}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status,_=new st;r&&(_=_.set("ward_id",r)),c&&(_=_.set("category",c)),f&&(_=_.set("social_category",f)),d&&(_=_.set("pwd_status",d)),_=_.set("offset",this.offset),_=_.set("limit",this.limit),_=_.set("opt_out","1"),_=_.set("installment",this.installment);let v=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:_,headers:v}).subscribe(S=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=S.count,S.data&&S.data.length>0?(this.application_list=this.application_list.concat(S.data),this.offset+=S.data.length,this.hasMoreRecords=S.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},S=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}exportToExcel(){let n=new st,r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;r&&(n=n.set("ward_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),n=n.set("export_all","1"),n=n.set("opt_out","1"),n=n.set("installment",this.installment);let _=new rt({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgressExcel=!1;let S=v.data.map((y,B)=>({"SI#":B+1,DISTRICT:y.district_name?y.district_name.toUpperCase():"",ULB:y.ulb_name?y.ulb_name.toUpperCase():"","WARD NO.":y.ward_no?y.ward_no.toUpperCase():"",CATEGORY:y.category.toUpperCase(),"APPLICATION NO.":y.application_number.toUpperCase(),"APPLICATION DATE":this.appService.dateFormat(y.application_date),"APPLICANT NAME":y.applicant_name.toUpperCase(),"FATHER/HUSBAND NAME":y.spouse_or_father_name.toUpperCase(),"SOCIAL CATEGORY":y.social_category.toUpperCase(),PWD:y.pwd_status.toUpperCase(),"MOBILE NO.":y.alt_mobile_number,"APPLICATION STATUS.":y.application_status,"OPT OUT STATUS":y.is_optout=="1"?"OPTED OUT":"","OPT OUT DATE":y.optout_date})),w=N.json_to_sheet(S),u=N.book_new();N.book_append_sheet(u,w,"Applications");let I=Z(u,{bookType:"xlsx",type:"array"}),R=new Date,z=R.toLocaleDateString("en-GB").split("/").reverse().join("-"),at=R.toLocaleTimeString("en-GB").replace(/:/g,"-"),ct=`opt_out_reports_${z}_${at}.xlsx`,lt=new Blob([I],{type:"application/octet-stream"}),O=document.createElement("a"),et=window.URL.createObjectURL(lt);O.href=et,O.download=ct,O.click(),window.URL.revokeObjectURL(et)},v=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",v)})}exportToPDF(){Qi.default.vfs=is.default.pdfMake.vfs;let n=new st,r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;r&&(n=n.set("ward_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),n=n.set("export_all","1"),n=n.set("opt_out","1"),n=n.set("installment",this.installment);let _=new rt({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgress=!1;let S=v.data[0]||{},w=(S.district_name||"N/A").toUpperCase(),u=(S.block_name||S.ulb_name||"N/A").toUpperCase(),I=(S.gp_name||S.ward_no||"N/A").toUpperCase(),R=[[{text:"SI#",fontSize:10},{text:"CATEGORY",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICATION DATE.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"SOCIAL CATEGORY",fontSize:10},{text:"PWD",fontSize:10},{text:"MOBILE NO",fontSize:10},{text:"APPLICATION STATUS",fontSize:10},{text:"OPT OUT STATUS",fontSize:10},{text:"OPT OUT DATE",fontSize:10}]];v.data.forEach((B,W)=>{R.push([{text:(W+1).toString().toUpperCase(),fontSize:9},{text:(B.category||"").toUpperCase(),fontSize:9},{text:(B.application_number||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(B.application_date)||"",fontSize:9},{text:(B.applicant_name||"").toUpperCase(),fontSize:9},{text:(B.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:(B.social_category||"").toUpperCase(),fontSize:9},{text:(B.pwd_status||"").toUpperCase(),fontSize:9},{text:(B.alt_mobile_number||"").toUpperCase(),fontSize:9},{text:(B.application_status||"").toUpperCase(),fontSize:9},{text:B.is_optout=="1"?"OPTED OUT":"",fontSize:9},{text:(B.optout_date||"").toUpperCase(),fontSize:9}])});let z=new Date,at=`Timestamp: ${z.toLocaleDateString()}, ${z.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,ct={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${w} > ULB: ${u} > WARD: ${I}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DETAILED REPORT - OPT-OUT",style:"header"},{table:{headerRows:1,body:R,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]},layout:{fillColor:function(B){return B===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:at,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},lt=new Date,O=lt.toLocaleDateString("en-GB").split("/").reverse().join("-"),et=lt.toLocaleTimeString("en-GB").replace(/:/g,"-"),y=`opt_out_reports_${O}_${et}.pdf`;Qi.default.createPdf(ct).download(y)},v=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",v)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(Ot),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-optout-ward-user-list"]],decls:56,vars:4,consts:[[1,"container-fluid","drilldown-reports"],[1,"d-flex","justify-content-between","w-100","mb-3"],[1,"card-title"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],["class","row mb-2"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-2"],[1,"col-md-4"],["for","a_category",1,"fw-bold"],["id","a_category","formControlName","a_category",1,"form-select","my-2"],["value",""],["value","1"],["value","0"],["for","social_category",1,"fw-bold"],["formControlName","social_category","id","social_category",1,"form-select","my-2"],["value","2"],["value","3"],["value","4"],["for","pwd_status",1,"fw-bold"],["formControlName","pwd_status","id","pwd_status",1,"form-select","my-2"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[1,"row","mb-2"],[1,"col-md-7"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"fa","fa-spinner","fa-spin"],[1,"col-md-5"],["id","recordCount"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports detail"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports","detail"],[1,"text-light",2,"background-color","#fd7b03"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"],[4,"ngIf"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1)(2,"h4",2),a(3,"Detailed Report - Opt Out"),e(),t(4,"div",3)(5,"a",4),L("click",function(){return c.appService.goBack()}),t(6,"button",5),m(7,"i",6),a(8," Back"),e()()()(),b(9,Fk,10,3,"div",7),t(10,"div",8)(11,"form",9),L("ngSubmit",function(){return c.onSearch()}),t(12,"div",10)(13,"div",11)(14,"label",12),a(15," Category "),e(),t(16,"select",13)(17,"option",14),a(18,"Choose Category"),e(),t(19,"option",15),a(20,"NFSA"),e(),t(21,"option",16),a(22,"NON-NFSA"),e()()(),t(23,"div",11)(24,"label",17),a(25," Social Category "),e(),t(26,"select",18)(27,"option",14),a(28,"Choose Social Category"),e(),t(29,"option",15),a(30,"Un-Reserved"),e(),t(31,"option",19),a(32,"OBC"),e(),t(33,"option",20),a(34,"SC"),e(),t(35,"option",21),a(36,"ST"),e()()(),t(37,"div",11)(38,"label",22),a(39," PWD "),e(),t(40,"select",23)(41,"option",14),a(42,"Choose PWD Status"),e(),t(43,"option",15),a(44,"Yes "),e(),t(45,"option",16),a(46,"NO"),e()()()(),t(47,"div",24)(48,"div",25),b(49,Vk,3,0,"button",26)(50,zk,3,0),e()()()(),t(51,"div",27)(52,"div",28)(53,"div",29),b(54,jk,2,0)(55,aP,21,7),e()()()()),r&2&&(l(9),E(9,c.filteredWardUserStats&&c.filteredWardUserStats.length>0?9:-1),l(2),T("formGroup",c.searchForm),l(38),E(49,c.isFormSearchInProgress?50:49),l(5),E(54,c.isStatsLoading?54:55))},dependencies:[ft,Pt,Nt,Rt,K,Ut,q,yt,J,Dt,At,it]});let i=s;return i})();var Zi=j(ut()),os=j(ht());function rP(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function sP(i,s){if(i&1){let o=U();t(0,"button",22),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",23),a(2,"Download PDF "),e()}}function lP(i,s){i&1&&(t(0,"button",24),m(1,"i",25),a(2,"Downloading "),e())}function cP(i,s){if(i&1){let o=U();t(0,"button",22),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",23),a(2,"Download EXCEL "),e()}}function dP(i,s){i&1&&(t(0,"button",24),m(1,"i",25),a(2,"Downloading "),e())}var pP=(i,s)=>s.id,mP=i=>({installment:i});function _P(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",29),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),$t("routerLink","/department/portal/nonnfsa-reject/block-ulb-stats/",o.district_id,""),T("queryParams",pt(7,mP,r.installment)),l(1),p(P(6,5,o.district_name)),l(3),p(o==null?null:o.non_nfsa_rejected_application)}}function fP(i,s){if(i&1&&(t(0,"table",26)(1,"thead",27)(2,"tr")(3,"th"),a(4,"Sl.#"),e(),t(5,"th"),a(6,"DISTRICT"),e(),t(7,"th"),a(8,"APPLICATION REJECTED"),e()()(),t(9,"tbody",28),F(10,_P,9,9,"tr",null,pP),e()()),i&2){let o=h(2);l(10),V(o.filteredDistrictStats)}}function uP(i,s){i&1&&a(0," No Data Found ")}function hP(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - NON-NFSA Applications Rejected"),e()(),t(4,"div",13)(5,"div",14)(6,"input",15),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(7,"i",16),e(),t(8,"div",17),b(9,sP,3,0,"button",18)(10,lP,3,0),e(),t(11,"div",19),b(12,cP,3,0,"button",18)(13,dP,3,0),e()()(),t(14,"div",20),b(15,fP,12,0,"table",21)(16,uP,1,0),e()}if(i&2){let o=h();l(6),T("ngModel",o.searchTerm),l(3),E(9,o.isExportInProgress?10:9),l(3),E(12,o.isExportInProgressExcel?13:12),l(3),E(15,o.filteredDistrictStats&&o.filteredDistrictStats.length>0?15:16)}}var as=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.districtStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment,this.card_name=n.card_name,this.fetchDistrictStats()})}fetchDistrictStats(){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?nonnfsa_rejeted=1&card_name=${this.card_name}&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isStatsLoading=!1,this.districtStats=n.data},n=>{this.isStatsLoading=!1,this.districtStats=[]})}get filteredDistrictStats(){return this.searchTerm?this.districtStats.filter(n=>n.district_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.districtStats}exportToExcel(){this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?nonnfsa_rejeted=1&installment=${this.installment}&card_name=${this.card_name}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isExportInProgressExcel=!1;let r=n.data.map((I,R)=>({"SI#":R+1,DISTRICT:I.district_name.toUpperCase(),"APPLICATION REJECTED":I?.non_nfsa_rejected_application})),c=N.json_to_sheet(r),f=N.book_new();N.book_append_sheet(f,c,"Applications");let d=Z(f,{bookType:"xlsx",type:"array"}),C=new Date,g=C.toLocaleDateString("en-GB").split("/").reverse().join("-"),_=C.toLocaleTimeString("en-GB").replace(/:/g,"-"),v=`non_nfsa_reject_district_drilldown_reports_${g}_${_}.xlsx`,S=new Blob([d],{type:"application/octet-stream"}),w=document.createElement("a"),u=window.URL.createObjectURL(S);w.href=u,w.download=v,w.click(),window.URL.revokeObjectURL(u)},n=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",n)})}exportToPDF(){Zi.default.vfs=os.default.pdfMake.vfs,this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?nonnfsa_rejeted=1&installment=${this.installment}&card_name=${this.card_name}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isExportInProgress=!1;let r=[[{text:"SI#",fontSize:10},{text:"DISTRICT",fontSize:10},{text:"APPLICATION REJECTED",fontSize:10}]];n.data.forEach((S,w)=>{r.push([{text:(w+1).toString().toUpperCase(),fontSize:9},{text:(S.district_name||"").toUpperCase(),fontSize:9},{text:S?.non_nfsa_rejected_application,fontSize:9}])});let c=new Date,f=`Timestamp: ${c.toLocaleDateString()}, ${c.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,d={pageOrientation:"landscape",pageSize:"A4",content:[{text:"DRILL-DOWN REPORT - NON-NFSA APPLICATIONS REJECTED DISTRICT-WISE",style:"header"},{table:{headerRows:1,body:r,widths:["20%","50%","30%"]},layout:{fillColor:function(S){return S===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:f,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},C=new Date,g=C.toLocaleDateString("en-GB").split("/").reverse().join("-"),_=C.toLocaleTimeString("en-GB").replace(/:/g,"-"),v=`non_nfsa_reject_district_drilldown_reports_${g}_${_}.pdf`;Zi.default.createPdf(d).download(v)},n=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",n)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-nonnfsa-reject-district-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,rP,2,0)(11,hP,17,4),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var tn=j(ut()),rs=j(ht());function SP(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function xP(i,s){if(i&1){let o=U();t(0,"button",25),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",26),a(2,"Download PDF "),e()}}function gP(i,s){i&1&&(t(0,"button",27),m(1,"i",28),a(2,"Downloading "),e())}function CP(i,s){if(i&1){let o=U();t(0,"button",25),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",26),a(2,"Download EXCEL "),e()}}function bP(i,s){i&1&&(t(0,"button",27),m(1,"i",28),a(2,"Downloading "),e())}var vP=(i,s)=>s.id,ss=i=>({installment:i});function EP(i,s){if(i&1&&(t(0,"a",33),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit,n=h(3);Vt("routerLink","/department/portal/nonnfsa-reject/gp-stats/",o.district_id,"/",o.block_id,""),T("queryParams",pt(6,ss,n.installment)),l(1),p(P(2,4,o.block_name))}}function wP(i,s){if(i&1&&(t(0,"a",33),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit,n=h(3);Vt("routerLink","/department/portal/nonnfsa-reject/ward-stats/",o.district_id,"/",o.ulb_id,""),T("queryParams",pt(6,ss,n.installment)),l(1),p(P(2,4,o.ulb_name))}}function TP(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td"),b(4,EP,3,8,"a",32)(5,wP,3,8),e(),t(6,"td"),a(7),e()()),i&2){let o=s.$implicit,n=s.$index;l(2),p(n+1),l(2),E(4,o.block_id?4:5),l(3),p(o==null?null:o.applications_received)}}function LP(i,s){if(i&1&&(t(0,"table",29)(1,"thead",30)(2,"tr")(3,"th"),a(4,"Sl.#"),e(),t(5,"th"),a(6,"BLOCK/ULB"),e(),t(7,"th"),a(8,"APPLICATION REJECTED"),e()()(),t(9,"tbody",31),F(10,TP,8,3,"tr",null,vP),e()()),i&2){let o=h(2);l(10),V(o.filteredBlockStats)}}function IP(i,s){i&1&&a(0," No Data Found ")}function yP(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - NON-NFSA Applications Rejected"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e()()()(),t(8,"div",16)(9,"div",17)(10,"input",18),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(11,"i",19),e(),t(12,"div",20),b(13,xP,3,0,"button",21)(14,gP,3,0),e(),t(15,"div",22),b(16,CP,3,0,"button",21)(17,bP,3,0),e()()(),t(18,"div",23),b(19,LP,12,0,"table",24)(20,IP,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredBlockStats[0].district_name),l(3),T("ngModel",o.searchTerm),l(3),E(13,o.isExportInProgress?14:13),l(3),E(16,o.isExportInProgressExcel?17:16),l(3),E(19,o.filteredBlockStats&&o.filteredBlockStats.length>0?19:20)}}var ls=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.districtStats=[],this.district_id="",this.blockStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{let r=n.id;this.district_id=r,this.fetchblockStats(r)})}fetchblockStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/block-count?district_id=${n}&nonnfsa_rejeted=1&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.blockStats=r.data,this.fetchulbStats(n)},r=>{this.isStatsLoading=!1,this.blockStats=[]})}fetchulbStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/ulb-count?district_id=${n}&nonnfsa_rejeted=1&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.blockStats=[...this.blockStats,...r.data]},r=>{this.isStatsLoading=!1})}get filteredBlockStats(){return this.searchTerm?this.blockStats.filter(n=>n.block_name&&n.block_name.toLowerCase().includes(this.searchTerm.toLowerCase())||n.ulb_name&&n.ulb_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.blockStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.blockStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name,"BLOCK/ULB":(u.block_name||u.ulb_name).toUpperCase(),"APPLICATION REJECTED":u?.applications_received})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`non_nfsa_reject_block_ulb_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){tn.default.vfs=rs.default.pdfMake.vfs,this.isExportInProgress=!0;let r=((this.blockStats[0]||{}).district_name||"N/A").toUpperCase(),c=[[{text:"SI#",fontSize:10},{text:"BLOCK/ULB",fontSize:10},{text:"APPLICATION REJECTED",fontSize:10}]];this.blockStats.forEach((w,u)=>{c.push([{text:(u+1).toString().toUpperCase(),fontSize:9},{text:(w.block_name||w.ulb_name||"").toUpperCase(),fontSize:9},{text:w?.applications_received,fontSize:9}])});let f=new Date,d=`Timestamp: ${f.toLocaleDateString()}, ${f.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,C={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - NON-NFSA APPLICATIONS REJECETED BLOCK/ULB WISE",style:"header"},{table:{headerRows:1,body:c,widths:["20%","50%","30%"]},layout:{fillColor:function(w){return w===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:d,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},g=new Date,_=g.toLocaleDateString("en-GB").split("/").reverse().join("-"),v=g.toLocaleTimeString("en-GB").replace(/:/g,"-"),S=`non_nfsa_reject_block_ulb_drilldown_reports_${_}_${v}.pdf`;tn.default.createPdf(C).download(S,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-nonnfsa-reject-block-ulb-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],[2,"font-size","14px"],["style","text-decoration: none",3,"routerLink","queryParams"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,SP,2,0)(11,yP,21,5),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var en=j(ut()),cs=j(ht());function kP(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function PP(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",27),a(2,"Download PDF "),e()}}function DP(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}function AP(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",27),a(2,"Download EXCEL "),e()}}function UP(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}var NP=(i,s)=>s.id,RP=i=>({installment:i});function OP(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",33),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),Mt("routerLink","/department/portal/nonnfsa-reject/village-stats/",o.district_id,"/",o.block_id,"/",o.gp_id,""),T("queryParams",pt(9,RP,r.installment)),l(1),p(P(6,7,o.gp_name)),l(3),p(o==null?null:o.applications_received)}}function BP(i,s){if(i&1&&(t(0,"table",30)(1,"thead",31)(2,"tr")(3,"th"),a(4,"Sl.#"),e(),t(5,"th"),a(6,"GRAM PANCHAYAT"),e(),t(7,"th"),a(8,"APPLICATION REJECTED"),e()()(),t(9,"tbody",32),F(10,OP,9,11,"tr",null,NP),e()()),i&2){let o=h(2);l(10),V(o.filteredGpStats)}}function WP(i,s){i&1&&a(0," No Data Found ")}function MP(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - NON-NFSA Applications Rejected"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e(),t(8,"li",16),a(9),e()()()(),t(10,"div",17)(11,"div",18)(12,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(13,"i",20),e(),t(14,"div",21),b(15,PP,3,0,"button",22)(16,DP,3,0),e(),t(17,"div",23),b(18,AP,3,0,"button",22)(19,UP,3,0),e()()(),t(20,"div",24),b(21,BP,12,0,"table",25)(22,WP,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredGpStats[0].district_name),l(2),p(o.filteredGpStats[0].block_name),l(3),T("ngModel",o.searchTerm),l(3),E(15,o.isExportInProgress?16:15),l(3),E(18,o.isExportInProgressExcel?19:18),l(3),E(21,o.filteredGpStats&&o.filteredGpStats.length>0?21:22)}}var ds=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.district_id="",this.gpStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.id,this.fetchgpStats(this.block_id)})}fetchgpStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/gp-count?block_id=${n}&nonnfsa_rejeted=1&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.gpStats=r.data},r=>{this.isStatsLoading=!1,this.gpStats=[]})}get filteredGpStats(){return this.searchTerm?this.gpStats.filter(n=>n.gp_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.gpStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.gpStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",BLOCK:u.block_name?u.block_name.toUpperCase():"",GP:u.gp_name?u.gp_name.toUpperCase():"","APPLICATION REJECTED":u?.applications_received})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`non_nfsa_reject_gp_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){en.default.vfs=cs.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.gpStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=[[{text:"SI#",fontSize:10},{text:"GP",fontSize:10},{text:"APPLICATION REJECTED",fontSize:10}]];this.gpStats.forEach((u,I)=>{f.push([{text:(I+1).toString().toUpperCase(),fontSize:9},{text:(u.gp_name||"").toUpperCase(),fontSize:9},{text:u?.applications_received,fontSize:9}])});let d=new Date,C=`Timestamp: ${d.toLocaleDateString()}, ${d.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,g={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK: ${c}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - NON-NFSA APPLICATIONS REJECTED GP WISE",style:"header"},{table:{headerRows:1,body:f,widths:["20%","50%","30%"]},layout:{fillColor:function(u){return u===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:C,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},_=new Date,v=_.toLocaleDateString("en-GB").split("/").reverse().join("-"),S=_.toLocaleTimeString("en-GB").replace(/:/g,"-"),w=`non_nfsa_reject_gp_drilldown_reports_${v}_${S}.pdf`;en.default.createPdf(g).download(w,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-nonnfsa-reject-gp-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,kP,2,0)(11,MP,23,6),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var nn=j(ut()),ps=j(ht());function FP(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function VP(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",27),a(2,"Download PDF "),e()}}function zP(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}function jP(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",27),a(2,"Download EXCEL "),e()}}function $P(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}var GP=(i,s)=>s.id,XP=i=>({installment:i});function YP(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",33),a(5),e()(),t(6,"td"),a(7),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),Mt("routerLink","/department/portal/nonnfsa-reject/ward-user-list/",o.district_id,"/",o.ulb_id,"/",o.ward_id,""),T("queryParams",pt(7,XP,r.installment)),l(1),p(o.ward_no),l(2),p(o==null?null:o.applications_received)}}function HP(i,s){if(i&1&&(t(0,"table",30)(1,"thead",31)(2,"tr")(3,"th"),a(4,"Sl.#"),e(),t(5,"th"),a(6,"WARD"),e(),t(7,"th"),a(8,"APPLICATION REJECTED"),e()()(),t(9,"tbody",32),F(10,YP,8,9,"tr",null,GP),e()()),i&2){let o=h(2);l(10),V(o.filteredWardStats)}}function KP(i,s){i&1&&a(0," No Data Found ")}function qP(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - NON-NFSA Applications Rejected"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e(),t(8,"li",16),a(9),e()()()(),t(10,"div",17)(11,"div",18)(12,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(13,"i",20),e(),t(14,"div",21),b(15,VP,3,0,"button",22)(16,zP,3,0),e(),t(17,"div",23),b(18,jP,3,0,"button",22)(19,$P,3,0),e()()(),t(20,"div",24),b(21,HP,12,0,"table",25)(22,KP,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredWardStats[0].district_name),l(2),p(o.filteredWardStats[0].ulb_name),l(3),T("ngModel",o.searchTerm),l(3),E(15,o.isExportInProgress?16:15),l(3),E(18,o.isExportInProgressExcel?19:18),l(3),E(21,o.filteredWardStats&&o.filteredWardStats.length>0?21:22)}}var ms=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.district_id="",this.wardStats=[],this.ulb_id="",this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.ulb_id=n.id,this.fetchWardStats(this.ulb_id)})}fetchWardStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/ward-count?ulb_id=${n}&nonnfsa_rejeted=1&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.wardStats=r.data},r=>{this.isStatsLoading=!1,this.wardStats=[]})}get filteredWardStats(){return this.searchTerm?this.wardStats.filter(n=>n.ward_no.toLowerCase().includes(this.searchTerm.toLowerCase())):this.wardStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.wardStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",ULB:u.ulb_name?u.ulb_name.toUpperCase():"","WARD NO.":u.ward_no?u.ward_no.toUpperCase():"","APPLICATION REJECTED":u?.applications_received})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`non_nfsa_reject_ward_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){nn.default.vfs=ps.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.wardStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=[[{text:"SI#",fontSize:10},{text:"WARD NO.",fontSize:10},{text:"APPLICATION REJECTED",fontSize:10}]];this.wardStats.forEach((u,I)=>{f.push([{text:(I+1).toString().toUpperCase(),fontSize:9},{text:(u.ward_no||"").toUpperCase(),fontSize:9},{text:u?.applications_received,fontSize:9}])});let d=new Date,C=`Timestamp: ${d.toLocaleDateString()}, ${d.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,g={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK/ULB: ${c}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - NON-NFSA APPLICATION REJECTED WARD WISE",style:"header"},{table:{headerRows:1,body:f,widths:["20%","50%","30%"]},layout:{fillColor:function(u){return u===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:C,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},_=new Date,v=_.toLocaleDateString("en-GB").split("/").reverse().join("-"),S=_.toLocaleTimeString("en-GB").replace(/:/g,"-"),w=`non_nfsa_reject_ward_drilldown_reports_${v}_${S}.pdf`;nn.default.createPdf(g).download(w,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-nonnfsa-reject-ward-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,FP,2,0)(11,qP,23,6),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J]});let i=s;return i})();var on=j(ut()),_s=j(ht());function JP(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function QP(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",27),a(2,"Download PDF "),e()}}function ZP(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}function tD(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",27),a(2,"Download EXCEL "),e()}}function eD(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}var iD=(i,s)=>s.id,nD=i=>({installment:i});function oD(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",33),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),Gt("routerLink","/department/portal/nonnfsa-reject/village-user-list/",o.district_id,"/",o.block_id,"/",o.gp_id,"/",o.village_id,""),T("queryParams",pt(10,nD,r.installment)),l(1),p(P(6,8,o.village_name)),l(3),p(o==null?null:o.applications_received)}}function aD(i,s){if(i&1&&(t(0,"table",30)(1,"thead",31)(2,"tr")(3,"th"),a(4,"Sl.#"),e(),t(5,"th"),a(6,"VILLAGE"),e(),t(7,"th"),a(8,"APPLICATION REJECTED"),e()()(),t(9,"tbody",32),F(10,oD,9,12,"tr",null,iD),e()()),i&2){let o=h(2);l(10),V(o.filteredVillageStats)}}function rD(i,s){i&1&&a(0," No Data Found ")}function sD(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - NON-NFSA Applications Rejected"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e(),t(8,"li",15),a(9),e(),t(10,"li",16),a(11),e()()()(),t(12,"div",17)(13,"div",18)(14,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(15,"i",20),e(),t(16,"div",21),b(17,QP,3,0,"button",22)(18,ZP,3,0),e(),t(19,"div",23),b(20,tD,3,0,"button",22)(21,eD,3,0),e()()(),t(22,"div",24),b(23,aD,12,0,"table",25)(24,rD,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredVillageStats[0].district_name),l(2),p(o.filteredVillageStats[0].block_name),l(2),p(o.filteredVillageStats[0].gp_name),l(3),T("ngModel",o.searchTerm),l(3),E(17,o.isExportInProgress?18:17),l(3),E(20,o.isExportInProgressExcel?21:20),l(3),E(23,o.filteredVillageStats&&o.filteredVillageStats.length>0?23:24)}}var fs=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.gp_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.block_id,this.gp_id=n.id,this.fetchvillageStats(this.gp_id)})}fetchvillageStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/village-count?gp_id=${n}&nonnfsa_rejeted=1&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.villageStats=r.data},r=>{this.isStatsLoading=!1,this.villageStats=[]})}get filteredVillageStats(){return this.searchTerm?this.villageStats.filter(n=>n.village_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.villageStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.villageStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",BLOCK:u.block_name?u.block_name.toUpperCase():"",GP:u.gp_name?u.gp_name.toUpperCase():"",VILLAGE:u.village_name?u.village_name.toUpperCase():"","APPLICATION REJECTED":u?.applications_received})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`non_nfsa_reject_village_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){on.default.vfs=_s.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.villageStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=(n.gp_name||n.ward_no||"N/A").toUpperCase(),d=[[{text:"SI#",fontSize:10},{text:"VILLAGE",fontSize:10},{text:"APPLICATION REJECTED",fontSize:10}]];this.villageStats.forEach((I,R)=>{d.push([{text:(R+1).toString().toUpperCase(),fontSize:9},{text:(I.village_name||"").toUpperCase(),fontSize:9},{text:I?.applications_received,fontSize:9}])});let C=new Date,g=`Timestamp: ${C.toLocaleDateString()}, ${C.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,_={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK: ${c} > GP:${f}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - NON-NFSA APPLICATION REJECTED VILLAGE WISE",style:"header"},{table:{headerRows:1,body:d,widths:["20%","50%","30%"]},layout:{fillColor:function(I){return I===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:g,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},v=new Date,S=v.toLocaleDateString("en-GB").split("/").reverse().join("-"),w=v.toLocaleTimeString("en-GB").replace(/:/g,"-"),u=`non_nfsa_reject_village_drilldown_reports_${S}_${w}.pdf`;on.default.createPdf(_).download(u,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-nonnfsa-reject-village-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,JP,2,0)(11,sD,25,7),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var an=j(ut()),us=j(ht());function lD(i,s){if(i&1&&(t(0,"div",28)(1,"div",29)(2,"nav",30)(3,"ol",31)(4,"li",32),a(5),e(),t(6,"li",32),a(7),e(),t(8,"li",32),a(9),e(),t(10,"li",33),a(11),e()()()()()),i&2){let o=h();l(5),p(o.filteredVillageUserStats[0].district_name),l(2),p(o.filteredVillageUserStats[0].block_name),l(2),p(o.filteredVillageUserStats[0].gp_name),l(2),p(o.filteredVillageUserStats[0].village_name)}}function cD(i,s){i&1&&(t(0,"button",34),m(1,"i",35),a(2,"Search "),e())}function dD(i,s){i&1&&(t(0,"button",36),m(1,"i",37),a(2," Searching ..."),e())}function pD(i,s){i&1&&(m(0,"i",38),a(1," We are fetching the data, please wait. "))}function mD(i,s){if(i&1){let o=U();t(0,"button",52),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",53),a(2,"Download to PDF "),e()}}function _D(i,s){i&1&&(t(0,"button",54),m(1,"i",37),a(2,"Downloading "),e())}function fD(i,s){if(i&1){let o=U();t(0,"button",52),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",53),a(2,"Download to EXCEL "),e()}}function uD(i,s){i&1&&(t(0,"button",54),m(1,"i",37),a(2,"Downloading "),e())}var hD=(i,s)=>s.id;function SD(i,s){if(i&1&&(t(0,"td"),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit;l(1),p(P(2,1,o.village_name))}}function xD(i,s){i&1&&m(0,"td")}function gD(i,s){i&1&&(t(0,"span"),a(1,", "),e())}function CD(i,s){if(i&1&&(t(0,"span"),a(1),b(2,gD,2,0,"span",58),e()),i&2){let o=s.$implicit,n=s.index,r=h().$implicit,c=h(3);l(1),dt(" ",o," "),l(1),T("ngIf",n<c.getAllReasons(r).length-1)}}function bD(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),b(3,SD,3,3,"td")(4,xD,1,0),t(5,"td"),a(6),k(7,"uppercase"),e(),t(8,"td"),a(9),k(10,"uppercase"),e(),t(11,"td"),a(12),k(13,"uppercase"),e(),t(14,"td"),a(15),k(16,"uppercase"),e(),t(17,"td"),a(18),k(19,"uppercase"),e(),t(20,"td"),a(21),k(22,"uppercase"),e(),t(23,"td"),a(24),e(),t(25,"td"),a(26),k(27,"uppercase"),e(),t(28,"td"),b(29,CD,3,2,"span",57),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(1),E(3,o.village_name?3:4),l(3),p(P(7,11,o.application_number)),l(3),p(P(10,13,r.appService.dateFormat(o.application_date))),l(3),p(P(13,15,o.applicant_name)),l(3),p(P(16,17,o.spouse_or_father_name)),l(3),p(P(19,19,o.social_category)),l(3),p(P(22,21,o.pwd_status)),l(3),p(o.alt_mobile_number),l(2),p(P(27,23,o.application_status)),l(3),T("ngForOf",r.getAllReasons(o))}}function vD(i,s){if(i&1&&(t(0,"table",55)(1,"thead",56)(2,"tr")(3,"th"),a(4,"SI#"),e(),t(5,"th"),a(6,"VILLAGE"),e(),t(7,"th"),a(8,"APPLICATION NO."),e(),t(9,"th"),a(10,"APPLICATION DATE"),e(),t(11,"th"),a(12,"APPLICANT NAME"),e(),t(13,"th"),a(14,"FATHER/HUSBAND NAME"),e(),t(15,"th"),a(16,"SOCIAL CATEGORY"),e(),t(17,"th"),a(18,"PWD"),e(),t(19,"th"),a(20,"MOBILE NO."),e(),t(21,"th"),a(22,"APPLICATION STATUS"),e(),t(23,"th"),a(24,"REASONS FOR INELIGIBILITY"),e()()(),t(25,"tbody"),F(26,bD,30,25,"tr",null,hD),e()()),i&2){let o=h(2);l(26),V(o.filteredVillageUserStats)}}function ED(i,s){i&1&&(t(0,"h5",59),a(1,"No data available"),e())}function wD(i,s){i&1&&(t(0,"div",60),a(1,"Loading.. "),m(2,"i",61),e())}function TD(i,s){i&1&&(t(0,"span"),m(1,"i",38),a(2," Loading..."),e())}function LD(i,s){i&1&&(t(0,"span"),a(1,"Load More"),e())}function ID(i,s){if(i&1){let o=U();t(0,"div",62)(1,"button",63),L("click",function(){D(o);let r=h(2);return A(r.loadMore())}),b(2,TD,3,0,"span",58)(3,LD,2,0,"span",58),e()()}if(i&2){let o=h(2);l(2),T("ngIf",o.isLoadMoreInProgress),l(1),T("ngIf",!o.isLoadMoreInProgress)}}function yD(i,s){if(i&1){let o=U();t(0,"div",28)(1,"div",39)(2,"h5",2),a(3," Number of records found : "),t(4,"span",40),a(5),e()()(),t(6,"div",41)(7,"div",42)(8,"input",43),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(9,"i",44),e(),t(10,"div",45),b(11,mD,3,0,"button",46)(12,_D,3,0),e(),t(13,"div",47),b(14,fD,3,0,"button",46)(15,uD,3,0),e()()(),t(16,"div",48),b(17,vD,28,0,"table",49)(18,ED,2,0)(19,wD,3,0,"div",50),e(),b(20,ID,4,2,"div",51)}if(i&2){let o=h();l(5),p(o.count),l(3),T("ngModel",o.searchTerm),l(3),E(11,o.isExportInProgress?12:11),l(3),E(14,o.isExportInProgressExcel?15:14),l(3),E(17,o.filteredVillageUserStats&&o.filteredVillageUserStats.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),l(2),E(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),l(1),T("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var hs=(()=>{let s=class s{constructor(n,r,c,f,d,C,g,_){this.route=n,this.router=r,this.formService=c,this.appService=f,this.httpClient=d,this.toastService=C,this.authService=g,this.masterDataService=_,this.isStatsLoading=!1,this.userStats=[],this.block_id="",this.gp_id="",this.village_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.limit=this.appService.loadmorelimit,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.count=0,this.reasonsMapping={},this.rejectedremarkMapping={},this.searchForm=new kt({a_category:new nt(""),social_category:new nt(""),pwd_status:new nt(""),submit_date:new nt(""),a_status:new nt("")})}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.block_id,this.gp_id=n.gp_id,this.village_id=n.id,this.fetchuserStats(this.village_id)}),this.loadRejectReasonMappings()}fetchuserStats(n,r=!1){this.isStatsLoading=!0;let c=new st;c=c.set("gp_id",this.gp_id),c=c.set("village_id",n),c=c.set("offset",this.offset),c=c.set("limit",this.limit),c=c.set("nonnfsa_rejeted","1"),c=c.set("installment",this.installment);let f=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:c,headers:f}).subscribe(d=>{this.isStatsLoading=!1,this.count=d.count,d.data&&d.data.length>0?(this.application_list=this.application_list.concat(d.data),this.offset+=d.data.length,this.hasMoreRecords=d.data.length===this.limit):this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)},d=>{this.isStatsLoading=!1,this.application_list=[],this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)})}get filteredVillageUserStats(){if(!this.searchTerm)return this.application_list;let n=this.searchTerm.toLowerCase();return this.application_list.filter(r=>r.village_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.application_number?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_date).toLowerCase().includes(this.searchTerm.toLowerCase())||r.applicant_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.spouse_or_father_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.dob).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.social_category).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.pwd_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.alt_mobile_number).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.payment_status).toLowerCase().includes(this.searchTerm.toLowerCase()))}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status,_=new st;_=_.set("gp_id",this.gp_id),r&&(_=_.set("village_id",r)),f&&(_=_.set("social_category",f)),d&&(_=_.set("pwd_status",d)),_=_.set("offset",this.offset),_=_.set("limit",this.limit),_=_.set("nonnfsa_rejeted","1"),_=_.set("installment",this.installment);let v=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:_,headers:v}).subscribe(S=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=S.count,S.data&&S.data.length>0?(this.application_list=this.application_list.concat(S.data),this.offset+=S.data.length,this.hasMoreRecords=S.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},S=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}loadRejectReasonMappings(){this.httpClient.get("assets/json/rejected_reasons.json").subscribe(n=>{this.reasonsMapping=n.exrMapping,this.rejectedremarkMapping=n.rejectedremarkMapping})}getReasonText(n){return this.reasonsMapping[n]||""}getExclusionReasons(n){return typeof n.exclusion_reasons=="string"?n.exclusion_reasons.split(",").map(c=>c.trim()).map(c=>isNaN(Number(c))?c:this.getReasonText(Number(c))):Array.isArray(n.exclusion_reasons)?n.exclusion_reasons.map(r=>typeof r=="number"?this.getReasonText(r):r):typeof n.exclusion_reasons=="number"?[this.getReasonText(n.exclusion_reasons)]:[]}getRejectedremark(n){return this.rejectedremarkMapping[n]||""}getAllReasons(n){let r=this.getExclusionReasons(n),c=n?.rejectedremark_reasons?this.getRejectedremark(n?.rejectedremark_reasons):null,f=[...r];return c&&f.push(c),f}exportToExcel(){let n=new st,r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;n=n.set("gp_id",this.gp_id),r&&(n=n.set("village_id",r)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),n=n.set("export_all","1"),n=n.set("nonnfsa_rejeted","1"),n=n.set("installment",this.installment);let _=new rt({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgressExcel=!1;let S=v.data.map((y,B)=>{let It=this.getAllReasons(y).join(", ");return{"SI#":B+1,DISTRICT:y.district_name?y.district_name.toUpperCase():"",BLOCK:y.block_name?y.block_name.toUpperCase():"",GP:y.gp_name?y.gp_name.toUpperCase():"",VILLAGE:y.village_name?y.village_name.toUpperCase():"","APPLICATION NO.":y.application_number.toUpperCase(),"APPLICATION DATE":this.appService.dateFormat(y.application_date),"APPLICANT NAME":y.applicant_name.toUpperCase(),"FATHER/HUSBAND NAME":y.spouse_or_father_name.toUpperCase(),"SOCIAL CATEGORY":y.social_category.toUpperCase(),PWD:y.pwd_status.toUpperCase(),"MOBILE NO.":y.alt_mobile_number,"APPLICATION STATUS":y.application_status.toUpperCase(),"REASONS FOR INELIGIBILITY":It}}),w=N.json_to_sheet(S),u=N.book_new();N.book_append_sheet(u,w,"Applications");let I=Z(u,{bookType:"xlsx",type:"array"}),R=new Date,z=R.toLocaleDateString("en-GB").split("/").reverse().join("-"),at=R.toLocaleTimeString("en-GB").replace(/:/g,"-"),ct=`non_nfsa_reject_reports_${z}_${at}.xlsx`,lt=new Blob([I],{type:"application/octet-stream"}),O=document.createElement("a"),et=window.URL.createObjectURL(lt);O.href=et,O.download=ct,O.click(),window.URL.revokeObjectURL(et)},v=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",v)})}exportToPDF(){an.default.vfs=us.default.pdfMake.vfs;let n=new st,r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;n=n.set("gp_id",this.gp_id),r&&(n=n.set("village_id",r)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),n=n.set("export_all","1"),n=n.set("nonnfsa_rejeted","1"),n=n.set("installment",this.installment);let _=new rt({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgress=!1;let S=v.data[0]||{},w=(S.district_name||"N/A").toUpperCase(),u=(S.block_name||S.ulb_name||"N/A").toUpperCase(),I=(S.gp_name||S.ward_no||"N/A").toUpperCase(),R=(S.village_name||"").toUpperCase(),z=[[{text:"SI#",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICATION DATE.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"SOCIAL CATEGORY",fontSize:10},{text:"PWD",fontSize:10},{text:"MOBILE NO",fontSize:10},{text:"APPLICATION STATUS",fontSize:10},{text:"REASONS FOR INELIGIBILITY",fontSize:10}]];v.data.forEach((W,It)=>{let qt=this.getAllReasons(W).join(", ");z.push([{text:(It+1).toString().toUpperCase(),fontSize:9},{text:(W.application_number||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(W.application_date)||"",fontSize:9},{text:(W.applicant_name||"").toUpperCase(),fontSize:9},{text:(W.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:(W.social_category||"").toUpperCase(),fontSize:9},{text:(W.pwd_status||"").toUpperCase(),fontSize:9},{text:(W.alt_mobile_number||"").toUpperCase(),fontSize:9},{text:(W.application_status||"").toUpperCase(),fontSize:9},{text:qt,fontSize:9}])});let at=new Date,ct=`Timestamp: ${at.toLocaleDateString()}, ${at.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,lt={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${w} > BLOCK: ${u} > GP: ${I} >VILLAGE: ${R}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DETAILED REPORT NON-NFSA APPLICATIONS REJECTED",style:"header"},{table:{headerRows:1,body:z,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]},layout:{fillColor:function(W){return W===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:ct,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},O=new Date,et=O.toLocaleDateString("en-GB").split("/").reverse().join("-"),y=O.toLocaleTimeString("en-GB").replace(/:/g,"-"),B=`non_nfsa_reject_reports_${et}_${y}.pdf`;an.default.createPdf(lt).download(B)},v=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",v)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(Ot),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-nonnfsa-reject-village-user-list"]],decls:46,vars:4,consts:[[1,"container-fluid","drilldown-reports"],[1,"d-flex","justify-content-between","w-100","mb-3"],[1,"card-title"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],["class","row mb-2"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-2"],[1,"col-md-6"],["for","social_category",1,"fw-bold"],["formControlName","social_category","id","social_category",1,"form-select","my-2"],["value",""],["value","1"],["value","2"],["value","3"],["value","4"],["for","pwd_status",1,"fw-bold"],["formControlName","pwd_status","id","pwd_status",1,"form-select","my-2"],["value","0"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[1,"row","mb-2"],[1,"col-md-7"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"fa","fa-spinner","fa-spin"],[1,"col-md-5"],["id","recordCount"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports detail"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports","detail"],[1,"text-light",2,"background-color","#fd7b03"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1)(2,"h4",2),a(3,"Detailed Report - NON-NFSA Applications rejected"),e(),t(4,"div",3)(5,"a",4),L("click",function(){return c.appService.goBack()}),t(6,"button",5),m(7,"i",6),a(8," Back"),e()()()(),b(9,lD,12,4,"div",7),t(10,"div",8)(11,"form",9),L("ngSubmit",function(){return c.onSearch()}),t(12,"div",10)(13,"div",11)(14,"label",12),a(15," Social Category "),e(),t(16,"select",13)(17,"option",14),a(18,"Choose Social Category"),e(),t(19,"option",15),a(20,"Un-Reserved"),e(),t(21,"option",16),a(22,"OBC"),e(),t(23,"option",17),a(24,"SC"),e(),t(25,"option",18),a(26,"ST"),e()()(),t(27,"div",11)(28,"label",19),a(29," PWD "),e(),t(30,"select",20)(31,"option",14),a(32,"Choose PWD Status"),e(),t(33,"option",15),a(34,"Yes "),e(),t(35,"option",21),a(36,"NO"),e()()()(),t(37,"div",22)(38,"div",23),b(39,cD,3,0,"button",24)(40,dD,3,0),e()()()(),t(41,"div",25)(42,"div",26)(43,"div",27),b(44,pD,2,0)(45,yD,21,7),e()()()()),r&2&&(l(9),E(9,c.filteredVillageUserStats&&c.filteredVillageUserStats.length>0?9:-1),l(2),T("formGroup",c.searchForm),l(28),E(39,c.isFormSearchInProgress?40:39),l(5),E(44,c.isStatsLoading?44:45))},dependencies:[Ht,ft,Pt,Nt,Rt,K,Ut,q,yt,J,Dt,At,it]});let i=s;return i})();var rn=j(ut()),Ss=j(ht());function kD(i,s){if(i&1&&(t(0,"div",28)(1,"div",29)(2,"nav",30)(3,"ol",31)(4,"li",32),a(5),e(),t(6,"li",32),a(7),e(),t(8,"li",33),a(9),e()()()()()),i&2){let o=h();l(5),p(o.filteredWardUserStats[0].district_name),l(2),p(o.filteredWardUserStats[0].ulb_name),l(2),p(o.filteredWardUserStats[0].ward_no)}}function PD(i,s){i&1&&(t(0,"button",34),m(1,"i",35),a(2,"Search "),e())}function DD(i,s){i&1&&(t(0,"button",36),m(1,"i",37),a(2," Searching ..."),e())}function AD(i,s){i&1&&(m(0,"i",38),a(1," We are fetching the data, please wait. "))}function UD(i,s){if(i&1){let o=U();t(0,"button",52),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",53),a(2,"Download to PDF "),e()}}function ND(i,s){i&1&&(t(0,"button",54),m(1,"i",37),a(2,"Downloading "),e())}function RD(i,s){if(i&1){let o=U();t(0,"button",52),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",53),a(2,"Download to EXCEL "),e()}}function OD(i,s){i&1&&(t(0,"button",54),m(1,"i",37),a(2,"Downloading "),e())}var BD=(i,s)=>s.id;function WD(i,s){if(i&1&&(t(0,"td"),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit;l(1),p(P(2,1,o.ward_no))}}function MD(i,s){i&1&&m(0,"td")}function FD(i,s){i&1&&(t(0,"span"),a(1,", "),e())}function VD(i,s){if(i&1&&(t(0,"span"),a(1),b(2,FD,2,0,"span",58),e()),i&2){let o=s.$implicit,n=s.index,r=h().$implicit,c=h(3);l(1),dt(" ",o," "),l(1),T("ngIf",n<c.getAllReasons(r).length-1)}}function zD(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),b(3,WD,3,3,"td")(4,MD,1,0),t(5,"td"),a(6),k(7,"uppercase"),e(),t(8,"td"),a(9),k(10,"uppercase"),e(),t(11,"td"),a(12),k(13,"uppercase"),e(),t(14,"td"),a(15),k(16,"uppercase"),e(),t(17,"td"),a(18),k(19,"uppercase"),e(),t(20,"td"),a(21),k(22,"uppercase"),e(),t(23,"td"),a(24),e(),t(25,"td"),a(26),k(27,"uppercase"),e(),t(28,"td"),b(29,VD,3,2,"span",57),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(1),E(3,o.ward_no?3:4),l(3),p(P(7,11,o.application_number)),l(3),p(P(10,13,r.appService.dateFormat(o.application_date))),l(3),p(P(13,15,o.applicant_name)),l(3),p(P(16,17,o.spouse_or_father_name)),l(3),p(P(19,19,o.social_category)),l(3),p(P(22,21,o.pwd_status)),l(3),p(o.alt_mobile_number),l(2),p(P(27,23,o.application_status)),l(3),T("ngForOf",r.getAllReasons(o))}}function jD(i,s){if(i&1&&(t(0,"table",55)(1,"thead",56)(2,"tr")(3,"th"),a(4,"SI#"),e(),t(5,"th"),a(6,"WARD NO."),e(),t(7,"th"),a(8,"APPLICATION NO."),e(),t(9,"th"),a(10,"APPLICATION DATE"),e(),t(11,"th"),a(12,"APPLICANT NAME"),e(),t(13,"th"),a(14,"FATHER/HUSBAND NAME"),e(),t(15,"th"),a(16,"SOCIAL CATEGORY"),e(),t(17,"th"),a(18,"PWD"),e(),t(19,"th"),a(20,"MOBILE NO."),e(),t(21,"th"),a(22,"APPLICATION STATUS"),e(),t(23,"th"),a(24,"REASONS FOR INELIGIBILITY"),e()()(),t(25,"tbody"),F(26,zD,30,25,"tr",null,BD),e()()),i&2){let o=h(2);l(26),V(o.filteredWardUserStats)}}function $D(i,s){i&1&&(t(0,"h5",59),a(1,"No data available"),e())}function GD(i,s){i&1&&(t(0,"div",60),a(1,"Loading.. "),m(2,"i",61),e())}function XD(i,s){i&1&&(t(0,"span"),m(1,"i",38),a(2," Loading..."),e())}function YD(i,s){i&1&&(t(0,"span"),a(1,"Load More"),e())}function HD(i,s){if(i&1){let o=U();t(0,"div",62)(1,"button",63),L("click",function(){D(o);let r=h(2);return A(r.loadMore())}),b(2,XD,3,0,"span",58)(3,YD,2,0,"span",58),e()()}if(i&2){let o=h(2);l(2),T("ngIf",o.isLoadMoreInProgress),l(1),T("ngIf",!o.isLoadMoreInProgress)}}function KD(i,s){if(i&1){let o=U();t(0,"div",28)(1,"div",39)(2,"h5",2),a(3," Number of records found : "),t(4,"span",40),a(5),e()()(),t(6,"div",41)(7,"div",42)(8,"input",43),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(9,"i",44),e(),t(10,"div",45),b(11,UD,3,0,"button",46)(12,ND,3,0),e(),t(13,"div",47),b(14,RD,3,0,"button",46)(15,OD,3,0),e()()(),t(16,"div",48),b(17,jD,28,0,"table",49)(18,$D,2,0)(19,GD,3,0,"div",50),e(),b(20,HD,4,2,"div",51)}if(i&2){let o=h();l(5),p(o.count),l(3),T("ngModel",o.searchTerm),l(3),E(11,o.isExportInProgress?12:11),l(3),E(14,o.isExportInProgressExcel?15:14),l(3),E(17,o.filteredWardUserStats&&o.filteredWardUserStats.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),l(2),E(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),l(1),T("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var xs=(()=>{let s=class s{constructor(n,r,c,f,d,C,g,_){this.route=n,this.router=r,this.formService=c,this.appService=f,this.httpClient=d,this.toastService=C,this.authService=g,this.masterDataService=_,this.isStatsLoading=!1,this.userStats=[],this.ulb_id="",this.ward_id="",this.village_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.limit=this.appService.loadmorelimit,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.count=0,this.reasonsMapping={},this.rejectedremarkMapping={},this.searchForm=new kt({a_category:new nt(""),social_category:new nt(""),pwd_status:new nt(""),submit_date:new nt(""),a_status:new nt("")})}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.ulb_id=n.ulb_id,this.ward_id=n.id,this.fetchuserStats(this.ward_id)}),this.loadRejectReasonMappings()}fetchuserStats(n,r=!1){this.isStatsLoading=!0;let c=new st;c=c.set("ward_id",n),c=c.set("offset",this.offset),c=c.set("limit",this.limit),c=c.set("nonnfsa_rejeted","1"),c=c.set("installment",this.installment);let f=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:c,headers:f}).subscribe(d=>{this.isStatsLoading=!1,this.count=d.count,d.data&&d.data.length>0?(this.application_list=this.application_list.concat(d.data),this.offset+=d.data.length,this.hasMoreRecords=d.data.length===this.limit):this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)},d=>{this.isStatsLoading=!1,this.application_list=[],this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)})}get filteredWardUserStats(){if(!this.searchTerm)return this.application_list;let n=this.searchTerm.toLowerCase();return this.application_list.filter(r=>r.ward_no?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.application_number?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_date).toLowerCase().includes(this.searchTerm.toLowerCase())||r.applicant_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.spouse_or_father_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.dob).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.social_category).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.pwd_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.alt_mobile_number).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_status).toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.payment_status).toLowerCase().includes(this.searchTerm.toLowerCase()))}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status,_=new st;r&&(_=_.set("ward_id",r)),f&&(_=_.set("social_category",f)),d&&(_=_.set("pwd_status",d)),_=_.set("offset",this.offset),_=_.set("limit",this.limit),_=_.set("nonnfsa_rejeted","1"),_=_.set("installment",this.installment);let v=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:_,headers:v}).subscribe(S=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=S.count,S.data&&S.data.length>0?(this.application_list=this.application_list.concat(S.data),this.offset+=S.data.length,this.hasMoreRecords=S.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},S=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}loadRejectReasonMappings(){this.httpClient.get("assets/json/rejected_reasons.json").subscribe(n=>{this.reasonsMapping=n.exrMapping,this.rejectedremarkMapping=n.rejectedremarkMapping})}getReasonText(n){return this.reasonsMapping[n]||""}getExclusionReasons(n){return typeof n.exclusion_reasons=="string"?n.exclusion_reasons.split(",").map(c=>c.trim()).map(c=>isNaN(Number(c))?c:this.getReasonText(Number(c))):Array.isArray(n.exclusion_reasons)?n.exclusion_reasons.map(r=>typeof r=="number"?this.getReasonText(r):r):typeof n.exclusion_reasons=="number"?[this.getReasonText(n.exclusion_reasons)]:[]}getRejectedremark(n){return this.rejectedremarkMapping[n]||""}getAllReasons(n){let r=this.getExclusionReasons(n),c=n?.rejectedremark_reasons?this.getRejectedremark(n?.rejectedremark_reasons):null,f=[...r];return c&&f.push(c),f}exportToExcel(){let n=new st,r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;r&&(n=n.set("ward_id",r)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),n=n.set("export_all","1"),n=n.set("nonnfsa_rejeted","1"),n=n.set("installment",this.installment);let _=new rt({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgressExcel=!1;let S=v.data.map((y,B)=>{let It=this.getAllReasons(y).join(", ");return{"SI#":B+1,DISTRICT:y.district_name?y.district_name.toUpperCase():"",ULB:y.ulb_name?y.ulb_name.toUpperCase():"","WARD NO.":y.ward_no?y.ward_no.toUpperCase():"","APPLICATION NO.":y.application_number.toUpperCase(),"APPLICATION DATE":this.appService.dateFormat(y.application_date),"APPLICANT NAME":y.applicant_name.toUpperCase(),"FATHER/HUSBAND NAME":y.spouse_or_father_name.toUpperCase(),"SOCIAL CATEGORY":y.social_category.toUpperCase(),PWD:y.pwd_status.toUpperCase(),"MOBILE NO.":y.alt_mobile_number,"APPLICATION STATUS":y.application_status.toUpperCase(),"REASONS FOR INELIGIBILITY":It}}),w=N.json_to_sheet(S),u=N.book_new();N.book_append_sheet(u,w,"Applications");let I=Z(u,{bookType:"xlsx",type:"array"}),R=new Date,z=R.toLocaleDateString("en-GB").split("/").reverse().join("-"),at=R.toLocaleTimeString("en-GB").replace(/:/g,"-"),ct=`non_nfsa_reject_reports_${z}_${at}.xlsx`,lt=new Blob([I],{type:"application/octet-stream"}),O=document.createElement("a"),et=window.URL.createObjectURL(lt);O.href=et,O.download=ct,O.click(),window.URL.revokeObjectURL(et)},v=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",v)})}exportToPDF(){rn.default.vfs=Ss.default.pdfMake.vfs;let n=new st,r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;r&&(n=n.set("ward_id",r)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),n=n.set("export_all","1"),n=n.set("nonnfsa_rejeted","1"),n=n.set("installment",this.installment);let _=new rt({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgress=!1;let S=v.data[0]||{},w=(S.district_name||"N/A").toUpperCase(),u=(S.block_name||S.ulb_name||"N/A").toUpperCase(),I=(S.gp_name||S.ward_no||"N/A").toUpperCase(),R=[[{text:"SI#",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICATION DATE.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"SOCIAL CATEGORY",fontSize:10},{text:"PWD",fontSize:10},{text:"MOBILE NO",fontSize:10},{text:"APPLICATION STATUS",fontSize:10},{text:"REASONS FOR INELIGIBILITY",fontSize:10}]];v.data.forEach((B,W)=>{let jt=this.getAllReasons(B).join(", ");R.push([{text:(W+1).toString().toUpperCase(),fontSize:9},{text:(B.application_number||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(B.application_date)||"",fontSize:9},{text:(B.applicant_name||"").toUpperCase(),fontSize:9},{text:(B.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:(B.social_category||"").toUpperCase(),fontSize:9},{text:(B.pwd_status||"").toUpperCase(),fontSize:9},{text:(B.alt_mobile_number||"").toUpperCase(),fontSize:9},{text:(B.application_status||"").toUpperCase(),fontSize:9},{text:jt,fontSize:9}])});let z=new Date,at=`Timestamp: ${z.toLocaleDateString()}, ${z.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,ct={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${w} > ULB: ${u} > WARD: ${I}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DETAILED REPORT NON-NFSA APPLICATIONS REJECTED",style:"header"},{table:{headerRows:1,body:R,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]},layout:{fillColor:function(B){return B===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:at,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},lt=new Date,O=lt.toLocaleDateString("en-GB").split("/").reverse().join("-"),et=lt.toLocaleTimeString("en-GB").replace(/:/g,"-"),y=`non_nfsa_reject_reports_${O}_${et}.pdf`;rn.default.createPdf(ct).download(y)},v=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",v)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(Ot),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-nonnfsa-reject-ward-user-list"]],decls:46,vars:4,consts:[[1,"container-fluid","drilldown-reports"],[1,"d-flex","justify-content-between","w-100","mb-3"],[1,"card-title"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],["class","row mb-2"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-2"],[1,"col-md-6"],["for","social_category",1,"fw-bold"],["formControlName","social_category","id","social_category",1,"form-select","my-2"],["value",""],["value","1"],["value","2"],["value","3"],["value","4"],["for","pwd_status",1,"fw-bold"],["formControlName","pwd_status","id","pwd_status",1,"form-select","my-2"],["value","0"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[1,"row","mb-2"],[1,"col-md-7"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"fa","fa-spinner","fa-spin"],[1,"col-md-5"],["id","recordCount"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports detail"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports","detail"],[1,"text-light",2,"background-color","#fd7b03"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1)(2,"h4",2),a(3,"Detailed Report - NON-NFSA Applications rejected"),e(),t(4,"div",3)(5,"a",4),L("click",function(){return c.appService.goBack()}),t(6,"button",5),m(7,"i",6),a(8," Back"),e()()()(),b(9,kD,10,3,"div",7),t(10,"div",8)(11,"form",9),L("ngSubmit",function(){return c.onSearch()}),t(12,"div",10)(13,"div",11)(14,"label",12),a(15," Social Category "),e(),t(16,"select",13)(17,"option",14),a(18,"Choose Social Category"),e(),t(19,"option",15),a(20,"Un-Reserved"),e(),t(21,"option",16),a(22,"OBC"),e(),t(23,"option",17),a(24,"SC"),e(),t(25,"option",18),a(26,"ST"),e()()(),t(27,"div",11)(28,"label",19),a(29," PWD "),e(),t(30,"select",20)(31,"option",14),a(32,"Choose PWD Status"),e(),t(33,"option",15),a(34,"Yes "),e(),t(35,"option",21),a(36,"NO"),e()()()(),t(37,"div",22)(38,"div",23),b(39,PD,3,0,"button",24)(40,DD,3,0),e()()()(),t(41,"div",25)(42,"div",26)(43,"div",27),b(44,AD,2,0)(45,KD,21,7),e()()()()),r&2&&(l(9),E(9,c.filteredWardUserStats&&c.filteredWardUserStats.length>0?9:-1),l(2),T("formGroup",c.searchForm),l(28),E(39,c.isFormSearchInProgress?40:39),l(5),E(44,c.isStatsLoading?44:45))},dependencies:[Ht,ft,Pt,Nt,Rt,K,Ut,q,yt,J,Dt,At,it]});let i=s;return i})();var sn=j(ut()),gs=j(ht());function qD(i,s){if(i&1&&(t(0,"div",30)(1,"div",31)(2,"nav",32)(3,"ol",33)(4,"li",34),a(5),e(),t(6,"li",34),a(7),e(),t(8,"li",35),a(9),e()()()()()),i&2){let o=h();l(5),p(o.filteredWardUserStats[0].district_name),l(2),p(o.filteredWardUserStats[0].ulb_name),l(2),p(o.filteredWardUserStats[0].ward_no)}}function JD(i,s){i&1&&(t(0,"button",36),m(1,"i",37),a(2,"Search "),e())}function QD(i,s){i&1&&(t(0,"button",38),m(1,"i",39),a(2," Searching ..."),e())}function ZD(i,s){i&1&&(m(0,"i",40),a(1," We are fetching the data, please wait. "))}function tA(i,s){if(i&1){let o=U();t(0,"button",54),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",55),a(2,"Download to PDF "),e()}}function eA(i,s){i&1&&(t(0,"button",56),m(1,"i",39),a(2,"Downloading "),e())}function iA(i,s){if(i&1){let o=U();t(0,"button",54),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",55),a(2,"Download to EXCEL "),e()}}function nA(i,s){i&1&&(t(0,"button",56),m(1,"i",39),a(2,"Downloading "),e())}var oA=(i,s)=>s.id;function aA(i,s){if(i&1&&(t(0,"td"),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit;l(1),p(P(2,1,o.ward_no))}}function rA(i,s){i&1&&m(0,"td")}function sA(i,s){i&1&&(t(0,"td"),a(1,"OPTED IN"),e())}function lA(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),b(3,aA,3,3,"td")(4,rA,1,0),t(5,"td"),a(6),k(7,"uppercase"),e(),t(8,"td"),a(9),k(10,"uppercase"),e(),t(11,"td"),a(12),k(13,"uppercase"),e(),t(14,"td"),a(15),k(16,"uppercase"),e(),t(17,"td"),a(18),k(19,"uppercase"),e(),t(20,"td"),a(21),k(22,"uppercase"),e(),t(23,"td"),a(24),k(25,"uppercase"),e(),t(26,"td"),a(27),e(),t(28,"td"),a(29),k(30,"uppercase"),e(),b(31,sA,2,0,"td"),t(32,"td"),a(33),k(34,"uppercase"),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(1),E(3,o.ward_no?3:4),l(3),p(P(7,13,o.category)),l(3),p(P(10,15,o.application_number)),l(3),p(P(13,17,r.appService.dateFormat(o.application_date))),l(3),p(P(16,19,o.applicant_name)),l(3),p(P(19,21,o.spouse_or_father_name)),l(3),p(P(22,23,o.social_category)),l(3),p(P(25,25,o.pwd_status)),l(3),p(o.alt_mobile_number),l(2),p(P(30,27,o.application_status)),l(2),E(31,o.is_optout==2?31:-1),l(2),p(P(34,29,o.optin_date))}}function cA(i,s){if(i&1&&(t(0,"table",57)(1,"thead",58)(2,"tr")(3,"th"),a(4,"SI#"),e(),t(5,"th"),a(6,"WARD NO."),e(),t(7,"th"),a(8,"CATEGORY"),e(),t(9,"th"),a(10,"APPLICATION NO."),e(),t(11,"th"),a(12,"APPLICATION DATE"),e(),t(13,"th"),a(14,"APPLICANT NAME"),e(),t(15,"th"),a(16,"FATHER/HUSBAND NAME"),e(),t(17,"th"),a(18,"SOCIAL CATEGORY"),e(),t(19,"th"),a(20,"PWD"),e(),t(21,"th"),a(22,"MOBILE NO."),e(),t(23,"th"),a(24,"APPLICATION STATUS"),e(),t(25,"th"),a(26,"OPT IN STATUS"),e(),t(27,"th"),a(28,"OPT IN DATE"),e()()(),t(29,"tbody"),F(30,lA,35,31,"tr",null,oA),e()()),i&2){let o=h(2);l(30),V(o.filteredWardUserStats)}}function dA(i,s){i&1&&(t(0,"h5",59),a(1,"No data available"),e())}function pA(i,s){i&1&&(t(0,"div",60),a(1,"Loading.. "),m(2,"i",61),e())}function mA(i,s){i&1&&(t(0,"span"),m(1,"i",40),a(2," Loading..."),e())}function _A(i,s){i&1&&(t(0,"span"),a(1,"Load More"),e())}function fA(i,s){if(i&1){let o=U();t(0,"div",62)(1,"button",63),L("click",function(){D(o);let r=h(2);return A(r.loadMore())}),b(2,mA,3,0,"span",64)(3,_A,2,0,"span",64),e()()}if(i&2){let o=h(2);l(2),T("ngIf",o.isLoadMoreInProgress),l(1),T("ngIf",!o.isLoadMoreInProgress)}}function uA(i,s){if(i&1){let o=U();t(0,"div",30)(1,"div",41)(2,"h5",2),a(3," Number of records found : "),t(4,"span",42),a(5),e()()(),t(6,"div",43)(7,"div",44)(8,"input",45),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(9,"i",46),e(),t(10,"div",47),b(11,tA,3,0,"button",48)(12,eA,3,0),e(),t(13,"div",49),b(14,iA,3,0,"button",48)(15,nA,3,0),e()()(),t(16,"div",50),b(17,cA,32,0,"table",51)(18,dA,2,0)(19,pA,3,0,"div",52),e(),b(20,fA,4,2,"div",53)}if(i&2){let o=h();l(5),p(o.count),l(3),T("ngModel",o.searchTerm),l(3),E(11,o.isExportInProgress?12:11),l(3),E(14,o.isExportInProgressExcel?15:14),l(3),E(17,o.filteredWardUserStats&&o.filteredWardUserStats.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),l(2),E(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),l(1),T("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var Cs=(()=>{let s=class s{constructor(n,r,c,f,d,C,g,_){this.route=n,this.router=r,this.formService=c,this.appService=f,this.httpClient=d,this.toastService=C,this.authService=g,this.masterDataService=_,this.isStatsLoading=!1,this.userStats=[],this.ulb_id="",this.ward_id="",this.village_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.limit=this.appService.loadmorelimit,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.count=0,this.searchForm=new kt({a_category:new nt(""),social_category:new nt(""),pwd_status:new nt(""),submit_date:new nt(""),a_status:new nt("")})}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.ulb_id=n.ulb_id,this.ward_id=n.id,this.fetchuserStats(this.ward_id)})}fetchuserStats(n,r=!1){this.isStatsLoading=!0;let c=new st;c=c.set("ward_id",n),c=c.set("offset",this.offset),c=c.set("limit",this.limit),c=c.set("opt_out","2"),c=c.set("installment",this.installment);let f=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:c,headers:f}).subscribe(d=>{this.isStatsLoading=!1,this.count=d.count,d.data&&d.data.length>0?(this.application_list=this.application_list.concat(d.data),this.offset+=d.data.length,this.hasMoreRecords=d.data.length===this.limit):this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)},d=>{this.isStatsLoading=!1,this.application_list=[],this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)})}get filteredWardUserStats(){if(!this.searchTerm)return this.application_list;let n=this.searchTerm.toLowerCase();return this.application_list.filter(r=>r.ward_no?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.category?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.application_number?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_date).toLowerCase().includes(this.searchTerm.toLowerCase())||r.applicant_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.spouse_or_father_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.dob).toLowerCase().includes(this.searchTerm.toLowerCase())||r.social_category?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.pwd_status?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.alt_mobile_number?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.npci_remark?.toLowerCase().includes(this.searchTerm.toLowerCase()))}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status,_=new st;r&&(_=_.set("ward_id",r)),c&&(_=_.set("category",c)),f&&(_=_.set("social_category",f)),d&&(_=_.set("pwd_status",d)),_=_.set("offset",this.offset),_=_.set("limit",this.limit),_=_.set("opt_out","2"),_=_.set("installment",this.installment);let v=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:_,headers:v}).subscribe(S=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=S.count,S.data&&S.data.length>0?(this.application_list=this.application_list.concat(S.data),this.offset+=S.data.length,this.hasMoreRecords=S.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},S=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}exportToExcel(){let n=new st,r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;r&&(n=n.set("ward_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),n=n.set("export_all","1"),n=n.set("opt_out","2"),n=n.set("installment",this.installment);let _=new rt({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgressExcel=!1;let S=v.data.map((y,B)=>({"SI#":B+1,DISTRICT:y.district_name?y.district_name.toUpperCase():"",ULB:y.ulb_name?y.ulb_name.toUpperCase():"","WARD NO.":y.ward_no?y.ward_no.toUpperCase():"",CATEGORY:y.category.toUpperCase(),"APPLICATION NO.":y.application_number.toUpperCase(),"APPLICATION DATE":this.appService.dateFormat(y.application_date),"APPLICANT NAME":y.applicant_name.toUpperCase(),"FATHER/HUSBAND NAME":y.spouse_or_father_name.toUpperCase(),"SOCIAL CATEGORY":y.social_category.toUpperCase(),PWD:y.pwd_status.toUpperCase(),"MOBILE NO.":y.alt_mobile_number,"APPLICATION STATUS.":y.application_status,"OPT IN STATUS":y.is_optout=="2"?"OPTED IN":"","OPT IN DATE":y.optin_date.toUpperCase()})),w=N.json_to_sheet(S),u=N.book_new();N.book_append_sheet(u,w,"Applications");let I=Z(u,{bookType:"xlsx",type:"array"}),R=new Date,z=R.toLocaleDateString("en-GB").split("/").reverse().join("-"),at=R.toLocaleTimeString("en-GB").replace(/:/g,"-"),ct=`opt_in_reports_${z}_${at}.xlsx`,lt=new Blob([I],{type:"application/octet-stream"}),O=document.createElement("a"),et=window.URL.createObjectURL(lt);O.href=et,O.download=ct,O.click(),window.URL.revokeObjectURL(et)},v=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",v)})}exportToPDF(){sn.default.vfs=gs.default.pdfMake.vfs;let n=new st,r=this.ward_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;r&&(n=n.set("ward_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),n=n.set("export_all","1"),n=n.set("opt_out","2"),n=n.set("installment",this.installment);let _=new rt({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgress=!1;let S=v.data[0]||{},w=(S.district_name||"N/A").toUpperCase(),u=(S.block_name||S.ulb_name||"N/A").toUpperCase(),I=(S.gp_name||S.ward_no||"N/A").toUpperCase(),R=[[{text:"SI#",fontSize:10},{text:"CATEGORY",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICATION DATE.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"SOCIAL CATEGORY",fontSize:10},{text:"PWD",fontSize:10},{text:"MOBILE NO",fontSize:10},{text:"APPLICATION STATUS",fontSize:10},{text:"OPT IN STATUS",fontSize:10},{text:"OPT IN DATE",fontSize:10}]];v.data.forEach((B,W)=>{R.push([{text:(W+1).toString().toUpperCase(),fontSize:9},{text:(B.category||"").toUpperCase(),fontSize:9},{text:(B.application_number||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(B.application_date)||"",fontSize:9},{text:(B.applicant_name||"").toUpperCase(),fontSize:9},{text:(B.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:(B.social_category||"").toUpperCase(),fontSize:9},{text:(B.pwd_status||"").toUpperCase(),fontSize:9},{text:(B.alt_mobile_number||"").toUpperCase(),fontSize:9},{text:(B.application_status||"").toUpperCase(),fontSize:9},{text:B.is_optout=="2"?"OPTED IN":"",fontSize:9},{text:(B.optin_date||"").toUpperCase(),fontSize:9}])});let z=new Date,at=`Timestamp: ${z.toLocaleDateString()}, ${z.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,ct={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${w} > ULB: ${u} > WARD: ${I}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DETAILED REPORT - OPT-IN",style:"header"},{table:{headerRows:1,body:R,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]},layout:{fillColor:function(B){return B===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:at,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},lt=new Date,O=lt.toLocaleDateString("en-GB").split("/").reverse().join("-"),et=lt.toLocaleTimeString("en-GB").replace(/:/g,"-"),y=`opt_in_reports_${O}_${et}.pdf`;sn.default.createPdf(ct).download(y)},v=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",v)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(Ot),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-optin-ward-user-list"]],decls:56,vars:4,consts:[[1,"container-fluid","drilldown-reports"],[1,"d-flex","justify-content-between","w-100","mb-3"],[1,"card-title"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],["class","row mb-2"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-2"],[1,"col-md-4"],["for","a_category",1,"fw-bold"],["id","a_category","formControlName","a_category",1,"form-select","my-2"],["value",""],["value","1"],["value","0"],["for","social_category",1,"fw-bold"],["formControlName","social_category","id","social_category",1,"form-select","my-2"],["value","2"],["value","3"],["value","4"],["for","pwd_status",1,"fw-bold"],["formControlName","pwd_status","id","pwd_status",1,"form-select","my-2"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[1,"row","mb-2"],[1,"col-md-7"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"fa","fa-spinner","fa-spin"],[1,"col-md-5"],["id","recordCount"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports detail"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports","detail"],[1,"text-light",2,"background-color","#fd7b03"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"],[4,"ngIf"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1)(2,"h4",2),a(3,"Detailed Report - Opt In"),e(),t(4,"div",3)(5,"a",4),L("click",function(){return c.appService.goBack()}),t(6,"button",5),m(7,"i",6),a(8," Back"),e()()()(),b(9,qD,10,3,"div",7),t(10,"div",8)(11,"form",9),L("ngSubmit",function(){return c.onSearch()}),t(12,"div",10)(13,"div",11)(14,"label",12),a(15," Category "),e(),t(16,"select",13)(17,"option",14),a(18,"Choose Category"),e(),t(19,"option",15),a(20,"NFSA"),e(),t(21,"option",16),a(22,"NON-NFSA"),e()()(),t(23,"div",11)(24,"label",17),a(25," Social Category "),e(),t(26,"select",18)(27,"option",14),a(28,"Choose Social Category"),e(),t(29,"option",15),a(30,"Un-Reserved"),e(),t(31,"option",19),a(32,"OBC"),e(),t(33,"option",20),a(34,"SC"),e(),t(35,"option",21),a(36,"ST"),e()()(),t(37,"div",11)(38,"label",22),a(39," PWD "),e(),t(40,"select",23)(41,"option",14),a(42,"Choose PWD Status"),e(),t(43,"option",15),a(44,"Yes "),e(),t(45,"option",16),a(46,"NO"),e()()()(),t(47,"div",24)(48,"div",25),b(49,JD,3,0,"button",26)(50,QD,3,0),e()()()(),t(51,"div",27)(52,"div",28)(53,"div",29),b(54,ZD,2,0)(55,uA,21,7),e()()()()),r&2&&(l(9),E(9,c.filteredWardUserStats&&c.filteredWardUserStats.length>0?9:-1),l(2),T("formGroup",c.searchForm),l(38),E(49,c.isFormSearchInProgress?50:49),l(5),E(54,c.isStatsLoading?54:55))},dependencies:[ft,Pt,Nt,Rt,K,Ut,q,yt,J,Dt,At,it]});let i=s;return i})();var ln=j(ut()),bs=j(ht());function hA(i,s){if(i&1&&(t(0,"div",30)(1,"div",31)(2,"nav",32)(3,"ol",33)(4,"li",34),a(5),e(),t(6,"li",34),a(7),e(),t(8,"li",34),a(9),e(),t(10,"li",35),a(11),e()()()()()),i&2){let o=h();l(5),p(o.filteredVillageUserStats[0].district_name),l(2),p(o.filteredVillageUserStats[0].block_name),l(2),p(o.filteredVillageUserStats[0].gp_name),l(2),p(o.filteredVillageUserStats[0].village_name)}}function SA(i,s){i&1&&(t(0,"button",36),m(1,"i",37),a(2,"Search "),e())}function xA(i,s){i&1&&(t(0,"button",38),m(1,"i",39),a(2," Searching ..."),e())}function gA(i,s){i&1&&(m(0,"i",40),a(1," We are fetching the data, please wait. "))}function CA(i,s){if(i&1){let o=U();t(0,"button",54),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",55),a(2,"Download to PDF "),e()}}function bA(i,s){i&1&&(t(0,"button",56),m(1,"i",39),a(2,"Downloading "),e())}function vA(i,s){if(i&1){let o=U();t(0,"button",54),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",55),a(2,"Download to EXCEL "),e()}}function EA(i,s){i&1&&(t(0,"button",56),m(1,"i",39),a(2,"Downloading "),e())}var wA=(i,s)=>s.id;function TA(i,s){if(i&1&&(t(0,"td"),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit;l(1),p(P(2,1,o.village_name))}}function LA(i,s){i&1&&m(0,"td")}function IA(i,s){i&1&&(t(0,"td"),a(1,"OPTED IN"),e())}function yA(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),b(3,TA,3,3,"td")(4,LA,1,0),t(5,"td"),a(6),k(7,"uppercase"),e(),t(8,"td"),a(9),k(10,"uppercase"),e(),t(11,"td"),a(12),k(13,"uppercase"),e(),t(14,"td"),a(15),k(16,"uppercase"),e(),t(17,"td"),a(18),k(19,"uppercase"),e(),t(20,"td"),a(21),k(22,"uppercase"),e(),t(23,"td"),a(24),k(25,"uppercase"),e(),t(26,"td"),a(27),e(),t(28,"td"),a(29),k(30,"uppercase"),e(),b(31,IA,2,0,"td"),t(32,"td"),a(33),k(34,"uppercase"),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(1),E(3,o.village_name?3:4),l(3),p(P(7,13,o.category)),l(3),p(P(10,15,o.application_number)),l(3),p(P(13,17,r.appService.dateFormat(o.application_date))),l(3),p(P(16,19,o.applicant_name)),l(3),p(P(19,21,o.spouse_or_father_name)),l(3),p(P(22,23,o.social_category)),l(3),p(P(25,25,o.pwd_status)),l(3),p(o.alt_mobile_number),l(2),p(P(30,27,o.application_status)),l(2),E(31,o.is_optout==2?31:-1),l(2),p(P(34,29,o.optin_date))}}function kA(i,s){if(i&1&&(t(0,"table",57)(1,"thead",58)(2,"tr")(3,"th"),a(4,"SI#"),e(),t(5,"th"),a(6,"VILLAGE"),e(),t(7,"th"),a(8,"CATEGORY"),e(),t(9,"th"),a(10,"APPLICATION NO."),e(),t(11,"th"),a(12,"APPLICATION DATE"),e(),t(13,"th"),a(14,"APPLICANT NAME"),e(),t(15,"th"),a(16,"FATHER/HUSBAND NAME"),e(),t(17,"th"),a(18,"SOCIAL CATEGORY"),e(),t(19,"th"),a(20,"PWD"),e(),t(21,"th"),a(22,"MOBILE NO."),e(),t(23,"th"),a(24,"APPLICATION STATUS"),e(),t(25,"th"),a(26,"OPT IN STATUS"),e(),t(27,"th"),a(28,"OPT IN DATE"),e()()(),t(29,"tbody"),F(30,yA,35,31,"tr",null,wA),e()()),i&2){let o=h(2);l(30),V(o.filteredVillageUserStats)}}function PA(i,s){i&1&&(t(0,"h5",59),a(1,"No data available"),e())}function DA(i,s){i&1&&(t(0,"div",60),a(1,"Loading.. "),m(2,"i",61),e())}function AA(i,s){i&1&&(t(0,"span"),m(1,"i",40),a(2," Loading..."),e())}function UA(i,s){i&1&&(t(0,"span"),a(1,"Load More"),e())}function NA(i,s){if(i&1){let o=U();t(0,"div",62)(1,"button",63),L("click",function(){D(o);let r=h(2);return A(r.loadMore())}),b(2,AA,3,0,"span",64)(3,UA,2,0,"span",64),e()()}if(i&2){let o=h(2);l(2),T("ngIf",o.isLoadMoreInProgress),l(1),T("ngIf",!o.isLoadMoreInProgress)}}function RA(i,s){if(i&1){let o=U();t(0,"div",30)(1,"div",41)(2,"h5",2),a(3," Number of records found : "),t(4,"span",42),a(5),e()()(),t(6,"div",43)(7,"div",44)(8,"input",45),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(9,"i",46),e(),t(10,"div",47),b(11,CA,3,0,"button",48)(12,bA,3,0),e(),t(13,"div",49),b(14,vA,3,0,"button",48)(15,EA,3,0),e()()(),t(16,"div",50),b(17,kA,32,0,"table",51)(18,PA,2,0)(19,DA,3,0,"div",52),e(),b(20,NA,4,2,"div",53)}if(i&2){let o=h();l(5),p(o.count),l(3),T("ngModel",o.searchTerm),l(3),E(11,o.isExportInProgress?12:11),l(3),E(14,o.isExportInProgressExcel?15:14),l(3),E(17,o.filteredVillageUserStats&&o.filteredVillageUserStats.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),l(2),E(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),l(1),T("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var vs=(()=>{let s=class s{constructor(n,r,c,f,d,C,g,_){this.route=n,this.router=r,this.formService=c,this.appService=f,this.httpClient=d,this.toastService=C,this.authService=g,this.masterDataService=_,this.isStatsLoading=!1,this.userStats=[],this.block_id="",this.gp_id="",this.village_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.limit=this.appService.loadmorelimit,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.count=0,this.searchForm=new kt({a_category:new nt(""),social_category:new nt(""),pwd_status:new nt(""),submit_date:new nt(""),a_status:new nt("")})}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.block_id,this.gp_id=n.gp_id,this.village_id=n.id,this.fetchuserStats(this.village_id)})}fetchuserStats(n,r=!1){this.isStatsLoading=!0;let c=new st;c=c.set("gp_id",this.gp_id),c=c.set("village_id",n),c=c.set("offset",this.offset),c=c.set("limit",this.limit),c=c.set("opt_out","2"),c=c.set("installment",this.installment);let f=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:c,headers:f}).subscribe(d=>{this.isStatsLoading=!1,this.count=d.count,d.data&&d.data.length>0?(this.application_list=this.application_list.concat(d.data),this.offset+=d.data.length,this.hasMoreRecords=d.data.length===this.limit):this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)},d=>{this.isStatsLoading=!1,this.application_list=[],this.hasMoreRecords=!1,r&&(this.isLoadMoreInProgress=!1)})}get filteredVillageUserStats(){if(!this.searchTerm)return this.application_list;let n=this.searchTerm.toLowerCase();return this.application_list.filter(r=>r.village_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.category?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.application_number?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.application_date).toLowerCase().includes(this.searchTerm.toLowerCase())||r.applicant_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.spouse_or_father_name?.toLowerCase().includes(this.searchTerm.toLowerCase())||this.appService.dateFormat(r.dob).toLowerCase().includes(this.searchTerm.toLowerCase())||r.social_category?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.pwd_status?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.alt_mobile_number?.toLowerCase().includes(this.searchTerm.toLowerCase())||r.npci_remark?.toLowerCase().includes(this.searchTerm.toLowerCase()))}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status,_=new st;_=_.set("gp_id",this.gp_id),r&&(_=_.set("village_id",r)),c&&(_=_.set("category",c)),f&&(_=_.set("social_category",f)),d&&(_=_.set("pwd_status",d)),_=_.set("offset",this.offset),_=_.set("limit",this.limit),_=_.set("opt_out","2"),_=_.set("installment",this.installment);let v=new rt({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:_,headers:v}).subscribe(S=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=S.count,S.data&&S.data.length>0?(this.application_list=this.application_list.concat(S.data),this.offset+=S.data.length,this.hasMoreRecords=S.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},S=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}exportToExcel(){let n=new st,r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;n=n.set("gp_id",this.gp_id),r&&(n=n.set("village_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),n=n.set("export_all","1"),n=n.set("opt_out","2"),n=n.set("installment",this.installment);let _=new rt({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgressExcel=!1;let S=v.data.map((y,B)=>({"SI#":B+1,DISTRICT:y.district_name?y.district_name.toUpperCase():"",BLOCK:y.block_name?y.block_name.toUpperCase():"",GP:y.gp_name?y.gp_name.toUpperCase():"",VILLAGE:y.village_name?y.village_name.toUpperCase():"",CATEGORY:y.category.toUpperCase(),"APPLICATION NO.":y.application_number.toUpperCase(),"APPLICATION DATE":this.appService.dateFormat(y.application_date),"APPLICANT NAME":y.applicant_name.toUpperCase(),"FATHER/HUSBAND NAME":y.spouse_or_father_name.toUpperCase(),"SOCIAL CATEGORY":y.social_category.toUpperCase(),PWD:y.pwd_status.toUpperCase(),"MOBILE NO.":y.alt_mobile_number,"APPLICATION STATUS.":y.application_status,"OPT IN STATUS":y.is_optout=="2"?"OPTED IN":"","OPT IN DATE":y.optin_date.toUpperCase()})),w=N.json_to_sheet(S),u=N.book_new();N.book_append_sheet(u,w,"Applications");let I=Z(u,{bookType:"xlsx",type:"array"}),R=new Date,z=R.toLocaleDateString("en-GB").split("/").reverse().join("-"),at=R.toLocaleTimeString("en-GB").replace(/:/g,"-"),ct=`opt_in_reports_${z}_${at}.xlsx`,lt=new Blob([I],{type:"application/octet-stream"}),O=document.createElement("a"),et=window.URL.createObjectURL(lt);O.href=et,O.download=ct,O.click(),window.URL.revokeObjectURL(et)},v=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",v)})}exportToPDF(){ln.default.vfs=bs.default.pdfMake.vfs;let n=new st,r=this.village_id,c=this.searchForm.value.a_category,f=this.searchForm.value.social_category,d=this.searchForm.value.pwd_status,C=this.searchForm.value.submit_date,g=this.searchForm.value.a_status;n=n.set("gp_id",this.gp_id),r&&(n=n.set("village_id",r)),c&&(n=n.set("category",c)),f&&(n=n.set("social_category",f)),d&&(n=n.set("pwd_status",d)),n=n.set("export_all","1"),n=n.set("opt_out","2"),n=n.set("installment",this.installment);let _=new rt({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/detailed-view`,{params:n,headers:_,responseType:"json"}).subscribe(v=>{this.isExportInProgress=!1;let S=v.data[0]||{},w=(S.district_name||"N/A").toUpperCase(),u=(S.block_name||S.ulb_name||"N/A").toUpperCase(),I=(S.gp_name||S.ward_no||"N/A").toUpperCase(),R=(S.village_name||"").toUpperCase(),z=[[{text:"SI#",fontSize:10},{text:"CATEGORY",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICATION DATE.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"SOCIAL CATEGORY",fontSize:10},{text:"PWD",fontSize:10},{text:"MOBILE NO",fontSize:10},{text:"APPLICATION STATUS",fontSize:10},{text:"OPT IN STATUS",fontSize:10},{text:"OPT IN DATE",fontSize:10}]];v.data.forEach((W,It)=>{z.push([{text:(It+1).toString().toUpperCase(),fontSize:9},{text:(W.category||"").toUpperCase(),fontSize:9},{text:(W.application_number||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(W.application_date)||"",fontSize:9},{text:(W.applicant_name||"").toUpperCase(),fontSize:9},{text:(W.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:(W.social_category||"").toUpperCase(),fontSize:9},{text:(W.pwd_status||"").toUpperCase(),fontSize:9},{text:(W.alt_mobile_number||"").toUpperCase(),fontSize:9},{text:(W.application_status||"").toUpperCase(),fontSize:9},{text:W.is_optout=="2"?"OPTED IN":"",fontSize:9},{text:(W.optin_date||"").toUpperCase(),fontSize:9}])});let at=new Date,ct=`Timestamp: ${at.toLocaleDateString()}, ${at.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,lt={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${w} > BLOCK: ${u} > GP: ${I} >VILLAGE: ${R}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DETAILED REPORT - OPT IN",style:"header"},{table:{headerRows:1,body:z,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]},layout:{fillColor:function(W){return W===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:ct,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},O=new Date,et=O.toLocaleDateString("en-GB").split("/").reverse().join("-"),y=O.toLocaleTimeString("en-GB").replace(/:/g,"-"),B=`opt_in_reports_${et}_${y}.pdf`;ln.default.createPdf(lt).download(B)},v=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",v)})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(Ot),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-optin-village-user-list"]],decls:56,vars:4,consts:[[1,"container-fluid","drilldown-reports"],[1,"d-flex","justify-content-between","w-100","mb-3"],[1,"card-title"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],["class","row mb-2"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-2"],[1,"col-md-4"],["for","a_category",1,"fw-bold"],["id","a_category","formControlName","a_category",1,"form-select","my-2"],["value",""],["value","1"],["value","0"],["for","social_category",1,"fw-bold"],["formControlName","social_category","id","social_category",1,"form-select","my-2"],["value","2"],["value","3"],["value","4"],["for","pwd_status",1,"fw-bold"],["formControlName","pwd_status","id","pwd_status",1,"form-select","my-2"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[1,"row","mb-2"],[1,"col-md-7"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"fa","fa-spinner","fa-spin"],[1,"col-md-5"],["id","recordCount"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports detail"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports","detail"],[1,"text-light",2,"background-color","#fd7b03"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"],[4,"ngIf"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1)(2,"h4",2),a(3,"Detailed Report - Opt In"),e(),t(4,"div",3)(5,"a",4),L("click",function(){return c.appService.goBack()}),t(6,"button",5),m(7,"i",6),a(8," Back"),e()()()(),b(9,hA,12,4,"div",7),t(10,"div",8)(11,"form",9),L("ngSubmit",function(){return c.onSearch()}),t(12,"div",10)(13,"div",11)(14,"label",12),a(15," Category "),e(),t(16,"select",13)(17,"option",14),a(18,"Choose Category"),e(),t(19,"option",15),a(20,"NFSA"),e(),t(21,"option",16),a(22,"NON-NFSA"),e()()(),t(23,"div",11)(24,"label",17),a(25," Social Category "),e(),t(26,"select",18)(27,"option",14),a(28,"Choose Social Category"),e(),t(29,"option",15),a(30,"Un-Reserved"),e(),t(31,"option",19),a(32,"OBC"),e(),t(33,"option",20),a(34,"SC"),e(),t(35,"option",21),a(36,"ST"),e()()(),t(37,"div",11)(38,"label",22),a(39," PWD "),e(),t(40,"select",23)(41,"option",14),a(42,"Choose PWD Status"),e(),t(43,"option",15),a(44,"Yes "),e(),t(45,"option",16),a(46,"NO"),e()()()(),t(47,"div",24)(48,"div",25),b(49,SA,3,0,"button",26)(50,xA,3,0),e()()()(),t(51,"div",27)(52,"div",28)(53,"div",29),b(54,gA,2,0)(55,RA,21,7),e()()()()),r&2&&(l(9),E(9,c.filteredVillageUserStats&&c.filteredVillageUserStats.length>0?9:-1),l(2),T("formGroup",c.searchForm),l(38),E(49,c.isFormSearchInProgress?50:49),l(5),E(54,c.isStatsLoading?54:55))},dependencies:[ft,Pt,Nt,Rt,K,Ut,q,yt,J,Dt,At,it]});let i=s;return i})();var cn=j(ut()),Es=j(ht());function OA(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function BA(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",27),a(2,"Download PDF "),e()}}function WA(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}function MA(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",27),a(2,"Download EXCEL "),e()}}function FA(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}var VA=(i,s)=>s.id,zA=i=>({installment:i});function jA(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",33),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),Gt("routerLink","/department/portal/optin/village-user-list/",o.district_id,"/",o.block_id,"/",o.gp_id,"/",o.village_id,""),T("queryParams",pt(10,zA,r.installment)),l(1),p(P(6,8,o.village_name)),l(3),p(o==null?null:o.applications_received)}}function $A(i,s){if(i&1&&(t(0,"table",30)(1,"thead",31)(2,"tr")(3,"th"),a(4,"Sl.#"),e(),t(5,"th"),a(6,"VILLAGE"),e(),t(7,"th"),a(8,"OPT IN"),e()()(),t(9,"tbody",32),F(10,jA,9,12,"tr",null,VA),e()()),i&2){let o=h(2);l(10),V(o.filteredVillageStats)}}function GA(i,s){i&1&&a(0," No Data Found ")}function XA(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - Opt In"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e(),t(8,"li",15),a(9),e(),t(10,"li",16),a(11),e()()()(),t(12,"div",17)(13,"div",18)(14,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(15,"i",20),e(),t(16,"div",21),b(17,BA,3,0,"button",22)(18,WA,3,0),e(),t(19,"div",23),b(20,MA,3,0,"button",22)(21,FA,3,0),e()()(),t(22,"div",24),b(23,$A,12,0,"table",25)(24,GA,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredVillageStats[0].district_name),l(2),p(o.filteredVillageStats[0].block_name),l(2),p(o.filteredVillageStats[0].gp_name),l(3),T("ngModel",o.searchTerm),l(3),E(17,o.isExportInProgress?18:17),l(3),E(20,o.isExportInProgressExcel?21:20),l(3),E(23,o.filteredVillageStats&&o.filteredVillageStats.length>0?23:24)}}var ws=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.gp_id="",this.district_id="",this.villageStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.block_id,this.gp_id=n.id,this.fetchvillageStats(this.gp_id)})}fetchvillageStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/village-count?gp_id=${n}&opt_out=2&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.villageStats=r.data},r=>{this.isStatsLoading=!1,this.villageStats=[]})}get filteredVillageStats(){return this.searchTerm?this.villageStats.filter(n=>n.village_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.villageStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.villageStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",BLOCK:u.block_name?u.block_name.toUpperCase():"",GP:u.gp_name?u.gp_name.toUpperCase():"",VILLAGE:u.village_name?u.village_name.toUpperCase():"","OPT IN":u?.applications_received})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`opt_in_village_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){cn.default.vfs=Es.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.villageStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=(n.gp_name||n.ward_no||"N/A").toUpperCase(),d=[[{text:"SI#",fontSize:10},{text:"VILLAGE",fontSize:10},{text:"OPT IN",fontSize:10}]];this.villageStats.forEach((I,R)=>{d.push([{text:(R+1).toString().toUpperCase(),fontSize:9},{text:(I.village_name||"").toUpperCase(),fontSize:9},{text:I?.applications_received,fontSize:9}])});let C=new Date,g=`Timestamp: ${C.toLocaleDateString()}, ${C.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,_={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK: ${c} > GP:${f}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - OPT-in VILLAGE WISE",style:"header"},{table:{headerRows:1,body:d,widths:["20%","50%","30%"]},layout:{fillColor:function(I){return I===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:g,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},v=new Date,S=v.toLocaleDateString("en-GB").split("/").reverse().join("-"),w=v.toLocaleTimeString("en-GB").replace(/:/g,"-"),u=`opt_in_village_drilldown_reports_${S}_${w}.pdf`;cn.default.createPdf(_).download(u,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-optin-village-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,OA,2,0)(11,XA,25,7),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var dn=j(ut()),Ts=j(ht());function YA(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function HA(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",27),a(2,"Download PDF "),e()}}function KA(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}function qA(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",27),a(2,"Download EXCEL "),e()}}function JA(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}var QA=(i,s)=>s.id,ZA=i=>({installment:i});function t4(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",34),a(5),e()(),t(6,"td"),a(7),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),Mt("routerLink","/department/portal/optin/ward-user-list/",o.district_id,"/",o.ulb_id,"/",o.ward_id,""),T("queryParams",pt(7,ZA,r.installment)),l(1),p(o.ward_no),l(2),p(o==null?null:o.applications_received)}}function e4(i,s){if(i&1&&(t(0,"table",30)(1,"thead",31)(2,"tr")(3,"th",32),a(4,"Sl.#"),e(),t(5,"th",32),a(6,"WARD"),e(),t(7,"th"),a(8,"OPT IN"),e()()(),t(9,"tbody",33),F(10,t4,8,9,"tr",null,QA),e()()),i&2){let o=h(2);l(10),V(o.filteredWardStats)}}function i4(i,s){i&1&&a(0," No Data Found ")}function n4(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - Opt In"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e(),t(8,"li",16),a(9),e()()()(),t(10,"div",17)(11,"div",18)(12,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(13,"i",20),e(),t(14,"div",21),b(15,HA,3,0,"button",22)(16,KA,3,0),e(),t(17,"div",23),b(18,qA,3,0,"button",22)(19,JA,3,0),e()()(),t(20,"div",24),b(21,e4,12,0,"table",25)(22,i4,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredWardStats[0].district_name),l(2),p(o.filteredWardStats[0].ulb_name),l(3),T("ngModel",o.searchTerm),l(3),E(15,o.isExportInProgress?16:15),l(3),E(18,o.isExportInProgressExcel?19:18),l(3),E(21,o.filteredWardStats&&o.filteredWardStats.length>0?21:22)}}var Ls=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.district_id="",this.wardStats=[],this.ulb_id="",this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.ulb_id=n.id,this.fetchWardStats(this.ulb_id)})}fetchWardStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/ward-count?ulb_id=${n}&opt_out=2&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.wardStats=r.data},r=>{this.isStatsLoading=!1,this.wardStats=[]})}get filteredWardStats(){return this.searchTerm?this.wardStats.filter(n=>n.ward_no.toLowerCase().includes(this.searchTerm.toLowerCase())):this.wardStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.wardStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",ULB:u.ulb_name?u.ulb_name.toUpperCase():"","WARD NO.":u.ward_no?u.ward_no.toUpperCase():"","OPT IN":u?.applications_received})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`opt_in_ward_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){dn.default.vfs=Ts.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.wardStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=[[{text:"SI#",fontSize:10},{text:"WARD NO.",fontSize:10},{text:"OPT IN",fontSize:10}]];this.wardStats.forEach((u,I)=>{f.push([{text:(I+1).toString().toUpperCase(),fontSize:9},{text:(u.ward_no||"").toUpperCase(),fontSize:9},{text:u?.applications_received,fontSize:9}])});let d=new Date,C=`Timestamp: ${d.toLocaleDateString()}, ${d.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,g={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK/ULB: ${c}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - OPT-IN WARD WISE",style:"header"},{table:{headerRows:1,body:f,widths:["20%","50%","30%"]},layout:{fillColor:function(u){return u===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:C,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},_=new Date,v=_.toLocaleDateString("en-GB").split("/").reverse().join("-"),S=_.toLocaleTimeString("en-GB").replace(/:/g,"-"),w=`opt_in_ward_drilldown_reports_${v}_${S}.pdf`;dn.default.createPdf(g).download(w,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-optin-ward-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],["rowspan","2"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,YA,2,0)(11,n4,23,6),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J]});let i=s;return i})();var pn=j(ut()),Is=j(ht());function o4(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function a4(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",27),a(2,"Download PDF "),e()}}function r4(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}function s4(i,s){if(i&1){let o=U();t(0,"button",26),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",27),a(2,"Download EXCEL "),e()}}function l4(i,s){i&1&&(t(0,"button",28),m(1,"i",29),a(2,"Downloading "),e())}var c4=(i,s)=>s.id,d4=i=>({installment:i});function p4(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",33),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),Mt("routerLink","/department/portal/optin/village-stats/",o.district_id,"/",o.block_id,"/",o.gp_id,""),T("queryParams",pt(9,d4,r.installment)),l(1),p(P(6,7,o.gp_name)),l(3),p(o==null?null:o.applications_received)}}function m4(i,s){if(i&1&&(t(0,"table",30)(1,"thead",31)(2,"tr")(3,"th"),a(4,"Sl.#"),e(),t(5,"th"),a(6,"GRAM PANCHAYAT"),e(),t(7,"th"),a(8,"Opt IN"),e()()(),t(9,"tbody",32),F(10,p4,9,11,"tr",null,c4),e()()),i&2){let o=h(2);l(10),V(o.filteredGpStats)}}function _4(i,s){i&1&&a(0," No Data Found ")}function f4(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - Opt In"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e(),t(8,"li",16),a(9),e()()()(),t(10,"div",17)(11,"div",18)(12,"input",19),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(13,"i",20),e(),t(14,"div",21),b(15,a4,3,0,"button",22)(16,r4,3,0),e(),t(17,"div",23),b(18,s4,3,0,"button",22)(19,l4,3,0),e()()(),t(20,"div",24),b(21,m4,12,0,"table",25)(22,_4,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredGpStats[0].district_name),l(2),p(o.filteredGpStats[0].block_name),l(3),T("ngModel",o.searchTerm),l(3),E(15,o.isExportInProgress?16:15),l(3),E(18,o.isExportInProgressExcel?19:18),l(3),E(21,o.filteredGpStats&&o.filteredGpStats.length>0?21:22)}}var ys=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.block_id="",this.district_id="",this.gpStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{this.district_id=n.district_id,this.block_id=n.id,this.fetchgpStats(this.block_id)})}fetchgpStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/gp-count?block_id=${n}&opt_out=2&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.gpStats=r.data},r=>{this.isStatsLoading=!1,this.gpStats=[]})}get filteredGpStats(){return this.searchTerm?this.gpStats.filter(n=>n.gp_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.gpStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.gpStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name?u.district_name.toUpperCase():"",BLOCK:u.block_name?u.block_name.toUpperCase():"",GP:u.gp_name?u.gp_name.toUpperCase():"","OPT IN":u?.applications_received})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`opt_in_gp_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){pn.default.vfs=Is.default.pdfMake.vfs,this.isExportInProgress=!0;let n=this.gpStats[0]||{},r=(n.district_name||"N/A").toUpperCase(),c=(n.block_name||n.ulb_name||"N/A").toUpperCase(),f=[[{text:"SI#",fontSize:10},{text:"GP",fontSize:10},{text:"OPT IN",fontSize:10}]];this.gpStats.forEach((u,I)=>{f.push([{text:(I+1).toString().toUpperCase(),fontSize:9},{text:(u.gp_name||"").toUpperCase(),fontSize:9},{text:u?.applications_received,fontSize:9}])});let d=new Date,C=`Timestamp: ${d.toLocaleDateString()}, ${d.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,g={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r} > BLOCK: ${c}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - OPT-IN GP WISE",style:"header"},{table:{headerRows:1,body:f,widths:["20%","50%","30%"]},layout:{fillColor:function(u){return u===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:C,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},_=new Date,v=_.toLocaleDateString("en-GB").split("/").reverse().join("-"),S=_.toLocaleTimeString("en-GB").replace(/:/g,"-"),w=`opt_in_gp_drilldown_reports_${v}_${S}.pdf`;pn.default.createPdf(g).download(w,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-optin-gp-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,o4,2,0)(11,f4,23,6),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var mn=j(ut()),ks=j(ht());function u4(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function h4(i,s){if(i&1){let o=U();t(0,"button",25),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",26),a(2,"Download PDF "),e()}}function S4(i,s){i&1&&(t(0,"button",27),m(1,"i",28),a(2,"Downloading "),e())}function x4(i,s){if(i&1){let o=U();t(0,"button",25),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",26),a(2,"Download EXCEL "),e()}}function g4(i,s){i&1&&(t(0,"button",27),m(1,"i",28),a(2,"Downloading "),e())}var C4=(i,s)=>s.id,Ps=i=>({installment:i});function b4(i,s){if(i&1&&(t(0,"a",33),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit,n=h(3);Vt("routerLink","/department/portal/optin/gp-stats/",o.district_id,"/",o.block_id,""),T("queryParams",pt(6,Ps,n.installment)),l(1),p(P(2,4,o.block_name))}}function v4(i,s){if(i&1&&(t(0,"a",33),a(1),k(2,"uppercase"),e()),i&2){let o=h().$implicit,n=h(3);Vt("routerLink","/department/portal/optin/ward-stats/",o.district_id,"/",o.ulb_id,""),T("queryParams",pt(6,Ps,n.installment)),l(1),p(P(2,4,o.ulb_name))}}function E4(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td"),b(4,b4,3,8,"a",32)(5,v4,3,8),e(),t(6,"td"),a(7),e()()),i&2){let o=s.$implicit,n=s.$index;l(2),p(n+1),l(2),E(4,o.block_id?4:5),l(3),p(o==null?null:o.applications_received)}}function w4(i,s){if(i&1&&(t(0,"table",29)(1,"thead",30)(2,"tr")(3,"th"),a(4,"Sl.#"),e(),t(5,"th"),a(6,"BLOCK/ULB"),e(),t(7,"th"),a(8,"OPT IN"),e()()(),t(9,"tbody",31),F(10,E4,8,3,"tr",null,C4),e()()),i&2){let o=h(2);l(10),V(o.filteredBlockStats)}}function T4(i,s){i&1&&a(0," No Data Found ")}function L4(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - Opt In"),e(),t(4,"nav",13)(5,"ol",14)(6,"li",15),a(7),e()()()(),t(8,"div",16)(9,"div",17)(10,"input",18),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(11,"i",19),e(),t(12,"div",20),b(13,h4,3,0,"button",21)(14,S4,3,0),e(),t(15,"div",22),b(16,x4,3,0,"button",21)(17,g4,3,0),e()()(),t(18,"div",23),b(19,w4,12,0,"table",24)(20,T4,1,0),e()}if(i&2){let o=h();l(7),p(o.filteredBlockStats[0].district_name),l(3),T("ngModel",o.searchTerm),l(3),E(13,o.isExportInProgress?14:13),l(3),E(16,o.isExportInProgressExcel?17:16),l(3),E(19,o.filteredBlockStats&&o.filteredBlockStats.length>0?19:20)}}var Ds=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.route=n,this.router=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.districtStats=[],this.district_id="",this.blockStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment}),this.route.params.subscribe(n=>{let r=n.id;this.district_id=r,this.fetchblockStats(r)})}fetchblockStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/block-count?district_id=${n}&opt_out=2&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.blockStats=r.data,this.fetchulbStats(n)},r=>{this.isStatsLoading=!1,this.blockStats=[]})}fetchulbStats(n){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/ulb-count?district_id=${n}&opt_out=2&installment=${this.installment}`,{headers:{Authorization:this.authService.authToken}}).subscribe(r=>{this.isStatsLoading=!1,this.blockStats=[...this.blockStats,...r.data]},r=>{this.isStatsLoading=!1})}get filteredBlockStats(){return this.searchTerm?this.blockStats.filter(n=>n.block_name&&n.block_name.toLowerCase().includes(this.searchTerm.toLowerCase())||n.ulb_name&&n.ulb_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.blockStats}exportToExcel(){this.isExportInProgressExcel=!0;let n=this.blockStats.map((u,I)=>({"SI#":I+1,DISTRICT:u.district_name,"BLOCK/ULB":(u.block_name||u.ulb_name).toUpperCase(),"OPT IN":u?.applications_received})),r=N.json_to_sheet(n),c=N.book_new();N.book_append_sheet(c,r,"Applications");let f=Z(c,{bookType:"xlsx",type:"array"}),d=new Date,C=d.toLocaleDateString("en-GB").split("/").reverse().join("-"),g=d.toLocaleTimeString("en-GB").replace(/:/g,"-"),_=`opt_in_block_ulb_drilldown_reports_${C}_${g}.xlsx`,v=new Blob([f],{type:"application/octet-stream"}),S=document.createElement("a"),w=window.URL.createObjectURL(v);S.href=w,S.download=_,S.click(),window.URL.revokeObjectURL(w),this.isExportInProgressExcel=!1}exportToPDF(){mn.default.vfs=ks.default.pdfMake.vfs,this.isExportInProgress=!0;let r=((this.blockStats[0]||{}).district_name||"N/A").toUpperCase(),c=[[{text:"SI#",fontSize:10},{text:"BLOCK/ULB",fontSize:10},{text:"OPT IN",fontSize:10}]];this.blockStats.forEach((w,u)=>{c.push([{text:(u+1).toString().toUpperCase(),fontSize:9},{text:(w.block_name||w.ulb_name||"").toUpperCase(),fontSize:9},{text:w?.applications_received,fontSize:9}])});let f=new Date,d=`Timestamp: ${f.toLocaleDateString()}, ${f.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,C={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${r}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"DRILL-DOWN REPORT - OPT-IN BLOCK-ULB WISE",style:"header"},{table:{headerRows:1,body:c,widths:["20%","50%","30%"]},layout:{fillColor:function(w){return w===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:d,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},g=new Date,_=g.toLocaleDateString("en-GB").split("/").reverse().join("-"),v=g.toLocaleTimeString("en-GB").replace(/:/g,"-"),S=`opt_in_block_ulb_drilldown_reports_${_}_${v}.pdf`;mn.default.createPdf(C).download(S,()=>{this.isExportInProgress=!1})}};s.\u0275fac=function(r){return new(r||s)(x(tt),x(G),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-optin-block-ulb-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],["aria-label","breadcrumb",2,"--bs-breadcrumb-divider",`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E")`],[1,"breadcrumb"],[1,"breadcrumb-item"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],[2,"font-size","14px"],["style","text-decoration: none",3,"routerLink","queryParams"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,u4,2,0)(11,L4,21,5),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var _n=j(ut()),As=j(ht());function I4(i,s){i&1&&(m(0,"i",9),a(1," We are fetching the data, please wait. "))}function y4(i,s){if(i&1){let o=U();t(0,"button",22),L("click",function(){D(o);let r=h(2);return A(r.exportToPDF())}),m(1,"i",23),a(2,"Download PDF "),e()}}function k4(i,s){i&1&&(t(0,"button",24),m(1,"i",25),a(2,"Downloading "),e())}function P4(i,s){if(i&1){let o=U();t(0,"button",22),L("click",function(){D(o);let r=h(2);return A(r.exportToExcel())}),m(1,"i",23),a(2,"Download EXCEL "),e()}}function D4(i,s){i&1&&(t(0,"button",24),m(1,"i",25),a(2,"Downloading "),e())}var A4=(i,s)=>s.id,U4=i=>({installment:i});function N4(i,s){if(i&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td")(4,"a",29),a(5),k(6,"uppercase"),e()(),t(7,"td"),a(8),e()()),i&2){let o=s.$implicit,n=s.$index,r=h(3);l(2),p(n+1),l(2),$t("routerLink","/department/portal/optin/block-ulb-stats/",o.district_id,""),T("queryParams",pt(7,U4,r.installment)),l(1),p(P(6,5,o.district_name)),l(3),p(o==null?null:o.count_opt_in)}}function R4(i,s){if(i&1&&(t(0,"table",26)(1,"thead",27)(2,"tr")(3,"th"),a(4,"Sl.#"),e(),t(5,"th"),a(6,"DISTRICT"),e(),t(7,"th"),a(8,"OPT IN"),e()()(),t(9,"tbody",28),F(10,N4,9,9,"tr",null,A4),e()()),i&2){let o=h(2);l(10),V(o.filteredDistrictStats)}}function O4(i,s){i&1&&a(0," No Data Found ")}function B4(i,s){if(i&1){let o=U();t(0,"div",10)(1,"div",11)(2,"h4",12),a(3,"Drill-Down Report - Opt In"),e()(),t(4,"div",13)(5,"div",14)(6,"input",15),L("ngModelChange",function(r){D(o);let c=h();return A(c.searchTerm=r)}),e(),m(7,"i",16),e(),t(8,"div",17),b(9,y4,3,0,"button",18)(10,k4,3,0),e(),t(11,"div",19),b(12,P4,3,0,"button",18)(13,D4,3,0),e()()(),t(14,"div",20),b(15,R4,12,0,"table",21)(16,O4,1,0),e()}if(i&2){let o=h();l(6),T("ngModel",o.searchTerm),l(3),E(9,o.isExportInProgress?10:9),l(3),E(12,o.isExportInProgressExcel?13:12),l(3),E(15,o.filteredDistrictStats&&o.filteredDistrictStats.length>0?15:16)}}var Us=(()=>{let s=class s{constructor(n,r,c,f,d,C,g){this.router=n,this.route=r,this.appService=c,this.httpClient=f,this.toastService=d,this.authService=C,this.masterDataService=g,this.isStatsLoading=!1,this.districtStats=[],this.searchTerm="",this.isExportInProgress=!1,this.isExportInProgressExcel=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.installment=n.installment,this.card_name=n.card_name,this.fetchDistrictStats()})}fetchDistrictStats(){this.isStatsLoading=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?opt_out=2&installment=${this.installment}&card_name=${this.card_name}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isStatsLoading=!1,this.districtStats=n.data},n=>{this.isStatsLoading=!1,this.districtStats=[]})}get filteredDistrictStats(){return this.searchTerm?this.districtStats.filter(n=>n.district_name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.districtStats}exportToExcel(){this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?opt_out=2&installment=${this.installment}&card_name=${this.card_name}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isExportInProgressExcel=!1;let r=n.data.map((I,R)=>({"SI#":R+1,DISTRICT:I.district_name.toUpperCase(),"OPT IN":I?.count_opt_in})),c=N.json_to_sheet(r),f=N.book_new();N.book_append_sheet(f,c,"Applications");let d=Z(f,{bookType:"xlsx",type:"array"}),C=new Date,g=C.toLocaleDateString("en-GB").split("/").reverse().join("-"),_=C.toLocaleTimeString("en-GB").replace(/:/g,"-"),v=`opt_in_district_drilldown_reports_${g}_${_}.xlsx`,S=new Blob([d],{type:"application/octet-stream"}),w=document.createElement("a"),u=window.URL.createObjectURL(S);w.href=u,w.download=v,w.click(),window.URL.revokeObjectURL(u)},n=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",n)})}exportToPDF(){_n.default.vfs=As.default.pdfMake.vfs,this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/drilldown/district-count?opt_out=2&installment=${this.installment}&card_name=${this.card_name}`,{headers:{Authorization:this.authService.authToken}}).subscribe(n=>{this.isExportInProgress=!1;let r=[[{text:"SI#",fontSize:10},{text:"DISTRICT",fontSize:10},{text:"OPT IN",fontSize:10}]];n.data.forEach((S,w)=>{r.push([{text:(w+1).toString().toUpperCase(),fontSize:9},{text:(S.district_name||"").toUpperCase(),fontSize:9},{text:S?.count_opt_in,fontSize:9}])});let c=new Date,f=`Timestamp: ${c.toLocaleDateString()}, ${c.toLocaleTimeString()} - Generated from subhadra.odisha.gov.in`,d={pageOrientation:"landscape",pageSize:"A4",content:[{text:"DRILL-DOWN REPORT - OPT-IN DISTRICT WISE",style:"header"},{table:{headerRows:1,body:r,widths:["20%","50%","30%"]},layout:{fillColor:function(S){return S===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}},{text:f,style:"timestamp",margin:[0,20,0,0],alignment:"left",fontSize:9,bold:!0}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},C=new Date,g=C.toLocaleDateString("en-GB").split("/").reverse().join("-"),_=C.toLocaleTimeString("en-GB").replace(/:/g,"-"),v=`opt_in_district_drilldown_reports_${g}_${_}.pdf`;_n.default.createPdf(d).download(v)},n=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",n)})}};s.\u0275fac=function(r){return new(r||s)(x(G),x(tt),x(X),x($),x(Y),x(H),x(Q))},s.\u0275cmp=M({type:s,selectors:[["app-optin-district-wise"]],decls:12,vars:1,consts:[[1,"container","drilldown-reports"],[1,"row","mb-2"],[1,"col-md-7"],[1,"col-md-5","d-flex","justify-content-end"],["type","button",1,"me-2",3,"click"],[1,"btn","btn-dark","py-2"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"card","mt-3"],[1,"card-body"],[1,"fa","fa-spinner","fa-spin"],[1,"row","d-flex","align-items-center"],[1,"col-md-5"],[2,"color","#fd7b03"],[1,"col-md-7","d-flex","justify-content-end"],[1,"search-box","me-2"],["type","text","placeholder","Search here..",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-search"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],["id","table-container",1,"table-responsive","mt-4"],["class","table table-bordered app_reports"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"table","table-bordered","app_reports"],[1,"text-light",2,"background-color","#fd7b03"],[2,"font-size","14px"],[2,"text-decoration","none",3,"routerLink","queryParams"]],template:function(r,c){r&1&&(t(0,"div",0)(1,"div",1),m(2,"div",2),t(3,"div",3)(4,"a",4),L("click",function(){return c.appService.goBack()}),t(5,"button",5),m(6,"i",6),a(7," Back"),e()()()(),t(8,"div",7)(9,"div",8),b(10,I4,2,0)(11,B4,17,4),e()()()),r&2&&(l(10),E(10,c.isStatsLoading?10:11))},dependencies:[ot,K,q,J,it]});let i=s;return i})();var W4=[{path:"application-stats/district-stats",component:gn,canActivate:[mt]},{path:"application-stats/block-ulb-stats/:id",component:bn,canActivate:[mt]},{path:"application-stats/gp-stats/:district_id/:id",component:En,canActivate:[mt]},{path:"application-stats/ward-stats/:district_id/:id",component:Tn,canActivate:[mt]},{path:"application-stats/village-stats/:district_id/:block_id/:id",component:In,canActivate:[mt]},{path:"application-stats/village-user-list/:district_id/:block_id/:gp_id/:id",component:kn,canActivate:[mt]},{path:"application-stats/ward-user-list/:district_id/:ulb_id/:id",component:Dn,canActivate:[mt]},{path:"lwe/district-stats",component:Un,canActivate:[mt]},{path:"lwe/block-ulb-stats/:id",component:On,canActivate:[mt]},{path:"lwe/gp-stats/:district_id/:id",component:Wn,canActivate:[mt]},{path:"lwe/ward-stats/:district_id/:id",component:Fn,canActivate:[mt]},{path:"lwe/village-stats/:district_id/:block_id/:id",component:zn,canActivate:[mt]},{path:"lwe/village-user-list/:district_id/:block_id/:gp_id/:id",component:$n,canActivate:[mt]},{path:"lwe/ward-user-list/:district_id/:ulb_id/:id",component:Xn,canActivate:[mt]},{path:"adp/district-stats",component:Hn,canActivate:[mt]},{path:"adp/block-ulb-stats/:id",component:qn,canActivate:[mt]},{path:"adp/gp-stats/:district_id/:id",component:Qn,canActivate:[mt]},{path:"adp/ward-stats/:district_id/:id",component:to,canActivate:[mt]},{path:"adp/village-stats/:district_id/:block_id/:id",component:io,canActivate:[mt]},{path:"adp/village-user-list/:district_id/:block_id/:gp_id/:id",component:oo,canActivate:[mt]},{path:"adp/ward-user-list/:district_id/:ulb_id/:id",component:ro,canActivate:[mt]},{path:"tsp/district-stats",component:vo,canActivate:[mt]},{path:"tsp/block-ulb-stats/:id",component:Co,canActivate:[mt]},{path:"tsp/gp-stats/:district_id/:id",component:So,canActivate:[mt]},{path:"tsp/ward-stats/:district_id/:id",component:uo,canActivate:[mt]},{path:"tsp/village-stats/:district_id/:block_id/:id",component:_o,canActivate:[mt]},{path:"tsp/village-user-list/:district_id/:block_id/:gp_id/:id",component:po,canActivate:[mt]},{path:"tsp/ward-user-list/:district_id/:ulb_id/:id",component:lo,canActivate:[mt]},{path:"pwd/district-stats",component:Bo,canActivate:[mt]},{path:"pwd/block-ulb-stats/:id",component:Ro,canActivate:[mt]},{path:"pwd/gp-stats/:district_id/:id",component:Ao,canActivate:[mt]},{path:"pwd/ward-stats/:district_id/:id",component:Po,canActivate:[mt]},{path:"pwd/village-stats/:district_id/:block_id/:id",component:yo,canActivate:[mt]},{path:"pwd/village-user-list/:district_id/:block_id/:gp_id/:id",component:Lo,canActivate:[mt]},{path:"pwd/ward-user-list/:district_id/:ulb_id/:id",component:wo,canActivate:[mt]},{path:"nfsa/district-stats",component:Mo,canActivate:[mt]},{path:"nfsa/block-ulb-stats/:id",component:zo,canActivate:[mt]},{path:"nfsa/gp-stats/:district_id/:id",component:$o,canActivate:[mt]},{path:"nfsa/ward-stats/:district_id/:id",component:Ho,canActivate:[mt]},{path:"nfsa/village-stats/:district_id/:block_id/:id",component:qo,canActivate:[mt]},{path:"nfsa/village-user-list/:district_id/:block_id/:gp_id/:id",component:Qo,canActivate:[mt]},{path:"nfsa/ward-user-list/:district_id/:ulb_id/:id",component:Xo,canActivate:[mt]},{path:"non_nfsa/district-stats",component:ta,canActivate:[mt]},{path:"non_nfsa/block-ulb-stats/:id",component:na,canActivate:[mt]},{path:"non_nfsa/gp-stats/:district_id/:id",component:aa,canActivate:[mt]},{path:"non_nfsa/ward-stats/:district_id/:id",component:sa,canActivate:[mt]},{path:"non_nfsa/village-stats/:district_id/:block_id/:id",component:ca,canActivate:[mt]},{path:"non_nfsa/village-user-list/:district_id/:block_id/:gp_id/:id",component:pa,canActivate:[mt]},{path:"non_nfsa/ward-user-list/:district_id/:ulb_id/:id",component:_a,canActivate:[mt]},{path:"ekycmode/district-stats",component:ua,canActivate:[mt]},{path:"ekycmode/block-ulb-stats/:id",component:xa,canActivate:[mt]},{path:"ekycmode/gp-stats/:district_id/:id",component:Ca,canActivate:[mt]},{path:"ekycmode/ward-stats/:district_id/:id",component:va,canActivate:[mt]},{path:"ekycmode/village-stats/:district_id/:block_id/:id",component:wa,canActivate:[mt]},{path:"ekycmode/village-user-list/:district_id/:block_id/:gp_id/:id",component:La,canActivate:[mt]},{path:"ekycmode/ward-user-list/:district_id/:ulb_id/:id",component:ya,canActivate:[mt]},{path:"soc_cat/district-stats",component:Pa,canActivate:[mt]},{path:"soc_cat/block-ulb-stats/:id",component:Ua,canActivate:[mt]},{path:"soc_cat/gp-stats/:district_id/:id",component:Ra,canActivate:[mt]},{path:"soc_cat/ward-stats/:district_id/:id",component:ja,canActivate:[mt]},{path:"soc_cat/village-stats/:district_id/:block_id/:id",component:Ma,canActivate:[mt]},{path:"soc_cat/village-user-list/:district_id/:block_id/:gp_id/:id",component:Va,canActivate:[mt]},{path:"soc_cat/ward-user-list/:district_id/:ulb_id/:id",component:Ba,canActivate:[mt]},{path:"payment/district-stats",component:Ga,canActivate:[mt]},{path:"payment/block-ulb-stats/:id",component:Ha,canActivate:[mt]},{path:"payment/gp-stats/:district_id/:id",component:qa,canActivate:[mt]},{path:"payment/ward-stats/:district_id/:id",component:Qa,canActivate:[mt]},{path:"payment/village-stats/:district_id/:block_id/:id",component:tr,canActivate:[mt]},{path:"payment/village-user-list/:district_id/:block_id/:gp_id/:id",component:ir,canActivate:[mt]},{path:"payment/ward-user-list/:district_id/:ulb_id/:id",component:or,canActivate:[mt]},{path:"age/district-stats",component:rr,canActivate:[mt]},{path:"age/block-ulb-stats/:id",component:sr,canActivate:[mt]},{path:"age/gp-stats/:district_id/:id",component:lr,canActivate:[mt]},{path:"age/ward-stats/:district_id/:id",component:cr,canActivate:[mt]},{path:"age/village-stats/:district_id/:block_id/:id",component:dr,canActivate:[mt]},{path:"age/village-user-list/:district_id/:block_id/:gp_id/:id",component:pr,canActivate:[mt]},{path:"age/ward-user-list/:district_id/:ulb_id/:id",component:mr,canActivate:[mt]},{path:"ekycstats/district-stats",component:fr,canActivate:[mt]},{path:"ekycstats/block-ulb-stats/:id",component:Sr,canActivate:[mt]},{path:"ekycstats/gp-stats/:district_id/:id",component:gr,canActivate:[mt]},{path:"ekycstats/ward-stats/:district_id/:id",component:br,canActivate:[mt]},{path:"ekycstats/village-stats/:district_id/:block_id/:id",component:Er,canActivate:[mt]},{path:"ekycstats/village-user-list/:district_id/:block_id/:gp_id/:id",component:Tr,canActivate:[mt]},{path:"ekycstats/ward-user-list/:district_id/:ulb_id/:id",component:Ir,canActivate:[mt]},{path:"npci_failed/district-stats",component:kr,canActivate:[mt]},{path:"npci_failed/block-ulb-stats/:id",component:Ar,canActivate:[mt]},{path:"npci_failed/gp-stats/:district_id/:id",component:Nr,canActivate:[mt]},{path:"npci_failed/ward-stats/:district_id/:id",component:Or,canActivate:[mt]},{path:"npci_failed/village-stats/:district_id/:block_id/:id",component:Wr,canActivate:[mt]},{path:"npci_failed/village-user-list/:district_id/:block_id/:gp_id/:id",component:Fr,canActivate:[mt]},{path:"npci_failed/ward-user-list/:district_id/:ulb_id/:id",component:zr,canActivate:[mt]},{path:"optout/district-stats",component:$r,canActivate:[mt]},{path:"optout/block-ulb-stats/:id",component:Yr,canActivate:[mt]},{path:"optout/gp-stats/:district_id/:id",component:Kr,canActivate:[mt]},{path:"optout/ward-stats/:district_id/:id",component:Jr,canActivate:[mt]},{path:"optout/village-stats/:district_id/:block_id/:id",component:Zr,canActivate:[mt]},{path:"optout/village-user-list/:district_id/:block_id/:gp_id/:id",component:es,canActivate:[mt]},{path:"optout/ward-user-list/:district_id/:ulb_id/:id",component:ns,canActivate:[mt]},{path:"optin/district-stats",component:Us,canActivate:[mt]},{path:"optin/block-ulb-stats/:id",component:Ds,canActivate:[mt]},{path:"optin/gp-stats/:district_id/:id",component:ys,canActivate:[mt]},{path:"optin/ward-stats/:district_id/:id",component:Ls,canActivate:[mt]},{path:"optin/village-stats/:district_id/:block_id/:id",component:ws,canActivate:[mt]},{path:"optin/village-user-list/:district_id/:block_id/:gp_id/:id",component:vs,canActivate:[mt]},{path:"optin/ward-user-list/:district_id/:ulb_id/:id",component:Cs,canActivate:[mt]},{path:"nonnfsa-reject/district-stats",component:as,canActivate:[mt]},{path:"nonnfsa-reject/block-ulb-stats/:id",component:ls,canActivate:[mt]},{path:"nonnfsa-reject/gp-stats/:district_id/:id",component:ds,canActivate:[mt]},{path:"nonnfsa-reject/ward-stats/:district_id/:id",component:ms,canActivate:[mt]},{path:"nonnfsa-reject/village-stats/:district_id/:block_id/:id",component:fs,canActivate:[mt]},{path:"nonnfsa-reject/village-user-list/:district_id/:block_id/:gp_id/:id",component:hs,canActivate:[mt]},{path:"nonnfsa-reject/ward-user-list/:district_id/:ulb_id/:id",component:xs,canActivate:[mt]}],Ns=(()=>{let s=class s{};s.\u0275fac=function(r){return new(r||s)},s.\u0275mod=Qt({type:s}),s.\u0275inj=Jt({imports:[Zt.forChild(W4),Zt]});let i=s;return i})();var v9=(()=>{let s=class s{};s.\u0275fac=function(r){return new(r||s)},s.\u0275mod=Qt({type:s}),s.\u0275inj=Jt({imports:[fn,Ns,Sn,un,hn]});let i=s;return i})();export{v9 as a};
