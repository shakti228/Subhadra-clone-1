import{a as ke,b as ee}from"./chunk-IBFSLYL4.js";import{a as ye,b as Te}from"./chunk-SZXMKXCP.js";import{a as De}from"./chunk-IJF73OZM.js";import{$b as Z,Ab as te,Bc as Ae,Ea as a,F as Ge,Fa as h,Fb as de,Ga as V,J as ne,K as $e,Mc as nt,N as X,O as J,Pa as v,Pb as me,Qa as C,Ub as _e,Z as s,_ as w,_b as Ie,a as N,ac as ue,b as P,bc as he,cb as re,cc as fe,da as d,db as se,ec as F,f as ie,gc as ge,ha as u,hb as le,ia as k,jb as et,jc as Se,ka as oe,kb as q,la as ae,lb as Q,ma as i,mb as ce,mc as xe,na as t,nc as be,oa as S,oc as ve,pa as z,pc as Ce,qa as G,sa as K,ta as B,ua as m,vb as pe,wc as tt,xc as it,yb as We,yc as Ee,zb as we}from"./chunk-SGLRJF2H.js";var He=ie(we()),ot=ie(De());function xt(e,r){if(e&1&&(i(0,"option",39),a(1),t()),e&2){let o=r.$implicit;d("value",o.id),s(1),h(o.district_name)}}function bt(e,r){if(e&1&&(i(0,"option",41),a(1),t()),e&2){let o=m().$implicit,n=m();d("ngValue",n.jsonify(o)),s(1),V(" ",o.block_name," ")}}function vt(e,r){if(e&1&&(z(0),u(1,bt,2,2,"option",40),G()),e&2){let o=r.$implicit;s(1),d("ngIf",o.pushType==="blockid")}}function Ct(e,r){if(e&1&&(i(0,"option",41),a(1),t()),e&2){let o=m().$implicit,n=m();d("ngValue",n.jsonify(o)),s(1),V(" ",o.ulb_name," ")}}function yt(e,r){if(e&1&&(z(0),u(1,Ct,2,2,"option",40),G()),e&2){let o=r.$implicit;s(1),d("ngIf",o.pushType==="ulbtype")}}function Et(e,r){if(e&1&&(i(0,"option",41),a(1),t()),e&2){let o=m().$implicit,n=m();d("ngValue",n.jsonify(o)),s(1),V(" ",o.gp_name," ")}}function Tt(e,r){if(e&1&&(z(0),u(1,Et,2,2,"option",40),G()),e&2){let o=r.$implicit;s(1),d("ngIf",o.pushType==="gpid")}}function kt(e,r){if(e&1&&(i(0,"option",41),a(1),t()),e&2){let o=m().$implicit,n=m();d("ngValue",n.jsonify(o)),s(1),V(" ",o.ward_no," ")}}function It(e,r){if(e&1&&(z(0),u(1,kt,2,2,"option",40),G()),e&2){let o=r.$implicit;s(1),d("ngIf",o.pushType==="wardid")}}function At(e,r){e&1&&(i(0,"button",42),S(1,"i",43),a(2,"Search "),t())}function Ft(e,r){e&1&&(i(0,"button",44),S(1,"i",45),a(2," Searching ..."),t())}function wt(e,r){if(e&1){let o=K();i(0,"button",61),B("click",function(){X(o);let p=m(2);return J(p.exportToPDF())}),S(1,"i",62),a(2,"Download to PDF "),t()}}function Dt(e,r){e&1&&(i(0,"button",63),S(1,"i",45),a(2,"Downloading "),t())}function Lt(e,r){if(e&1){let o=K();i(0,"button",61),B("click",function(){X(o);let p=m(2);return J(p.exportToExcel())}),S(1,"i",62),a(2,"Download to EXCEL "),t()}}function Nt(e,r){e&1&&(i(0,"button",63),S(1,"i",45),a(2,"Downloading "),t())}var Pt=(e,r)=>r.id;function Bt(e,r){if(e&1&&(i(0,"td"),a(1),v(2,"uppercase"),t()),e&2){let o=m().$implicit;s(1),h(C(2,1,o.block_name))}}function Rt(e,r){if(e&1&&(i(0,"td"),a(1),v(2,"uppercase"),t()),e&2){let o=m().$implicit;s(1),h(C(2,1,o.ulb_name))}}function Ot(e,r){if(e&1&&(i(0,"td"),a(1),v(2,"uppercase"),t()),e&2){let o=m().$implicit;s(1),h(C(2,1,o.gp_name))}}function Ut(e,r){if(e&1&&(i(0,"td"),a(1),v(2,"uppercase"),t()),e&2){let o=m().$implicit;s(1),h(C(2,1,o.ward_no))}}function Mt(e,r){if(e&1&&(i(0,"td"),a(1),v(2,"uppercase"),t()),e&2){let o=m().$implicit;s(1),h(C(2,1,o.village))}}function jt(e,r){e&1&&S(0,"td")}function Vt(e,r){e&1&&(i(0,"span"),a(1,"PENDING"),t())}function zt(e,r){e&1&&(i(0,"span"),a(1,"VERIFIED"),t())}function Gt(e,r){if(e&1&&(i(0,"td"),u(1,Vt,2,0,"span",67)(2,zt,2,0,"span",67),t()),e&2){let o=m().$implicit;s(1),d("ngIf",o.e_kyc_status==="0"),s(1),d("ngIf",o.e_kyc_status==="1")}}function $t(e,r){e&1&&S(0,"td")}function Yt(e,r){e&1&&(i(0,"span"),a(1,", "),t())}function Wt(e,r){if(e&1&&(i(0,"span"),a(1),u(2,Yt,2,0,"span",67),t()),e&2){let o=r.$implicit,n=r.index,p=m().$implicit,l=m(3);s(1),V(" ",o," "),s(1),d("ngIf",n<l.getAllReasons(p).length-1)}}function Ht(e,r){if(e&1&&(i(0,"tr")(1,"td"),a(2),t(),i(3,"td"),a(4),v(5,"uppercase"),t(),u(6,Bt,3,3,"td")(7,Rt,3,3)(8,Ot,3,3,"td")(9,Ut,3,3)(10,Mt,3,3,"td")(11,jt,1,0),i(12,"td"),a(13),v(14,"uppercase"),t(),i(15,"td"),a(16),v(17,"uppercase"),t(),i(18,"td"),a(19),v(20,"uppercase"),t(),i(21,"td"),a(22),v(23,"uppercase"),t(),i(24,"td"),a(25),v(26,"uppercase"),t(),i(27,"td"),a(28),v(29,"uppercase"),t(),i(30,"td"),a(31),v(32,"uppercase"),t(),u(33,Gt,3,2,"td")(34,$t,1,0),i(35,"td"),a(36),v(37,"uppercase"),t(),i(38,"td"),u(39,Wt,3,2,"span",15),t()()),e&2){let o=r.$implicit,n=r.$index,p=m(3);s(2),h(n+1),s(2),h(C(5,15,o.district_name)),s(2),k(6,o.block_name?6:o.ulb_name?7:-1),s(2),k(8,o.gp_name?8:o.ward_no?9:-1),s(2),k(10,o.village?10:11),s(3),h(C(14,17,o.source)),s(3),h(C(17,19,o.application_number)),s(3),h(C(20,21,o.applicant_name)),s(3),h(C(23,23,o.spouse_or_father_name)),s(3),h(p.appService.dateFormat(C(26,25,o.dob))),s(3),h(C(29,27,o.social_category)),s(3),h(C(32,29,o.pwd_status)),s(2),k(33,o.e_kyc_status?33:34),s(3),h(C(37,31,o.application_status)),s(3),d("ngForOf",p.getAllReasons(o))}}function Xt(e,r){if(e&1&&(i(0,"table",64)(1,"thead")(2,"tr")(3,"th"),a(4,"SI#"),t(),i(5,"th"),a(6,"DISTRICT"),t(),i(7,"th"),a(8,"BLOCK/ULB"),t(),i(9,"th"),a(10,"GP/WARD"),t(),i(11,"th"),a(12,"VILLAGE"),t(),i(13,"th"),a(14,"CATEGORY"),t(),i(15,"th"),a(16,"APPLICATION NO."),t(),i(17,"th"),a(18,"APPLICANT NAME"),t(),i(19,"th"),a(20,"FATHER/HUSBAND NAME"),t(),i(21,"th",65),a(22,"DOB"),t(),i(23,"th"),a(24,"SOCIAL CATEGORY"),t(),i(25,"th"),a(26,"PWD"),t(),i(27,"th"),a(28,"E-KYC STATUS"),t(),i(29,"th"),a(30,"APPLICATION STATUS"),t(),i(31,"th",66),a(32,"REASONS (IF REJECTED)"),t()()(),i(33,"tbody"),oe(34,Ht,40,33,"tr",null,Pt),t()()),e&2){let o=m(2);s(34),ae(o.application_list)}}function Jt(e,r){e&1&&(i(0,"h5",68),a(1,"No data available"),t())}function Kt(e,r){e&1&&(i(0,"div",69),a(1,"Loading.. "),S(2,"i",70),t())}function qt(e,r){e&1&&(i(0,"span"),S(1,"i",73),a(2," Loading..."),t())}function Qt(e,r){e&1&&(i(0,"span"),a(1,"Load More"),t())}function Zt(e,r){if(e&1){let o=K();i(0,"div",71)(1,"button",72),B("click",function(){X(o);let p=m(2);return J(p.loadMore())}),u(2,qt,3,0,"span",67)(3,Qt,2,0,"span",67),t()()}if(e&2){let o=m(2);s(2),d("ngIf",o.isLoadMoreInProgress),s(1),d("ngIf",!o.isLoadMoreInProgress)}}function ei(e,r){if(e&1&&(i(0,"div",46)(1,"div",47)(2,"div",48)(3,"div",49)(4,"div",50)(5,"h5",51),a(6," Number of records found : "),i(7,"span",52),a(8),t()()(),i(9,"div",53)(10,"div",54),u(11,wt,3,0,"button",55)(12,Dt,3,0),t(),i(13,"div",56),u(14,Lt,3,0,"button",55)(15,Nt,3,0),t()()(),i(16,"div",57),u(17,Xt,36,0,"table",58)(18,Jt,2,0)(19,Kt,3,0,"div",59),t(),u(20,Zt,4,2,"div",60),t()()()),e&2){let o=m();s(8),h(o.count),s(3),k(11,o.isExportInProgress?12:11),s(3),k(14,o.isExportInProgressExcel?15:14),s(3),k(17,o.application_list&&o.application_list.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),s(2),k(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),s(1),d("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var at=(()=>{let r=class r{constructor(n,p,l,c,g,x,E){this.router=n,this.formService=p,this.appService=l,this.httpClient=c,this.toastService=g,this.authService=x,this.masterDataService=E,this.districts=[],this.blocks=[],this.ulbs=[],this.gramPanchats=[],this.wards=[],this.blockULBList=[],this.gpWardList=[],this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.limit=this.appService.loadmorelimit,this.isDisabled=!1,this.count=0,this.reasonsMapping={},this.rejectedremarkMapping={},this.searchForm=new fe({district:new F("",[Z.required]),block_ulb:new F("",[Z.required]),gp:new F("",[Z.required]),a_category:new F(""),a_status:new F(""),submit_date:new F(""),social_category:new F(""),pwd_status:new F("")})}ngOnInit(){let n=this.authService.userDetail.role.id,p=this.authService.userDetail.demography_id,l=this.authService.userDetail.district_id,c=this.authService.userDetail.demography_type;c===1?this.fetchAllDistricts():c===2?(this.fetchDistrictById(p),this.isDisabled=!0,this.searchForm.get("district")?.disable()):(c===3||c===5)&&(this.fetchDistrictById(l),this.isDisabled=!0,this.searchForm.get("district")?.disable(),this.searchForm.get("block_ulb")?.disable()),this.loadRejectReasonMappings()}getMaskedAadhaar(n){return!n||n.length!==12?n:"********"+n.slice(-4)}fetchAllDistricts(){this.districts=te.data}fetchDistrictById(n){this.districts=te.data.filter(p=>p.id==n),this.searchForm.patchValue({district:n}),this.onDistrictChange()}onDistrictChange(){let n="";this.searchForm.value.district!=""&&(n=this.searchForm.value.district),this.searchForm.get("block_ulb")?.setValue(""),this.searchForm.get("gp")?.setValue(""),this.blocks=[],this.ulbs=[],this.blockULBList=[],this.blocks=this.masterDataService.getBlockData(n),this.ulbs=this.masterDataService.getULBData(n),this.blockULBList=[...this.blocks.map(c=>P(N({},c),{pushType:"blockid"})),...this.ulbs.map(c=>P(N({},c),{pushType:"ulbtype"}))];let p=this.authService.userDetail.demography_type,l=this.authService.userDetail.role.id;p===5&&(this.blocks=[],this.ulbs=this.ulbs.filter(c=>c.id==this.authService.userDetail.demography_id)),p===5&&(this.searchForm.patchValue({block_ulb:this.jsonify(P(N({},this.ulbs.find(c=>c.id==this.authService.userDetail.demography_id)),{pushType:"ulbtype"}))}),this.onBlockChange()),p===3&&(this.blocks=this.blocks.filter(c=>c.id==this.authService.userDetail.demography_id),this.ulbs=[]),p===3&&(this.searchForm.patchValue({block_ulb:this.jsonify(P(N({},this.blocks.find(c=>c.id==this.authService.userDetail.demography_id)),{pushType:"blockid"}))}),this.onBlockChange())}onBlockChange(){let n="";this.searchForm.value.block_ulb&&(n=JSON.parse(this.searchForm.value.block_ulb)),this.searchForm.get("gp")?.setValue(""),this.gramPanchats=[],this.wards=[],this.gpWardList=[];let p=n.pushType==="blockid",l=n.pushType==="ulbtype",c=[];p&&(this.gramPanchats=this.masterDataService.getGPData(n.id),this.gpWardList=this.gramPanchats.map(g=>P(N({},g),{pushType:"gpid"}))),l&&(this.wards=this.masterDataService.getWARDData(n.id),this.gpWardList=this.wards.map(g=>P(N({},g),{pushType:"wardid"})))}jsonify(n){return JSON.stringify(n)}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let p=this.searchForm.value.district,l=this.searchForm.value.gp?JSON.parse(this.searchForm.value.gp):null,c=this.searchForm.value.block_ulb?JSON.parse(this.searchForm.value.block_ulb):null,g=this.searchForm.value.a_category,x=this.searchForm.value.submit_date,E=this.searchForm.value.a_status,y=this.searchForm.value.social_category,T=this.searchForm.value.pwd_status,_=new Q;c&&(c.pushType==="blockid"?_=_.set("block_id",c.id):c.pushType==="ulbtype"&&(_=_.set("ulb_id",c.id))),l&&(l.pushType==="gpid"?_=_.set("gp_id",l.id):l.pushType==="wardid"&&(_=_.set("ward_id",l.id))),p&&(_=_.set("district_id",p)),x&&(_=_.set("submission_date",x)),E&&(_=_.set("application_status",E)),g&&(_=_.set("category",g)),y&&(_=_.set("social_category",y)),T&&(_=_.set("pwd_status",T)),_=_.set("offset",this.offset),_=_.set("limit",this.limit);let f=new q({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/report/application-status`,{params:_,headers:f}).subscribe(b=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=b.count,b.data&&b.data.length>0?(this.application_list=this.application_list.concat(b.data),this.offset+=b.data.length,this.hasMoreRecords=b.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},b=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}loadRejectReasonMappings(){this.httpClient.get("assets/json/rejected_reasons.json").subscribe(n=>{this.reasonsMapping=n.exrMapping,this.rejectedremarkMapping=n.rejectedremarkMapping})}getReasonText(n){return this.reasonsMapping[n]||""}getExclusionReasons(n){return typeof n.exclusion_reasons=="string"?n.exclusion_reasons.split(",").map(l=>l.trim()).map(l=>isNaN(Number(l))?l:this.getReasonText(Number(l))):Array.isArray(n.exclusion_reasons)?n.exclusion_reasons.map(p=>typeof p=="number"?this.getReasonText(p):p):typeof n.exclusion_reasons=="number"?[this.getReasonText(n.exclusion_reasons)]:[]}getRejectedremark(n){return this.rejectedremarkMapping[n]||""}getAllReasons(n){let p=this.getExclusionReasons(n),l=n?.rejectedremark_reasons?this.getRejectedremark(n?.rejectedremark_reasons):null,c=[...p];return l&&c.push(l),c}exportToExcel(){let n=new Q,p=this.searchForm.value.district,l=this.searchForm.value.gp?JSON.parse(this.searchForm.value.gp):null,c=this.searchForm.value.block_ulb?JSON.parse(this.searchForm.value.block_ulb):null,g=this.searchForm.value.submit_date,x=this.searchForm.value.a_status,E=this.searchForm.value.a_category,y=this.searchForm.value.social_category,T=this.searchForm.value.pwd_status;c&&(c.pushType==="blockid"?n=n.set("block_id",c.id):c.pushType==="ulbtype"&&(n=n.set("ulb_id",c.id))),l&&(l.pushType==="gpid"?n=n.set("gp_id",l.id):l.pushType==="wardid"&&(n=n.set("ward_id",l.id))),p&&(n=n.set("district_id",p)),g&&(n=n.set("submission_date",g)),x&&(n=n.set("application_status",x)),E&&(n=n.set("category",E)),y&&(n=n.set("social_category",y)),T&&(n=n.set("pwd_status",T)),n=n.set("export_all","1");let _=new q({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/report/application-status`,{params:n,headers:_,responseType:"json"}).subscribe(f=>{this.isExportInProgressExcel=!1;let b=f.data.map((L,D)=>{let Ye=this.getAllReasons(L).join(", ");return{"SI#":D+1,DISTRICT:L.district_name.toUpperCase(),"BLOCK/ULB":(L.block_name||L.ulb_name).toUpperCase(),"GP/WARD":(L.gp_name||L.ward_no).toUpperCase(),VILLAGE:L.village?L.village.toUpperCase():"",CATEGORY:L.source.toUpperCase(),"APPLICATION NO.":L.application_number.toUpperCase(),"APPLICANT NAME":L.applicant_name.toUpperCase(),"FATHER/HUSBAND NAME":L.spouse_or_father_name.toUpperCase(),DOB:this.appService.dateFormat(L.dob),"SOCIAL CATEGORY":L.social_category.toUpperCase(),PWD:L.pwd_status.toUpperCase(),"E-KYC STATUS":L.e_kyc_status==="0"?"PENDING":L.e_kyc_status==="1"?"VERIFIED":"","APPLICATION STATUS":L.application_status.toUpperCase(),"REASONS (IF REJECTED)":Ye}}),R=ee.json_to_sheet(b),U=ee.book_new();ee.book_append_sheet(U,R,"Applications");let Y=ke(U,{bookType:"xlsx",type:"array"}),H=new Date,$=H.toLocaleDateString("en-GB").split("/").reverse().join("-"),j=H.toLocaleTimeString("en-GB").replace(/:/g,"-"),O=`application_reports_${$}_${j}.xlsx`,M=new Blob([Y],{type:"application/octet-stream"}),I=document.createElement("a"),A=window.URL.createObjectURL(M);I.href=A,I.download=O,I.click(),window.URL.revokeObjectURL(A)},f=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",f)})}exportToPDF(){He.default.vfs=ot.default.pdfMake.vfs;let n=new Q,p=this.searchForm.value.district,l=this.searchForm.value.gp?JSON.parse(this.searchForm.value.gp):null,c=this.searchForm.value.block_ulb?JSON.parse(this.searchForm.value.block_ulb):null,g=this.searchForm.value.submit_date,x=this.searchForm.value.a_status,E=this.searchForm.value.a_category,y=this.searchForm.value.social_category,T=this.searchForm.value.pwd_status;c&&(c.pushType==="blockid"?n=n.set("block_id",c.id):c.pushType==="ulbtype"&&(n=n.set("ulb_id",c.id))),l&&(l.pushType==="gpid"?n=n.set("gp_id",l.id):l.pushType==="wardid"&&(n=n.set("ward_id",l.id))),p&&(n=n.set("district_id",p)),g&&(n=n.set("submission_date",g)),x&&(n=n.set("application_status",x)),E&&(n=n.set("category",E)),y&&(n=n.set("social_category",y)),T&&(n=n.set("pwd_status",T)),n=n.set("export_all","1");let _=new q({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/report/application-status`,{params:n,headers:_,responseType:"json"}).subscribe(f=>{this.isExportInProgress=!1;let b=f.data[0]||{},R=(b.district_name||"N/A").toUpperCase(),U=(b.block_name||b.ulb_name||"N/A").toUpperCase(),Y=(b.gp_name||b.ward_no||"N/A").toUpperCase(),H=[[{text:"SI#",fontSize:10},{text:"VILLAGE",fontSize:10},{text:"CATEGORY",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"DOB",fontSize:10},{text:"SOCIAL CATEGORY",fontSize:10},{text:"PWD",fontSize:10},{text:"E-KYC STATUS",fontSize:10},{text:"APPLICATION STATUS",fontSize:10},{text:"REASONS (IF REJECTED)",fontSize:10}]];f.data.forEach((A,L)=>{let W=this.getAllReasons(A).join(", ");H.push([{text:(L+1).toString().toUpperCase(),fontSize:9},{text:(A.village||"").toUpperCase(),fontSize:9},{text:(A.source||"").toUpperCase(),fontSize:9},{text:(A.application_number||"").toUpperCase(),fontSize:9},{text:(A.applicant_name||"").toUpperCase(),fontSize:9},{text:(A.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(A.dob)||"",fontSize:9},{text:(A.social_category||"").toUpperCase(),fontSize:9},{text:(A.pwd_status||"").toUpperCase(),fontSize:9},{text:A.e_kyc_status==="0"?"PENDING":A.e_kyc_status==="1"?"VERIFIED":"",fontSize:9},{text:(A.application_status||"").toUpperCase(),fontSize:9},{text:W,fontSize:9}])});let $={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${R} > BLOCK/ULB: ${U} > GP/WARD: ${Y}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"APPLICATION STATUS REPORT",style:"header"},{table:{headerRows:1,body:H,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]},layout:{fillColor:function(A){return A===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},j=new Date,O=j.toLocaleDateString("en-GB").split("/").reverse().join("-"),M=j.toLocaleTimeString("en-GB").replace(/:/g,"-"),I=`application_reports_${O}_${M}.pdf`;He.default.createPdf($).download(I)},f=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",f)})}};r.\u0275fac=function(p){return new(p||r)(w(pe),w(ye),w(de),w(ce),w(me),w(_e),w(Te))},r.\u0275cmp=ne({type:r,selectors:[["app-application"]],decls:96,vars:11,consts:[[1,"container-fluid"],[1,"card-title","mb-3"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-2"],[1,"col-md-3"],["for","district",1,"fw-bold"],[1,"text-danger"],["id","district","formControlName","district",1,"form-control","form-select","my-2",3,"change"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"field"],["for","block_ulb",1,"fw-bold"],["id","block_ulb","formControlName","block_ulb",1,"form-control","form-select","my-2",3,"change"],["label","Blocks"],[4,"ngFor","ngForOf"],["label","ULBs"],["for","gp",1,"fw-bold"],["id","gp","formControlName","gp",1,"form-control","form-select","my-2"],["for","a_category",1,"fw-bold"],["formControlName","a_category","id","a_category",1,"form-select","my-2"],["value","1"],["value","0"],[1,"row","g-3"],["for","a_status",1,"fw-bold"],["formControlName","a_status","id","a_status",1,"form-select","my-2"],["value","2"],["for","social_category",1,"fw-bold"],["formControlName","social_category","id","social_category",1,"form-select","my-2"],["value","3"],["value","4"],["for","pwd_status",1,"fw-bold"],["formControlName","pwd_status","id","pwd_status",1,"form-select","my-2"],["for","submit_date",1,"fw-bold"],["type","date","id","submit_date","formControlName","submit_date",1,"form-control","my-2"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],["class","mt-3","style","background-color: #e3e3e3; border: none;",4,"ngIf"],[3,"value"],[3,"ngValue",4,"ngIf"],[3,"ngValue"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[1,"row","mb-2"],[1,"col-md-6"],[1,"card-title"],["id","recordCount"],[1,"col-md-6","text-end"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports"],[2,"min-width","100px"],[2,"min-width","300px"],[4,"ngIf"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"],[1,"fa","fa-spinner","fa-spin"]],template:function(p,l){p&1&&(i(0,"div",0)(1,"h4",1),a(2,"Application Status Report"),t(),i(3,"div",2)(4,"form",3),B("ngSubmit",function(){return l.onSearch()}),i(5,"div",4)(6,"div",5)(7,"label",6),a(8,"District "),i(9,"span",7),a(10,"*"),t()(),i(11,"select",8),B("change",function(){return l.onDistrictChange()}),i(12,"option",9),a(13,"Select District"),t(),u(14,xt,2,2,"option",10),t(),S(15,"app-form-error",11),t(),i(16,"div",5)(17,"label",12),a(18,"Block/ULB "),i(19,"span",7),a(20,"*"),t()(),i(21,"select",13),B("change",function(){return l.onBlockChange()}),i(22,"option",9),a(23,"Select Block/ULB"),t(),i(24,"optgroup",14),u(25,vt,2,1,"ng-container",15),t(),i(26,"optgroup",16),u(27,yt,2,1,"ng-container",15),t()(),S(28,"app-form-error",11),t(),i(29,"div",5)(30,"label",17),a(31,"GP/Ward "),i(32,"span",7),a(33,"*"),t()(),i(34,"select",18)(35,"option",9),a(36,"Select GP/Ward"),t(),u(37,Tt,2,1,"ng-container",15)(38,It,2,1,"ng-container",15),t(),S(39,"app-form-error",11),t(),i(40,"div",5)(41,"label",19),a(42," Category "),t(),i(43,"select",20)(44,"option",9),a(45,"Choose Category"),t(),i(46,"option",21),a(47,"NFSA"),t(),i(48,"option",22),a(49,"NON-NFSA"),t()()()(),i(50,"div",23)(51,"div",5)(52,"label",24),a(53," Application Status "),t(),i(54,"select",25)(55,"option",9),a(56,"Choose Status"),t(),i(57,"option",22),a(58,"Under Process"),t(),i(59,"option",21),a(60,"Approved"),t(),i(61,"option",26),a(62,"Rejected"),t()()(),i(63,"div",5)(64,"label",27),a(65," Social Category "),t(),i(66,"select",28)(67,"option",9),a(68,"Choose Social Category"),t(),i(69,"option",21),a(70,"General"),t(),i(71,"option",26),a(72,"OBC"),t(),i(73,"option",29),a(74,"SC"),t(),i(75,"option",30),a(76,"ST"),t()()(),i(77,"div",5)(78,"label",31),a(79," PWD "),t(),i(80,"select",32)(81,"option",9),a(82,"Choose PWD"),t(),i(83,"option",21),a(84,"Yes "),t(),i(85,"option",22),a(86,"NO"),t()()(),i(87,"div",5)(88,"label",33),a(89," Submission Date "),t(),S(90,"input",34),t()(),i(91,"div",35)(92,"div",36),u(93,At,3,0,"button",37)(94,Ft,3,0),t()()()(),u(95,ei,21,6,"div",38),t()),p&2&&(s(4),d("formGroup",l.searchForm),s(10),d("ngForOf",l.districts),s(1),d("field",l.searchForm.controls.district),s(10),d("ngForOf",l.blockULBList),s(2),d("ngForOf",l.blockULBList),s(1),d("field",l.searchForm.controls.block_ulb),s(9),d("ngForOf",l.gpWardList),s(1),d("ngForOf",l.gpWardList),s(1),d("field",l.searchForm.controls.gp),s(54),k(93,l.isFormSearchInProgress?94:93),s(2),d("ngIf",l.showTable))},dependencies:[re,se,Ee,ge,ve,Ce,Ie,be,ue,he,Se,xe,le]});let e=r;return e})();var Xe=ie(we()),rt=ie(De());function ti(e,r){if(e&1&&(i(0,"option",42),a(1),t()),e&2){let o=r.$implicit;d("value",o.id),s(1),h(o.district_name)}}function ii(e,r){if(e&1&&(i(0,"option",44),a(1),t()),e&2){let o=m().$implicit,n=m();d("ngValue",n.jsonify(o)),s(1),V(" ",o.block_name," ")}}function ni(e,r){if(e&1&&(z(0),u(1,ii,2,2,"option",43),G()),e&2){let o=r.$implicit;s(1),d("ngIf",o.pushType==="blockid")}}function oi(e,r){if(e&1&&(i(0,"option",44),a(1),t()),e&2){let o=m().$implicit,n=m();d("ngValue",n.jsonify(o)),s(1),V(" ",o.ulb_name," ")}}function ai(e,r){if(e&1&&(z(0),u(1,oi,2,2,"option",43),G()),e&2){let o=r.$implicit;s(1),d("ngIf",o.pushType==="ulbtype")}}function ri(e,r){if(e&1&&(i(0,"option",44),a(1),t()),e&2){let o=m().$implicit,n=m();d("ngValue",n.jsonify(o)),s(1),V(" ",o.gp_name," ")}}function si(e,r){if(e&1&&(z(0),u(1,ri,2,2,"option",43),G()),e&2){let o=r.$implicit;s(1),d("ngIf",o.pushType==="gpid")}}function li(e,r){if(e&1&&(i(0,"option",44),a(1),t()),e&2){let o=m().$implicit,n=m();d("ngValue",n.jsonify(o)),s(1),V(" ",o.ward_no," ")}}function ci(e,r){if(e&1&&(z(0),u(1,li,2,2,"option",43),G()),e&2){let o=r.$implicit;s(1),d("ngIf",o.pushType==="wardid")}}function pi(e,r){e&1&&(i(0,"button",45),S(1,"i",46),a(2,"Search "),t())}function di(e,r){e&1&&(i(0,"button",47),S(1,"i",48),a(2," Searching ..."),t())}function mi(e,r){if(e&1){let o=K();i(0,"button",64),B("click",function(){X(o);let p=m(2);return J(p.exportToPDF())}),S(1,"i",65),a(2,"Download to PDF "),t()}}function _i(e,r){e&1&&(i(0,"button",66),S(1,"i",48),a(2,"Downloading "),t())}function ui(e,r){if(e&1){let o=K();i(0,"button",64),B("click",function(){X(o);let p=m(2);return J(p.exportToExcel())}),S(1,"i",65),a(2,"Download to EXCEL "),t()}}function hi(e,r){e&1&&(i(0,"button",66),S(1,"i",48),a(2,"Downloading "),t())}var fi=(e,r)=>r.id;function gi(e,r){if(e&1&&(i(0,"td"),a(1),v(2,"uppercase"),t()),e&2){let o=m().$implicit;s(1),h(C(2,1,o.block_name))}}function Si(e,r){if(e&1&&(i(0,"td"),a(1),v(2,"uppercase"),t()),e&2){let o=m().$implicit;s(1),h(C(2,1,o.ulb_name))}}function xi(e,r){if(e&1&&(i(0,"td"),a(1),v(2,"uppercase"),t()),e&2){let o=m().$implicit;s(1),h(C(2,1,o.gp_name))}}function bi(e,r){if(e&1&&(i(0,"td"),a(1),v(2,"uppercase"),t()),e&2){let o=m().$implicit;s(1),h(C(2,1,o.ward_no))}}function vi(e,r){if(e&1&&(i(0,"td"),a(1),v(2,"uppercase"),t()),e&2){let o=m().$implicit;s(1),h(C(2,1,o.village_name))}}function Ci(e,r){e&1&&S(0,"td")}function yi(e,r){e&1&&(i(0,"span"),a(1,"PENDING"),t())}function Ei(e,r){e&1&&(i(0,"span"),a(1,"VERIFIED"),t())}function Ti(e,r){if(e&1&&(i(0,"td"),u(1,yi,2,0,"span",69)(2,Ei,2,0,"span",69),t()),e&2){let o=m().$implicit;s(1),d("ngIf",o.e_kyc_status==="0"),s(1),d("ngIf",o.e_kyc_status==="1")}}function ki(e,r){e&1&&S(0,"td")}function Ii(e,r){e&1&&(i(0,"span"),a(1,"OTP"),t())}function Ai(e,r){e&1&&(i(0,"span"),a(1," BIOMETRIC "),t())}function Fi(e,r){if(e&1&&(i(0,"td"),u(1,Ii,2,0,"span",69)(2,Ai,2,0,"span",69),t()),e&2){let o=m().$implicit;s(1),d("ngIf",o.e_kyc_mode==="1"),s(1),d("ngIf",o.e_kyc_mode==="2"||o.e_kyc_mode==="3"||o.e_kyc_mode==="4")}}function wi(e,r){e&1&&S(0,"td")}function Di(e,r){if(e&1&&(i(0,"tr")(1,"td"),a(2),t(),i(3,"td"),a(4),v(5,"uppercase"),t(),u(6,gi,3,3,"td")(7,Si,3,3)(8,xi,3,3,"td")(9,bi,3,3)(10,vi,3,3,"td")(11,Ci,1,0),i(12,"td"),a(13),v(14,"uppercase"),t(),i(15,"td"),a(16),v(17,"uppercase"),t(),i(18,"td"),a(19),v(20,"uppercase"),t(),i(21,"td"),a(22),v(23,"uppercase"),t(),i(24,"td"),a(25),t(),i(26,"td"),a(27),v(28,"uppercase"),t(),i(29,"td"),a(30),v(31,"uppercase"),t(),u(32,Ti,3,2,"td")(33,ki,1,0),i(34,"td"),a(35),t(),u(36,Fi,3,2,"td")(37,wi,1,0),t()),e&2){let o=r.$implicit,n=r.$index,p=m(3);s(2),h(n+1),s(2),h(C(5,15,o.district_name)),s(2),k(6,o.block_name?6:o.ulb_name?7:-1),s(2),k(8,o.gp_name?8:o.ward_no?9:-1),s(2),k(10,o.village_name?10:11),s(3),h(C(14,17,o.source)),s(3),h(C(17,19,o.application_number)),s(3),h(C(20,21,o.applicant_name)),s(3),h(C(23,23,o.spouse_or_father_name)),s(3),h(p.appService.dateFormat(o.dob)),s(2),h(C(28,25,o.social_category)),s(3),h(C(31,27,o.pwd_status)),s(2),k(32,o.e_kyc_status?32:33),s(3),h(p.appService.dateFormat(o.e_kyc_date)),s(1),k(36,o.e_kyc_mode?36:37)}}function Li(e,r){if(e&1&&(i(0,"table",67)(1,"thead")(2,"tr")(3,"th"),a(4,"SI#"),t(),i(5,"th"),a(6,"DISTRICT"),t(),i(7,"th"),a(8,"BLOCK/ULB"),t(),i(9,"th"),a(10,"GP/WARD"),t(),i(11,"th"),a(12,"VILLAGE"),t(),i(13,"th"),a(14,"CATEGORY"),t(),i(15,"th"),a(16,"APPLICATION NO."),t(),i(17,"th"),a(18,"APPLICANT NAME"),t(),i(19,"th"),a(20,"FATHER/HUSBAND NAME"),t(),i(21,"th",68),a(22,"DOB"),t(),i(23,"th"),a(24,"SOCIAL CATEGORY"),t(),i(25,"th"),a(26,"PWD"),t(),i(27,"th"),a(28,"E-KYC STATUS"),t(),i(29,"th",68),a(30,"E-KYC DATE"),t(),i(31,"th"),a(32,"E-KYC MODE"),t()()(),i(33,"tbody"),oe(34,Di,38,29,"tr",null,fi),t()()),e&2){let o=m(2);s(34),ae(o.application_list)}}function Ni(e,r){e&1&&(i(0,"h5",70),a(1,"No data available"),t())}function Pi(e,r){e&1&&(i(0,"div",71),a(1,"Loading.. "),S(2,"i",72),t())}function Bi(e,r){e&1&&(i(0,"span"),S(1,"i",75),a(2," Loading..."),t())}function Ri(e,r){e&1&&(i(0,"span"),a(1,"Load More"),t())}function Oi(e,r){if(e&1){let o=K();i(0,"div",73)(1,"button",74),B("click",function(){X(o);let p=m(2);return J(p.loadMore())}),u(2,Bi,3,0,"span",69)(3,Ri,2,0,"span",69),t()()}if(e&2){let o=m(2);s(2),d("ngIf",o.isLoadMoreInProgress),s(1),d("ngIf",!o.isLoadMoreInProgress)}}function Ui(e,r){if(e&1&&(i(0,"div",49)(1,"div",50)(2,"div",51)(3,"div",52)(4,"div",53)(5,"h5",54),a(6," Number of records found : "),i(7,"span",55),a(8),t()()(),i(9,"div",56)(10,"div",57),u(11,mi,3,0,"button",58)(12,_i,3,0),t(),i(13,"div",59),u(14,ui,3,0,"button",58)(15,hi,3,0),t()()(),i(16,"div",60),u(17,Li,36,0,"table",61)(18,Ni,2,0)(19,Pi,3,0,"div",62),t(),u(20,Oi,4,2,"div",63),t()()()),e&2){let o=m();s(8),h(o.count),s(3),k(11,o.isExportInProgress?12:11),s(3),k(14,o.isExportInProgressExcel?15:14),s(3),k(17,o.application_list&&o.application_list.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),s(2),k(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),s(1),d("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var st=(()=>{let r=class r{constructor(n,p,l,c,g,x,E){this.router=n,this.formService=p,this.appService=l,this.httpClient=c,this.toastService=g,this.authService=x,this.masterDataService=E,this.districts=[],this.blocks=[],this.ulbs=[],this.gramPanchats=[],this.wards=[],this.blockULBList=[],this.gpWardList=[],this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.limit=this.appService.loadmorelimit,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.isDisabled=!1,this.count=0,this.searchForm=new fe({district:new F("",[Z.required]),block_ulb:new F("",[Z.required]),gp:new F("",[Z.required]),a_status:new F(""),submit_date:new F(""),e_kyc:new F(""),e_kyc_mode:new F(""),a_category:new F(""),social_category:new F(""),pwd_status:new F("")})}ngOnInit(){let n=this.authService.userDetail.role.id,p=this.authService.userDetail.demography_id,l=this.authService.userDetail.district_id,c=this.authService.userDetail.demography_type;c===1?this.fetchAllDistricts():c===2?(this.fetchDistrictById(p),this.isDisabled=!0,this.searchForm.get("district")?.disable()):(c===3||c===5)&&(this.fetchDistrictById(l),this.isDisabled=!0,this.searchForm.get("district")?.disable(),this.searchForm.get("block_ulb")?.disable())}getMaskedAadhaar(n){return!n||n.length!==12?n:"********"+n.slice(-4)}fetchAllDistricts(){this.districts=te.data}fetchDistrictById(n){this.districts=te.data.filter(p=>p.id==n),this.searchForm.patchValue({district:n}),this.onDistrictChange()}onDistrictChange(){let n="";this.searchForm.value.district!=""&&(n=this.searchForm.value.district),this.searchForm.get("block_ulb")?.setValue(""),this.searchForm.get("gp")?.setValue(""),this.blocks=[],this.ulbs=[],this.blockULBList=[],this.blocks=this.masterDataService.getBlockData(n),this.ulbs=this.masterDataService.getULBData(n),this.blockULBList=[...this.blocks.map(c=>P(N({},c),{pushType:"blockid"})),...this.ulbs.map(c=>P(N({},c),{pushType:"ulbtype"}))];let p=this.authService.userDetail.demography_type,l=this.authService.userDetail.role.id;p===5&&(this.blocks=[],this.ulbs=this.ulbs.filter(c=>c.id==this.authService.userDetail.demography_id)),p===5&&(console.log("ulbs",this.ulbs),this.searchForm.patchValue({block_ulb:this.jsonify(P(N({},this.ulbs.find(c=>c.id==this.authService.userDetail.demography_id)),{pushType:"ulbtype"}))}),this.onBlockChange()),p===3&&(this.blocks=this.blocks.filter(c=>c.id==this.authService.userDetail.demography_id),this.ulbs=[]),p===3&&(this.searchForm.patchValue({block_ulb:this.jsonify(P(N({},this.blocks.find(c=>c.id==this.authService.userDetail.demography_id)),{pushType:"blockid"}))}),this.onBlockChange())}onBlockChange(){let n="";this.searchForm.value.block_ulb&&(n=JSON.parse(this.searchForm.value.block_ulb)),this.searchForm.get("gp")?.setValue(""),this.gramPanchats=[],this.wards=[],this.gpWardList=[];let p=n.pushType==="blockid",l=n.pushType==="ulbtype",c=[];p&&(this.gramPanchats=this.masterDataService.getGPData(n.id),this.gpWardList=this.gramPanchats.map(g=>P(N({},g),{pushType:"gpid"}))),l&&(this.wards=this.masterDataService.getWARDData(n.id),this.gpWardList=this.wards.map(g=>P(N({},g),{pushType:"wardid"})))}jsonify(n){return JSON.stringify(n)}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let p=this.searchForm.value.district,l=this.searchForm.value.gp?JSON.parse(this.searchForm.value.gp):null,c=this.searchForm.value.block_ulb?JSON.parse(this.searchForm.value.block_ulb):null,g=this.searchForm.value.submit_date,x=this.searchForm.value.e_kyc,E=this.searchForm.value.e_kyc_mode,y=this.searchForm.value.a_category,T=this.searchForm.value.social_category,_=this.searchForm.value.pwd_status,f=new Q;c&&(c.pushType==="blockid"?f=f.set("block_id",c.id):c.pushType==="ulbtype"&&(f=f.set("ulb_id",c.id))),l&&(l.pushType==="gpid"?f=f.set("gp_id",l.id):l.pushType==="wardid"&&(f=f.set("ward_id",l.id))),p&&(f=f.set("district_id",p)),g&&(f=f.set("submission_date",g)),x&&(f=f.set("ekyc_status",x)),E&&(f=f.set("ekyc_mode",E)),y&&(f=f.set("category",y)),T&&(f=f.set("social_category",T)),_&&(f=f.set("pwd_status",_)),f=f.set("offset",this.offset),f=f.set("limit",this.limit);let b=new q({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/report/ekyc-status`,{params:f,headers:b}).subscribe(R=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=R.count,R.data&&R.data.length>0?(this.application_list=this.application_list.concat(R.data),this.offset+=R.data.length,this.hasMoreRecords=R.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},R=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}exportToExcel(){let n=this.searchForm.value.district,p=this.searchForm.value.gp?JSON.parse(this.searchForm.value.gp):null,l=this.searchForm.value.block_ulb?JSON.parse(this.searchForm.value.block_ulb):null,c=this.searchForm.value.submit_date,g=this.searchForm.value.e_kyc,x=this.searchForm.value.e_kyc_mode,E=this.searchForm.value.a_category,y=this.searchForm.value.social_category,T=this.searchForm.value.pwd_status,_=new Q;l&&(l.pushType==="blockid"?_=_.set("block_id",l.id):l.pushType==="ulbtype"&&(_=_.set("ulb_id",l.id))),p&&(p.pushType==="gpid"?_=_.set("gp_id",p.id):p.pushType==="wardid"&&(_=_.set("ward_id",p.id))),n&&(_=_.set("district_id",n)),c&&(_=_.set("submission_date",c)),g&&(_=_.set("ekyc_status",g)),x&&(_=_.set("ekyc_mode",x)),E&&(_=_.set("category",E)),y&&(_=_.set("social_category",y)),T&&(_=_.set("pwd_status",T)),_=_.set("export_all","1");let f=new q({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/report/ekyc-status`,{params:_,headers:f,responseType:"json"}).subscribe(b=>{this.isExportInProgressExcel=!1;let R=b.data.map((D,W)=>({"SI#":W+1,DISTRICT:D.district_name.toUpperCase(),"BLOCK/ULB":(D.block_name||D.ulb_name).toUpperCase(),"GP/WARD":(D.gp_name||D.ward_no).toUpperCase(),VILLAGE:D.village_name?D.village_name.toUpperCase():"",CATEGORY:D.source.toUpperCase(),"APPLICATION NO.":D.application_number.toUpperCase(),"APPLICANT NAME":D.applicant_name.toUpperCase(),"FATHER/HUSBAND NAME":D.spouse_or_father_name.toUpperCase(),DOB:this.appService.dateFormat(D.dob),"SOCIAL CATEGORY":D.social_category.toUpperCase(),PWD:D.pwd_status.toUpperCase(),"E-KYC STATUS":D.e_kyc_status==="0"?"PENDING":D.e_kyc_status==="1"?"VERIFIED":"","E-KYC DATE":this.appService.dateFormat(D.e_kyc_date),"E-KYC MODE":D.e_kyc_mode==="1"?"OTP":D.e_kyc_mode==="2"||D.e_kyc_mode==="3"||D.e_kyc_mode==="4"?"BIOMETRIC":""})),U=ee.json_to_sheet(R),Y=ee.book_new();ee.book_append_sheet(Y,U,"Applications");let H=ke(Y,{bookType:"xlsx",type:"array"}),$=new Date,j=$.toLocaleDateString("en-GB").split("/").reverse().join("-"),O=$.toLocaleTimeString("en-GB").replace(/:/g,"-"),M=`ekyc_reports_${j}_${O}.xlsx`,I=new Blob([H],{type:"application/octet-stream"}),A=document.createElement("a"),L=window.URL.createObjectURL(I);A.href=L,A.download=M,A.click(),window.URL.revokeObjectURL(L)},b=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",b)})}exportToPDF(){Xe.default.vfs=rt.default.pdfMake.vfs;let n=new Q,p=this.searchForm.value.district,l=this.searchForm.value.gp?JSON.parse(this.searchForm.value.gp):null,c=this.searchForm.value.block_ulb?JSON.parse(this.searchForm.value.block_ulb):null,g=this.searchForm.value.submit_date,x=this.searchForm.value.e_kyc,E=this.searchForm.value.e_kyc_mode,y=this.searchForm.value.a_category,T=this.searchForm.value.social_category,_=this.searchForm.value.pwd_status;c&&(c.pushType==="blockid"?n=n.set("block_id",c.id):c.pushType==="ulbtype"&&(n=n.set("ulb_id",c.id))),l&&(l.pushType==="gpid"?n=n.set("gp_id",l.id):l.pushType==="wardid"&&(n=n.set("ward_id",l.id))),p&&(n=n.set("district_id",p)),g&&(n=n.set("submission_date",g)),x&&(n=n.set("ekyc_status",x)),E&&(n=n.set("ekyc_mode",E)),y&&(n=n.set("category",y)),T&&(n=n.set("social_category",T)),_&&(n=n.set("pwd_status",_)),n=n.set("export_all","1");let f=new q({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/report/ekyc-status`,{params:n,headers:f,responseType:"json"}).subscribe(b=>{this.isExportInProgress=!1;let R=b.data[0]||{},U=(R.district_name||"N/A").toUpperCase(),Y=(R.block_name||R.ulb_name||"N/A").toUpperCase(),H=(R.gp_name||R.ward_no||"N/A").toUpperCase(),$=[[{text:"SI#",fontSize:10},{text:"VILLAGE",fontSize:10},{text:"CATEGORY",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"DOB",fontSize:10},{text:"SOCIAL CATEGORY",fontSize:10},{text:"PWD",fontSize:10},{text:"E-KYC STATUS",fontSize:10},{text:"E-KYC DATE",fontSize:10},{text:"E-KYC MODE",fontSize:10}]];b.data.forEach((L,D)=>{$.push([{text:(D+1).toString().toUpperCase(),fontSize:9},{text:(L.village_name||"").toUpperCase(),fontSize:9},{text:(L.source||"").toUpperCase(),fontSize:9},{text:(L.application_number||"").toUpperCase(),fontSize:9},{text:(L.applicant_name||"").toUpperCase(),fontSize:9},{text:(L.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(L.dob)||"",fontSize:9},{text:(L.social_category||"").toUpperCase(),fontSize:9},{text:(L.pwd_status||"").toUpperCase(),fontSize:9},{text:L.e_kyc_status==="0"?"PENDING":L.e_kyc_status==="1"?"VERIFIED":"",fontSize:9},{text:this.appService.dateFormat(L.e_kyc_date)||"",fontSize:9},{text:L.e_kyc_mode==="1"?"OTP":["2","3","4"].includes(L.e_kyc_mode)?"BIOMETRIC":"",fontSize:9}])});let j={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${U} > BLOCK/ULB: ${Y} > GP/WARD: ${H}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"eKYC STATUS REPORT",style:"header"},{table:{headerRows:1,body:$,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]},layout:{fillColor:function(L){return L===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},O=new Date,M=O.toLocaleDateString("en-GB").split("/").reverse().join("-"),I=O.toLocaleTimeString("en-GB").replace(/:/g,"-"),A=`eKYC_reports_${M}_${I}.pdf`;Xe.default.createPdf(j).download(A)},b=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",b)})}};r.\u0275fac=function(p){return new(p||r)(w(pe),w(ye),w(de),w(ce),w(me),w(_e),w(Te))},r.\u0275cmp=ne({type:r,selectors:[["app-ekyc"]],decls:105,vars:11,consts:[[1,"container-fluid"],[1,"card-title","mb-3"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-2"],[1,"col-md-3"],["for","district",1,"fw-bold"],[1,"text-danger"],["id","district","formControlName","district",1,"form-control","form-select","my-2",3,"change"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"field"],["for","block_ulb",1,"fw-bold"],["id","block_ulb","formControlName","block_ulb",1,"form-control","form-select","my-2",3,"change"],["label","Blocks"],[4,"ngFor","ngForOf"],["label","ULBs"],["for","gp",1,"fw-bold"],["id","gp","formControlName","gp",1,"form-control","form-select","my-2"],["for","submit_date",1,"fw-bold"],["type","date","id","submit_date","formControlName","submit_date",1,"form-control","my-2"],[1,"row","g-3"],["for","a_category",1,"fw-bold"],["formControlName","a_category","id","a_category",1,"form-select","my-2"],["value","1"],["value","0"],["for","e-KYC",1,"fw-bold"],["formControlName","e_kyc","id","e-KYC",1,"form-select","my-2"],["for","e-KYC_Mode",1,"fw-bold"],["formControlName","e_kyc_mode","id","a_e-KYC_mode",1,"form-select","my-2"],["value","5"],["for","social_category",1,"fw-bold"],["formControlName","social_category","id","social_category",1,"form-select","my-2"],["value","2"],["value","3"],["value","4"],["for","pwd_status",1,"fw-bold"],["formControlName","pwd_status","id","pwd_status",1,"form-select","my-2"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],["class","mt-3","style","background-color: #e3e3e3; border: none;",4,"ngIf"],[3,"value"],[3,"ngValue",4,"ngIf"],[3,"ngValue"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[1,"row","mb-2"],[1,"col-md-6"],[1,"card-title"],["id","recordCount"],[1,"col-md-6","text-end"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports"],[2,"min-width","100px"],[4,"ngIf"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"],[1,"fa","fa-spinner","fa-spin"]],template:function(p,l){p&1&&(i(0,"div",0)(1,"h4",1),a(2,"e-KYC Status Report"),t(),i(3,"div",2)(4,"form",3),B("ngSubmit",function(){return l.onSearch()}),i(5,"div",4)(6,"div",5)(7,"label",6),a(8,"District "),i(9,"span",7),a(10,"*"),t()(),i(11,"select",8),B("change",function(){return l.onDistrictChange()}),i(12,"option",9),a(13,"Select District"),t(),u(14,ti,2,2,"option",10),t(),S(15,"app-form-error",11),t(),i(16,"div",5)(17,"label",12),a(18,"Block/ULB "),i(19,"span",7),a(20,"*"),t()(),i(21,"select",13),B("change",function(){return l.onBlockChange()}),i(22,"option",9),a(23,"Select Block/ULB"),t(),i(24,"optgroup",14),u(25,ni,2,1,"ng-container",15),t(),i(26,"optgroup",16),u(27,ai,2,1,"ng-container",15),t()(),S(28,"app-form-error",11),t(),i(29,"div",5)(30,"label",17),a(31,"GP/Ward "),i(32,"span",7),a(33,"*"),t()(),i(34,"select",18)(35,"option",9),a(36,"Select GP/Ward"),t(),u(37,si,2,1,"ng-container",15)(38,ci,2,1,"ng-container",15),t(),S(39,"app-form-error",11),t(),i(40,"div",5)(41,"label",19),a(42," Submission Date "),t(),S(43,"input",20),t()(),i(44,"div",21)(45,"div",5)(46,"label",22),a(47," Category "),t(),i(48,"select",23)(49,"option",9),a(50,"Choose Category"),t(),i(51,"option",24),a(52,"NFSA"),t(),i(53,"option",25),a(54,"NON-NFSA"),t()()(),i(55,"div",5)(56,"label",26),a(57," e-KYC Status "),t(),i(58,"select",27)(59,"option",9),a(60,"Select e-KYC Status"),t(),i(61,"option",25),a(62,"Pending"),t(),i(63,"option",24),a(64,"Verified"),t()()(),i(65,"div",5)(66,"label",28),a(67," e-KYC Mode "),t(),i(68,"select",29)(69,"option",9),a(70,"Select e-KYC Mode"),t(),i(71,"option",24),a(72,"OTP"),t(),i(73,"option",30),a(74,"Biometric"),t()()(),i(75,"div",5)(76,"label",31),a(77," Social Category "),t(),i(78,"select",32)(79,"option",9),a(80,"Choose Social Category"),t(),i(81,"option",24),a(82,"General"),t(),i(83,"option",33),a(84,"OBC"),t(),i(85,"option",34),a(86,"SC"),t(),i(87,"option",35),a(88,"ST"),t()()()(),i(89,"div",4)(90,"div",5)(91,"label",36),a(92," PWD "),t(),i(93,"select",37)(94,"option",9),a(95,"Choose PWD"),t(),i(96,"option",24),a(97,"Yes "),t(),i(98,"option",25),a(99,"NO"),t()()()(),i(100,"div",38)(101,"div",39),u(102,pi,3,0,"button",40)(103,di,3,0),t()()()(),u(104,Ui,21,6,"div",41),t()),p&2&&(s(4),d("formGroup",l.searchForm),s(10),d("ngForOf",l.districts),s(1),d("field",l.searchForm.controls.district),s(10),d("ngForOf",l.blockULBList),s(2),d("ngForOf",l.blockULBList),s(1),d("field",l.searchForm.controls.block_ulb),s(9),d("ngForOf",l.gpWardList),s(1),d("ngForOf",l.gpWardList),s(1),d("field",l.searchForm.controls.gp),s(63),k(102,l.isFormSearchInProgress?103:102),s(2),d("ngIf",l.showTable))},dependencies:[re,se,Ee,ge,ve,Ce,Ie,be,ue,he,Se,xe,le]});let e=r;return e})();var Je=ie(we()),lt=ie(De());function Mi(e,r){if(e&1&&(i(0,"option",37),a(1),t()),e&2){let o=r.$implicit;d("value",o.id),s(1),h(o.district_name)}}function ji(e,r){if(e&1&&(i(0,"option",39),a(1),t()),e&2){let o=m().$implicit,n=m();d("ngValue",n.jsonify(o)),s(1),V(" ",o.block_name," ")}}function Vi(e,r){if(e&1&&(z(0),u(1,ji,2,2,"option",38),G()),e&2){let o=r.$implicit;s(1),d("ngIf",o.pushType==="blockid")}}function zi(e,r){if(e&1&&(i(0,"option",39),a(1),t()),e&2){let o=m().$implicit,n=m();d("ngValue",n.jsonify(o)),s(1),V(" ",o.ulb_name," ")}}function Gi(e,r){if(e&1&&(z(0),u(1,zi,2,2,"option",38),G()),e&2){let o=r.$implicit;s(1),d("ngIf",o.pushType==="ulbtype")}}function $i(e,r){if(e&1&&(i(0,"option",39),a(1),t()),e&2){let o=m().$implicit,n=m();d("ngValue",n.jsonify(o)),s(1),V(" ",o.gp_name," ")}}function Yi(e,r){if(e&1&&(z(0),u(1,$i,2,2,"option",38),G()),e&2){let o=r.$implicit;s(1),d("ngIf",o.pushType==="gpid")}}function Wi(e,r){if(e&1&&(i(0,"option",39),a(1),t()),e&2){let o=m().$implicit,n=m();d("ngValue",n.jsonify(o)),s(1),V(" ",o.ward_no," ")}}function Hi(e,r){if(e&1&&(z(0),u(1,Wi,2,2,"option",38),G()),e&2){let o=r.$implicit;s(1),d("ngIf",o.pushType==="wardid")}}function Xi(e,r){e&1&&(i(0,"button",40),S(1,"i",41),a(2,"Search "),t())}function Ji(e,r){e&1&&(i(0,"button",42),S(1,"i",43),a(2," Searching ..."),t())}function Ki(e,r){if(e&1){let o=K();i(0,"button",59),B("click",function(){X(o);let p=m(2);return J(p.exportToPDF())}),S(1,"i",60),a(2,"Download to PDF "),t()}}function qi(e,r){e&1&&(i(0,"button",61),S(1,"i",43),a(2,"Downloading "),t())}function Qi(e,r){if(e&1){let o=K();i(0,"button",59),B("click",function(){X(o);let p=m(2);return J(p.exportToExcel())}),S(1,"i",60),a(2,"Download to EXCEL "),t()}}function Zi(e,r){e&1&&(i(0,"button",61),S(1,"i",43),a(2,"Downloading "),t())}var en=(e,r)=>r.id;function tn(e,r){if(e&1&&(i(0,"td"),a(1),v(2,"uppercase"),t()),e&2){let o=m().$implicit;s(1),h(C(2,1,o.block_name))}}function nn(e,r){if(e&1&&(i(0,"td"),a(1),v(2,"uppercase"),t()),e&2){let o=m().$implicit;s(1),h(C(2,1,o.ulb_name))}}function on(e,r){if(e&1&&(i(0,"td"),a(1),v(2,"uppercase"),t()),e&2){let o=m().$implicit;s(1),h(C(2,1,o.gp_name))}}function an(e,r){if(e&1&&(i(0,"td"),a(1),v(2,"uppercase"),t()),e&2){let o=m().$implicit;s(1),h(C(2,1,o.ward_no))}}function rn(e,r){if(e&1&&(i(0,"td"),a(1),v(2,"uppercase"),t()),e&2){let o=m().$implicit;s(1),h(C(2,1,o.village_name))}}function sn(e,r){e&1&&S(0,"td")}function ln(e,r){e&1&&(i(0,"span"),a(1,", "),t())}function cn(e,r){if(e&1&&(i(0,"span"),a(1),u(2,ln,2,0,"span",65),t()),e&2){let o=r.$implicit,n=r.index,p=m().$implicit,l=m(3);s(1),V(" ",o," "),s(1),d("ngIf",n<l.getAllReasons(p).length-1)}}function pn(e,r){if(e&1&&(i(0,"tr")(1,"td"),a(2),t(),i(3,"td"),a(4),v(5,"uppercase"),t(),u(6,tn,3,3,"td")(7,nn,3,3)(8,on,3,3,"td")(9,an,3,3)(10,rn,3,3,"td")(11,sn,1,0),i(12,"td"),a(13),v(14,"uppercase"),t(),i(15,"td"),a(16),v(17,"uppercase"),t(),i(18,"td"),a(19),v(20,"uppercase"),t(),i(21,"td"),a(22),v(23,"uppercase"),t(),i(24,"td"),a(25),t(),i(26,"td"),a(27),v(28,"uppercase"),t(),i(29,"td"),a(30),v(31,"uppercase"),t(),i(32,"td"),a(33),t(),i(34,"td"),u(35,cn,3,2,"span",15),t()()),e&2){let o=r.$implicit,n=r.$index,p=m(3);s(2),h(n+1),s(2),h(C(5,14,o.district_name)),s(2),k(6,o.block_name?6:o.ulb_name?7:-1),s(2),k(8,o.gp_name?8:o.ward_no?9:-1),s(2),k(10,o.village_name?10:11),s(3),h(C(14,16,o.source)),s(3),h(C(17,18,o.application_number)),s(3),h(C(20,20,o.applicant_name)),s(3),h(C(23,22,o.spouse_or_father_name)),s(3),h(p.appService.dateFormat(o.dob)),s(2),h(C(28,24,o.social_category)),s(3),h(C(31,26,o.pwd_status)),s(3),h(o.alt_mobile_number),s(2),d("ngForOf",p.getAllReasons(o))}}function dn(e,r){if(e&1&&(i(0,"table",62)(1,"thead")(2,"tr")(3,"th"),a(4,"SI#"),t(),i(5,"th"),a(6,"DISTRICT"),t(),i(7,"th"),a(8,"BLOCK/ULB"),t(),i(9,"th"),a(10,"GP/WARD"),t(),i(11,"th"),a(12,"VILLAGE"),t(),i(13,"th"),a(14,"CATEGORY"),t(),i(15,"th"),a(16,"APPLICATION NO."),t(),i(17,"th"),a(18,"APPLICANT NAME"),t(),i(19,"th"),a(20,"FATHER/HUSBAND NAME"),t(),i(21,"th",63),a(22,"DOB"),t(),i(23,"th"),a(24,"SOCIAL CATEGORY"),t(),i(25,"th"),a(26,"PWD"),t(),i(27,"th"),a(28,"MOBILE NO."),t(),i(29,"th",64),a(30,"REASONS FOR INELIGIBILITY(REJECTIONS)"),t()()(),i(31,"tbody"),oe(32,pn,36,28,"tr",null,en),t()()),e&2){let o=m(2);s(32),ae(o.application_list)}}function mn(e,r){e&1&&(i(0,"h5",66),a(1,"No data available"),t())}function _n(e,r){e&1&&(i(0,"div",67),a(1,"Loading.. "),S(2,"i",68),t())}function un(e,r){e&1&&(i(0,"span"),S(1,"i",71),a(2," Loading..."),t())}function hn(e,r){e&1&&(i(0,"span"),a(1,"Load More"),t())}function fn(e,r){if(e&1){let o=K();i(0,"div",69)(1,"button",70),B("click",function(){X(o);let p=m(2);return J(p.loadMore())}),u(2,un,3,0,"span",65)(3,hn,2,0,"span",65),t()()}if(e&2){let o=m(2);s(2),d("ngIf",o.isLoadMoreInProgress),s(1),d("ngIf",!o.isLoadMoreInProgress)}}function gn(e,r){if(e&1&&(i(0,"div",44)(1,"div",45)(2,"div",46)(3,"div",47)(4,"div",48)(5,"h5",49),a(6," Number of records found : "),i(7,"span",50),a(8),t()()(),i(9,"div",51)(10,"div",52),u(11,Ki,3,0,"button",53)(12,qi,3,0),t(),i(13,"div",54),u(14,Qi,3,0,"button",53)(15,Zi,3,0),t()()(),i(16,"div",55),u(17,dn,34,0,"table",56)(18,mn,2,0)(19,_n,3,0,"div",57),t(),u(20,fn,4,2,"div",58),t()()()),e&2){let o=m();s(8),h(o.count),s(3),k(11,o.isExportInProgress?12:11),s(3),k(14,o.isExportInProgressExcel?15:14),s(3),k(17,o.application_list&&o.application_list.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),s(2),k(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),s(1),d("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var ct=(()=>{let r=class r{constructor(n,p,l,c,g,x,E){this.router=n,this.formService=p,this.appService=l,this.httpClient=c,this.toastService=g,this.authService=x,this.masterDataService=E,this.districts=[],this.blocks=[],this.ulbs=[],this.gramPanchats=[],this.wards=[],this.blockULBList=[],this.gpWardList=[],this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.limit=this.appService.loadmorelimit,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.isDisabled=!1,this.count=0,this.reasonsMapping={},this.rejectedremarkMapping={},this.searchForm=new fe({district:new F("",[Z.required]),block_ulb:new F("",[Z.required]),gp:new F("",[Z.required]),a_category:new F(""),a_status:new F(""),submit_date:new F(""),social_category:new F(""),pwd_status:new F("")})}ngOnInit(){let n=this.authService.userDetail.role.id,p=this.authService.userDetail.demography_id,l=this.authService.userDetail.district_id,c=this.authService.userDetail.demography_type;c===1?this.fetchAllDistricts():c===2?(this.fetchDistrictById(p),this.isDisabled=!0,this.searchForm.get("district")?.disable()):(c===3||c===5)&&(this.fetchDistrictById(l),this.isDisabled=!0,this.searchForm.get("district")?.disable(),this.searchForm.get("block_ulb")?.disable()),this.loadRejectReasonMappings()}getMaskedAadhaar(n){return!n||n.length!==12?n:"********"+n.slice(-4)}fetchAllDistricts(){this.districts=te.data}fetchDistrictById(n){this.districts=te.data.filter(p=>p.id==n),this.searchForm.patchValue({district:n}),this.onDistrictChange()}onDistrictChange(){let n="";this.searchForm.value.district!=""&&(n=this.searchForm.value.district),this.searchForm.get("block_ulb")?.setValue(""),this.searchForm.get("gp")?.setValue(""),this.blocks=[],this.ulbs=[],this.blockULBList=[],this.blocks=this.masterDataService.getBlockData(n),this.ulbs=this.masterDataService.getULBData(n),this.blockULBList=[...this.blocks.map(c=>P(N({},c),{pushType:"blockid"})),...this.ulbs.map(c=>P(N({},c),{pushType:"ulbtype"}))];let p=this.authService.userDetail.demography_type,l=this.authService.userDetail.role.id;p===5&&(this.blocks=[],this.ulbs=this.ulbs.filter(c=>c.id==this.authService.userDetail.demography_id)),p===5&&(console.log("ulbs",this.ulbs),this.searchForm.patchValue({block_ulb:this.jsonify(P(N({},this.ulbs.find(c=>c.id==this.authService.userDetail.demography_id)),{pushType:"ulbtype"}))}),this.onBlockChange()),p===3&&(this.blocks=this.blocks.filter(c=>c.id==this.authService.userDetail.demography_id),this.ulbs=[]),p===3&&(this.searchForm.patchValue({block_ulb:this.jsonify(P(N({},this.blocks.find(c=>c.id==this.authService.userDetail.demography_id)),{pushType:"blockid"}))}),this.onBlockChange())}onBlockChange(){let n="";this.searchForm.value.block_ulb&&(n=JSON.parse(this.searchForm.value.block_ulb)),this.searchForm.get("gp")?.setValue(""),this.gramPanchats=[],this.wards=[],this.gpWardList=[];let p=n.pushType==="blockid",l=n.pushType==="ulbtype",c=[];p&&(this.gramPanchats=this.masterDataService.getGPData(n.id),this.gpWardList=this.gramPanchats.map(g=>P(N({},g),{pushType:"gpid"}))),l&&(this.wards=this.masterDataService.getWARDData(n.id),this.gpWardList=this.wards.map(g=>P(N({},g),{pushType:"wardid"})))}jsonify(n){return JSON.stringify(n)}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let p=this.searchForm.value.district,l=this.searchForm.value.gp?JSON.parse(this.searchForm.value.gp):null,c=this.searchForm.value.block_ulb?JSON.parse(this.searchForm.value.block_ulb):null,g=this.searchForm.value.a_category,x=this.searchForm.value.submit_date,E=this.searchForm.value.a_status,y=this.searchForm.value.social_category,T=this.searchForm.value.pwd_status,_=new Q;c&&(c.pushType==="blockid"?_=_.set("block_id",c.id):c.pushType==="ulbtype"&&(_=_.set("ulb_id",c.id))),l&&(l.pushType==="gpid"?_=_.set("gp_id",l.id):l.pushType==="wardid"&&(_=_.set("ward_id",l.id))),p&&(_=_.set("district_id",p)),x&&(_=_.set("submission_date",x)),E&&(_=_.set("application_status",E)),g&&(_=_.set("category",g)),y&&(_=_.set("social_category",y)),T&&(_=_.set("pwd_status",T)),_=_.set("offset",this.offset),_=_.set("limit",this.limit);let f=new q({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/report/rejected-applications`,{params:_,headers:f}).subscribe(b=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=b.count,b.data&&b.data.length>0?(this.application_list=this.application_list.concat(b.data),this.offset+=b.data.length,this.hasMoreRecords=b.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},b=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}loadRejectReasonMappings(){this.httpClient.get("assets/json/rejected_reasons.json").subscribe(n=>{this.reasonsMapping=n.exrMapping,this.rejectedremarkMapping=n.rejectedremarkMapping})}getReasonText(n){return this.reasonsMapping[n]||""}getExclusionReasons(n){return typeof n.exclusion_reasons=="string"?n.exclusion_reasons.split(",").map(l=>l.trim()).map(l=>isNaN(Number(l))?l:this.getReasonText(Number(l))):Array.isArray(n.exclusion_reasons)?n.exclusion_reasons.map(p=>typeof p=="number"?this.getReasonText(p):p):typeof n.exclusion_reasons=="number"?[this.getReasonText(n.exclusion_reasons)]:[]}getRejectedremark(n){return this.rejectedremarkMapping[n]||""}getAllReasons(n){let p=this.getExclusionReasons(n),l=n?.rejectedremark_reasons?this.getRejectedremark(n?.rejectedremark_reasons):null,c=[...p];return l&&c.push(l),c}exportToExcel(){let n=new Q,p=this.searchForm.value.district,l=this.searchForm.value.gp?JSON.parse(this.searchForm.value.gp):null,c=this.searchForm.value.block_ulb?JSON.parse(this.searchForm.value.block_ulb):null,g=this.searchForm.value.submit_date,x=this.searchForm.value.a_category,E=this.searchForm.value.social_category,y=this.searchForm.value.pwd_status;c&&(c.pushType==="blockid"?n=n.set("block_id",c.id):c.pushType==="ulbtype"&&(n=n.set("ulb_id",c.id))),l&&(l.pushType==="gpid"?n=n.set("gp_id",l.id):l.pushType==="wardid"&&(n=n.set("ward_id",l.id))),p&&(n=n.set("district_id",p)),g&&(n=n.set("submission_date",g)),x&&(n=n.set("category",x)),E&&(n=n.set("social_category",E)),y&&(n=n.set("pwd_status",y)),n=n.set("export_all","1");let T=new q({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/report/rejected-applications`,{params:n,headers:T,responseType:"json"}).subscribe(_=>{this.isExportInProgressExcel=!1;let f=_.data.map((A,L)=>{let W=this.getAllReasons(A).join(", ");return{"SI#":L+1,DISTRICT:A.district_name.toUpperCase(),"BLOCK/ULB":(A.block_name||A.ulb_name).toUpperCase(),"GP/WARD":(A.gp_name||A.ward_no).toUpperCase(),VILLAGE:A.village_name?A.village_name.toUpperCase():"",CATEGORY:A.source.toUpperCase(),"APPLICATION NO.":A.application_number.toUpperCase(),"APPLICANT NAME":A.applicant_name.toUpperCase(),"FATHER/HUSBAND NAME":A.spouse_or_father_name.toUpperCase(),DOB:this.appService.dateFormat(A.dob),"SOCIAL CATEGORY":A.social_category.toUpperCase(),PWD:A.pwd_status.toUpperCase(),"MOBILE NO.":A.alt_mobile_number,"REASONS FOR INELIGIBILITY(REJECTIONS)":W}}),b=ee.json_to_sheet(f),R=ee.book_new();ee.book_append_sheet(R,b,"Applications");let U=ke(R,{bookType:"xlsx",type:"array"}),Y=new Date,H=Y.toLocaleDateString("en-GB").split("/").reverse().join("-"),$=Y.toLocaleTimeString("en-GB").replace(/:/g,"-"),j=`rejected_reports_${H}_${$}.xlsx`,O=new Blob([U],{type:"application/octet-stream"}),M=document.createElement("a"),I=window.URL.createObjectURL(O);M.href=I,M.download=j,M.click(),window.URL.revokeObjectURL(I)},_=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",_)})}exportToPDF(){Je.default.vfs=lt.default.pdfMake.vfs;let n=new Q,p=this.searchForm.value.district,l=this.searchForm.value.gp?JSON.parse(this.searchForm.value.gp):null,c=this.searchForm.value.block_ulb?JSON.parse(this.searchForm.value.block_ulb):null,g=this.searchForm.value.submit_date,x=this.searchForm.value.a_category,E=this.searchForm.value.social_category,y=this.searchForm.value.pwd_status;c&&(c.pushType==="blockid"?n=n.set("block_id",c.id):c.pushType==="ulbtype"&&(n=n.set("ulb_id",c.id))),l&&(l.pushType==="gpid"?n=n.set("gp_id",l.id):l.pushType==="wardid"&&(n=n.set("ward_id",l.id))),p&&(n=n.set("district_id",p)),g&&(n=n.set("submission_date",g)),x&&(n=n.set("category",x)),E&&(n=n.set("social_category",E)),y&&(n=n.set("pwd_status",y)),n=n.set("export_all","1");let T=new q({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/report/rejected-applications`,{params:n,headers:T,responseType:"json"}).subscribe(_=>{this.isExportInProgress=!1;let f=_.data[0]||{},b=(f.district_name||"N/A").toUpperCase(),R=(f.block_name||f.ulb_name||"N/A").toUpperCase(),U=(f.gp_name||f.ward_no||"N/A").toUpperCase(),Y=[[{text:"SI#",fontSize:10},{text:"VILLAGE",fontSize:10},{text:"CATEGORY",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"DOB",fontSize:10},{text:"SOCIAL CATEGORY",fontSize:10},{text:"PWD",fontSize:10},{text:"MOBILE NO.",fontSize:10},{text:"REASONS FOR INELIGIBILITY(REJECTIONS)",fontSize:10}]];_.data.forEach((I,A)=>{let D=this.getAllReasons(I).join(", ");Y.push([{text:(A+1).toString().toUpperCase(),fontSize:9},{text:(I.village_name||"").toUpperCase(),fontSize:9},{text:(I.source||"").toUpperCase(),fontSize:9},{text:(I.application_number||"").toUpperCase(),fontSize:9},{text:(I.applicant_name||"").toUpperCase(),fontSize:9},{text:(I.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(I.dob)||"",fontSize:9},{text:(I.social_category||"").toUpperCase(),fontSize:9},{text:(I.pwd_status||"").toUpperCase(),fontSize:9},{text:(I.alt_mobile_number||"").toUpperCase(),fontSize:9},{text:D,fontSize:9}])});let H={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${b} > BLOCK/ULB: ${R} > GP/WARD: ${U}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"APPLICATION REJECTED STATUS REPORT",style:"header"},{table:{headerRows:1,body:Y,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]},layout:{fillColor:function(I){return I===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},$=new Date,j=$.toLocaleDateString("en-GB").split("/").reverse().join("-"),O=$.toLocaleTimeString("en-GB").replace(/:/g,"-"),M=`application_rejected_reports_${j}_${O}.pdf`;Je.default.createPdf(H).download(M)},_=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",_)})}};r.\u0275fac=function(p){return new(p||r)(w(pe),w(ye),w(de),w(ce),w(me),w(_e),w(Te))},r.\u0275cmp=ne({type:r,selectors:[["app-reject-application"]],decls:84,vars:11,consts:[[1,"container-fluid"],[1,"card-title","mb-3"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-2"],[1,"col-md-3"],["for","district",1,"fw-bold"],[1,"text-danger"],["id","district","formControlName","district",1,"form-control","form-select","my-2",3,"change"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"field"],["for","block_ulb",1,"fw-bold"],["id","block_ulb","formControlName","block_ulb",1,"form-control","form-select","my-2",3,"change"],["label","Blocks"],[4,"ngFor","ngForOf"],["label","ULBs"],["for","gp",1,"fw-bold"],["id","gp","formControlName","gp",1,"form-control","form-select","my-2"],["for","a_category",1,"fw-bold"],["formControlName","a_category","id","a_category",1,"form-select","my-2"],["value","1"],["value","0"],[1,"row","g-3"],["for","social_category",1,"fw-bold"],["formControlName","social_category","id","social_category",1,"form-select","my-2"],["value","2"],["value","3"],["value","4"],["for","pwd_status",1,"fw-bold"],["formControlName","pwd_status","id","pwd_status",1,"form-select","my-2"],["for","submit_date",1,"fw-bold"],["type","date","id","submit_date","formControlName","submit_date",1,"form-control","my-2"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],["class","mt-3","style","background-color: #e3e3e3; border: none;",4,"ngIf"],[3,"value"],[3,"ngValue",4,"ngIf"],[3,"ngValue"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[1,"row","mb-2"],[1,"col-md-6"],[1,"card-title"],["id","recordCount"],[1,"col-md-6","text-end"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports"],[2,"min-width","100px"],[2,"min-width","300px"],[4,"ngIf"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"],[1,"fa","fa-spinner","fa-spin"]],template:function(p,l){p&1&&(i(0,"div",0)(1,"h4",1),a(2,"Rejected Application Status Report"),t(),i(3,"div",2)(4,"form",3),B("ngSubmit",function(){return l.onSearch()}),i(5,"div",4)(6,"div",5)(7,"label",6),a(8,"District "),i(9,"span",7),a(10,"*"),t()(),i(11,"select",8),B("change",function(){return l.onDistrictChange()}),i(12,"option",9),a(13,"Select District"),t(),u(14,Mi,2,2,"option",10),t(),S(15,"app-form-error",11),t(),i(16,"div",5)(17,"label",12),a(18,"Block/ULB "),i(19,"span",7),a(20,"*"),t()(),i(21,"select",13),B("change",function(){return l.onBlockChange()}),i(22,"option",9),a(23,"Select Block/ULB"),t(),i(24,"optgroup",14),u(25,Vi,2,1,"ng-container",15),t(),i(26,"optgroup",16),u(27,Gi,2,1,"ng-container",15),t()(),S(28,"app-form-error",11),t(),i(29,"div",5)(30,"label",17),a(31,"GP/Ward "),i(32,"span",7),a(33,"*"),t()(),i(34,"select",18)(35,"option",9),a(36,"Select GP/Ward"),t(),u(37,Yi,2,1,"ng-container",15)(38,Hi,2,1,"ng-container",15),t(),S(39,"app-form-error",11),t(),i(40,"div",5)(41,"label",19),a(42," Category "),t(),i(43,"select",20)(44,"option",9),a(45,"Choose Category"),t(),i(46,"option",21),a(47,"NFSA"),t(),i(48,"option",22),a(49,"NON-NFSA"),t()()()(),i(50,"div",23)(51,"div",5)(52,"label",24),a(53," Social Category "),t(),i(54,"select",25)(55,"option",9),a(56,"Choose Social Category"),t(),i(57,"option",21),a(58,"General"),t(),i(59,"option",26),a(60,"OBC"),t(),i(61,"option",27),a(62,"SC"),t(),i(63,"option",28),a(64,"ST"),t()()(),i(65,"div",5)(66,"label",29),a(67," PWD "),t(),i(68,"select",30)(69,"option",9),a(70,"Choose PWD"),t(),i(71,"option",21),a(72,"Yes "),t(),i(73,"option",22),a(74,"NO"),t()()(),i(75,"div",5)(76,"label",31),a(77," Submission Date "),t(),S(78,"input",32),t()(),i(79,"div",33)(80,"div",34),u(81,Xi,3,0,"button",35)(82,Ji,3,0),t()()()(),u(83,gn,21,6,"div",36),t()),p&2&&(s(4),d("formGroup",l.searchForm),s(10),d("ngForOf",l.districts),s(1),d("field",l.searchForm.controls.district),s(10),d("ngForOf",l.blockULBList),s(2),d("ngForOf",l.blockULBList),s(1),d("field",l.searchForm.controls.block_ulb),s(9),d("ngForOf",l.gpWardList),s(1),d("ngForOf",l.gpWardList),s(1),d("field",l.searchForm.controls.gp),s(42),k(81,l.isFormSearchInProgress?82:81),s(2),d("ngIf",l.showTable))},dependencies:[re,se,Ee,ge,ve,Ce,Ie,be,ue,he,Se,xe,le]});let e=r;return e})();var Ke=ie(we()),pt=ie(De());function Sn(e,r){if(e&1&&(i(0,"option",47),a(1),t()),e&2){let o=r.$implicit;d("value",o.id),s(1),h(o.district_name)}}function xn(e,r){if(e&1&&(i(0,"option",49),a(1),t()),e&2){let o=m().$implicit,n=m();d("ngValue",n.jsonify(o)),s(1),V(" ",o.block_name," ")}}function bn(e,r){if(e&1&&(z(0),u(1,xn,2,2,"option",48),G()),e&2){let o=r.$implicit;s(1),d("ngIf",o.pushType==="blockid")}}function vn(e,r){if(e&1&&(i(0,"option",49),a(1),t()),e&2){let o=m().$implicit,n=m();d("ngValue",n.jsonify(o)),s(1),V(" ",o.ulb_name," ")}}function Cn(e,r){if(e&1&&(z(0),u(1,vn,2,2,"option",48),G()),e&2){let o=r.$implicit;s(1),d("ngIf",o.pushType==="ulbtype")}}function yn(e,r){if(e&1&&(i(0,"option",49),a(1),t()),e&2){let o=m().$implicit,n=m();d("ngValue",n.jsonify(o)),s(1),V(" ",o.gp_name," ")}}function En(e,r){if(e&1&&(z(0),u(1,yn,2,2,"option",48),G()),e&2){let o=r.$implicit;s(1),d("ngIf",o.pushType==="gpid")}}function Tn(e,r){if(e&1&&(i(0,"option",49),a(1),t()),e&2){let o=m().$implicit,n=m();d("ngValue",n.jsonify(o)),s(1),V(" ",o.ward_no," ")}}function kn(e,r){if(e&1&&(z(0),u(1,Tn,2,2,"option",48),G()),e&2){let o=r.$implicit;s(1),d("ngIf",o.pushType==="wardid")}}function In(e,r){if(e&1&&(i(0,"option",47),a(1),t()),e&2){let o=r.$implicit;d("value",o.value),s(1),V(" ",o.label," ")}}function An(e,r){e&1&&(i(0,"button",50),S(1,"i",51),a(2,"Search "),t())}function Fn(e,r){e&1&&(i(0,"button",52),S(1,"i",53),a(2," Searching ..."),t())}function wn(e,r){if(e&1){let o=K();i(0,"button",69),B("click",function(){X(o);let p=m(2);return J(p.exportToPDF())}),S(1,"i",70),a(2,"Download to PDF "),t()}}function Dn(e,r){e&1&&(i(0,"button",71),S(1,"i",53),a(2,"Downloading "),t())}function Ln(e,r){if(e&1){let o=K();i(0,"button",69),B("click",function(){X(o);let p=m(2);return J(p.exportToExcel())}),S(1,"i",70),a(2,"Download to EXCEL "),t()}}function Nn(e,r){e&1&&(i(0,"button",71),S(1,"i",53),a(2,"Downloading "),t())}var Pn=(e,r)=>r.id;function Bn(e,r){if(e&1&&(i(0,"td"),a(1),v(2,"uppercase"),t()),e&2){let o=m().$implicit;s(1),h(C(2,1,o.block_name))}}function Rn(e,r){if(e&1&&(i(0,"td"),a(1),v(2,"uppercase"),t()),e&2){let o=m().$implicit;s(1),h(C(2,1,o.ulb_name))}}function On(e,r){if(e&1&&(i(0,"td"),a(1),v(2,"uppercase"),t()),e&2){let o=m().$implicit;s(1),h(C(2,1,o.gp_name))}}function Un(e,r){if(e&1&&(i(0,"td"),a(1),v(2,"uppercase"),t()),e&2){let o=m().$implicit;s(1),h(C(2,1,o.ward_no))}}function Mn(e,r){if(e&1&&(i(0,"td"),a(1),v(2,"uppercase"),t()),e&2){let o=m().$implicit;s(1),h(C(2,1,o.village))}}function jn(e,r){e&1&&S(0,"td")}function Vn(e,r){if(e&1&&(i(0,"td"),a(1),t()),e&2){let o=m().$implicit,n=m(3);s(1),h(n.appService.dateFormat(o.paymentdate))}}function zn(e,r){e&1&&S(0,"td")}function Gn(e,r){e&1&&(i(0,"span"),a(1,"DBT"),t())}function $n(e,r){e&1&&(i(0,"span"),a(1,"CBDC"),t())}function Yn(e,r){if(e&1&&(i(0,"td"),u(1,Gn,2,0,"span",74)(2,$n,2,0,"span",74),t()),e&2){let o=m().$implicit;s(1),d("ngIf",o.payment_mode==="1"),s(1),d("ngIf",o.payment_mode==="2")}}function Wn(e,r){e&1&&S(0,"td")}function Hn(e,r){e&1&&(i(0,"span"),a(1,"PAID"),t())}function Xn(e,r){e&1&&(i(0,"span"),a(1,"FAILED"),t())}function Jn(e,r){if(e&1&&(i(0,"td"),u(1,Hn,2,0,"span",74)(2,Xn,2,0,"span",74),t()),e&2){let o=m().$implicit;s(1),d("ngIf",o.payment_status==="S00"),s(1),d("ngIf",o.payment_status!="S00")}}function Kn(e,r){e&1&&S(0,"td")}function qn(e,r){if(e&1&&(i(0,"td"),a(1),v(2,"uppercase"),t()),e&2){let o=m().$implicit;s(1),h(C(2,1,o.reason_of_failure))}}function Qn(e,r){e&1&&S(0,"td")}function Zn(e,r){if(e&1&&(i(0,"tr")(1,"td"),a(2),t(),i(3,"td"),a(4),v(5,"uppercase"),t(),u(6,Bn,3,3,"td")(7,Rn,3,3)(8,On,3,3,"td")(9,Un,3,3)(10,Mn,3,3,"td")(11,jn,1,0),i(12,"td"),a(13),v(14,"uppercase"),t(),i(15,"td"),a(16),v(17,"uppercase"),t(),i(18,"td"),a(19),v(20,"uppercase"),t(),i(21,"td"),a(22),v(23,"uppercase"),t(),i(24,"td"),a(25),t(),i(26,"td"),a(27),v(28,"uppercase"),t(),i(29,"td"),a(30),v(31,"uppercase"),t(),i(32,"td"),a(33),t(),u(34,Vn,2,1,"td")(35,zn,1,0)(36,Yn,3,2,"td")(37,Wn,1,0)(38,Jn,3,2,"td")(39,Kn,1,0),i(40,"td"),a(41),v(42,"uppercase"),t(),u(43,qn,3,3,"td")(44,Qn,1,0),t()),e&2){let o=r.$implicit,n=r.$index,p=m(3);s(2),h(n+1),s(2),h(C(5,18,o.district_name)),s(2),k(6,o.block_name?6:o.ulb_name?7:-1),s(2),k(8,o.gp_name?8:o.ward_no?9:-1),s(2),k(10,o.village?10:11),s(3),h(C(14,20,o.source)),s(3),h(C(17,22,o.application_number)),s(3),h(C(20,24,o.applicant_name)),s(3),h(C(23,26,o.spouse_or_father_name)),s(3),h(p.appService.dateFormat(o.dob)),s(2),h(C(28,28,o.social_category)),s(3),h(C(31,30,o.pwd_status)),s(3),h(o.alt_mobile_number),s(1),k(34,o.paymentdate?34:35),s(2),k(36,o.payment_mode?36:37),s(2),k(38,o.payment_status?38:39),s(3),h(C(42,32,o.installment)),s(2),k(43,o.reason_of_failure?43:44)}}function eo(e,r){if(e&1&&(i(0,"table",72)(1,"thead")(2,"tr")(3,"th"),a(4,"SI#"),t(),i(5,"th"),a(6,"DISTRICT"),t(),i(7,"th"),a(8,"BLOCK/ULB"),t(),i(9,"th"),a(10,"GP/WARD"),t(),i(11,"th"),a(12,"VILLAGE"),t(),i(13,"th"),a(14,"CATEGORY"),t(),i(15,"th"),a(16,"APPLICATION NO."),t(),i(17,"th"),a(18,"APPLICANT NAME"),t(),i(19,"th"),a(20,"FATHER/HUSBAND NAME"),t(),i(21,"th",73),a(22,"DOB"),t(),i(23,"th"),a(24,"SOCIAL CATEGORY"),t(),i(25,"th"),a(26,"PWD"),t(),i(27,"th"),a(28,"MOBILE NO."),t(),i(29,"th"),a(30,"PAYMENT DATE"),t(),i(31,"th"),a(32,"PAYMENT MODE"),t(),i(33,"th"),a(34,"PAYMENT STATUS"),t(),i(35,"th"),a(36,"PAYMENT INSTALLMENT"),t(),i(37,"th"),a(38,"REASON"),t()()(),i(39,"tbody"),oe(40,Zn,45,34,"tr",null,Pn),t()()),e&2){let o=m(2);s(40),ae(o.application_list)}}function to(e,r){e&1&&(i(0,"h5",75),a(1,"No data available"),t())}function io(e,r){e&1&&(i(0,"div",76),a(1,"Loading.. "),S(2,"i",77),t())}function no(e,r){e&1&&(i(0,"span"),S(1,"i",80),a(2," Loading..."),t())}function oo(e,r){e&1&&(i(0,"span"),a(1,"Load More"),t())}function ao(e,r){if(e&1){let o=K();i(0,"div",78)(1,"button",79),B("click",function(){X(o);let p=m(2);return J(p.loadMore())}),u(2,no,3,0,"span",74)(3,oo,2,0,"span",74),t()()}if(e&2){let o=m(2);s(2),d("ngIf",o.isLoadMoreInProgress),s(1),d("ngIf",!o.isLoadMoreInProgress)}}function ro(e,r){if(e&1&&(i(0,"div",54)(1,"div",55)(2,"div",56)(3,"div",57)(4,"div",58)(5,"h5",59),a(6," Number of records found : "),i(7,"span",60),a(8),t()()(),i(9,"div",61)(10,"div",62),u(11,wn,3,0,"button",63)(12,Dn,3,0),t(),i(13,"div",64),u(14,Ln,3,0,"button",63)(15,Nn,3,0),t()()(),i(16,"div",65),u(17,eo,42,0,"table",66)(18,to,2,0)(19,io,3,0,"div",67),t(),u(20,ao,4,2,"div",68),t()()()),e&2){let o=m();s(8),h(o.count),s(3),k(11,o.isExportInProgress?12:11),s(3),k(14,o.isExportInProgressExcel?15:14),s(3),k(17,o.application_list&&o.application_list.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),s(2),k(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),s(1),d("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var dt=(()=>{let r=class r{constructor(n,p,l,c,g,x,E){this.router=n,this.formService=p,this.appService=l,this.httpClient=c,this.toastService=g,this.authService=x,this.masterDataService=E,this.districts=[],this.blocks=[],this.ulbs=[],this.gramPanchats=[],this.wards=[],this.blockULBList=[],this.gpWardList=[],this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.limit=this.appService.loadmorelimit,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.isDisabled=!1,this.count=0,this.searchForm=new fe({district:new F("",[Z.required]),block_ulb:new F("",[Z.required]),gp:new F("",[Z.required]),p_status:new F(""),p_mode:new F(""),a_category:new F(""),submit_date:new F(""),social_category:new F(""),pwd_status:new F(""),installment:new F("")})}ngOnInit(){let n=this.authService.userDetail.role.id,p=this.authService.userDetail.demography_id,l=this.authService.userDetail.district_id,c=this.authService.userDetail.demography_type;c===1?this.fetchAllDistricts():c===2?(this.fetchDistrictById(p),this.isDisabled=!0,this.searchForm.get("district")?.disable()):(c===3||c===5)&&(this.fetchDistrictById(l),this.isDisabled=!0,this.searchForm.get("district")?.disable(),this.searchForm.get("block_ulb")?.disable()),this.loadPaymentInstallments()}loadPaymentInstallments(){this.httpClient.get("assets/json/payment_installments.json").subscribe(n=>{this.payment_installments=n.installments,this.searchForm.patchValue({installment:n.defaultInstallment})})}getMaskedAadhaar(n){return!n||n.length!==12?n:"********"+n.slice(-4)}fetchAllDistricts(){this.districts=te.data}fetchDistrictById(n){this.districts=te.data.filter(p=>p.id==n),this.searchForm.patchValue({district:n}),this.onDistrictChange()}onDistrictChange(){let n="";this.searchForm.value.district!=""&&(n=this.searchForm.value.district),this.searchForm.get("block_ulb")?.setValue(""),this.searchForm.get("gp")?.setValue(""),this.blocks=[],this.ulbs=[],this.blockULBList=[],this.blocks=this.masterDataService.getBlockData(n),this.ulbs=this.masterDataService.getULBData(n),this.blockULBList=[...this.blocks.map(c=>P(N({},c),{pushType:"blockid"})),...this.ulbs.map(c=>P(N({},c),{pushType:"ulbtype"}))];let p=this.authService.userDetail.demography_type,l=this.authService.userDetail.role.id;p===5&&(this.blocks=[],this.ulbs=this.ulbs.filter(c=>c.id==this.authService.userDetail.demography_id)),p===5&&(console.log("ulbs",this.ulbs),this.searchForm.patchValue({block_ulb:this.jsonify(P(N({},this.ulbs.find(c=>c.id==this.authService.userDetail.demography_id)),{pushType:"ulbtype"}))}),this.onBlockChange()),p===3&&(this.blocks=this.blocks.filter(c=>c.id==this.authService.userDetail.demography_id),this.ulbs=[]),p===3&&(this.searchForm.patchValue({block_ulb:this.jsonify(P(N({},this.blocks.find(c=>c.id==this.authService.userDetail.demography_id)),{pushType:"blockid"}))}),this.onBlockChange())}onBlockChange(){let n="";this.searchForm.value.block_ulb&&(n=JSON.parse(this.searchForm.value.block_ulb)),this.searchForm.get("gp")?.setValue(""),this.gramPanchats=[],this.wards=[],this.gpWardList=[];let p=n.pushType==="blockid",l=n.pushType==="ulbtype",c=[];p&&(this.gramPanchats=this.masterDataService.getGPData(n.id),this.gpWardList=this.gramPanchats.map(g=>P(N({},g),{pushType:"gpid"}))),l&&(this.wards=this.masterDataService.getWARDData(n.id),this.gpWardList=this.wards.map(g=>P(N({},g),{pushType:"wardid"})))}jsonify(n){return JSON.stringify(n)}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let p=this.searchForm.value.district,l=this.searchForm.value.gp?JSON.parse(this.searchForm.value.gp):null,c=this.searchForm.value.block_ulb?JSON.parse(this.searchForm.value.block_ulb):null,g=this.searchForm.value.submit_date,x=this.searchForm.value.p_status,E=this.searchForm.value.p_mode,y=this.searchForm.value.a_category,T=this.searchForm.value.social_category,_=this.searchForm.value.pwd_status,f=this.searchForm.value.installment,b=new Q;c&&(c.pushType==="blockid"?b=b.set("block_id",c.id):c.pushType==="ulbtype"&&(b=b.set("ulb_id",c.id))),l&&(l.pushType==="gpid"?b=b.set("gp_id",l.id):l.pushType==="wardid"&&(b=b.set("ward_id",l.id))),p&&(b=b.set("district_id",p)),g&&(b=b.set("submission_date",g)),x&&(b=b.set("payment_status",x)),E&&(b=b.set("payment_mode",E)),y&&(b=b.set("category",y)),T&&(b=b.set("social_category",T)),_&&(b=b.set("pwd_status",_)),f&&(b=b.set("installment",f)),b=b.set("offset",this.offset),b=b.set("limit",this.limit);let R=new q({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/report/approved-applications`,{params:b,headers:R}).subscribe(U=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=U.count,U.data&&U.data.length>0?(this.application_list=this.application_list.concat(U.data),this.offset+=U.data.length,this.hasMoreRecords=U.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},U=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}exportToExcel(){let n=this.searchForm.value.district,p=this.searchForm.value.gp?JSON.parse(this.searchForm.value.gp):null,l=this.searchForm.value.block_ulb?JSON.parse(this.searchForm.value.block_ulb):null,c=this.searchForm.value.submit_date,g=this.searchForm.value.p_status,x=this.searchForm.value.p_mode,E=this.searchForm.value.a_category,y=this.searchForm.value.social_category,T=this.searchForm.value.pwd_status,_=this.searchForm.value.installment,f=new Q;l&&(l.pushType==="blockid"?f=f.set("block_id",l.id):l.pushType==="ulbtype"&&(f=f.set("ulb_id",l.id))),p&&(p.pushType==="gpid"?f=f.set("gp_id",p.id):p.pushType==="wardid"&&(f=f.set("ward_id",p.id))),n&&(f=f.set("district_id",n)),c&&(f=f.set("submission_date",c)),g&&(f=f.set("payment_status",g)),x&&(f=f.set("payment_mode",x)),E&&(f=f.set("category",E)),y&&(f=f.set("social_category",y)),T&&(f=f.set("pwd_status",T)),_&&(f=f.set("installment",_)),f=f.set("export_all","1");let b=new q({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/report/approved-applications`,{params:f,headers:b,responseType:"json"}).subscribe(R=>{this.isExportInProgressExcel=!1;let U=R.data.map((W,Ye)=>({"SI#":Ye+1,DISTRICT:W.district_name.toUpperCase(),"BLOCK/ULB":(W.block_name||W.ulb_name).toUpperCase(),"GP/WARD":(W.gp_name||W.ward_no).toUpperCase(),VILLAGE:W.village?W.village.toUpperCase():"",CATEGORY:W.source.toUpperCase(),"APPLICATION NO.":W.application_number.toUpperCase(),"APPLICANT NAME":W.applicant_name.toUpperCase(),"FATHER/HUSBAND NAME":W.spouse_or_father_name.toUpperCase(),DOB:this.appService.dateFormat(W.dob),"SOCIAL CATEGORY":W.social_category.toUpperCase(),PWD:W.pwd_status.toUpperCase(),"MOBILE NO.":W.alt_mobile_number,"PAYMENT DATE":this.appService.dateFormat(W.paymentdate),"PAYMENT MODE":W.payment_mode==="1"?"DBT":W.payment_mode==="2"?"CBDC":"","PAYMENT STATUS":W.payment_status==="S00"?"PAID":"FAILED","PAYMENT INSTALLMENT":W.installment,REASON:W.reason_of_failure?W.reason_of_failure.toUpperCase():""})),Y=ee.json_to_sheet(U),H=ee.book_new();ee.book_append_sheet(H,Y,"Applications");let $=ke(H,{bookType:"xlsx",type:"array"}),j=new Date,O=j.toLocaleDateString("en-GB").split("/").reverse().join("-"),M=j.toLocaleTimeString("en-GB").replace(/:/g,"-"),I=`approved_application_reports_${O}_${M}.xlsx`,A=new Blob([$],{type:"application/octet-stream"}),L=document.createElement("a"),D=window.URL.createObjectURL(A);L.href=D,L.download=I,L.click(),window.URL.revokeObjectURL(D)},R=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",R)})}exportToPDF(){Ke.default.vfs=pt.default.pdfMake.vfs;let n=new Q,p=this.searchForm.value.district,l=this.searchForm.value.gp?JSON.parse(this.searchForm.value.gp):null,c=this.searchForm.value.block_ulb?JSON.parse(this.searchForm.value.block_ulb):null,g=this.searchForm.value.submit_date,x=this.searchForm.value.p_status,E=this.searchForm.value.p_mode,y=this.searchForm.value.a_category,T=this.searchForm.value.social_category,_=this.searchForm.value.pwd_status,f=this.searchForm.value.installment;c&&(c.pushType==="blockid"?n=n.set("block_id",c.id):c.pushType==="ulbtype"&&(n=n.set("ulb_id",c.id))),l&&(l.pushType==="gpid"?n=n.set("gp_id",l.id):l.pushType==="wardid"&&(n=n.set("ward_id",l.id))),p&&(n=n.set("district_id",p)),g&&(n=n.set("submission_date",g)),x&&(n=n.set("payment_status",x)),E&&(n=n.set("payment_mode",E)),y&&(n=n.set("category",y)),T&&(n=n.set("social_category",T)),_&&(n=n.set("pwd_status",_)),f&&(n=n.set("installment",f)),n=n.set("export_all","1");let b=new q({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/report/approved-applications`,{params:n,headers:b,responseType:"json"}).subscribe(R=>{this.isExportInProgress=!1;let U=R.data[0]||{},Y=(U.district_name||"N/A").toUpperCase(),H=(U.block_name||U.ulb_name||"N/A").toUpperCase(),$=(U.gp_name||U.ward_no||"N/A").toUpperCase(),j=[[{text:"SI#",fontSize:10},{text:"VILLAGE",fontSize:10},{text:"CATEGORY",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"DOB",fontSize:10},{text:"SOCIAL CATEGORY",fontSize:10},{text:"PWD",fontSize:10},{text:"MOBILE NO.",fontSize:10},{text:"PAYMENT DATE",fontSize:10},{text:"PAYMENT MODE",fontSize:10},{text:"PAYMENT STATUS",fontSize:10},{text:"PAYMENT INSTALLMENT",fontSize:10},{text:"REASON",fontSize:10}]];R.data.forEach((D,W)=>{j.push([{text:(W+1).toString().toUpperCase(),fontSize:9},{text:(D.village||"").toUpperCase(),fontSize:9},{text:(D.source||"").toUpperCase(),fontSize:9},{text:(D.application_number||"").toUpperCase(),fontSize:9},{text:(D.applicant_name||"").toUpperCase(),fontSize:9},{text:(D.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(D.dob)||"",fontSize:9},{text:(D.social_category||"").toUpperCase(),fontSize:9},{text:(D.pwd_status||"").toUpperCase(),fontSize:9},{text:(D.alt_mobile_number||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(D.paymentdate)||"",fontSize:9},{text:D.payment_mode==="1"?"DBT":D.payment_mode==="2"?"CBDC":"",fontSize:9},{text:D.payment_status==="S00"?"PAID":"FAILED",fontSize:9},{text:(D.installment||"").toUpperCase(),fontSize:9},{text:(D.reason_of_failure||"").toUpperCase(),fontSize:9}])});let O={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${Y} > BLOCK/ULB: ${H} > GP/WARD: ${$}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"APPLICATION APPROVED STATUS REPORT",style:"header"},{table:{headerRows:1,body:j,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]},layout:{fillColor:function(D){return D===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},M=new Date,I=M.toLocaleDateString("en-GB").split("/").reverse().join("-"),A=M.toLocaleTimeString("en-GB").replace(/:/g,"-"),L=`approved_application_reports_${I}_${A}.pdf`;Ke.default.createPdf(O).download(L)},R=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",R)})}};r.\u0275fac=function(p){return new(p||r)(w(pe),w(ye),w(de),w(ce),w(me),w(_e),w(Te))},r.\u0275cmp=ne({type:r,selectors:[["app-approve-application"]],decls:110,vars:12,consts:[[1,"container-fluid"],[1,"card-title","mb-3"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-2"],[1,"col-md-3"],["for","district",1,"fw-bold"],[1,"text-danger"],["id","district","formControlName","district",1,"form-control","form-select","my-2",3,"change"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"field"],["for","block_ulb",1,"fw-bold"],["id","block_ulb","formControlName","block_ulb",1,"form-control","form-select","my-2",3,"change"],["label","Blocks"],[4,"ngFor","ngForOf"],["label","ULBs"],["for","gp",1,"fw-bold"],["id","gp","formControlName","gp",1,"form-control","form-select","my-2"],["for","a_category",1,"fw-bold"],["formControlName","a_category","id","a_category",1,"form-select","my-2"],["value","1"],["value","0"],[1,"row","g-3"],["for","p_status",1,"fw-bold"],["formControlName","p_status","id","p_status",1,"form-select","my-2"],["value","S00"],["value","NS00"],["for","p_mode",1,"fw-bold"],["formControlName","p_mode","id","p_mode",1,"form-select","my-2"],["value","WALLET"],["value","APBS"],["for","social_category",1,"fw-bold"],["formControlName","social_category","id","social_category",1,"form-select","my-2"],["value","2"],["value","3"],["value","4"],["for","pwd_status",1,"fw-bold"],["formControlName","pwd_status","id","pwd_status",1,"form-select","my-2"],["for","submit_date",1,"fw-bold"],["type","date","id","submit_date","formControlName","submit_date",1,"form-control","my-2"],["for","installment",1,"fw-bold"],["formControlName","installment","id","installment",1,"form-select","my-2"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],["class","mt-3","style","background-color: #e3e3e3; border: none;",4,"ngIf"],[3,"value"],[3,"ngValue",4,"ngIf"],[3,"ngValue"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[1,"row","mb-2"],[1,"col-md-6"],[1,"card-title"],["id","recordCount"],[1,"col-md-6","text-end"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports"],[2,"min-width","100px"],[4,"ngIf"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"],[1,"fa","fa-spinner","fa-spin"]],template:function(p,l){p&1&&(i(0,"div",0)(1,"h4",1),a(2,"Approved Application Status Report"),t(),i(3,"div",2)(4,"form",3),B("ngSubmit",function(){return l.onSearch()}),i(5,"div",4)(6,"div",5)(7,"label",6),a(8,"District "),i(9,"span",7),a(10,"*"),t()(),i(11,"select",8),B("change",function(){return l.onDistrictChange()}),i(12,"option",9),a(13,"Select District"),t(),u(14,Sn,2,2,"option",10),t(),S(15,"app-form-error",11),t(),i(16,"div",5)(17,"label",12),a(18,"Block/ULB "),i(19,"span",7),a(20,"*"),t()(),i(21,"select",13),B("change",function(){return l.onBlockChange()}),i(22,"option",9),a(23,"Select Block/ULB"),t(),i(24,"optgroup",14),u(25,bn,2,1,"ng-container",15),t(),i(26,"optgroup",16),u(27,Cn,2,1,"ng-container",15),t()(),S(28,"app-form-error",11),t(),i(29,"div",5)(30,"label",17),a(31,"GP/Ward "),i(32,"span",7),a(33,"*"),t()(),i(34,"select",18)(35,"option",9),a(36,"Select GP/Ward"),t(),u(37,En,2,1,"ng-container",15)(38,kn,2,1,"ng-container",15),t(),S(39,"app-form-error",11),t(),i(40,"div",5)(41,"label",19),a(42," Category "),t(),i(43,"select",20)(44,"option",9),a(45,"Choose Category"),t(),i(46,"option",21),a(47,"NFSA"),t(),i(48,"option",22),a(49,"NON-NFSA"),t()()()(),i(50,"div",23)(51,"div",5)(52,"label",24),a(53," Payment Status "),t(),i(54,"select",25)(55,"option",9),a(56,"Choose Payment Status"),t(),i(57,"option",26),a(58,"Paid"),t(),i(59,"option",27),a(60,"Failed"),t()()(),i(61,"div",5)(62,"label",28),a(63," Payment Mode "),t(),i(64,"select",29)(65,"option",9),a(66,"Choose Payment Mode"),t(),i(67,"option",30),a(68,"CBDC"),t(),i(69,"option",31),a(70,"DBT"),t()()(),i(71,"div",5)(72,"label",32),a(73," Social Category "),t(),i(74,"select",33)(75,"option",9),a(76,"Choose Social Category"),t(),i(77,"option",21),a(78,"General"),t(),i(79,"option",34),a(80,"OBC"),t(),i(81,"option",35),a(82,"SC"),t(),i(83,"option",36),a(84,"ST"),t()()(),i(85,"div",5)(86,"label",37),a(87," PWD "),t(),i(88,"select",38)(89,"option",9),a(90,"Choose PWD"),t(),i(91,"option",21),a(92,"Yes "),t(),i(93,"option",22),a(94,"NO"),t()()()(),i(95,"div",4)(96,"div",5)(97,"label",39),a(98," Submission Date "),t(),S(99,"input",40),t(),i(100,"div",5)(101,"label",41),a(102," Payment Installment "),t(),i(103,"select",42),u(104,In,2,2,"option",10),t()()(),i(105,"div",43)(106,"div",44),u(107,An,3,0,"button",45)(108,Fn,3,0),t()()()(),u(109,ro,21,6,"div",46),t()),p&2&&(s(4),d("formGroup",l.searchForm),s(10),d("ngForOf",l.districts),s(1),d("field",l.searchForm.controls.district),s(10),d("ngForOf",l.blockULBList),s(2),d("ngForOf",l.blockULBList),s(1),d("field",l.searchForm.controls.block_ulb),s(9),d("ngForOf",l.gpWardList),s(1),d("ngForOf",l.gpWardList),s(1),d("field",l.searchForm.controls.gp),s(65),d("ngForOf",l.payment_installments),s(3),k(107,l.isFormSearchInProgress?108:107),s(2),d("ngIf",l.showTable))},dependencies:[re,se,Ee,ge,ve,Ce,Ie,be,ue,he,Se,xe,le]});let e=r;return e})();var qe=ie(we()),mt=ie(De());function so(e,r){if(e&1&&(i(0,"option",42),a(1),t()),e&2){let o=r.$implicit;d("value",o.id),s(1),h(o.district_name)}}function lo(e,r){if(e&1&&(i(0,"option",44),a(1),t()),e&2){let o=m().$implicit,n=m();d("ngValue",n.jsonify(o)),s(1),V(" ",o.block_name," ")}}function co(e,r){if(e&1&&(z(0),u(1,lo,2,2,"option",43),G()),e&2){let o=r.$implicit;s(1),d("ngIf",o.pushType==="blockid")}}function po(e,r){if(e&1&&(i(0,"option",44),a(1),t()),e&2){let o=m().$implicit,n=m();d("ngValue",n.jsonify(o)),s(1),V(" ",o.ulb_name," ")}}function mo(e,r){if(e&1&&(z(0),u(1,po,2,2,"option",43),G()),e&2){let o=r.$implicit;s(1),d("ngIf",o.pushType==="ulbtype")}}function _o(e,r){if(e&1&&(i(0,"option",44),a(1),t()),e&2){let o=m().$implicit,n=m();d("ngValue",n.jsonify(o)),s(1),V(" ",o.gp_name," ")}}function uo(e,r){if(e&1&&(z(0),u(1,_o,2,2,"option",43),G()),e&2){let o=r.$implicit;s(1),d("ngIf",o.pushType==="gpid")}}function ho(e,r){if(e&1&&(i(0,"option",44),a(1),t()),e&2){let o=m().$implicit,n=m();d("ngValue",n.jsonify(o)),s(1),V(" ",o.ward_no," ")}}function fo(e,r){if(e&1&&(z(0),u(1,ho,2,2,"option",43),G()),e&2){let o=r.$implicit;s(1),d("ngIf",o.pushType==="wardid")}}function go(e,r){e&1&&(i(0,"button",45),S(1,"i",46),a(2,"Search "),t())}function So(e,r){e&1&&(i(0,"button",47),S(1,"i",48),a(2," Searching ..."),t())}function xo(e,r){if(e&1){let o=K();i(0,"button",64),B("click",function(){X(o);let p=m(2);return J(p.exportToPDF())}),S(1,"i",65),a(2,"Download to PDF "),t()}}function bo(e,r){e&1&&(i(0,"button",66),S(1,"i",48),a(2,"Downloading "),t())}function vo(e,r){if(e&1){let o=K();i(0,"button",64),B("click",function(){X(o);let p=m(2);return J(p.exportToExcel())}),S(1,"i",65),a(2,"Download to EXCEL "),t()}}function Co(e,r){e&1&&(i(0,"button",66),S(1,"i",48),a(2,"Downloading "),t())}var yo=(e,r)=>r.id;function Eo(e,r){if(e&1&&(i(0,"tr")(1,"td"),a(2),t(),i(3,"td"),a(4),v(5,"uppercase"),t(),i(6,"td"),a(7),v(8,"uppercase"),t(),i(9,"td"),a(10),v(11,"uppercase"),t(),i(12,"td"),a(13),v(14,"uppercase"),t(),i(15,"td"),a(16),v(17,"uppercase"),t(),i(18,"td"),a(19),t(),i(20,"td"),a(21),v(22,"uppercase"),t(),i(23,"td"),a(24),v(25,"uppercase"),t(),i(26,"td"),a(27),v(28,"uppercase"),t()()),e&2){let o=r.$implicit,n=r.$index;s(2),h(n+1),s(2),h(C(5,10,o.category)),s(3),h(C(8,12,o.village_name)),s(3),h(C(11,14,o.application_number)),s(3),h(C(14,16,o.applicant_name)),s(3),h(C(17,18,o.spouse_or_father_name)),s(3),h(o.age),s(2),h(C(22,20,o.social_status)),s(3),h(C(25,22,o.pwd)),s(3),h(C(28,24,o.status))}}function To(e,r){if(e&1&&(i(0,"table",67)(1,"thead")(2,"tr")(3,"th"),a(4,"SI#"),t(),i(5,"th"),a(6,"CATEGORY"),t(),i(7,"th"),a(8,"VILLAGE"),t(),i(9,"th"),a(10,"APPLICATION NO."),t(),i(11,"th"),a(12,"APPLICANT NAME"),t(),i(13,"th"),a(14,"FATHER/HUSBAND NAME"),t(),i(15,"th"),a(16,"AGE"),t(),i(17,"th"),a(18,"SOCIAL CATEGORY"),t(),i(19,"th"),a(20,"PWD (YES/NO)"),t(),i(21,"th"),a(22,"APPLICATION STATUS"),t()()(),i(23,"tbody"),oe(24,Eo,29,26,"tr",null,yo),t()()),e&2){let o=m(2);s(24),ae(o.application_list)}}function ko(e,r){e&1&&(i(0,"h5",68),a(1,"No data available"),t())}function Io(e,r){e&1&&(i(0,"div",69),a(1,"Loading.. "),S(2,"i",70),t())}function Ao(e,r){e&1&&(i(0,"span"),S(1,"i",74),a(2," Loading..."),t())}function Fo(e,r){e&1&&(i(0,"span"),a(1,"Load More"),t())}function wo(e,r){if(e&1){let o=K();i(0,"div",71)(1,"button",72),B("click",function(){X(o);let p=m(2);return J(p.loadMore())}),u(2,Ao,3,0,"span",73)(3,Fo,2,0,"span",73),t()()}if(e&2){let o=m(2);s(2),d("ngIf",o.isLoadMoreInProgress),s(1),d("ngIf",!o.isLoadMoreInProgress)}}function Do(e,r){if(e&1&&(i(0,"div",49)(1,"div",50)(2,"div",51)(3,"div",52)(4,"div",53)(5,"h5",54),a(6," Number of records found : "),i(7,"span",55),a(8),t()()(),i(9,"div",56)(10,"div",57),u(11,xo,3,0,"button",58)(12,bo,3,0),t(),i(13,"div",59),u(14,vo,3,0,"button",58)(15,Co,3,0),t()()(),i(16,"div",60),u(17,To,26,0,"table",61)(18,ko,2,0)(19,Io,3,0,"div",62),t(),u(20,wo,4,2,"div",63),t()()()),e&2){let o=m();s(8),h(o.count),s(3),k(11,o.isExportInProgress?12:11),s(3),k(14,o.isExportInProgressExcel?15:14),s(3),k(17,o.application_list&&o.application_list.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),s(2),k(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),s(1),d("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var _t=(()=>{let r=class r{constructor(n,p,l,c,g,x,E){this.router=n,this.formService=p,this.appService=l,this.httpClient=c,this.toastService=g,this.authService=x,this.masterDataService=E,this.districts=[],this.blocks=[],this.ulbs=[],this.gramPanchats=[],this.wards=[],this.blockULBList=[],this.gpWardList=[],this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.limit=this.appService.loadmorelimit,this.isDisabled=!1,this.count=0,this.searchForm=new fe({district:new F("",[Z.required]),block_ulb:new F("",[Z.required]),gp:new F("",[Z.required]),a_category:new F(""),age_grp:new F(""),social_sts:new F(""),pwd:new F("")}),this.reasonsMapping={1:"GOVT. EMPLOYEE IN FAMILY",2:"GOVT. PENSIONER IN FAMILY",3:"4 WHEELER VEHICLE IN FAMILY",4:"MORE THAN 5 ACRE IRRIGATED LAND OR 10 ACRE NON-IRRIGATED LAND IN FAMILY",5:"PRI MEMBER EXIST IN FAMILY",6:"INDIVIDUAL RECEIVING STUDENT SCHOLARSHIP MORE THAN 1,500/ MONTH OR 18,000/- PER YEAR",7:"INDIVIDUAL RECEIVING MSKY (MUKHYAMANTRI KALAKAR SAHAYATA YOJANA) ASSISTANCE MORE THAN 1,500/ MONTH OR 18,000/- PER YEAR",8:"ULB REPRESENTATIVE EXIST IN FAMILY",9:"REPRESENTATIVE FROM BOARD"}}ngOnInit(){let n=this.authService.userDetail.role.id,p=this.authService.userDetail.demography_id,l=this.authService.userDetail.district_id,c=this.authService.userDetail.demography_type;c===1?this.fetchAllDistricts():c===2?(this.fetchDistrictById(p),this.isDisabled=!0,this.searchForm.get("district")?.disable()):(c===3||c===5)&&(this.fetchDistrictById(l),this.isDisabled=!0,this.searchForm.get("district")?.disable(),this.searchForm.get("block_ulb")?.disable())}getMaskedAadhaar(n){return!n||n.length!==12?n:"********"+n.slice(-4)}fetchAllDistricts(){this.districts=te.data}fetchDistrictById(n){this.districts=te.data.filter(p=>p.id==n),this.searchForm.patchValue({district:n}),this.onDistrictChange()}onDistrictChange(){let n="";this.searchForm.value.district!=""&&(n=this.searchForm.value.district),this.searchForm.get("block_ulb")?.setValue(""),this.searchForm.get("gp")?.setValue(""),this.blocks=[],this.ulbs=[],this.blockULBList=[],this.blocks=this.masterDataService.getBlockData(n),this.ulbs=this.masterDataService.getULBData(n),this.blockULBList=[...this.blocks.map(c=>P(N({},c),{pushType:"blockid"})),...this.ulbs.map(c=>P(N({},c),{pushType:"ulbtype"}))];let p=this.authService.userDetail.demography_type,l=this.authService.userDetail.role.id;p===5&&(this.blocks=[],this.ulbs=this.ulbs.filter(c=>c.id==this.authService.userDetail.demography_id)),p===5&&(console.log("ulbs",this.ulbs),this.searchForm.patchValue({block_ulb:this.jsonify(P(N({},this.ulbs.find(c=>c.id==this.authService.userDetail.demography_id)),{pushType:"ulbtype"}))}),this.onBlockChange()),p===3&&(this.blocks=this.blocks.filter(c=>c.id==this.authService.userDetail.demography_id),this.ulbs=[]),p===3&&(this.searchForm.patchValue({block_ulb:this.jsonify(P(N({},this.blocks.find(c=>c.id==this.authService.userDetail.demography_id)),{pushType:"blockid"}))}),this.onBlockChange())}onBlockChange(){let n="";this.searchForm.value.block_ulb&&(n=JSON.parse(this.searchForm.value.block_ulb)),this.searchForm.get("gp")?.setValue(""),this.gramPanchats=[],this.wards=[],this.gpWardList=[];let p=n.pushType==="blockid",l=n.pushType==="ulbtype",c=[];p&&(this.gramPanchats=this.masterDataService.getGPData(n.id),this.gpWardList=this.gramPanchats.map(g=>P(N({},g),{pushType:"gpid"}))),l&&(this.wards=this.masterDataService.getWARDData(n.id),this.gpWardList=this.wards.map(g=>P(N({},g),{pushType:"wardid"})))}jsonify(n){return JSON.stringify(n)}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let p=this.searchForm.value.district,l=this.searchForm.value.gp?JSON.parse(this.searchForm.value.gp):null,c=this.searchForm.value.block_ulb?JSON.parse(this.searchForm.value.block_ulb):null,g=this.searchForm.value.a_category,x=this.searchForm.value.age_grp,E=this.searchForm.value.social_sts,y=this.searchForm.value.pwd,T=new Q;if(c&&(c.pushType==="blockid"?T=T.set("block_id",c.id):c.pushType==="ulbtype"&&(T=T.set("ulb_id",c.id))),l&&(l.pushType==="gpid"?T=T.set("gp_id",l.id):l.pushType==="wardid"&&(T=T.set("ward_id",l.id))),p&&(T=T.set("district_id",p)),g&&(T=T.set("category",g)),x){let f,b;x.includes("+")?(f=x.replace("+",""),b="0"):[f,b]=x.split("-"),T=T.set("start_age",f),T=T.set("end_age",b)}E&&(T=T.set("social_status",E)),y&&(T=T.set("pwd_status",y)),T=T.set("offset",this.offset),T=T.set("limit",this.limit);let _=new q({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/report/application-report-status`,{params:T,headers:_}).subscribe(f=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=f.count,f.data&&f.data.length>0?(this.application_list=this.application_list.concat(f.data),this.offset+=f.data.length,this.hasMoreRecords=f.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},f=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}getReasonText(n){return this.reasonsMapping[n]||""}getExclusionReasons(n){return typeof n.exclusion_reasons=="string"?n.exclusion_reasons.split(",").map(l=>l.trim()).map(l=>isNaN(Number(l))?l:this.getReasonText(Number(l))):Array.isArray(n.exclusion_reasons)?n.exclusion_reasons.map(p=>typeof p=="number"?this.getReasonText(p):p):typeof n.exclusion_reasons=="number"?[this.getReasonText(n.exclusion_reasons)]:[]}exportToExcel(){let n=new Q,p=this.searchForm.value.district,l=this.searchForm.value.gp?JSON.parse(this.searchForm.value.gp):null,c=this.searchForm.value.block_ulb?JSON.parse(this.searchForm.value.block_ulb):null,g=this.searchForm.value.a_category,x=this.searchForm.value.age_grp,E=this.searchForm.value.social_sts,y=this.searchForm.value.pwd;if(c&&(c.pushType==="blockid"?n=n.set("block_id",c.id):c.pushType==="ulbtype"&&(n=n.set("ulb_id",c.id))),l&&(l.pushType==="gpid"?n=n.set("gp_id",l.id):l.pushType==="wardid"&&(n=n.set("ward_id",l.id))),p&&(n=n.set("district_id",p)),g&&(n=n.set("category",g)),x){let _,f;x.includes("+")?(_=x.replace("+",""),f="0"):[_,f]=x.split("-"),n=n.set("start_age",_),n=n.set("end_age",f)}E&&(n=n.set("social_status",E)),y&&(n=n.set("pwd_status",y)),n=n.set("export_all","1");let T=new q({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/report/application-report-status`,{params:n,headers:T,responseType:"json"}).subscribe(_=>{this.isExportInProgressExcel=!1;let f=_.data.map((A,L)=>{let W=this.getExclusionReasons(A).join(", ");return{"SI#":L+1,Category:A.category,Village:A.village_name,"Application No.":A.application_number,"Applicant Name":A.applicant_name,"Father/Husband Name":A.spouse_or_father_name,Age:A.age,"Social Status":A.social_status,"PWD (Yes/No)":A.pwd,"Application Status":A.status}}),b=ee.json_to_sheet(f),R=ee.book_new();ee.book_append_sheet(R,b,"Applications");let U=ke(R,{bookType:"xlsx",type:"array"}),Y=new Date,H=Y.toLocaleDateString("en-GB").split("/").reverse().join("-"),$=Y.toLocaleTimeString("en-GB").replace(/:/g,"-"),j=`application_reports_${H}_${$}.xlsx`,O=new Blob([U],{type:"application/octet-stream"}),M=document.createElement("a"),I=window.URL.createObjectURL(O);M.href=I,M.download=j,M.click(),window.URL.revokeObjectURL(I)},_=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",_)})}exportToPDF(){qe.default.vfs=mt.default.pdfMake.vfs;let n=new Q,p=this.searchForm.value.district,l=this.searchForm.value.gp?JSON.parse(this.searchForm.value.gp):null,c=this.searchForm.value.block_ulb?JSON.parse(this.searchForm.value.block_ulb):null,g=this.searchForm.value.a_category,x=this.searchForm.value.age_grp,E=this.searchForm.value.social_sts,y=this.searchForm.value.pwd;if(c&&(c.pushType==="blockid"?n=n.set("block_id",c.id):c.pushType==="ulbtype"&&(n=n.set("ulb_id",c.id))),l&&(l.pushType==="gpid"?n=n.set("gp_id",l.id):l.pushType==="wardid"&&(n=n.set("ward_id",l.id))),p&&(n=n.set("district_id",p)),g&&(n=n.set("category",g)),x){let _,f;x.includes("+")?(_=x.replace("+",""),f="0"):[_,f]=x.split("-"),n=n.set("start_age",_),n=n.set("end_age",f)}E&&(n=n.set("social_status",E)),y&&(n=n.set("pwd_status",y)),n=n.set("export_all","1");let T=new q({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/report/application-report-status`,{params:n,headers:T,responseType:"json"}).subscribe(_=>{this.isExportInProgress=!1;let f=_.data[0]||{},b=(f.district_name||"N/A").toUpperCase(),R=(f.block_name||f.ulb_name||"N/A").toUpperCase(),U=(f.gp_name||f.ward_no||"N/A").toUpperCase(),Y=[[{text:"SI#",fontSize:10},{text:"CATEGORY",fontSize:10},{text:"VILLAGE",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"AGE",fontSize:10},{text:"SOCIAL CATEGORY",fontSize:10},{text:"PWD",fontSize:10},{text:"STATUS",fontSize:10}]];_.data.forEach((I,A)=>{let D=this.getExclusionReasons(I).join(", ");Y.push([{text:(A+1).toString(),fontSize:9},{text:(I.category||"").toUpperCase(),fontSize:9},{text:(I.village_name||"").toUpperCase(),fontSize:9},{text:(I.application_number||"").toUpperCase(),fontSize:9},{text:(I.applicant_name||"").toUpperCase(),fontSize:9},{text:(I.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:(I.age||"").toUpperCase(),fontSize:9},{text:(I.social_status||"").toUpperCase(),fontSize:9},{text:(I.pwd||"").toUpperCase(),fontSize:9},{text:(I.status||"").toUpperCase(),fontSize:9}])});let H={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${b} > BLOCK/ULB: ${R} > GP/WARD: ${U}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"APPLICATION STATUS REPORT",style:"header"},{table:{headerRows:1,body:Y,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]},layout:{fillColor:function(I){return I===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},$=new Date,j=$.toLocaleDateString("en-GB").split("/").reverse().join("-"),O=$.toLocaleTimeString("en-GB").replace(/:/g,"-"),M=`application_reports_${j}_${O}.pdf`;qe.default.createPdf(H).download(M)},_=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",_)})}};r.\u0275fac=function(p){return new(p||r)(w(pe),w(ye),w(de),w(ce),w(me),w(_e),w(Te))},r.\u0275cmp=ne({type:r,selectors:[["app-application-status"]],decls:96,vars:11,consts:[[1,"container-fluid"],[1,"card-title","mb-3"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-2"],[1,"col-md-3"],["for","district",1,"fw-bold"],[1,"text-danger"],["id","district","formControlName","district",1,"form-control","form-select","my-2",3,"change"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"field"],["for","block_ulb",1,"fw-bold"],["id","block_ulb","formControlName","block_ulb",1,"form-control","form-select","my-2",3,"change"],["label","Blocks"],[4,"ngFor","ngForOf"],["label","ULBs"],["for","gp",1,"fw-bold"],["id","gp","formControlName","gp",1,"form-control","form-select","my-2"],["for","a_category",1,"fw-bold"],["formControlName","a_category","id","a_category",1,"form-select","my-2"],["value","1"],["value","0"],[1,"row","g-3"],["for","age_grp",1,"fw-bold"],["formControlName","age_grp","id","age_grp",1,"form-select","my-2"],["value","21-29.99"],["value","30-39.99"],["value","40-49.99"],["value","50-59.99"],["value","60-0"],["for","social_sts",1,"fw-bold"],["formControlName","social_sts","id","social_sts",1,"form-select","my-2"],["value","2"],["value","3"],["value","4"],["for","pwd",1,"fw-bold"],["formControlName","pwd","id","pwd",1,"form-select","my-2"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],["class","mt-3","style","background-color: #e3e3e3; border: none;",4,"ngIf"],[3,"value"],[3,"ngValue",4,"ngIf"],[3,"ngValue"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[1,"row","mb-2"],[1,"col-md-6"],[1,"card-title"],["id","recordCount"],[1,"col-md-6","text-end"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"],[4,"ngIf"],[1,"fa","fa-spinner","fa-spin"]],template:function(p,l){p&1&&(i(0,"div",0)(1,"h4",1),a(2,"Application Status Report"),t(),i(3,"div",2)(4,"form",3),B("ngSubmit",function(){return l.onSearch()}),i(5,"div",4)(6,"div",5)(7,"label",6),a(8,"District "),i(9,"span",7),a(10,"*"),t()(),i(11,"select",8),B("change",function(){return l.onDistrictChange()}),i(12,"option",9),a(13,"Select District"),t(),u(14,so,2,2,"option",10),t(),S(15,"app-form-error",11),t(),i(16,"div",5)(17,"label",12),a(18,"Block/ULB "),i(19,"span",7),a(20,"*"),t()(),i(21,"select",13),B("change",function(){return l.onBlockChange()}),i(22,"option",9),a(23,"Select Block/ULB"),t(),i(24,"optgroup",14),u(25,co,2,1,"ng-container",15),t(),i(26,"optgroup",16),u(27,mo,2,1,"ng-container",15),t()(),S(28,"app-form-error",11),t(),i(29,"div",5)(30,"label",17),a(31,"GP/Ward "),i(32,"span",7),a(33,"*"),t()(),i(34,"select",18)(35,"option",9),a(36,"Select GP/Ward"),t(),u(37,uo,2,1,"ng-container",15)(38,fo,2,1,"ng-container",15),t(),S(39,"app-form-error",11),t(),i(40,"div",5)(41,"label",19),a(42," Category "),t(),i(43,"select",20)(44,"option",9),a(45,"Choose Category"),t(),i(46,"option",21),a(47,"NFSA"),t(),i(48,"option",22),a(49,"NON-NFSA"),t()()()(),i(50,"div",23)(51,"div",5)(52,"label",24),a(53," Age Group "),t(),i(54,"select",25)(55,"option",9),a(56,"Choose Age Group"),t(),i(57,"option",26),a(58,"21-30"),t(),i(59,"option",27),a(60,"30-40"),t(),i(61,"option",28),a(62,"40-50"),t(),i(63,"option",29),a(64,"50-60"),t(),i(65,"option",30),a(66,"60+"),t()()(),i(67,"div",5)(68,"label",31),a(69," Social Category "),t(),i(70,"select",32)(71,"option",9),a(72,"Choose Social Category"),t(),i(73,"option",21),a(74,"General"),t(),i(75,"option",33),a(76,"OBC"),t(),i(77,"option",34),a(78,"SC"),t(),i(79,"option",35),a(80,"ST"),t()()(),i(81,"div",5)(82,"label",36),a(83," PWD "),t(),i(84,"select",37)(85,"option",9),a(86,"Choose PWD"),t(),i(87,"option",21),a(88,"Yes "),t(),i(89,"option",22),a(90,"NO"),t()()()(),i(91,"div",38)(92,"div",39),u(93,go,3,0,"button",40)(94,So,3,0),t()()()(),u(95,Do,21,6,"div",41),t()),p&2&&(s(4),d("formGroup",l.searchForm),s(10),d("ngForOf",l.districts),s(1),d("field",l.searchForm.controls.district),s(10),d("ngForOf",l.blockULBList),s(2),d("ngForOf",l.blockULBList),s(1),d("field",l.searchForm.controls.block_ulb),s(9),d("ngForOf",l.gpWardList),s(1),d("ngForOf",l.gpWardList),s(1),d("field",l.searchForm.controls.gp),s(54),k(93,l.isFormSearchInProgress?94:93),s(2),d("ngIf",l.showTable))},dependencies:[re,se,Ee,ge,ve,Ce,be,ue,he,Se,xe,le]});let e=r;return e})();var Qe=ie(we()),ut=ie(De());function Lo(e,r){if(e&1&&(i(0,"option",34),a(1),t()),e&2){let o=r.$implicit;d("value",o.id),s(1),h(o.district_name)}}function No(e,r){if(e&1&&(i(0,"option",36),a(1),t()),e&2){let o=m().$implicit,n=m();d("ngValue",n.jsonify(o)),s(1),V(" ",o.block_name," ")}}function Po(e,r){if(e&1&&(z(0),u(1,No,2,2,"option",35),G()),e&2){let o=r.$implicit;s(1),d("ngIf",o.pushType==="blockid")}}function Bo(e,r){if(e&1&&(i(0,"option",36),a(1),t()),e&2){let o=m().$implicit,n=m();d("ngValue",n.jsonify(o)),s(1),V(" ",o.ulb_name," ")}}function Ro(e,r){if(e&1&&(z(0),u(1,Bo,2,2,"option",35),G()),e&2){let o=r.$implicit;s(1),d("ngIf",o.pushType==="ulbtype")}}function Oo(e,r){if(e&1&&(i(0,"option",36),a(1),t()),e&2){let o=m().$implicit,n=m();d("ngValue",n.jsonify(o)),s(1),V(" ",o.gp_name," ")}}function Uo(e,r){if(e&1&&(z(0),u(1,Oo,2,2,"option",35),G()),e&2){let o=r.$implicit;s(1),d("ngIf",o.pushType==="gpid")}}function Mo(e,r){if(e&1&&(i(0,"option",36),a(1),t()),e&2){let o=m().$implicit,n=m();d("ngValue",n.jsonify(o)),s(1),V(" ",o.ward_no," ")}}function jo(e,r){if(e&1&&(z(0),u(1,Mo,2,2,"option",35),G()),e&2){let o=r.$implicit;s(1),d("ngIf",o.pushType==="wardid")}}function Vo(e,r){e&1&&(i(0,"button",37),S(1,"i",38),a(2,"Search "),t())}function zo(e,r){e&1&&(i(0,"button",39),S(1,"i",40),a(2," Searching ..."),t())}function Go(e,r){if(e&1){let o=K();i(0,"button",56),B("click",function(){X(o);let p=m(2);return J(p.exportToPDF())}),S(1,"i",57),a(2,"Download to PDF "),t()}}function $o(e,r){e&1&&(i(0,"button",58),S(1,"i",40),a(2,"Downloading "),t())}function Yo(e,r){if(e&1){let o=K();i(0,"button",56),B("click",function(){X(o);let p=m(2);return J(p.exportToExcel())}),S(1,"i",57),a(2,"Download to EXCEL "),t()}}function Wo(e,r){e&1&&(i(0,"button",58),S(1,"i",40),a(2,"Downloading "),t())}var Ho=(e,r)=>r.id;function Xo(e,r){if(e&1&&(i(0,"td"),a(1),v(2,"uppercase"),t()),e&2){let o=m().$implicit;s(1),h(C(2,1,o.block_name))}}function Jo(e,r){if(e&1&&(i(0,"td"),a(1),v(2,"uppercase"),t()),e&2){let o=m().$implicit;s(1),h(C(2,1,o.ulb_name))}}function Ko(e,r){if(e&1&&(i(0,"td"),a(1),v(2,"uppercase"),t()),e&2){let o=m().$implicit;s(1),h(C(2,1,o.gp_name))}}function qo(e,r){if(e&1&&(i(0,"td"),a(1),v(2,"uppercase"),t()),e&2){let o=m().$implicit;s(1),h(C(2,1,o.ward_no))}}function Qo(e,r){if(e&1&&(i(0,"td"),a(1),v(2,"uppercase"),t()),e&2){let o=m().$implicit;s(1),h(C(2,1,o.village))}}function Zo(e,r){e&1&&S(0,"td")}function ea(e,r){if(e&1&&(i(0,"tr")(1,"td"),a(2),t(),i(3,"td"),a(4),v(5,"uppercase"),t(),u(6,Xo,3,3,"td")(7,Jo,3,3)(8,Ko,3,3,"td")(9,qo,3,3)(10,Qo,3,3,"td")(11,Zo,1,0),i(12,"td"),a(13),v(14,"uppercase"),t(),i(15,"td"),a(16),v(17,"uppercase"),t(),i(18,"td"),a(19),v(20,"uppercase"),t(),i(21,"td"),a(22),v(23,"uppercase"),t(),i(24,"td"),a(25),t(),i(26,"td"),a(27),v(28,"uppercase"),t(),i(29,"td"),a(30),v(31,"uppercase"),t(),i(32,"td"),a(33),t(),i(34,"td"),a(35),v(36,"uppercase"),t()()),e&2){let o=r.$implicit,n=r.$index,p=m(3);s(2),h(n+1),s(2),h(C(5,14,o.district_name)),s(2),k(6,o.block_name?6:o.ulb_name?7:-1),s(2),k(8,o.gp_name?8:o.ward_no?9:-1),s(2),k(10,o.village?10:11),s(3),h(C(14,16,o.category)),s(3),h(C(17,18,o.application_number)),s(3),h(C(20,20,o.applicant_name)),s(3),h(C(23,22,o.spouse_or_father_name)),s(3),h(p.appService.dateFormat(o.dob)),s(2),h(C(28,24,o.social_category)),s(3),h(C(31,26,o.pwd_status)),s(3),h(o.alt_mobile_number),s(2),h(C(36,28,o.failure_remarks))}}function ta(e,r){if(e&1&&(i(0,"table",59)(1,"thead")(2,"tr")(3,"th"),a(4,"SI#"),t(),i(5,"th"),a(6,"DISTRICT"),t(),i(7,"th"),a(8,"BLOCK/ULB"),t(),i(9,"th"),a(10,"GP/WARD"),t(),i(11,"th"),a(12,"VILLAGE"),t(),i(13,"th"),a(14,"CATEGORY"),t(),i(15,"th"),a(16,"APPLICATION NO."),t(),i(17,"th"),a(18,"APPLICANT NAME"),t(),i(19,"th"),a(20,"FATHER/HUSBAND NAME"),t(),i(21,"th",60),a(22,"DOB"),t(),i(23,"th"),a(24,"SOCIAL CATEGORY"),t(),i(25,"th"),a(26,"PWD"),t(),i(27,"th"),a(28,"MOBILE NO."),t(),i(29,"th"),a(30,"NPCI FAILED REASON"),t()()(),i(31,"tbody"),oe(32,ea,37,30,"tr",null,Ho),t()()),e&2){let o=m(2);s(32),ae(o.application_list)}}function ia(e,r){e&1&&(i(0,"h5",61),a(1,"No data available"),t())}function na(e,r){e&1&&(i(0,"div",62),a(1,"Loading.. "),S(2,"i",63),t())}function oa(e,r){e&1&&(i(0,"span"),S(1,"i",67),a(2," Loading..."),t())}function aa(e,r){e&1&&(i(0,"span"),a(1,"Load More"),t())}function ra(e,r){if(e&1){let o=K();i(0,"div",64)(1,"button",65),B("click",function(){X(o);let p=m(2);return J(p.loadMore())}),u(2,oa,3,0,"span",66)(3,aa,2,0,"span",66),t()()}if(e&2){let o=m(2);s(2),d("ngIf",o.isLoadMoreInProgress),s(1),d("ngIf",!o.isLoadMoreInProgress)}}function sa(e,r){if(e&1&&(i(0,"div",41)(1,"div",42)(2,"div",43)(3,"div",44)(4,"div",45)(5,"h5",46),a(6," Number of records found : "),i(7,"span",47),a(8),t()()(),i(9,"div",48)(10,"div",49),u(11,Go,3,0,"button",50)(12,$o,3,0),t(),i(13,"div",51),u(14,Yo,3,0,"button",50)(15,Wo,3,0),t()()(),i(16,"div",52),u(17,ta,34,0,"table",53)(18,ia,2,0)(19,na,3,0,"div",54),t(),u(20,ra,4,2,"div",55),t()()()),e&2){let o=m();s(8),h(o.count),s(3),k(11,o.isExportInProgress?12:11),s(3),k(14,o.isExportInProgressExcel?15:14),s(3),k(17,o.application_list&&o.application_list.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),s(2),k(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),s(1),d("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var ht=(()=>{let r=class r{constructor(n,p,l,c,g,x,E){this.router=n,this.formService=p,this.appService=l,this.httpClient=c,this.toastService=g,this.authService=x,this.masterDataService=E,this.districts=[],this.blocks=[],this.ulbs=[],this.gramPanchats=[],this.wards=[],this.blockULBList=[],this.gpWardList=[],this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.limit=this.appService.loadmorelimit,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.isDisabled=!1,this.count=0,this.searchForm=new fe({district:new F("",[Z.required]),block_ulb:new F("",[Z.required]),gp:new F("",[Z.required]),a_category:new F(""),social_category:new F(""),pwd_status:new F("")}),this.reasonsMapping={1:"Govt. employee in family",2:"Govt. pensioner in family",3:"4 wheeler vehicle in family",4:"More than 5 Acre irrigated land or 10 Acre non-irrigated land in family",5:"PRI member exist in family",6:"Individual receiving student scholarship more than 1,500/ month or 18,000/- per year",7:"Individual receiving  MSKY (Mukhyamantri Kalakar Sahayata Yojana) assisstance more than 1,500/ month or 18,000/- per year",8:"ULB representative exist in family",9:"Representative from Board"}}ngOnInit(){let n=this.authService.userDetail.role.id,p=this.authService.userDetail.demography_id,l=this.authService.userDetail.district_id,c=this.authService.userDetail.demography_type;c===1?this.fetchAllDistricts():c===2?(this.fetchDistrictById(p),this.isDisabled=!0,this.searchForm.get("district")?.disable()):(c===3||c===5)&&(this.fetchDistrictById(l),this.isDisabled=!0,this.searchForm.get("district")?.disable(),this.searchForm.get("block_ulb")?.disable())}getMaskedAadhaar(n){return!n||n.length!==12?n:"********"+n.slice(-4)}fetchAllDistricts(){this.districts=te.data}fetchDistrictById(n){this.districts=te.data.filter(p=>p.id==n),this.searchForm.patchValue({district:n}),this.onDistrictChange()}onDistrictChange(){let n="";this.searchForm.value.district!=""&&(n=this.searchForm.value.district),this.searchForm.get("block_ulb")?.setValue(""),this.searchForm.get("gp")?.setValue(""),this.blocks=[],this.ulbs=[],this.blockULBList=[],this.blocks=this.masterDataService.getBlockData(n),this.ulbs=this.masterDataService.getULBData(n),this.blockULBList=[...this.blocks.map(c=>P(N({},c),{pushType:"blockid"})),...this.ulbs.map(c=>P(N({},c),{pushType:"ulbtype"}))];let p=this.authService.userDetail.demography_type,l=this.authService.userDetail.role.id;p===5&&(this.blocks=[],this.ulbs=this.ulbs.filter(c=>c.id==this.authService.userDetail.demography_id)),p===5&&(console.log("ulbs",this.ulbs),this.searchForm.patchValue({block_ulb:this.jsonify(P(N({},this.ulbs.find(c=>c.id==this.authService.userDetail.demography_id)),{pushType:"ulbtype"}))}),this.onBlockChange()),p===3&&(this.blocks=this.blocks.filter(c=>c.id==this.authService.userDetail.demography_id),this.ulbs=[]),p===3&&(this.searchForm.patchValue({block_ulb:this.jsonify(P(N({},this.blocks.find(c=>c.id==this.authService.userDetail.demography_id)),{pushType:"blockid"}))}),this.onBlockChange())}onBlockChange(){let n="";this.searchForm.value.block_ulb&&(n=JSON.parse(this.searchForm.value.block_ulb)),this.searchForm.get("gp")?.setValue(""),this.gramPanchats=[],this.wards=[],this.gpWardList=[];let p=n.pushType==="blockid",l=n.pushType==="ulbtype",c=[];p&&(this.gramPanchats=this.masterDataService.getGPData(n.id),this.gpWardList=this.gramPanchats.map(g=>P(N({},g),{pushType:"gpid"}))),l&&(this.wards=this.masterDataService.getWARDData(n.id),this.gpWardList=this.wards.map(g=>P(N({},g),{pushType:"wardid"})))}jsonify(n){return JSON.stringify(n)}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let p=this.searchForm.value.district,l=this.searchForm.value.gp?JSON.parse(this.searchForm.value.gp):null,c=this.searchForm.value.block_ulb?JSON.parse(this.searchForm.value.block_ulb):null,g=this.searchForm.value.a_category,x=this.searchForm.value.social_category,E=this.searchForm.value.pwd_status,y=new Q;c&&(c.pushType==="blockid"?y=y.set("block_id",c.id):c.pushType==="ulbtype"&&(y=y.set("ulb_id",c.id))),l&&(l.pushType==="gpid"?y=y.set("gp_id",l.id):l.pushType==="wardid"&&(y=y.set("ward_id",l.id))),p&&(y=y.set("district_id",p)),g&&(y=y.set("category",g)),x&&(y=y.set("social_category",x)),E&&(y=y.set("pwd_status",E)),y=y.set("offset",this.offset),y=y.set("limit",this.limit);let T=new q({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/report/npci-status`,{params:y,headers:T}).subscribe(_=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=_.count,_.data&&_.data.length>0?(this.application_list=this.application_list.concat(_.data),this.offset+=_.data.length,this.hasMoreRecords=_.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},_=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}getReasonText(n){return this.reasonsMapping[n]||""}getExclusionReasons(n){return Array.isArray(n.exclusion_reasons)?n.exclusion_reasons:typeof n.exclusion_reasons=="number"?[n.exclusion_reasons]:typeof n.exclusion_reasons=="string"?n.exclusion_reasons.split(",").map(Number):[]}exportToExcel(){let n=new Q,p=this.searchForm.value.district,l=this.searchForm.value.gp?JSON.parse(this.searchForm.value.gp):null,c=this.searchForm.value.block_ulb?JSON.parse(this.searchForm.value.block_ulb):null,g=this.searchForm.value.a_category,x=this.searchForm.value.social_category,E=this.searchForm.value.pwd_status;c&&(c.pushType==="blockid"?n=n.set("block_id",c.id):c.pushType==="ulbtype"&&(n=n.set("ulb_id",c.id))),l&&(l.pushType==="gpid"?n=n.set("gp_id",l.id):l.pushType==="wardid"&&(n=n.set("ward_id",l.id))),p&&(n=n.set("district_id",p)),g&&(n=n.set("category",g)),x&&(n=n.set("social_category",x)),E&&(n=n.set("pwd_status",E)),n=n.set("export_all","1");let y=new q({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/report/npci-status`,{params:n,headers:y,responseType:"json"}).subscribe(T=>{this.isExportInProgressExcel=!1;let _=T.data.map((I,A)=>({"SI#":A+1,DISTRICT:I.district_name.toUpperCase(),"BLOCK/ULB":(I.block_name||I.ulb_name).toUpperCase(),"GP/WARD":(I.gp_name||I.ward_no).toUpperCase(),VILLAGE:(I.village?I.village:"").toUpperCase(),CATEGORY:I.category.toUpperCase(),"APPLICATION NO.":I.application_number.toUpperCase(),"APPLICANT NAME":I.applicant_name.toUpperCase(),"FATHER/HUSBAND NAME":I.spouse_or_father_name.toUpperCase(),DOB:this.appService.dateFormat(I.dob),"SOCIAL CATEGORY":I.social_category.toUpperCase(),PWD:I.pwd_status.toUpperCase(),"MOBILE NO.":I.alt_mobile_number,"NPCI FAILED REASONS":(I.failure_remarks?I.failure_remarks:"").toUpperCase()})),f=ee.json_to_sheet(_),b=ee.book_new();ee.book_append_sheet(b,f,"Applications");let R=ke(b,{bookType:"xlsx",type:"array"}),U=new Date,Y=U.toLocaleDateString("en-GB").split("/").reverse().join("-"),H=U.toLocaleTimeString("en-GB").replace(/:/g,"-"),$=`npci_reports_${Y}_${H}.xlsx`,j=new Blob([R],{type:"application/octet-stream"}),O=document.createElement("a"),M=window.URL.createObjectURL(j);O.href=M,O.download=$,O.click(),window.URL.revokeObjectURL(M)},T=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",T)})}exportToPDF(){Qe.default.vfs=ut.default.pdfMake.vfs;let n=new Q,p=this.searchForm.value.district,l=this.searchForm.value.gp?JSON.parse(this.searchForm.value.gp):null,c=this.searchForm.value.block_ulb?JSON.parse(this.searchForm.value.block_ulb):null,g=this.searchForm.value.a_category,x=this.searchForm.value.social_category,E=this.searchForm.value.pwd_status;c&&(c.pushType==="blockid"?n=n.set("block_id",c.id):c.pushType==="ulbtype"&&(n=n.set("ulb_id",c.id))),l&&(l.pushType==="gpid"?n=n.set("gp_id",l.id):l.pushType==="wardid"&&(n=n.set("ward_id",l.id))),p&&(n=n.set("district_id",p)),g&&(n=n.set("category",g)),x&&(n=n.set("social_category",x)),E&&(n=n.set("pwd_status",E)),n=n.set("export_all","1");let y=new q({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/report/npci-status`,{params:n,headers:y,responseType:"json"}).subscribe(T=>{this.isExportInProgress=!1;let _=T.data[0]||{},f=(_.district_name||"N/A").toUpperCase(),b=(_.block_name||_.ulb_name||"N/A").toUpperCase(),R=(_.gp_name||_.ward_no||"N/A").toUpperCase(),U=[[{text:"SI#",fontSize:10},{text:"VILLAGE",fontSize:10},{text:"CATEGORY",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"DOB",fontSize:10},{text:"SOCIAL CATEGORY",fontSize:10},{text:"PWD",fontSize:10},{text:"MOBILE NO",fontSize:10},{text:"NPCI FAILED REASONS",fontSize:10}]];T.data.forEach((M,I)=>{U.push([{text:(I+1).toString().toUpperCase(),fontSize:9},{text:(M.village?M.village:"").toUpperCase(),fontSize:9},{text:(M.category||"").toUpperCase(),fontSize:9},{text:(M.application_number||"").toUpperCase(),fontSize:9},{text:(M.applicant_name||"").toUpperCase(),fontSize:9},{text:(M.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(M.dob)||"",fontSize:9},{text:(M.social_category||"").toUpperCase(),fontSize:9},{text:(M.pwd_status||"").toUpperCase(),fontSize:9},{text:(M.alt_mobile_number||"").toUpperCase(),fontSize:9},{text:(M.failure_remarks||"").toUpperCase(),fontSize:9}])});let Y={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${f} > BLOCK/ULB: ${b} > GP/WARD: ${R}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"NPCI FAILED STATUS REPORT",style:"header"},{table:{headerRows:1,body:U,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]},layout:{fillColor:function(M){return M===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},H=new Date,$=H.toLocaleDateString("en-GB").split("/").reverse().join("-"),j=H.toLocaleTimeString("en-GB").replace(/:/g,"-"),O=`npci_failed_reports_${$}_${j}.pdf`;Qe.default.createPdf(Y).download(O)},T=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",T)})}};r.\u0275fac=function(p){return new(p||r)(w(pe),w(ye),w(de),w(ce),w(me),w(_e),w(Te))},r.\u0275cmp=ne({type:r,selectors:[["app-npci-status"]],decls:80,vars:11,consts:[[1,"container-fluid"],[1,"card-title","mb-3"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-2"],[1,"col-md-3"],["for","district",1,"fw-bold"],[1,"text-danger"],["id","district","formControlName","district",1,"form-control","form-select","my-2",3,"change"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"field"],["for","block_ulb",1,"fw-bold"],["id","block_ulb","formControlName","block_ulb",1,"form-control","form-select","my-2",3,"change"],["label","Blocks"],[4,"ngFor","ngForOf"],["label","ULBs"],["for","gp",1,"fw-bold"],["id","gp","formControlName","gp",1,"form-control","form-select","my-2"],["for","a_category",1,"fw-bold"],["formControlName","a_category","id","a_category",1,"form-select","my-2"],["value","1"],["value","0"],["for","social_category",1,"fw-bold"],["formControlName","social_category","id","social_category",1,"form-select","my-2"],["value","2"],["value","3"],["value","4"],["for","pwd_status",1,"fw-bold"],["formControlName","pwd_status","id","pwd_status",1,"form-select","my-2"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],["class","mt-3","style","background-color: #e3e3e3; border: none;",4,"ngIf"],[3,"value"],[3,"ngValue",4,"ngIf"],[3,"ngValue"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[1,"row","mb-2"],[1,"col-md-6"],[1,"card-title"],["id","recordCount"],[1,"col-md-6","text-end"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports"],[2,"min-width","100px"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"],[4,"ngIf"],[1,"fa","fa-spinner","fa-spin"]],template:function(p,l){p&1&&(i(0,"div",0)(1,"h4",1),a(2,"NPCI Failed Status Report"),t(),i(3,"div",2)(4,"form",3),B("ngSubmit",function(){return l.onSearch()}),i(5,"div",4)(6,"div",5)(7,"label",6),a(8,"District "),i(9,"span",7),a(10,"*"),t()(),i(11,"select",8),B("change",function(){return l.onDistrictChange()}),i(12,"option",9),a(13,"Select District"),t(),u(14,Lo,2,2,"option",10),t(),S(15,"app-form-error",11),t(),i(16,"div",5)(17,"label",12),a(18,"Block/ULB "),i(19,"span",7),a(20,"*"),t()(),i(21,"select",13),B("change",function(){return l.onBlockChange()}),i(22,"option",9),a(23,"Select Block/ULB"),t(),i(24,"optgroup",14),u(25,Po,2,1,"ng-container",15),t(),i(26,"optgroup",16),u(27,Ro,2,1,"ng-container",15),t()(),S(28,"app-form-error",11),t(),i(29,"div",5)(30,"label",17),a(31,"GP/Ward "),i(32,"span",7),a(33,"*"),t()(),i(34,"select",18)(35,"option",9),a(36,"Select GP/Ward"),t(),u(37,Uo,2,1,"ng-container",15)(38,jo,2,1,"ng-container",15),t(),S(39,"app-form-error",11),t(),i(40,"div",5)(41,"label",19),a(42," Category "),t(),i(43,"select",20)(44,"option",9),a(45,"Choose Category"),t(),i(46,"option",21),a(47,"NFSA"),t(),i(48,"option",22),a(49,"NON-NFSA"),t()()()(),i(50,"div",4)(51,"div",5)(52,"label",23),a(53," Social Category "),t(),i(54,"select",24)(55,"option",9),a(56,"Choose Social Category"),t(),i(57,"option",21),a(58,"General"),t(),i(59,"option",25),a(60,"OBC"),t(),i(61,"option",26),a(62,"SC"),t(),i(63,"option",27),a(64,"ST"),t()()(),i(65,"div",5)(66,"label",28),a(67," PWD "),t(),i(68,"select",29)(69,"option",9),a(70,"Choose PWD"),t(),i(71,"option",21),a(72,"Yes "),t(),i(73,"option",22),a(74,"NO"),t()()()(),i(75,"div",30)(76,"div",31),u(77,Vo,3,0,"button",32)(78,zo,3,0),t()()()(),u(79,sa,21,6,"div",33),t()),p&2&&(s(4),d("formGroup",l.searchForm),s(10),d("ngForOf",l.districts),s(1),d("field",l.searchForm.controls.district),s(10),d("ngForOf",l.blockULBList),s(2),d("ngForOf",l.blockULBList),s(1),d("field",l.searchForm.controls.block_ulb),s(9),d("ngForOf",l.gpWardList),s(1),d("ngForOf",l.gpWardList),s(1),d("field",l.searchForm.controls.gp),s(38),k(77,l.isFormSearchInProgress?78:77),s(2),d("ngIf",l.showTable))},dependencies:[re,se,Ee,ge,ve,Ce,be,ue,he,Se,xe,le]});let e=r;return e})();var Ze=ie(we()),ft=ie(De());function la(e,r){if(e&1&&(i(0,"option",25),a(1),t()),e&2){let o=r.$implicit;d("value",o.id),s(1),h(o.district_name)}}function ca(e,r){if(e&1&&(i(0,"option",27),a(1),t()),e&2){let o=m().$implicit,n=m();d("ngValue",n.jsonify(o)),s(1),V(" ",o.block_name," ")}}function pa(e,r){if(e&1&&(z(0),u(1,ca,2,2,"option",26),G()),e&2){let o=r.$implicit;s(1),d("ngIf",o.pushType==="blockid")}}function da(e,r){if(e&1&&(i(0,"option",27),a(1),t()),e&2){let o=m().$implicit,n=m();d("ngValue",n.jsonify(o)),s(1),V(" ",o.ulb_name," ")}}function ma(e,r){if(e&1&&(z(0),u(1,da,2,2,"option",26),G()),e&2){let o=r.$implicit;s(1),d("ngIf",o.pushType==="ulbtype")}}function _a(e,r){if(e&1&&(i(0,"option",27),a(1),t()),e&2){let o=m().$implicit,n=m();d("ngValue",n.jsonify(o)),s(1),V(" ",o.gp_name," ")}}function ua(e,r){if(e&1&&(z(0),u(1,_a,2,2,"option",26),G()),e&2){let o=r.$implicit;s(1),d("ngIf",o.pushType==="gpid")}}function ha(e,r){if(e&1&&(i(0,"option",27),a(1),t()),e&2){let o=m().$implicit,n=m();d("ngValue",n.jsonify(o)),s(1),V(" ",o.ward_no," ")}}function fa(e,r){if(e&1&&(z(0),u(1,ha,2,2,"option",26),G()),e&2){let o=r.$implicit;s(1),d("ngIf",o.pushType==="wardid")}}function ga(e,r){e&1&&(i(0,"button",28),S(1,"i",29),a(2,"Search "),t())}function Sa(e,r){e&1&&(i(0,"button",30),S(1,"i",31),a(2," Searching ..."),t())}function xa(e,r){if(e&1){let o=K();i(0,"button",47),B("click",function(){X(o);let p=m(2);return J(p.exportToPDF())}),S(1,"i",48),a(2,"Download to PDF "),t()}}function ba(e,r){e&1&&(i(0,"button",49),S(1,"i",31),a(2,"Downloading "),t())}function va(e,r){if(e&1){let o=K();i(0,"button",47),B("click",function(){X(o);let p=m(2);return J(p.exportToExcel())}),S(1,"i",48),a(2,"Download to EXCEL "),t()}}function Ca(e,r){e&1&&(i(0,"button",49),S(1,"i",31),a(2,"Downloading "),t())}var ya=(e,r)=>r.id;function Ea(e,r){if(e&1&&(i(0,"td"),a(1),v(2,"uppercase"),t()),e&2){let o=m().$implicit;s(1),h(C(2,1,o.block_name))}}function Ta(e,r){if(e&1&&(i(0,"td"),a(1),v(2,"uppercase"),t()),e&2){let o=m().$implicit;s(1),h(C(2,1,o.ulb_name))}}function ka(e,r){if(e&1&&(i(0,"td"),a(1),v(2,"uppercase"),t()),e&2){let o=m().$implicit;s(1),h(C(2,1,o.gp_name))}}function Ia(e,r){if(e&1&&(i(0,"td"),a(1),v(2,"uppercase"),t()),e&2){let o=m().$implicit;s(1),h(C(2,1,o.ward_no))}}function Aa(e,r){if(e&1&&(i(0,"td"),a(1),v(2,"uppercase"),t()),e&2){let o=m().$implicit;s(1),h(C(2,1,o.village_name))}}function Fa(e,r){e&1&&S(0,"td")}function wa(e,r){e&1&&(i(0,"span"),a(1,"VERIFIED"),t())}function Da(e,r){if(e&1&&(i(0,"td"),u(1,wa,2,0,"span",52),t()),e&2){let o=m().$implicit;s(1),d("ngIf",o.re_ekyc_status==="1")}}function La(e,r){e&1&&S(0,"td")}function Na(e,r){if(e&1&&(i(0,"tr")(1,"td"),a(2),t(),i(3,"td"),a(4),v(5,"uppercase"),t(),u(6,Ea,3,3,"td")(7,Ta,3,3)(8,ka,3,3,"td")(9,Ia,3,3)(10,Aa,3,3,"td")(11,Fa,1,0),i(12,"td"),a(13),v(14,"uppercase"),t(),i(15,"td"),a(16),v(17,"uppercase"),t(),i(18,"td"),a(19),v(20,"uppercase"),t(),i(21,"td"),a(22),v(23,"uppercase"),t(),i(24,"td"),a(25),t(),u(26,Da,2,1,"td")(27,La,1,0),i(28,"td"),a(29),t(),i(30,"td"),a(31),v(32,"uppercase"),t()()),e&2){let o=r.$implicit,n=r.$index,p=m(3);s(2),h(n+1),s(2),h(C(5,13,o.district_name)),s(2),k(6,o.block_name?6:o.ulb_name?7:-1),s(2),k(8,o.gp_name?8:o.ward_no?9:-1),s(2),k(10,o.village_name?10:11),s(3),h(C(14,15,o.category)),s(3),h(C(17,17,o.application_number)),s(3),h(C(20,19,o.applicant_name)),s(3),h(C(23,21,o.spouse_or_father_name)),s(3),h(p.appService.dateFormat(o.dob)),s(1),k(26,o.re_ekyc_status?26:27),s(3),h(p.appService.dateFormat(o.re_ekycdate)),s(2),h(C(32,23,o.e_kyc_mode))}}function Pa(e,r){if(e&1&&(i(0,"table",50)(1,"thead")(2,"tr")(3,"th"),a(4,"SI#"),t(),i(5,"th"),a(6,"DISTRICT"),t(),i(7,"th"),a(8,"BLOCK/ULB"),t(),i(9,"th"),a(10,"GP/WARD"),t(),i(11,"th"),a(12,"VILLAGE"),t(),i(13,"th"),a(14,"CATEGORY"),t(),i(15,"th"),a(16,"APPLICATION NO."),t(),i(17,"th"),a(18,"APPLICANT NAME"),t(),i(19,"th"),a(20,"FATHER/HUSBAND NAME"),t(),i(21,"th",51),a(22,"DOB"),t(),i(23,"th"),a(24,"RE-eKYC STATUS"),t(),i(25,"th",51),a(26,"RE-eKYC DATE"),t(),i(27,"th"),a(28,"RE-eKYC MODE"),t()()(),i(29,"tbody"),oe(30,Na,33,25,"tr",null,ya),t()()),e&2){let o=m(2);s(30),ae(o.application_list)}}function Ba(e,r){e&1&&(i(0,"h5",53),a(1,"No data available"),t())}function Ra(e,r){e&1&&(i(0,"div",54),a(1,"Loading.. "),S(2,"i",55),t())}function Oa(e,r){e&1&&(i(0,"span"),S(1,"i",58),a(2," Loading..."),t())}function Ua(e,r){e&1&&(i(0,"span"),a(1,"Load More"),t())}function Ma(e,r){if(e&1){let o=K();i(0,"div",56)(1,"button",57),B("click",function(){X(o);let p=m(2);return J(p.loadMore())}),u(2,Oa,3,0,"span",52)(3,Ua,2,0,"span",52),t()()}if(e&2){let o=m(2);s(2),d("ngIf",o.isLoadMoreInProgress),s(1),d("ngIf",!o.isLoadMoreInProgress)}}function ja(e,r){if(e&1&&(i(0,"div",32)(1,"div",33)(2,"div",34)(3,"div",35)(4,"div",36)(5,"h5",37),a(6," Number of records found : "),i(7,"span",38),a(8),t()()(),i(9,"div",39)(10,"div",40),u(11,xa,3,0,"button",41)(12,ba,3,0),t(),i(13,"div",42),u(14,va,3,0,"button",41)(15,Ca,3,0),t()()(),i(16,"div",43),u(17,Pa,32,0,"table",44)(18,Ba,2,0)(19,Ra,3,0,"div",45),t(),u(20,Ma,4,2,"div",46),t()()()),e&2){let o=m();s(8),h(o.count),s(3),k(11,o.isExportInProgress?12:11),s(3),k(14,o.isExportInProgressExcel?15:14),s(3),k(17,o.application_list&&o.application_list.length>0?17:o.application_list&&o.application_list.length==0&&!o.isFormSearchInProgress?18:-1),s(2),k(19,o.isFormSearchInProgress&&o.application_list&&o.application_list.length==0?19:-1),s(1),d("ngIf",o.hasMoreRecords&&o.application_list.length>0)}}var gt=(()=>{let r=class r{constructor(n,p,l,c,g,x,E){this.router=n,this.formService=p,this.appService=l,this.httpClient=c,this.toastService=g,this.authService=x,this.masterDataService=E,this.districts=[],this.blocks=[],this.ulbs=[],this.gramPanchats=[],this.wards=[],this.blockULBList=[],this.gpWardList=[],this.isFormSearchInProgress=!1,this.showTable=!1,this.application_list=[],this.hasMoreRecords=!0,this.offset=0,this.isLoadMoreInProgress=!1,this.limit=this.appService.loadmorelimit,this.isExportInProgress=!1,this.isExportInProgressExcel=!1,this.isDisabled=!1,this.count=0,this.searchForm=new fe({district:new F("",[Z.required]),block_ulb:new F("",[Z.required]),gp:new F("",[Z.required]),a_status:new F(""),reekyc_date:new F("")})}ngOnInit(){let n=this.authService.userDetail.role.id,p=this.authService.userDetail.demography_id,l=this.authService.userDetail.district_id,c=this.authService.userDetail.demography_type;c===1?this.fetchAllDistricts():c===2?(this.fetchDistrictById(p),this.isDisabled=!0,this.searchForm.get("district")?.disable()):(c===3||c===5)&&(this.fetchDistrictById(l),this.isDisabled=!0,this.searchForm.get("district")?.disable(),this.searchForm.get("block_ulb")?.disable())}getMaskedAadhaar(n){return!n||n.length!==12?n:"********"+n.slice(-4)}fetchAllDistricts(){this.districts=te.data}fetchDistrictById(n){this.districts=te.data.filter(p=>p.id==n),this.searchForm.patchValue({district:n}),this.onDistrictChange()}onDistrictChange(){let n="";this.searchForm.value.district!=""&&(n=this.searchForm.value.district),this.searchForm.get("block_ulb")?.setValue(""),this.searchForm.get("gp")?.setValue(""),this.blocks=[],this.ulbs=[],this.blockULBList=[],this.blocks=this.masterDataService.getBlockData(n),this.ulbs=this.masterDataService.getULBData(n),this.blockULBList=[...this.blocks.map(c=>P(N({},c),{pushType:"blockid"})),...this.ulbs.map(c=>P(N({},c),{pushType:"ulbtype"}))];let p=this.authService.userDetail.demography_type,l=this.authService.userDetail.role.id;p===5&&(this.blocks=[],this.ulbs=this.ulbs.filter(c=>c.id==this.authService.userDetail.demography_id)),p===5&&(console.log("ulbs",this.ulbs),this.searchForm.patchValue({block_ulb:this.jsonify(P(N({},this.ulbs.find(c=>c.id==this.authService.userDetail.demography_id)),{pushType:"ulbtype"}))}),this.onBlockChange()),p===3&&(this.blocks=this.blocks.filter(c=>c.id==this.authService.userDetail.demography_id),this.ulbs=[]),p===3&&(this.searchForm.patchValue({block_ulb:this.jsonify(P(N({},this.blocks.find(c=>c.id==this.authService.userDetail.demography_id)),{pushType:"blockid"}))}),this.onBlockChange())}onBlockChange(){let n="";this.searchForm.value.block_ulb&&(n=JSON.parse(this.searchForm.value.block_ulb)),this.searchForm.get("gp")?.setValue(""),this.gramPanchats=[],this.wards=[],this.gpWardList=[];let p=n.pushType==="blockid",l=n.pushType==="ulbtype",c=[];p&&(this.gramPanchats=this.masterDataService.getGPData(n.id),this.gpWardList=this.gramPanchats.map(g=>P(N({},g),{pushType:"gpid"}))),l&&(this.wards=this.masterDataService.getWARDData(n.id),this.gpWardList=this.wards.map(g=>P(N({},g),{pushType:"wardid"})))}jsonify(n){return JSON.stringify(n)}onSearch(n=!1){if(this.searchForm.status==="INVALID"){this.formService.triggerFormValidation(this.searchForm);return}n||(this.application_list=[],this.offset=0,this.hasMoreRecords=!0),this.isFormSearchInProgress=this.offset===0,this.isLoadMoreInProgress=this.offset>0;let p=this.searchForm.value.district,l=this.searchForm.value.gp?JSON.parse(this.searchForm.value.gp):null,c=this.searchForm.value.block_ulb?JSON.parse(this.searchForm.value.block_ulb):null,g=this.searchForm.value.reekyc_date,x=new Q;c&&(c.pushType==="blockid"?x=x.set("block_id",c.id):c.pushType==="ulbtype"&&(x=x.set("ulb_id",c.id))),l&&(l.pushType==="gpid"?x=x.set("gp_id",l.id):l.pushType==="wardid"&&(x=x.set("ward_id",l.id))),p&&(x=x.set("district_id",p)),g&&(x=x.set("reekyc_date",g)),x=x.set("offset",this.offset),x=x.set("limit",this.limit);let E=new q({Authorization:this.authService.authToken});this.httpClient.get(`${this.appService.departmentBaseUrl}/citizen-ekyc/re-ekyc-applicants`,{params:x,headers:E}).subscribe(y=>{this.isFormSearchInProgress=!1,this.showTable=!0,this.count=y.count,y.data&&y.data.length>0?(this.application_list=this.application_list.concat(y.data),this.offset+=y.data.length,this.hasMoreRecords=y.data.length===this.limit):this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)},y=>{this.isFormSearchInProgress=!1,this.application_list=[],this.showTable=!1,this.hasMoreRecords=!1,n&&(this.isLoadMoreInProgress=!1)})}loadMore(){this.onSearch(!0)}exportToExcel(){let n=this.searchForm.value.district,p=this.searchForm.value.gp?JSON.parse(this.searchForm.value.gp):null,l=this.searchForm.value.block_ulb?JSON.parse(this.searchForm.value.block_ulb):null,c=this.searchForm.value.reekyc_date,g=new Q;l&&(l.pushType==="blockid"?g=g.set("block_id",l.id):l.pushType==="ulbtype"&&(g=g.set("ulb_id",l.id))),p&&(p.pushType==="gpid"?g=g.set("gp_id",p.id):p.pushType==="wardid"&&(g=g.set("ward_id",p.id))),n&&(g=g.set("district_id",n)),c&&(g=g.set("reekyc_date",c)),g=g.set("export_all","1");let x=new q({Authorization:this.authService.authToken});this.isExportInProgressExcel=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/citizen-ekyc/re-ekyc-applicants`,{params:g,headers:x,responseType:"json"}).subscribe(E=>{this.isExportInProgressExcel=!1;let y=E.data.map((O,M)=>({"SI#":M+1,DISTRICT:O.district_name.toUpperCase(),"BLOCK/ULB":(O.block_name||O.ulb_name).toUpperCase(),"GP/WARD":(O.gp_name||O.ward_no).toUpperCase(),VILLAGE:O.village_name?O.village_name.toUpperCase():"",CATEGORY:O.category.toUpperCase(),"APPLICATION NO.":O.application_number,"APPLICANT NAME":O.applicant_name.toUpperCase(),"FATHER/HUSBAND NAME":O.spouse_or_father_name.toUpperCase(),DOB:this.appService.dateFormat(O.dob),"RE-eKYC STATUS":O.re_ekyc_status==="1"?"VERIFIED":"","RE-eKYC DATE":this.appService.dateFormat(O.re_ekycdate),"RE-eKYC MODE":O.e_kyc_mode.toUpperCase()})),T=ee.json_to_sheet(y),_=ee.book_new();ee.book_append_sheet(_,T,"Applications");let f=ke(_,{bookType:"xlsx",type:"array"}),b=new Date,R=b.toLocaleDateString("en-GB").split("/").reverse().join("-"),U=b.toLocaleTimeString("en-GB").replace(/:/g,"-"),Y=`reekyc_reports_${R}_${U}.xlsx`,H=new Blob([f],{type:"application/octet-stream"}),$=document.createElement("a"),j=window.URL.createObjectURL(H);$.href=j,$.download=Y,$.click(),window.URL.revokeObjectURL(j)},E=>{this.isExportInProgressExcel=!1,console.error("Error exporting to Excel:",E)})}exportToPDF(){Ze.default.vfs=ft.default.pdfMake.vfs;let n=new Q,p=this.searchForm.value.district,l=this.searchForm.value.gp?JSON.parse(this.searchForm.value.gp):null,c=this.searchForm.value.block_ulb?JSON.parse(this.searchForm.value.block_ulb):null,g=this.searchForm.value.reekyc_date;c&&(c.pushType==="blockid"?n=n.set("block_id",c.id):c.pushType==="ulbtype"&&(n=n.set("ulb_id",c.id))),l&&(l.pushType==="gpid"?n=n.set("gp_id",l.id):l.pushType==="wardid"&&(n=n.set("ward_id",l.id))),p&&(n=n.set("district_id",p)),g&&(n=n.set("reekyc_date",g)),n=n.set("export_all","1");let x=new q({Authorization:this.authService.authToken});this.isExportInProgress=!0,this.httpClient.get(`${this.appService.departmentBaseUrl}/citizen-ekyc/re-ekyc-applicants`,{params:n,headers:x,responseType:"json"}).subscribe(E=>{this.isExportInProgress=!1;let y=E.data[0]||{},T=(y.district_name||"N/A").toUpperCase(),_=(y.block_name||y.ulb_name||"N/A").toUpperCase(),f=(y.gp_name||y.ward_no||"N/A").toUpperCase(),b=[[{text:"SI#",fontSize:10},{text:"VILLAGE",fontSize:10},{text:"CATEGORY",fontSize:10},{text:"APPLICATION NO.",fontSize:10},{text:"APPLICANT NAME",fontSize:10},{text:"FATHER/HUSBAND NAME",fontSize:10},{text:"DOB",fontSize:10},{text:"RE-eKYC STATUS",fontSize:10},{text:"RE-eKYC DATE",fontSize:10},{text:"RE-eKYC MODE",fontSize:10}]];E.data.forEach((j,O)=>{b.push([{text:(O+1).toString().toUpperCase(),fontSize:9},{text:(j.village_name||"").toUpperCase(),fontSize:9},{text:(j.category||"").toUpperCase(),fontSize:9},{text:(j.application_number||"").toUpperCase(),fontSize:9},{text:(j.applicant_name||"").toUpperCase(),fontSize:9},{text:(j.spouse_or_father_name||"").toUpperCase(),fontSize:9},{text:this.appService.dateFormat(j.dob)||"",fontSize:9},{text:j.re_ekyc_status==="1"?"VERIFIED":"",fontSize:9},{text:this.appService.dateFormat(j.re_ekycdate)||"",fontSize:9},{text:(j.e_kyc_mode||"").toUpperCase(),fontSize:9}])});let R={pageOrientation:"landscape",pageSize:"A4",content:[{text:`DISTRICT: ${T} > BLOCK/ULB: ${_} > GP/WARD: ${f}`,style:"breadcrumb",margin:[0,0,0,10]},{text:"RE - eKYC STATUS REPORT",style:"header"},{table:{headerRows:1,body:b,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"]},layout:{fillColor:function(j){return j===0?"#CCCCCC":null},paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}}],styles:{header:{fontSize:9,bold:!0,margin:[0,0,0,5]},breadcrumb:{fontSize:9,bold:!0,margin:[0,0,0,10]},table:{fontSize:7,lineHeight:1.2}}},U=new Date,Y=U.toLocaleDateString("en-GB").split("/").reverse().join("-"),H=U.toLocaleTimeString("en-GB").replace(/:/g,"-"),$=`reeKYC_reports_${Y}_${H}.pdf`;Ze.default.createPdf(R).download($)},E=>{this.isExportInProgress=!1,console.error("Error exporting to PDF:",E)})}};r.\u0275fac=function(p){return new(p||r)(w(pe),w(ye),w(de),w(ce),w(me),w(_e),w(Te))},r.\u0275cmp=ne({type:r,selectors:[["app-re-ekyc"]],decls:49,vars:11,consts:[[1,"container-fluid"],[1,"card-title","mb-3"],[1,"card","p-3","mb-3"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-2"],[1,"col-md-3"],["for","district",1,"fw-bold"],[1,"text-danger"],["id","district","formControlName","district",1,"form-control","form-select","my-2",3,"change"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"field"],["for","block_ulb",1,"fw-bold"],["id","block_ulb","formControlName","block_ulb",1,"form-control","form-select","my-2",3,"change"],["label","Blocks"],[4,"ngFor","ngForOf"],["label","ULBs"],["for","gp",1,"fw-bold"],["id","gp","formControlName","gp",1,"form-control","form-select","my-2"],["for","reekyc_date",1,"fw-bold"],["type","date","id","reekyc_date","formControlName","reekyc_date",1,"form-control","my-2"],[1,"row","g-3","mt-3","d-flex","justify-content-center"],[1,"col-md-4","text-center"],["class","btn bg-btn","type","submit"],["class","mt-3","style","background-color: #e3e3e3; border: none;",4,"ngIf"],[3,"value"],[3,"ngValue",4,"ngIf"],[3,"ngValue"],["type","submit",1,"btn","bg-btn"],[1,"fa-solid","fa-arrow-circle-right","me-1"],["type","button","disabled","",1,"btn","bg-btn"],[1,"fa-solid","fa-spinner","fa-spin","me-1"],[1,"mt-3",2,"background-color","#e3e3e3","border","none"],[1,"card"],[1,"card-body","p-3"],[1,"row","mb-2"],[1,"col-md-6"],[1,"card-title"],["id","recordCount"],[1,"col-md-6","text-end"],[1,"d-inline","me-2"],["class","btn px-2","style","background-color: #ffe8d0; color: #fd7b03; font-weight: 620;","type","button"],[1,"d-inline"],[1,"table-responsive"],["class","table table-bordered app_reports"],["class","text-center pb-3"],["class","text-center mt-3",4,"ngIf"],["type","button",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620",3,"click"],[1,"fa-solid","fa-cloud-arrow-down","me-1"],["disabled","",1,"btn","px-2",2,"background-color","#ffe8d0","color","#fd7b03","font-weight","620"],[1,"table","table-bordered","app_reports"],[2,"min-width","100px"],[4,"ngIf"],[1,"text-center"],[1,"text-center","pb-3"],[1,"fas","fa-spinner","fa-spin","ms-2"],[1,"text-center","mt-3"],[1,"btn","btn-primary",3,"click"],[1,"fa","fa-spinner","fa-spin"]],template:function(p,l){p&1&&(i(0,"div",0)(1,"h4",1),a(2,"Re-eKYC Status Report"),t(),i(3,"div",2)(4,"form",3),B("ngSubmit",function(){return l.onSearch()}),i(5,"div",4)(6,"div",5)(7,"label",6),a(8,"District "),i(9,"span",7),a(10,"*"),t()(),i(11,"select",8),B("change",function(){return l.onDistrictChange()}),i(12,"option",9),a(13,"Select District"),t(),u(14,la,2,2,"option",10),t(),S(15,"app-form-error",11),t(),i(16,"div",5)(17,"label",12),a(18,"Block/ULB "),i(19,"span",7),a(20,"*"),t()(),i(21,"select",13),B("change",function(){return l.onBlockChange()}),i(22,"option",9),a(23,"Select Block/ULB"),t(),i(24,"optgroup",14),u(25,pa,2,1,"ng-container",15),t(),i(26,"optgroup",16),u(27,ma,2,1,"ng-container",15),t()(),S(28,"app-form-error",11),t(),i(29,"div",5)(30,"label",17),a(31,"GP/Ward "),i(32,"span",7),a(33,"*"),t()(),i(34,"select",18)(35,"option",9),a(36,"Select GP/Ward"),t(),u(37,ua,2,1,"ng-container",15)(38,fa,2,1,"ng-container",15),t(),S(39,"app-form-error",11),t(),i(40,"div",5)(41,"label",19),a(42," Re-eKYC Date "),t(),S(43,"input",20),t()(),i(44,"div",21)(45,"div",22),u(46,ga,3,0,"button",23)(47,Sa,3,0),t()()()(),u(48,ja,21,6,"div",24),t()),p&2&&(s(4),d("formGroup",l.searchForm),s(10),d("ngForOf",l.districts),s(1),d("field",l.searchForm.controls.district),s(10),d("ngForOf",l.blockULBList),s(2),d("ngForOf",l.blockULBList),s(1),d("field",l.searchForm.controls.block_ulb),s(9),d("ngForOf",l.gpWardList),s(1),d("ngForOf",l.gpWardList),s(1),d("field",l.searchForm.controls.gp),s(7),k(46,l.isFormSearchInProgress?47:46),s(2),d("ngIf",l.showTable))},dependencies:[re,se,Ee,ge,ve,Ce,Ie,be,ue,he,Se,xe,le]});let e=r;return e})();var Va=[{path:"application",component:at,canActivate:[Ae]},{path:"application-status",component:_t,canActivate:[Ae]},{path:"rejected-application",component:ct,canActivate:[Ae]},{path:"ekyc",component:st,canActivate:[Ae]},{path:"approved-application",component:dt,canActivate:[Ae]},{path:"npci-rejection-status",component:ht,canActivate:[Ae]},{path:"re-ekyc",component:gt,canActivate:[Ae]}],St=(()=>{let r=class r{};r.\u0275fac=function(p){return new(p||r)},r.\u0275mod=$e({type:r}),r.\u0275inj=Ge({imports:[We.forChild(Va),We]});let e=r;return e})();var Or=(()=>{let r=class r{};r.\u0275fac=function(p){return new(p||r)},r.\u0275mod=$e({type:r}),r.\u0275inj=Ge({imports:[et,St,nt,tt,it]});let e=r;return e})();export{Or as a};
